{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ShellBook","text":"<p>Bienvenue dans ShellBook, la base de connaissances Docs-as-Code pour les \u00e9quipes SysOps/DevOps.</p>"},{"location":"#parcours-de-formation","title":"Parcours de Formation","text":"<p>Les formations sont organis\u00e9es par niveau de complexit\u00e9 et zone d'acc\u00e8s infrastructure :</p> Niveau Focus Public cible Niveau 0 Acc\u00e8s PADSEC, VPN, Active Directory Nouveaux arrivants, tous profils Niveau 1 S\u00e9curit\u00e9, PKI, Certificats Ops confirm\u00e9s, Security Engineers Niveau 2 Linux, Windows, Scripting avanc\u00e9 SysAdmins, Platform Engineers Niveau 3 Cloud (GCP/GKE), IaC, GitOps DevOps, SRE, Cloud Architects"},{"location":"#demarrage-rapide","title":"D\u00e9marrage Rapide","text":"<ul> <li> <p>:material-shield-lock:{ .lg .middle } Niveau 0 - Fondations</p> <p>Commencez par comprendre l'architecture PADSEC et les acc\u00e8s VPN.</p> <p>:octicons-arrow-right-24: Architecture PADSEC</p> </li> <li> <p>:material-certificate:{ .lg .middle } Niveau 1 - S\u00e9curit\u00e9</p> <p>Ma\u00eetrisez la PKI et la gestion des certificats.</p> <p>:octicons-arrow-right-24: Infrastructure PKI</p> </li> <li> <p>:material-linux:{ .lg .middle } Niveau 2 - Plateformes</p> <p>Approfondissez Linux, Windows et le scripting.</p> <p>:octicons-arrow-right-24: Linux Performance</p> </li> <li> <p>:material-cloud:{ .lg .middle } Niveau 3 - Cloud &amp; DevOps</p> <p>D\u00e9ployez sur GKE avec Terraform et ArgoCD.</p> <p>:octicons-arrow-right-24: GCP &amp; GKE</p> </li> </ul>"},{"location":"#architecture-documentaire","title":"Architecture Documentaire","text":"<pre><code>docs/\n\u251c\u2500\u2500 formations/           # Modules de formation par technologie\n\u2502   \u251c\u2500\u2500 ad-hardening/     # Hardening Active Directory\n\u2502   \u251c\u2500\u2500 gcp-gke/          # Google Kubernetes Engine\n\u2502   \u251c\u2500\u2500 gitops-argocd/    # GitOps avec ArgoCD\n\u2502   \u251c\u2500\u2500 linux/            # Services Linux (Edge, etc.)\n\u2502   \u251c\u2500\u2500 linux-perf/       # Performance Linux\n\u2502   \u251c\u2500\u2500 pki-security/     # Infrastructure PKI\n\u2502   \u251c\u2500\u2500 powershell-advanced/  # PowerShell avanc\u00e9\n\u2502   \u251c\u2500\u2500 terraform-ops/    # Terraform industrialis\u00e9\n\u2502   \u2514\u2500\u2500 windows/          # Active Directory, WSUS, etc.\n\u251c\u2500\u2500 network/              # Documentation r\u00e9seau (VPN, etc.)\n\u251c\u2500\u2500 security/             # Guides s\u00e9curit\u00e9 transverses\n\u2514\u2500\u2500 developer/            # Documentation technique interne\n</code></pre>"},{"location":"#conventions","title":"Conventions","text":"<p>Anonymisation</p> <p>Tous les exemples utilisent des noms de domaine et adresses IP fictifs :</p> <ul> <li>Domaine : <code>*.shellbook.local</code></li> <li>Plages IP : <code>192.168.x.x</code>, <code>10.x.x.x</code></li> <li>Serveurs : <code>srv-*</code>, <code>fw-*</code>, <code>dc-*</code></li> </ul> <p>Classification</p> <p>Cette documentation est destin\u00e9e \u00e0 un usage interne uniquement. Ne partagez pas les informations d'architecture en dehors de l'organisation.</p>"},{"location":"#contribution","title":"Contribution","text":"<p>ShellBook suit le paradigme Docs-as-Code :</p> <ol> <li>Fork le repository</li> <li>Cr\u00e9ez une branche feature</li> <li>R\u00e9digez en Markdown avec les extensions MkDocs Material</li> <li>Soumettez une Pull Request</li> </ol> <pre><code># Preview local\nmkdocs serve\n\n# Build statique\nmkdocs build\n</code></pre>"},{"location":"FAQ/","title":"\u2753 FAQ - Questions Fr\u00e9quemment Pos\u00e9es","text":"<p>Trouvez rapidement des r\u00e9ponses aux questions les plus courantes sur TwinShell</p>"},{"location":"FAQ/#table-des-matieres","title":"Table des Mati\u00e8res","text":"<ul> <li>G\u00e9n\u00e9ral</li> <li>Installation</li> <li>Recherche</li> <li>Favoris et Historique</li> <li>Cat\u00e9gories</li> <li>Th\u00e8mes et Interface</li> <li>Export et Import</li> <li>S\u00e9curit\u00e9</li> <li>D\u00e9pannage</li> <li>Fonctionnalit\u00e9s Futures</li> </ul>"},{"location":"FAQ/#general","title":"G\u00e9n\u00e9ral","text":""},{"location":"FAQ/#q-twinshell-fonctionne-t-il-sur-mac-ou-linux","title":"Q : TwinShell fonctionne-t-il sur Mac ou Linux ?","text":"<p>R : Non, TwinShell est une application Windows WPF (.NET 8). Elle n\u00e9cessite : - Windows 10 ou Windows 11 (64-bit) - .NET 8 Runtime</p> <p>Il n'existe pas de version Mac ou Linux pour le moment.</p>"},{"location":"FAQ/#q-puis-je-executer-les-commandes-directement-depuis-twinshell","title":"Q : Puis-je ex\u00e9cuter les commandes directement depuis TwinShell ?","text":"<p>R : Non, TwinShell est un g\u00e9n\u00e9rateur de commandes, pas un terminal.</p> <p>Workflow : 1. S\u00e9lectionnez une commande dans TwinShell 2. Remplissez les param\u00e8tres 3. Copiez la commande g\u00e9n\u00e9r\u00e9e 4. Collez-la dans PowerShell ou Bash 5. Ex\u00e9cutez-la</p> <p>Raison : Cela vous permet de v\u00e9rifier et modifier la commande avant de l'ex\u00e9cuter (s\u00e9curit\u00e9).</p>"},{"location":"FAQ/#q-les-commandes-bash-fonctionnent-elles-sur-windows","title":"Q : Les commandes Bash fonctionnent-elles sur Windows ?","text":"<p>R : Oui, si vous avez install\u00e9 WSL (Windows Subsystem for Linux).</p> <p>\u00c9tapes : 1. Installez WSL : Guide Microsoft 2. Ouvrez un terminal WSL (ex: Ubuntu) 3. Collez et ex\u00e9cutez les commandes Bash g\u00e9n\u00e9r\u00e9es par TwinShell</p> <p>Sans WSL : Les commandes Bash ne fonctionneront pas sur Windows natif (CMD/PowerShell).</p>"},{"location":"FAQ/#q-combien-de-commandes-sont-disponibles-dans-twinshell","title":"Q : Combien de commandes sont disponibles dans TwinShell ?","text":"<p>R : TwinShell inclut 500+ commandes PowerShell et Bash au lancement initial.</p> <p>Cat\u00e9gories couvertes (15 au total) : - \ud83c\udfe2 Active Directory &amp; GPO (utilisateurs, groupes, GPO) - \ud83c\udf10 Network &amp; DNS (ping, traceroute, DNS) - \ud83d\udcca Monitoring &amp; Logs (EventLog, journald) - \u2699\ufe0f Services &amp; Automation (services, t\u00e2ches planifi\u00e9es) - \ud83d\udcbb Windows Optimization (maintenance Windows) - \ud83d\udc27 Linux Administration (administration Linux) - \ud83d\udce6 Package Management (apt, yum, winget, choco) - \ud83d\udcc1 Files &amp; Storage (fichiers, stockage) - \ud83d\udd12 Security &amp; Encryption (s\u00e9curit\u00e9, BitLocker) - \ud83d\udd04 Windows Updates (mises \u00e0 jour) - Et plus encore...</p> <p>\u00c9volution : De nouvelles commandes sont r\u00e9guli\u00e8rement ajout\u00e9es.</p>"},{"location":"FAQ/#q-puis-je-ajouter-mes-propres-commandes","title":"Q : Puis-je ajouter mes propres commandes ?","text":"<p>R : Pas encore via l'interface.</p> <p>M\u00e9thode actuelle (technique) : 1. Modifiez le fichier <code>data/seed/initial-actions.json</code> 2. Ajoutez votre commande au format JSON 3. Relancez l'application (la base de donn\u00e9es sera mise \u00e0 jour)</p> <p>\u00c0 venir : Une interface pour cr\u00e9er des commandes personnalis\u00e9es est pr\u00e9vue dans une future version.</p>"},{"location":"FAQ/#q-ou-sont-stockees-mes-donnees","title":"Q : O\u00f9 sont stock\u00e9es mes donn\u00e9es ?","text":"<p>R : TwinShell stocke vos donn\u00e9es localement dans deux emplacements :</p> Donn\u00e9es Emplacement Format Base de donn\u00e9es (Actions, Favoris, Historique, Cat\u00e9gories) <code>%LOCALAPPDATA%\\TwinShell\\twinshell.db</code> SQLite Param\u00e8tres (Th\u00e8me, pr\u00e9f\u00e9rences) <code>%APPDATA%\\TwinShell\\settings.json</code> JSON <p>Exemple de chemins Windows : <pre><code>C:\\Users\\VotreNom\\AppData\\Local\\TwinShell\\twinshell.db\nC:\\Users\\VotreNom\\AppData\\Roaming\\TwinShell\\settings.json\n</code></pre></p>"},{"location":"FAQ/#installation","title":"Installation","text":""},{"location":"FAQ/#q-quelle-version-de-net-dois-je-installer","title":"Q : Quelle version de .NET dois-je installer ?","text":"<p>R : Vous devez installer .NET 8 Runtime (version 8.0 ou sup\u00e9rieure).</p> <p>T\u00e9l\u00e9chargement : - Page officielle : https://dotnet.microsoft.com/download/dotnet/8.0 - Choisissez : \".NET Desktop Runtime 8.0.x\" (incluant WPF)</p> <p>V\u00e9rifier l'installation : <pre><code>dotnet --version\n# Doit afficher : 8.0.x\n</code></pre></p>"},{"location":"FAQ/#q-quelle-est-la-difference-entre-la-version-setup-et-portable","title":"Q : Quelle est la diff\u00e9rence entre la version Setup et Portable ?","text":"<p>R :</p> Caract\u00e9ristique Version Setup Version Portable Installation N\u00e9cessite un installeur D\u00e9compression ZIP Emplacement Program Files N'importe o\u00f9 Menu D\u00e9marrer Oui, raccourci cr\u00e9\u00e9 Non, lancement manuel D\u00e9sinstallation Via \"Programmes et fonctionnalit\u00e9s\" Suppression du dossier Mises \u00e0 jour Via installeur Remplacement manuel Recommand\u00e9e pour Usage quotidien USB, machines restreintes <p>Recommandation : Utilisez la version Setup pour une installation classique.</p>"},{"location":"FAQ/#q-twinshell-necessite-t-il-des-droits-administrateur","title":"Q : TwinShell n\u00e9cessite-t-il des droits administrateur ?","text":"<p>R : Non pour l'utilisation normale de TwinShell.</p> <p>Cependant : - Certaines commandes g\u00e9n\u00e9r\u00e9es peuvent n\u00e9cessiter des droits admin (ex: gestion de services, modification de GPO) - L'installation (version Setup) peut demander des droits admin</p> <p>Conseil : Lancez PowerShell en tant qu'administrateur si vous devez ex\u00e9cuter des commandes privil\u00e9gi\u00e9es.</p>"},{"location":"FAQ/#recherche","title":"Recherche","text":""},{"location":"FAQ/#q-pourquoi-ma-recherche-get-service-trouve-t-elle-aussi-get-service-et-getservice","title":"Q : Pourquoi ma recherche \"Get-Service\" trouve-t-elle aussi \"Get Service\" et \"GetService\" ?","text":"<p>R : TwinShell normalise la ponctuation pour une recherche plus tol\u00e9rante.</p> <p>Normalisation appliqu\u00e9e : - Tirets (<code>-</code>) \u2192 Espace - Underscores (<code>_</code>) \u2192 Espace - Points (<code>.</code>) \u2192 Espace</p> <p>Exemples : - <code>Get-Service</code> \u2192 <code>get service</code> - <code>List_AD_Users</code> \u2192 <code>list ad users</code> - <code>System.Management</code> \u2192 <code>system management</code></p> <p>Avantage : Vous trouvez des commandes m\u00eame si vous ne tapez pas la syntaxe exacte.</p>"},{"location":"FAQ/#q-la-recherche-est-elle-sensible-aux-accents","title":"Q : La recherche est-elle sensible aux accents ?","text":"<p>R : Non, les accents sont automatiquement ignor\u00e9s.</p> <p>Exemples : - Recherche : <code>reseau</code> \u2192 Trouve \"Configuration R\u00e9seau\" - Recherche : <code>cafe</code> \u2192 Trouve \"Caf\u00e9\" - Recherche : <code>nino</code> \u2192 Trouve \"Ni\u00f1o\"</p> <p>Langues support\u00e9es : Fran\u00e7ais, Espagnol, Allemand, Portugais, etc.</p>"},{"location":"FAQ/#q-comment-chercher-plusieurs-mots","title":"Q : Comment chercher plusieurs mots ?","text":"<p>R : Tapez simplement les mots s\u00e9par\u00e9s par des espaces.</p> <p>Logique AND : TOUS les mots doivent \u00eatre pr\u00e9sents dans la commande.</p> <p>Exemples :</p> Recherche R\u00e9sultats <code>ad user</code> Actions contenant \"ad\" ET \"user\" (ex: \"List AD Users\") <code>dns cache</code> Actions contenant \"dns\" ET \"cache\" (ex: \"Clear DNS Cache\") <code>service windows</code> Actions contenant \"service\" ET \"windows\" <p>Ordre indiff\u00e9rent : <code>user ad</code> et <code>ad user</code> donnent les m\u00eames r\u00e9sultats.</p>"},{"location":"FAQ/#q-comment-utiliser-la-recherche-fuzzy","title":"Q : Comment utiliser la recherche fuzzy ?","text":"<p>R : La recherche fuzzy est automatique !</p> <p>TwinShell tol\u00e8re jusqu'\u00e0 30% de diff\u00e9rence entre votre recherche et les mots dans les commandes.</p> <p>Exemples de fautes tol\u00e9r\u00e9es : - <code>serviec</code> \u2192 Trouve \"service\" (2 lettres invers\u00e9es) - <code>netwrok</code> \u2192 Trouve \"network\" (1 lettre mal plac\u00e9e) - <code>usr</code> \u2192 Trouve \"user\" (1 lettre manquante)</p> <p>Pas de configuration n\u00e9cessaire.</p>"},{"location":"FAQ/#q-pourquoi-ma-recherche-ne-donne-aucun-resultat","title":"Q : Pourquoi ma recherche ne donne aucun r\u00e9sultat ?","text":"<p>R : V\u00e9rifiez ces points :</p>"},{"location":"FAQ/#1-filtres-actifs","title":"1. Filtres actifs","text":"<ul> <li>D\u00e9sactivez les filtres Platform (Windows/Linux/Both)</li> <li>D\u00e9sactivez les filtres Level (Info/Run/Dangerous)</li> </ul>"},{"location":"FAQ/#2-categorie-selectionnee","title":"2. Cat\u00e9gorie s\u00e9lectionn\u00e9e","text":"<ul> <li>Cliquez sur \"\ud83d\udccb All Commands\" pour voir toutes les commandes</li> </ul>"},{"location":"FAQ/#3-recherche-trop-specifique","title":"3. Recherche trop sp\u00e9cifique","text":"<ul> <li>Essayez une recherche plus courte</li> <li>Exemple : Au lieu de <code>\"comment obtenir les services\"</code>, tapez <code>\"service\"</code></li> </ul>"},{"location":"FAQ/#4-commande-inexistante","title":"4. Commande inexistante","text":"<ul> <li>Toutes les commandes ne sont pas forc\u00e9ment dans la base</li> <li>Consultez la liste dans <code>data/seed/initial-actions.json</code></li> </ul>"},{"location":"FAQ/#favoris-et-historique","title":"Favoris et Historique","text":""},{"location":"FAQ/#q-combien-de-favoris-puis-je-avoir","title":"Q : Combien de favoris puis-je avoir ?","text":"<p>R : Maximum 50 favoris par utilisateur.</p> <p>Raison : Limiter le nombre de favoris force \u00e0 s\u00e9lectionner les commandes vraiment importantes, am\u00e9liorant l'organisation.</p> <p>Si vous atteignez la limite : - Un message s'affiche : \"Limite de favoris atteinte (50/50)\" - Retirez un favori existant pour en ajouter un nouveau</p>"},{"location":"FAQ/#q-combien-de-temps-lhistorique-est-il-conserve","title":"Q : Combien de temps l'historique est-il conserv\u00e9 ?","text":"<p>R : Par d\u00e9faut : 90 jours</p> <p>Configurable dans les param\u00e8tres (de 1 \u00e0 3650 jours).</p> <p>Comment modifier : 1. <code>Ctrl+,</code> (Param\u00e8tres) 2. Section Behavior \u2192 Command History Retention 3. Changez la valeur (ex: 30, 180, 365 jours) 4. Cliquez sur \"Save\"</p> <p>Nettoyage automatique : Les commandes plus anciennes que la dur\u00e9e configur\u00e9e sont automatiquement supprim\u00e9es.</p>"},{"location":"FAQ/#q-puis-je-recuperer-une-commande-supprimee-de-lhistorique","title":"Q : Puis-je r\u00e9cup\u00e9rer une commande supprim\u00e9e de l'historique ?","text":"<p>R : Non, la suppression d'une commande de l'historique est d\u00e9finitive.</p> <p>Pr\u00e9vention : - Exportez r\u00e9guli\u00e8rement votre configuration (<code>Ctrl+E</code>) - L'export inclut l'historique complet</p> <p>R\u00e9cup\u00e9ration possible : - Si vous avez un export r\u00e9cent, importez-le (<code>Ctrl+I</code>) - Les commandes de l'export seront fusionn\u00e9es avec l'historique actuel</p>"},{"location":"FAQ/#q-les-favoris-sont-ils-sauvegardes-si-je-desinstalle-twinshell","title":"Q : Les favoris sont-ils sauvegard\u00e9s si je d\u00e9sinstalle TwinShell ?","text":"<p>R : \u00c7a d\u00e9pend.</p> M\u00e9thode Favoris conserv\u00e9s ? D\u00e9sinstallation standard \u274c Non (base de donn\u00e9es supprim\u00e9e) Export avant d\u00e9sinstallation \u2705 Oui (si vous importez apr\u00e8s r\u00e9installation) <p>Bonne pratique : 1. Exportez votre configuration (<code>Ctrl+E</code>) 2. D\u00e9sinstallez TwinShell 3. R\u00e9installez TwinShell 4. Importez le fichier export\u00e9 (<code>Ctrl+I</code>)</p>"},{"location":"FAQ/#categories","title":"Cat\u00e9gories","text":""},{"location":"FAQ/#q-quelle-est-la-difference-entre-categories-systeme-et-personnalisees","title":"Q : Quelle est la diff\u00e9rence entre cat\u00e9gories syst\u00e8me et personnalis\u00e9es ?","text":"<p>R :</p> Caract\u00e9ristique Cat\u00e9gories Syst\u00e8me Cat\u00e9gories Personnalis\u00e9es Pr\u00e9install\u00e9es \u2705 Oui \u274c Non, cr\u00e9\u00e9es par l'utilisateur Badge \ud83d\udfe1 Jaune \"System\" \ud83d\udfe2 Vert \"Custom\" Renommer \u274c Non \u2705 Oui Supprimer \u274c Non \u2705 Oui Masquer \u2705 Oui \u2705 Oui Exemples AD, DNS, Logs, Services Backup, Monitoring, Urgences"},{"location":"FAQ/#q-combien-de-categories-personnalisees-puis-je-creer","title":"Q : Combien de cat\u00e9gories personnalis\u00e9es puis-je cr\u00e9er ?","text":"<p>R : Maximum 50 cat\u00e9gories personnalis\u00e9es.</p> <p>Message si limite atteinte : <pre><code>\u26a0\ufe0f Limite de cat\u00e9gories atteinte (50/50)\nSupprimez une cat\u00e9gorie existante pour en cr\u00e9er une nouvelle.\n</code></pre></p> <p>Note : Les cat\u00e9gories syst\u00e8me ne comptent pas dans cette limite.</p>"},{"location":"FAQ/#q-que-se-passe-t-il-si-je-supprime-une-categorie-personnalisee","title":"Q : Que se passe-t-il si je supprime une cat\u00e9gorie personnalis\u00e9e ?","text":"<p>R : La cat\u00e9gorie est retir\u00e9e de toutes les actions qui l'utilisent.</p> <p>Les actions NE SONT PAS supprim\u00e9es, seule la r\u00e9f\u00e9rence \u00e0 la cat\u00e9gorie est effac\u00e9e.</p> <p>Exemple : - Cat\u00e9gorie \"Backup\" assign\u00e9e \u00e0 5 actions - Vous supprimez \"Backup\" - Les 5 actions existent toujours, mais n'ont plus de cat\u00e9gorie \"Backup\"</p> <p>Confirmation : Avant de supprimer, un message affiche le nombre d'actions affect\u00e9es.</p>"},{"location":"FAQ/#q-puis-je-assigner-plusieurs-categories-a-une-action","title":"Q : Puis-je assigner plusieurs cat\u00e9gories \u00e0 une action ?","text":"<p>R : Pas encore dans la version actuelle (v1.2.0).</p> <p>Chaque action a une seule cat\u00e9gorie.</p> <p>\u00c0 venir : Le support multi-cat\u00e9gories est pr\u00e9vu dans une future version.</p>"},{"location":"FAQ/#q-pourquoi-ne-puis-je-pas-supprimer-la-categorie-active-directory","title":"Q : Pourquoi ne puis-je pas supprimer la cat\u00e9gorie \"Active Directory\" ?","text":"<p>R : \"Active Directory\" est une cat\u00e9gorie syst\u00e8me, prot\u00e9g\u00e9e contre la suppression.</p> <p>Cat\u00e9gories syst\u00e8me non supprimables : - Active Directory &amp; GPO - Network &amp; DNS - Monitoring &amp; Logs - Services &amp; Automation - Windows Optimization - Linux Administration - Package Management - Files &amp; Storage - Security &amp; Encryption - Windows Updates - User Management - Containers &amp; VMs - Database - Development - Performance</p> <p>Alternative : - Vous pouvez masquer la cat\u00e9gorie (bouton \"Hide\") - Cr\u00e9ez une nouvelle cat\u00e9gorie personnalis\u00e9e si besoin</p>"},{"location":"FAQ/#themes-et-interface","title":"Th\u00e8mes et Interface","text":""},{"location":"FAQ/#q-le-theme-ne-change-pas-apres-avoir-clique-sur-save","title":"Q : Le th\u00e8me ne change pas apr\u00e8s avoir cliqu\u00e9 sur \"Save\"","text":"<p>R : V\u00e9rifiez ces points :</p>"},{"location":"FAQ/#1-avez-vous-clique-sur-save","title":"1. Avez-vous cliqu\u00e9 sur \"Save\" ?","text":"<ul> <li>Assurez-vous de cliquer sur \"Save\" (et non \"Cancel\")</li> <li>Une notification doit s'afficher : \u2705 \"Param\u00e8tres sauvegard\u00e9s\"</li> </ul>"},{"location":"FAQ/#2-redemarrez-lapplication","title":"2. Red\u00e9marrez l'application","text":"<ul> <li>Fermez compl\u00e8tement TwinShell (v\u00e9rifiez le Gestionnaire des t\u00e2ches)</li> <li>Relancez l'application</li> </ul>"},{"location":"FAQ/#3-verifiez-le-fichier-settingsjson","title":"3. V\u00e9rifiez le fichier settings.json","text":"<p>Ouvrez : <pre><code>%APPDATA%\\TwinShell\\settings.json\n</code></pre></p> <p>V\u00e9rifiez la valeur de <code>Theme</code> : <pre><code>{\n  \"Theme\": \"Dark\"  // Doit \u00eatre \"Light\", \"Dark\" ou \"System\"\n}\n</code></pre></p>"},{"location":"FAQ/#4-fichier-en-lecture-seule","title":"4. Fichier en lecture seule ?","text":"<ul> <li>Clic droit sur <code>settings.json</code> \u2192 Propri\u00e9t\u00e9s</li> <li>D\u00e9cochez \"Lecture seule\" si coch\u00e9</li> </ul>"},{"location":"FAQ/#q-quelle-est-la-difference-entre-le-mode-dark-et-le-mode-system","title":"Q : Quelle est la diff\u00e9rence entre le mode \"Dark\" et le mode \"System\" ?","text":"<p>R :</p> Mode Comportement Light Th\u00e8me clair en permanence (fond blanc, texte noir) Dark Th\u00e8me sombre en permanence (fond noir, texte blanc) System Suit automatiquement le th\u00e8me Windows (clair le jour, sombre la nuit par exemple) <p>Mode \"System\" - Comment \u00e7a marche : 1. TwinShell lit le registre Windows : <code>HKEY_CURRENT_USER\\...\\Personalize\\AppsUseLightTheme</code> 2. Si Windows est en mode sombre \u2192 TwinShell bascule en mode sombre 3. Si Windows est en mode clair \u2192 TwinShell bascule en mode clair 4. Le changement est automatique et instantan\u00e9</p> <p>Id\u00e9al pour : Ceux qui changent de th\u00e8me Windows selon l'heure de la journ\u00e9e.</p>"},{"location":"FAQ/#q-le-theme-sombre-est-il-accessible-wcag","title":"Q : Le th\u00e8me sombre est-il accessible (WCAG) ?","text":"<p>R : Oui, les th\u00e8mes TwinShell respectent WCAG AAA (niveau le plus \u00e9lev\u00e9).</p> <p>Contraste v\u00e9rifi\u00e9 : | \u00c9l\u00e9ment | Contraste | Norme WCAG AAA | Statut | |---------|-----------|----------------|--------| | Texte principal | 11.6:1 | 7:1 requis | \u2705 Conforme | | Texte secondaire | 9.2:1 | 7:1 requis | \u2705 Conforme | | \u00c9l\u00e9ments UI | 7.2:1 | 3:1 requis | \u2705 Conforme |</p> <p>Avantages : - Lisibilit\u00e9 optimale m\u00eame pour les personnes malvoyantes - R\u00e9duction de la fatigue oculaire lors de longues sessions</p>"},{"location":"FAQ/#q-puis-je-creer-mon-propre-theme-personnalise","title":"Q : Puis-je cr\u00e9er mon propre th\u00e8me personnalis\u00e9 ?","text":"<p>R : Pas encore dans l'interface utilisateur.</p> <p>M\u00e9thode technique (d\u00e9veloppeurs) : 1. Cr\u00e9ez un nouveau fichier <code>Themes/CustomTheme.xaml</code> 2. D\u00e9finissez vos couleurs (SolidColorBrush) 3. Modifiez <code>ThemeService.cs</code> pour charger votre th\u00e8me 4. Recompilez l'application</p> <p>\u00c0 venir : Un \u00e9diteur de th\u00e8mes est pr\u00e9vu dans une future version.</p>"},{"location":"FAQ/#export-et-import","title":"Export et Import","text":""},{"location":"FAQ/#q-que-contient-un-fichier-dexport","title":"Q : Que contient un fichier d'export ?","text":"<p>R : Le fichier JSON export\u00e9 contient 3 sections :</p> <pre><code>{\n  \"favorites\": [...],      // Liste de vos favoris\n  \"history\": [...],        // Historique complet des commandes\n  \"settings\": {...}        // Vos param\u00e8tres (th\u00e8me, r\u00e9tention, etc.)\n}\n</code></pre> <p>Favoris : - IDs des actions favorites - Date d'ajout aux favoris</p> <p>Historique : - Commandes g\u00e9n\u00e9r\u00e9es compl\u00e8tes - Param\u00e8tres utilis\u00e9s - Dates de g\u00e9n\u00e9ration - Cat\u00e9gories et plateformes</p> <p>Param\u00e8tres : - Th\u00e8me s\u00e9lectionn\u00e9 - Dur\u00e9e de r\u00e9tention de l'historique - Nombre de commandes r\u00e9centes - Options de comportement</p>"},{"location":"FAQ/#q-puis-je-partager-mes-favoris-avec-un-collegue","title":"Q : Puis-je partager mes favoris avec un coll\u00e8gue ?","text":"<p>R : Oui !</p> <p>M\u00e9thode : 1. Exportez votre configuration (<code>Ctrl+E</code>) 2. Partagez le fichier JSON avec votre coll\u00e8gue 3. Votre coll\u00e8gue importe le fichier (<code>Ctrl+I</code>) 4. Ses favoris sont fusionn\u00e9s avec les v\u00f4tres (pas de doublon)</p> <p>Id\u00e9al pour : - Standardiser les commandes dans une \u00e9quipe - Partager des \"best practices\" - Former de nouveaux administrateurs syst\u00e8me</p>"},{"location":"FAQ/#q-limport-supprime-t-il-mes-donnees-existantes","title":"Q : L'import supprime-t-il mes donn\u00e9es existantes ?","text":"<p>R : Non, l'import utilise un mode fusion.</p> <p>Comportement : - Favoris : Les favoris import\u00e9s sont ajout\u00e9s (pas de remplacement) - Historique : Les commandes import\u00e9es sont fusionn\u00e9es avec l'existant - Param\u00e8tres : Les param\u00e8tres import\u00e9s remplacent les existants</p> <p>Exemple : - Vous avez 10 favoris - Vous importez un fichier avec 5 favoris (dont 2 d\u00e9j\u00e0 pr\u00e9sents) - R\u00e9sultat : 13 favoris (10 existants + 3 nouveaux)</p>"},{"location":"FAQ/#q-comment-migrer-twinshell-vers-un-nouveau-pc","title":"Q : Comment migrer TwinShell vers un nouveau PC ?","text":"<p>R : 4 \u00e9tapes simples :</p> <p>Sur l'ancien PC : 1. Exportez votre configuration (<code>Ctrl+E</code>) 2. Sauvegardez le fichier JSON (ex: sur cl\u00e9 USB ou cloud)</p> <p>Sur le nouveau PC : 3. Installez TwinShell 4. Importez le fichier JSON (<code>Ctrl+I</code>)</p> <p>R\u00e9sultat : Vous retrouvez tous vos favoris, historique et param\u00e8tres !</p>"},{"location":"FAQ/#securite","title":"S\u00e9curit\u00e9","text":""},{"location":"FAQ/#q-twinshell-execute-t-il-les-commandes-automatiquement","title":"Q : TwinShell ex\u00e9cute-t-il les commandes automatiquement ?","text":"<p>R : Non, TwinShell ne jamais ex\u00e9cute de commandes.</p> <p>Workflow s\u00e9curis\u00e9 : 1. TwinShell g\u00e9n\u00e8re la commande 2. Vous copiez la commande 3. Vous collez dans PowerShell/Bash 4. Vous v\u00e9rifiez la commande 5. Vous ex\u00e9cutez manuellement</p> <p>Avantage : Vous gardez le contr\u00f4le total et pouvez modifier avant d'ex\u00e9cuter.</p>"},{"location":"FAQ/#q-que-signifie-le-niveau-dangerous","title":"Q : Que signifie le niveau \"Dangerous\" ?","text":"<p>R : Les commandes de niveau Dangerous peuvent modifier le syst\u00e8me ou supprimer des donn\u00e9es.</p> <p>Exemples de commandes dangereuses : - <code>Clear-EventLog</code> : Efface les logs Windows (perte de donn\u00e9es) - <code>Disable-ADAccount</code> : D\u00e9sactive un compte Active Directory (impact utilisateur) - <code>Stop-Process -Force</code> : Force l'arr\u00eat d'un processus (risque de perte de donn\u00e9es) - <code>Remove-Item -Recurse</code> : Supprime des fichiers/dossiers r\u00e9cursivement</p> <p>Protection dans TwinShell : - Bandeau d'avertissement rouge affich\u00e9 - Option de confirmation avant copie (configurable dans les param\u00e8tres)</p> <p>Recommandation : V\u00e9rifiez toujours les param\u00e8tres avant d'ex\u00e9cuter une commande dangereuse.</p>"},{"location":"FAQ/#q-twinshell-stocke-t-il-mes-mots-de-passe-ou-identifiants","title":"Q : TwinShell stocke-t-il mes mots de passe ou identifiants ?","text":"<p>R : Non.</p> <p>TwinShell stocke uniquement : - Les param\u00e8tres que vous remplissez (ex: nom de service, nom d'utilisateur AD) - Jamais de mots de passe ou secrets</p> <p>Exemple : - Action : \"Reset User Password\" - Stock\u00e9 : Nom d'utilisateur (<code>jdoe</code>) - Non stock\u00e9 : Nouveau mot de passe</p> <p>Les mots de passe doivent \u00eatre entr\u00e9s au moment de l'ex\u00e9cution dans le terminal.</p>"},{"location":"FAQ/#q-les-donnees-sont-elles-envoyees-sur-internet","title":"Q : Les donn\u00e9es sont-elles envoy\u00e9es sur Internet ?","text":"<p>R : Non, TwinShell est 100% local.</p> <p>Aucune donn\u00e9e n'est envoy\u00e9e : - Pas de t\u00e9l\u00e9m\u00e9trie - Pas d'analytiques - Pas de connexion cloud (sauf si vous activez la synchronisation cloud dans une future version)</p> <p>Toutes les donn\u00e9es (favoris, historique, param\u00e8tres) restent sur votre PC.</p>"},{"location":"FAQ/#depannage","title":"D\u00e9pannage","text":""},{"location":"FAQ/#q-lapplication-ne-demarre-pas-erreur-net-runtime-manquant","title":"Q : L'application ne d\u00e9marre pas - Erreur \".NET Runtime manquant\"","text":"<p>R : Installez .NET 8 Runtime.</p> <p>T\u00e9l\u00e9chargement : <pre><code>https://dotnet.microsoft.com/download/dotnet/8.0\n</code></pre></p> <p>Choisissez : \".NET Desktop Runtime 8.0.x\" (incluant WPF)</p> <p>Apr\u00e8s installation : - Red\u00e9marrez votre PC - Lancez TwinShell</p>"},{"location":"FAQ/#q-erreur-impossible-dacceder-a-la-base-de-donnees","title":"Q : Erreur \"Impossible d'acc\u00e9der \u00e0 la base de donn\u00e9es\"","text":"<p>R : Causes possibles :</p>"},{"location":"FAQ/#1-permissions-insuffisantes","title":"1. Permissions insuffisantes","text":"<p>V\u00e9rifiez que vous avez acc\u00e8s en \u00e9criture \u00e0 : <pre><code>%LOCALAPPDATA%\\TwinShell\n</code></pre></p> <p>Solution : - Ex\u00e9cutez TwinShell en tant qu'administrateur (temporaire) - Ajustez les permissions du dossier</p>"},{"location":"FAQ/#2-base-de-donnees-corrompue","title":"2. Base de donn\u00e9es corrompue","text":"<p>Solution : 1. Exportez d'abord votre configuration (si possible) 2. Fermez TwinShell 3. Supprimez : <code>%LOCALAPPDATA%\\TwinShell\\twinshell.db</code> 4. Relancez TwinShell (une nouvelle base sera cr\u00e9\u00e9e) 5. Importez votre configuration export\u00e9e</p>"},{"location":"FAQ/#q-les-raccourcis-clavier-ne-fonctionnent-pas","title":"Q : Les raccourcis clavier ne fonctionnent pas","text":"<p>R : V\u00e9rifiez ces points :</p>"},{"location":"FAQ/#1-focus-sur-la-fenetre","title":"1. Focus sur la fen\u00eatre","text":"<ul> <li>Cliquez sur la fen\u00eatre TwinShell pour lui donner le focus</li> <li>Les raccourcis ne fonctionnent que si TwinShell est au premier plan</li> </ul>"},{"location":"FAQ/#2-conflit-avec-une-autre-application","title":"2. Conflit avec une autre application","text":"<p>Certaines applications interceptent les raccourcis : - <code>Ctrl+,</code> : Peut \u00eatre utilis\u00e9 par Visual Studio Code, IntelliJ, etc. - <code>F5</code> : Peut \u00eatre utilis\u00e9 par des navigateurs</p> <p>Solution : - Fermez temporairement l'application conflictuelle - Ou utilisez les menus au lieu des raccourcis</p>"},{"location":"FAQ/#3-verifier-les-raccourcis-actifs","title":"3. V\u00e9rifier les raccourcis actifs","text":"<p>Appuyez sur F1 pour afficher la liste compl\u00e8te des raccourcis.</p>"},{"location":"FAQ/#q-la-fenetre-de-twinshell-est-trop-petite-trop-grande","title":"Q : La fen\u00eatre de TwinShell est trop petite / trop grande","text":"<p>R : TwinShell est responsive et s'adapte \u00e0 votre \u00e9cran.</p> <p>Taille minimale : 800x600 pixels Taille maximale : Plein \u00e9cran</p> <p>Redimensionner : - Glissez les bords de la fen\u00eatre - Double-cliquez sur la barre de titre pour maximiser/restaurer - La taille est sauvegard\u00e9e entre les sessions</p> <p>Probl\u00e8me d'affichage ? - V\u00e9rifiez la r\u00e9solution de votre \u00e9cran (minimum 1024x768 recommand\u00e9) - Ajustez la mise \u00e0 l'\u00e9chelle Windows (Param\u00e8tres \u2192 Affichage \u2192 Mise \u00e0 l'\u00e9chelle)</p>"},{"location":"FAQ/#fonctionnalites-futures","title":"Fonctionnalit\u00e9s Futures","text":""},{"location":"FAQ/#q-quand-pourrai-je-ajouter-mes-propres-commandes-via-linterface","title":"Q : Quand pourrai-je ajouter mes propres commandes via l'interface ?","text":"<p>R : Cette fonctionnalit\u00e9 est disponible depuis la version 1.2.0.</p> <p>Fonctionnalit\u00e9s attendues : - Cr\u00e9er une nouvelle commande via un formulaire - D\u00e9finir des param\u00e8tres personnalis\u00e9s - Assigner des cat\u00e9gories et tags - Sauvegarder dans la base de donn\u00e9es</p> <p>Suivre l'avancement : GitHub Issues</p>"},{"location":"FAQ/#q-y-aura-t-il-un-support-multi-langues-anglais","title":"Q : Y aura-t-il un support multi-langues (anglais) ?","text":"<p>R : Pr\u00e9vu pour une future version.</p> <p>Langues pr\u00e9vues : - \ud83c\uddeb\ud83c\uddf7 Fran\u00e7ais (actuel) - \ud83c\uddec\ud83c\udde7 Anglais - (Autres langues selon la demande communautaire)</p> <p>Param\u00e8tre : Settings \u2192 Language \u2192 Fran\u00e7ais | English</p>"},{"location":"FAQ/#q-est-il-prevu-dintegrer-un-terminal-directement-dans-twinshell","title":"Q : Est-il pr\u00e9vu d'int\u00e9grer un terminal directement dans TwinShell ?","text":"<p>R : Oui, c'est dans la roadmap pour une future version.</p> <p>Fonctionnalit\u00e9s envisag\u00e9es : - Terminal PowerShell int\u00e9gr\u00e9 - Terminal Bash (WSL) int\u00e9gr\u00e9 - Ex\u00e9cution directe depuis TwinShell - Affichage du r\u00e9sultat dans l'interface</p> <p>Avantage : Workflow complet sans quitter TwinShell.</p>"},{"location":"FAQ/#q-la-synchronisation-cloud-est-elle-prevue","title":"Q : La synchronisation cloud est-elle pr\u00e9vue ?","text":"<p>R : Oui, optionnelle dans une future version (v1.3+).</p> <p>Fonctionnalit\u00e9s envisag\u00e9es : - Synchronisation des favoris entre machines - Synchronisation des cat\u00e9gories personnalis\u00e9es - Opt-in : Vous choisissez d'activer ou non</p> <p>Confidentialit\u00e9 : - Chiffrement des donn\u00e9es - Aucune donn\u00e9e sensible (pas de commandes de l'historique)</p>"},{"location":"FAQ/#ressources","title":"Ressources","text":""},{"location":"FAQ/#documentation","title":"Documentation","text":"<ul> <li>Guide de Demarrage Rapide</li> <li>Guide Utilisateur Complet</li> <li>GitHub TwinShell</li> </ul>"},{"location":"FAQ/#support","title":"Support","text":"<ul> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Signaler un Bug</li> </ul> <p>Question non list\u00e9e ? Posez-la sur GitHub Discussions !</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-11-26 Version : 1.2.0</p>"},{"location":"QuickStart/","title":"\ud83d\ude80 Guide de D\u00e9marrage Rapide - TwinShell","text":"<p>Commencez \u00e0 utiliser TwinShell en 5 minutes !</p>"},{"location":"QuickStart/#installation-2-minutes","title":"\ud83d\udce5 Installation (2 minutes)","text":""},{"location":"QuickStart/#etape-1-telecharger-twinshell","title":"\u00c9tape 1 : T\u00e9l\u00e9charger TwinShell","text":"<ol> <li>Rendez-vous sur GitHub Releases</li> <li>T\u00e9l\u00e9chargez la derni\u00e8re version :</li> <li>TwinShell-Setup.exe (Installeur - Recommand\u00e9)</li> <li>TwinShell-Portable.zip (Version portable)</li> </ol>"},{"location":"QuickStart/#etape-2-installer","title":"\u00c9tape 2 : Installer","text":"<p>Option A : Installeur (Recommand\u00e9) 1. Double-cliquez sur <code>TwinShell-Setup.exe</code> 2. Suivez l'assistant d'installation 3. Lancez TwinShell depuis le menu D\u00e9marrer</p> <p>Option B : Version Portable 1. D\u00e9compressez <code>TwinShell-Portable.zip</code> 2. Double-cliquez sur <code>TwinShell.exe</code></p>"},{"location":"QuickStart/#etape-3-premier-lancement","title":"\u00c9tape 3 : Premier Lancement","text":"<p>Au premier lancement, TwinShell : - Cr\u00e9e automatiquement sa base de donn\u00e9es SQLite - Charge 500+ commandes PowerShell et Bash - Est pr\u00eat \u00e0 l'emploi !</p>"},{"location":"QuickStart/#vos-3-premieres-actions-3-minutes","title":"\ud83c\udfaf Vos 3 Premi\u00e8res Actions (3 minutes)","text":""},{"location":"QuickStart/#action-1-trouver-et-copier-une-commande","title":"Action 1 : Trouver et Copier une Commande","text":"<ol> <li>Tapez dans la barre de recherche : <code>service</code></li> <li>Cliquez sur \"Get-Service\" dans la liste</li> <li>Remplissez le param\u00e8tre (ex: <code>Spooler</code> pour le service d'impression)</li> <li>Cliquez sur \"\ud83d\udccb Copier dans le presse-papiers\"</li> <li>Collez dans PowerShell et ex\u00e9cutez !</li> </ol> <pre><code>Get-Service -Name Spooler\n</code></pre> <p>\u2705 F\u00e9licitations ! Vous avez g\u00e9n\u00e9r\u00e9 votre premi\u00e8re commande.</p>"},{"location":"QuickStart/#action-2-ajouter-un-favori","title":"Action 2 : Ajouter un Favori","text":"<ol> <li>Recherchez une commande que vous utilisez souvent (ex: <code>dns</code>)</li> <li>Cliquez sur l'\u00e9toile (\u2606) \u00e0 c\u00f4t\u00e9 du titre</li> <li>L'\u00e9toile devient dor\u00e9e (\u2605) - la commande est ajout\u00e9e aux favoris</li> <li>Cliquez sur \"\u2b50 Favorites\" dans le panneau de gauche</li> <li>Votre commande favorite appara\u00eet !</li> </ol>"},{"location":"QuickStart/#action-3-activer-le-mode-sombre","title":"Action 3 : Activer le Mode Sombre","text":"<ol> <li>Appuyez sur <code>Ctrl+,</code> (ou Menu File \u2192 Settings)</li> <li>Section Appearance, s\u00e9lectionnez Dark</li> <li>Cliquez sur \"Preview Theme\" pour voir le r\u00e9sultat</li> <li>Cliquez sur \"Save\"</li> </ol> <p>\ud83c\udf19 Magnifique ! Vos yeux vous remercient.</p>"},{"location":"QuickStart/#conseils-pour-bien-commencer","title":"\ud83d\udd0d Conseils pour Bien Commencer","text":""},{"location":"QuickStart/#navigation-rapide","title":"Navigation Rapide","text":"<ul> <li>Cat\u00e9gories (panneau gauche) : Cliquez pour filtrer par type (AD &amp; GPO, Network &amp; DNS, Logs, etc.)</li> <li>\ud83d\udccb All Commands : Voir toutes les commandes disponibles</li> <li>\u2b50 Favorites : Acc\u00e8s rapide \u00e0 vos commandes pr\u00e9f\u00e9r\u00e9es</li> </ul>"},{"location":"QuickStart/#recherche-intelligente","title":"Recherche Intelligente","text":"<p>La recherche TwinShell est tr\u00e8s tol\u00e9rante :</p> Vous tapez Trouve <code>reseau</code> (sans accent) \"Configuration R\u00e9seau\" <code>Get Service</code> (sans tiret) \"Get-Service\" <code>AD user</code> (multi-mots) \"List AD Users\", \"Get AD User Info\" <code>serviec</code> (faute de frappe) \"service\" (fuzzy matching)"},{"location":"QuickStart/#filtres-utiles","title":"Filtres Utiles","text":"<ul> <li>Platform : Windows, Linux ou Both</li> <li>Level :</li> <li>Info (bleu) = Lecture seule, sans danger</li> <li>Run (orange) = Ex\u00e9cution, attention</li> <li>Dangerous (rouge) = Modification syst\u00e8me, danger !</li> </ul>"},{"location":"QuickStart/#raccourcis-a-connaitre","title":"\u2328\ufe0f Raccourcis \u00e0 Conna\u00eetre","text":"Raccourci Action <code>Ctrl+,</code> Param\u00e8tres <code>Ctrl+M</code> G\u00e9rer les cat\u00e9gories <code>F5</code> Actualiser <code>F1</code> Aide"},{"location":"QuickStart/#et-maintenant","title":"\ud83d\udcda Et Maintenant ?","text":""},{"location":"QuickStart/#explorez-les-fonctionnalites-avancees","title":"Explorez les Fonctionnalit\u00e9s Avanc\u00e9es","text":"<ol> <li>Historique : Menu \"\ud83d\udcdc History\" - Consultez toutes vos commandes pass\u00e9es</li> <li>Export/Import : Menu \"File \u2192 Export Configuration\" - Sauvegardez vos favoris</li> <li>Cat\u00e9gories Personnalis\u00e9es : <code>Ctrl+M</code> - Cr\u00e9ez vos propres cat\u00e9gories</li> </ol>"},{"location":"QuickStart/#documentation-complete","title":"Documentation Compl\u00e8te","text":"<ul> <li>Guide Utilisateur Complet</li> <li>FAQ - Questions Frequentes</li> <li>GitHub TwinShell</li> </ul>"},{"location":"QuickStart/#besoin-daide","title":"\ud83c\udd98 Besoin d'Aide ?","text":""},{"location":"QuickStart/#probleme-lapplication-ne-demarre-pas","title":"Probl\u00e8me : L'application ne d\u00e9marre pas","text":"<ol> <li>V\u00e9rifiez que .NET 8 Runtime est install\u00e9</li> <li>T\u00e9l\u00e9chargez-le ici : https://dotnet.microsoft.com/download/dotnet/8.0</li> <li>V\u00e9rifiez que vous avez Windows 10 ou 11 (64-bit)</li> </ol>"},{"location":"QuickStart/#probleme-je-ne-trouve-pas-une-commande","title":"Probl\u00e8me : Je ne trouve pas une commande","text":"<ol> <li>V\u00e9rifiez que vous n'avez pas de filtres actifs (Platform/Level)</li> <li>Cliquez sur \"\ud83d\udccb All Commands\" pour voir toutes les commandes</li> <li>Essayez une recherche plus courte (ex: <code>dns</code> au lieu de <code>dns query</code>)</li> </ol>"},{"location":"QuickStart/#probleme-le-theme-ne-change-pas","title":"Probl\u00e8me : Le th\u00e8me ne change pas","text":"<ol> <li>Assurez-vous de cliquer sur \"Save\" dans les param\u00e8tres</li> <li>Red\u00e9marrez l'application si n\u00e9cessaire</li> </ol>"},{"location":"QuickStart/#astuce-du-jour","title":"\ud83d\udca1 Astuce du Jour","text":"<p>Utilisez le widget des commandes r\u00e9centes !</p> <p>Sur la page d'accueil, TwinShell affiche vos 5 derni\u00e8res commandes g\u00e9n\u00e9r\u00e9es. Cliquez simplement sur une entr\u00e9e pour la recopier instantan\u00e9ment !</p>"},{"location":"QuickStart/#vous-etes-pret","title":"\ud83c\udf89 Vous \u00eates Pr\u00eat !","text":"<p>Vous avez maintenant les bases pour utiliser TwinShell efficacement.</p> <p>Bon travail avec TwinShell ! \ud83d\ude80</p> <p>GitHub TwinShell | Guide Utilisateur Complet | FAQ</p>"},{"location":"UserGuide/","title":"\ud83d\udcd8 Guide Utilisateur Complet - TwinShell","text":"<p>Documentation compl\u00e8te pour ma\u00eetriser toutes les fonctionnalit\u00e9s de TwinShell</p>"},{"location":"UserGuide/#table-des-matieres","title":"Table des Mati\u00e8res","text":"<ol> <li>Interface Principale</li> <li>Recherche et Filtrage</li> <li>G\u00e9n\u00e9rer et Copier des Commandes</li> <li>Syst\u00e8me de Favoris</li> <li>Historique des Commandes</li> <li>Cat\u00e9gories Personnalis\u00e9es</li> <li>Th\u00e8mes et Personnalisation</li> <li>Param\u00e8tres Avanc\u00e9s</li> <li>Export et Import de Configuration</li> <li>Raccourcis Clavier</li> <li>Conseils et Astuces</li> <li>R\u00e9solution de Probl\u00e8mes</li> </ol>"},{"location":"UserGuide/#interface-principale","title":"Interface Principale","text":""},{"location":"UserGuide/#vue-densemble","title":"Vue d'Ensemble","text":"<p>L'interface TwinShell est organis\u00e9e en 3 panneaux principaux :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  TwinShell                                             [_][\u25a1][X]\u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \ud83d\udcc1 File  \u2699\ufe0f Tools  \u2753 Help        [Recherche___] \ud83d\udd0d  Filtres \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Cat\u00e9gories  \u2502   Liste des Commandes       \u2502  D\u00e9tails &amp; Params  \u2502\n\u2502              \u2502                              \u2502                   \u2502\n\u2502  \ud83d\udccb All      \u2502  \u2713 Get-Service              \u2502  Get-Service      \u2502\n\u2502  \u2b50 Favs     \u2502    List Windows services    \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502              \u2502    [Windows] [Run]           \u2502  Service Name:    \u2502\n\u2502  \ud83c\udfe2 AD&amp;GPO   \u2502                             \u2502  [Spooler____]    \u2502\n\u2502  \ud83c\udf10 Network  \u2502  \u2713 systemctl status         \u2502                   \u2502\n\u2502  \ud83d\udcca Logs     \u2502    Linux service info       \u2502  Generated:       \u2502\n\u2502  \u2699\ufe0f Services \u2502    [Linux] [Info]           \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \ud83d\udcbb Windows  \u2502                             \u2502  \u2502Get-Service...\u2502 \u2502\n\u2502  \ud83d\udc27 Linux    \u2502  \u2713 Get-EventLog             \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  ...         \u2502    Windows event logs       \u2502                    \u2502\n\u2502              \u2502    [Windows] [Dangerous]    \u2502  [\ud83d\udccb Copier]       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"UserGuide/#panneau-1-categories-gauche","title":"Panneau 1 : Cat\u00e9gories (Gauche)","text":"<p>Cat\u00e9gories Sp\u00e9ciales : - \ud83d\udccb All Commands : Affiche toutes les commandes disponibles (sans filtre) - \u2b50 Favorites : Acc\u00e8s rapide \u00e0 vos commandes favorites (max 50)</p> <p>Cat\u00e9gories Pr\u00e9d\u00e9finies : - \ud83c\udfe2 Active Directory &amp; GPO : Gestion des utilisateurs AD, groupes, GPO - \ud83c\udf10 Network &amp; DNS : Diagnostics r\u00e9seau, DNS, ping, traceroute - \ud83d\udcca Monitoring &amp; Logs : EventLog, journald, surveillance syst\u00e8me - \u2699\ufe0f Services &amp; Automation : Services Windows/Linux, t\u00e2ches planifi\u00e9es - \ud83d\udcbb Windows Optimization : Optimisation et maintenance Windows - \ud83d\udc27 Linux Administration : Administration syst\u00e8me Linux - \ud83d\udce6 Package Management : Gestion des paquets (apt, yum, winget, choco) - \ud83d\udcc1 Files &amp; Storage : Gestion des fichiers et stockage - \ud83d\udd12 Security &amp; Encryption : S\u00e9curit\u00e9, chiffrement, BitLocker - \ud83d\udd04 Windows Updates : Mises \u00e0 jour Windows - \ud83d\udc65 User Management : Gestion des utilisateurs locaux - \ud83d\udc33 Containers &amp; VMs : Docker, conteneurs, machines virtuelles - \ud83d\udcbd Database : Bases de donn\u00e9es (SQL Server, MySQL, PostgreSQL) - \ud83d\udd27 Development : Outils de d\u00e9veloppement (Git, npm, etc.) - \u26a1 Performance : Analyse et optimisation des performances</p> <p>Cat\u00e9gories Personnalis\u00e9es : - Cr\u00e9ez vos propres cat\u00e9gories avec ic\u00f4nes et couleurs personnalis\u00e9es - G\u00e9rez-les via <code>Ctrl+M</code> ou menu Tools \u2192 Manage Categories</p>"},{"location":"UserGuide/#panneau-2-liste-des-commandes-centre","title":"Panneau 2 : Liste des Commandes (Centre)","text":"<p>Affiche les commandes filtr\u00e9es avec : - Titre de la commande - Description courte - Badges :   - Plateforme : [Windows] | [Linux] | [Both]   - Niveau : [Info] (bleu) | [Run] (orange) | [Dangerous] (rouge) - Tags visuels : Identifiez rapidement le type de commande</p> <p>\ud83c\udf0d Nouveau : Le badge [Both] indique que la commande fonctionne nativement sur Windows (PowerShell) et Linux (Bash). C'est le cas pour la plupart des outils Cloud et DevOps (AWS CLI, Terraform, OpenSSL, Docker, kubectl).</p>"},{"location":"UserGuide/#panneau-3-details-et-parametres-droite","title":"Panneau 3 : D\u00e9tails et Param\u00e8tres (Droite)","text":"<p>Affiche pour la commande s\u00e9lectionn\u00e9e : - Titre et Description compl\u00e8te - \u00c9toile de favori (\u2606/\u2605) - Param\u00e8tres dynamiques \u00e0 remplir - Commande g\u00e9n\u00e9r\u00e9e en temps r\u00e9el - Bouton Copier pour le presse-papiers - Exemples d'utilisation (avec s\u00e9lection de texte) - Notes et Liens externes (si disponibles)</p>"},{"location":"UserGuide/#recherche-et-filtrage","title":"Recherche et Filtrage","text":""},{"location":"UserGuide/#recherche-textuelle","title":"Recherche Textuelle","text":""},{"location":"UserGuide/#fonctionnement","title":"Fonctionnement","text":"<p>La barre de recherche (en haut) filtre les commandes en temps r\u00e9el dans : - Titre - Description - Cat\u00e9gorie - Tags - Notes - Templates de commandes (PowerShell et Bash)</p>"},{"location":"UserGuide/#recherche-intelligente","title":"Recherche Intelligente","text":"<p>TwinShell utilise une normalisation avanc\u00e9e pour une recherche tol\u00e9rante :</p> Fonctionnalit\u00e9 Exemple R\u00e9sultat Insensible \u00e0 la casse <code>SERVICE</code> Trouve \"Get-Service\" Ignore les accents <code>reseau</code> Trouve \"Configuration R\u00e9seau\" Normalise la ponctuation <code>Get Service</code> Trouve \"Get-Service\" Fuzzy matching <code>serviec</code> Trouve \"service\" (tol\u00e9rance 30%) Multi-mots (AND) <code>AD user</code> Trouve actions contenant \"AD\" ET \"user\""},{"location":"UserGuide/#suggestions-dautocompletion","title":"Suggestions d'Autocompl\u00e9tion","text":"<p>Lors de la saisie, TwinShell propose des suggestions bas\u00e9es sur l'historique de vos recherches pr\u00e9c\u00e9dentes.</p>"},{"location":"UserGuide/#exemples-de-recherche","title":"Exemples de Recherche","text":"<pre><code>Recherche : \"dns\"\nR\u00e9sultats : \"Clear DNS Cache\", \"DNS Query\", \"Get DNS Records\"\n\nRecherche : \"active directory user\"\nR\u00e9sultats : \"List AD Users\", \"Create AD User\", \"Get AD User Info\"\n\nRecherche : \"systemctl\"\nR\u00e9sultats : Toutes les commandes utilisant systemctl dans leurs templates\n\nRecherche : \"aws ec2\"\nR\u00e9sultats : \"Lister les instances EC2\", \"D\u00e9marrer une instance\"\n\nRecherche : \"k8s pods\"\nR\u00e9sultats : \"kubectl-get-pods\", \"kubectl-describe-pod\"\n</code></pre>"},{"location":"UserGuide/#filtres-avances","title":"Filtres Avanc\u00e9s","text":""},{"location":"UserGuide/#filtre-platform","title":"Filtre Platform","text":"<p>Cochez les plateformes souhait\u00e9es : - \u2611 Windows : Commandes PowerShell uniquement - \u2611 Linux : Commandes Bash uniquement - \u2611 Both : Commandes disponibles sur les deux plateformes</p>"},{"location":"UserGuide/#filtre-level","title":"Filtre Level","text":"<p>Filtrez par niveau de criticit\u00e9 : - \u2611 Info (bleu) : Commandes de lecture, sans danger - \u2611 Run (orange) : Commandes d'ex\u00e9cution, n\u00e9cessitent attention - \u2611 Dangerous (rouge) : Commandes de modification syst\u00e8me, DANGER !</p> <p>\u26a0\ufe0f Note : Quand une recherche textuelle est active, le filtre de cat\u00e9gorie est automatiquement d\u00e9sactiv\u00e9 pour montrer tous les r\u00e9sultats pertinents.</p>"},{"location":"UserGuide/#metriques-de-recherche","title":"M\u00e9triques de Recherche","text":"<p>En bas de la liste, TwinShell affiche : - \ud83d\udcca Nombre de r\u00e9sultats : Ex. \"142 r\u00e9sultats trouv\u00e9s\" - \u23f1\ufe0f Temps de recherche : Ex. \"en 23ms\"</p>"},{"location":"UserGuide/#generer-et-copier-des-commandes","title":"G\u00e9n\u00e9rer et Copier des Commandes","text":""},{"location":"UserGuide/#etape-par-etape","title":"\u00c9tape par \u00c9tape","text":""},{"location":"UserGuide/#1-selectionner-une-commande","title":"1. S\u00e9lectionner une Commande","text":"<p>Cliquez sur une commande dans la liste centrale. Le panneau de droite affiche les d\u00e9tails.</p>"},{"location":"UserGuide/#2-remplir-les-parametres","title":"2. Remplir les Param\u00e8tres","text":"<p>Selon la commande, remplissez les champs demand\u00e9s :</p> <p>Exemple : Get-Service - ServiceName (requis) : <code>Spooler</code></p> <p>Exemple : Get-ADUser - Identity (requis) : <code>jdoe</code> - Properties (optionnel) : <code>DisplayName,EmailAddress</code></p> <p>\ud83d\udca1 Les champs obligatoires sont marqu\u00e9s d'un ast\u00e9risque <code>*</code></p>"},{"location":"UserGuide/#3-commande-generee-automatiquement","title":"3. Commande G\u00e9n\u00e9r\u00e9e Automatiquement","text":"<p>La commande se g\u00e9n\u00e8re en temps r\u00e9el au fur et \u00e0 mesure que vous remplissez les param\u00e8tres.</p> <p>Avant : <pre><code>Get-Service -Name {ServiceName}\n</code></pre></p> <p>Apr\u00e8s (avec param\u00e8tre \"Spooler\") : <pre><code>Get-Service -Name Spooler\n</code></pre></p>"},{"location":"UserGuide/#4-copier-dans-le-presse-papiers","title":"4. Copier dans le Presse-Papiers","text":"<p>Cliquez sur le bouton \"\ud83d\udccb Copier dans le presse-papiers\".</p> <p>Une notification toast verte confirme : \u2705 \"Commande copi\u00e9e !\"</p>"},{"location":"UserGuide/#5-executer-dans-votre-terminal","title":"5. Ex\u00e9cuter dans votre Terminal","text":"<p>PowerShell : <pre><code># Collez (Ctrl+V) dans PowerShell\nGet-Service -Name Spooler\n</code></pre></p> <p>Bash (WSL) : <pre><code># Collez (Ctrl+Shift+V) dans un terminal WSL\nsystemctl status nginx\n</code></pre></p>"},{"location":"UserGuide/#exemples-interactifs-v120","title":"Exemples Interactifs (v1.2.0)","text":"<p>Chaque commande inclut des exemples d'utilisation que vous pouvez appliquer directement au g\u00e9n\u00e9rateur :</p>"},{"location":"UserGuide/#mode-template-par-defaut","title":"Mode Template (par d\u00e9faut)","text":"<p>Utilisez les param\u00e8tres pr\u00e9d\u00e9finis du template de commande.</p>"},{"location":"UserGuide/#mode-exemple","title":"Mode Exemple","text":"<ol> <li>Cliquez sur un exemple dans la liste des exemples</li> <li>Le g\u00e9n\u00e9rateur s'adapte automatiquement \u00e0 l'exemple s\u00e9lectionn\u00e9</li> <li>Les champs de param\u00e8tres sont pr\u00e9-remplis avec les valeurs de l'exemple</li> <li>Modifiez les valeurs selon vos besoins</li> <li>Un badge \"Example Mode\" s'affiche pour indiquer le mode actif</li> <li>Cliquez sur \"Reset to Template\" pour revenir au mode template</li> </ol>"},{"location":"UserGuide/#scripts-complexes-editables","title":"Scripts Complexes \u00c9ditables","text":"<p>Pour les commandes complexes (contenant <code>foreach</code>, <code>ForEach-Object</code>, <code>while</code>, pipelines multiples, etc.), TwinShell affiche un \u00e9diteur multiligne :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Command:                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 1..100 | ForEach-Object {                                   \u2502 \u2502\n\u2502  \u2502   Test-NetConnection 192.168.1.$_ -Port 80                  \u2502 \u2502\n\u2502  \u2502 } | Where-Object {$_.TcpTestSucceeded -eq $true}            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <ul> <li>Modifiez directement la commande dans l'\u00e9diteur</li> <li>La police monospace (Consolas) facilite la lecture du code</li> <li>La commande g\u00e9n\u00e9r\u00e9e refl\u00e8te vos modifications en temps r\u00e9el</li> </ul> <p>\ud83d\udca1 Astuce : Vous pouvez aussi s\u00e9lectionner le texte dans les exemples pour le copier manuellement.</p>"},{"location":"UserGuide/#alertes-de-securite","title":"Alertes de S\u00e9curit\u00e9","text":"<p>Les commandes de niveau Dangerous affichent un bandeau d'avertissement rouge :</p> <pre><code>\u26a0\ufe0f ATTENTION : Cette commande peut causer des modifications importantes du syst\u00e8me\n              V\u00e9rifiez tous les param\u00e8tres avant ex\u00e9cution.\n</code></pre> <p>Exemples de commandes dangereuses : - <code>Clear-EventLog</code> : Efface les logs Windows - <code>Disable-ADAccount</code> : D\u00e9sactive un compte Active Directory - <code>Stop-Process -Force</code> : Force l'arr\u00eat d'un processus</p>"},{"location":"UserGuide/#systeme-de-favoris","title":"Syst\u00e8me de Favoris","text":""},{"location":"UserGuide/#ajouter-un-favori","title":"Ajouter un Favori","text":"<ol> <li>S\u00e9lectionnez une commande dans la liste</li> <li>Cliquez sur l'\u00e9toile vide (\u2606) \u00e0 c\u00f4t\u00e9 du titre</li> <li>L'\u00e9toile devient pleine et dor\u00e9e (\u2605)</li> <li>Un message confirme : \u2705 \"Ajout\u00e9 aux favoris\"</li> </ol>"},{"location":"UserGuide/#acceder-aux-favoris","title":"Acc\u00e9der aux Favoris","text":"<ul> <li>Cliquez sur la cat\u00e9gorie \"\u2b50 Favorites\" dans le panneau de gauche</li> <li>Toutes vos commandes favorites s'affichent</li> </ul>"},{"location":"UserGuide/#retirer-un-favori","title":"Retirer un Favori","text":"<ul> <li>Cliquez sur l'\u00e9toile pleine (\u2605) pour la vider</li> <li>La commande est retir\u00e9e des favoris</li> </ul>"},{"location":"UserGuide/#limites-et-messages","title":"Limites et Messages","text":"<ul> <li>Maximum : 50 favoris par utilisateur</li> <li>Si vous atteignez la limite, un message s'affiche :   <pre><code>\u26a0\ufe0f Limite de favoris atteinte (50/50)\nRetirez un favori existant pour en ajouter un nouveau.\n</code></pre></li> </ul>"},{"location":"UserGuide/#persistance","title":"Persistance","text":"<p>Les favoris sont sauvegard\u00e9s dans la base de donn\u00e9es SQLite et persistent entre les sessions.</p>"},{"location":"UserGuide/#historique-des-commandes","title":"Historique des Commandes","text":""},{"location":"UserGuide/#vue-densemble_1","title":"Vue d'Ensemble","text":"<p>TwinShell enregistre automatiquement chaque commande g\u00e9n\u00e9r\u00e9e avec : - Commande compl\u00e8te g\u00e9n\u00e9r\u00e9e - Date et heure de g\u00e9n\u00e9ration - Cat\u00e9gorie et Titre de l'action - Plateforme (Windows/Linux) - Param\u00e8tres utilis\u00e9s</p>"},{"location":"UserGuide/#acceder-a-lhistorique","title":"Acc\u00e9der \u00e0 l'Historique","text":"<p>Menu : Cliquez sur l'onglet \"\ud83d\udcdc History\"</p>"},{"location":"UserGuide/#interface-de-lhistorique","title":"Interface de l'Historique","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \ud83d\udcdc Historique des Commandes                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  [Recherche___] \ud83d\udd0d    Filtres: [Date] [Cat\u00e9gorie] [Platform]  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                \u2502\n\u2502  \u23f0 Il y a 5 min                                  [Windows]    \u2502\n\u2502  Get-Service -Name Spooler                                     \u2502\n\u2502  Action: Get-Service | Cat\u00e9gorie: Services                     \u2502\n\u2502  [\ud83d\udccb Copier]  [\ud83d\uddd1\ufe0f Supprimer]                                   \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                \u2502\n\u2502  \u23f0 Il y a 2h                                     [Linux]      \u2502\n\u2502  systemctl status nginx                                        \u2502\n\u2502  Action: System Service Check | Cat\u00e9gorie: Services           \u2502\n\u2502  [\ud83d\udccb Copier]  [\ud83d\uddd1\ufe0f Supprimer]                                   \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                \u2502\n\u2502  \u23f0 Hier \u00e0 14:30                                  [Windows]    \u2502\n\u2502  Get-ADUser -Identity jdoe -Properties DisplayName             \u2502\n\u2502  Action: Get AD User | Cat\u00e9gorie: Active Directory            \u2502\n\u2502  [\ud83d\udccb Copier]  [\ud83d\uddd1\ufe0f Supprimer]                                   \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                \u2502\n\u2502  ... (affiche jusqu'\u00e0 1000 entr\u00e9es par d\u00e9faut)                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"UserGuide/#rechercher-dans-lhistorique","title":"Rechercher dans l'Historique","text":"<p>Tapez dans la barre de recherche pour filtrer par : - Texte de la commande - Titre de l'action - Cat\u00e9gorie</p>"},{"location":"UserGuide/#filtrer-lhistorique","title":"Filtrer l'Historique","text":"<p>Par Date : - S\u00e9lectionnez une plage de dates (ex: \"Derniers 7 jours\", \"Derniers 30 jours\", \"Personnalis\u00e9\")</p> <p>Par Cat\u00e9gorie : - S\u00e9lectionnez une cat\u00e9gorie sp\u00e9cifique (ex: \"Active Directory\", \"DNS\")</p> <p>Par Plateforme : - Windows uniquement - Linux uniquement - Les deux</p>"},{"location":"UserGuide/#copier-une-commande-passee","title":"Copier une Commande Pass\u00e9e","text":"<ul> <li>Cliquez sur le bouton \"\ud83d\udccb Copier\" \u00e0 c\u00f4t\u00e9 de la commande</li> <li>La commande est copi\u00e9e dans le presse-papiers</li> </ul>"},{"location":"UserGuide/#supprimer-une-entree","title":"Supprimer une Entr\u00e9e","text":"<ul> <li>Cliquez sur le bouton \"\ud83d\uddd1\ufe0f Supprimer\"</li> <li>Confirmez la suppression</li> <li>L'entr\u00e9e est supprim\u00e9e de l'historique</li> </ul>"},{"location":"UserGuide/#nettoyage-automatique","title":"Nettoyage Automatique","text":"<p>Par d\u00e9faut, l'historique conserve 90 jours de commandes.</p> <p>Les commandes plus anciennes sont automatiquement supprim\u00e9es.</p> <p>Configurable dans les param\u00e8tres (de 1 \u00e0 3650 jours).</p>"},{"location":"UserGuide/#widget-des-commandes-recentes","title":"Widget des Commandes R\u00e9centes","text":"<p>Sur la page d'accueil, un widget affiche vos 5 derni\u00e8res commandes :</p> <pre><code>\ud83d\udccb Commandes R\u00e9centes\n\n\u23f0 5 min ago    Get-Service -Name Spooler\n\u23f0 2h ago       systemctl status nginx\n\u23f0 Hier 14:30   Get-ADUser -Identity jdoe\n\u23f0 3 jours      Clear-DnsClientCache\n\u23f0 1 semaine    Get-EventLog -LogName System -Newest 100\n</code></pre> <p>Cliquez sur une entr\u00e9e pour la copier instantan\u00e9ment !</p>"},{"location":"UserGuide/#categories-personnalisees","title":"Cat\u00e9gories Personnalis\u00e9es","text":""},{"location":"UserGuide/#ouvrir-le-gestionnaire-de-categories","title":"Ouvrir le Gestionnaire de Cat\u00e9gories","text":"<p>M\u00e9thode 1 : Menu Tools \u2192 Manage Categories M\u00e9thode 2 : Raccourci clavier Ctrl+M</p>"},{"location":"UserGuide/#interface-de-gestion","title":"Interface de Gestion","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  G\u00e9rer les Cat\u00e9gories                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Cat\u00e9gories          \u2502  D\u00e9tails de la Cat\u00e9gorie                \u2502\n\u2502  [+ Add New]         \u2502                                         \u2502\n\u2502                      \u2502  \ud83d\udd35 Active Directory                     \u2502\n\u2502  \ud83d\udd35 AD (5 actions)   \u2502  Icon: user                             \u2502\n\u2502  \ud83d\udfe2 DNS (3 actions)  \u2502  Color: #2196F3                         \u2502\n\u2502  \ud83d\udd34 Logs (7 actions) \u2502  Actions: 5                             \u2502\n\u2502  \ud83d\udfe0 Backup           \u2502  Status: Visible                        \u2502\n\u2502  \ud83d\udfe3 Monitoring       \u2502  Type: Custom                           \u2502\n\u2502                      \u2502                                         \u2502\n\u2502  [\u2191 Move Up]         \u2502  [Rename]  [Hide]  [Delete]            \u2502\n\u2502  [\u2193 Move Down]       \u2502                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"UserGuide/#creer-une-categorie","title":"Cr\u00e9er une Cat\u00e9gorie","text":"<ol> <li>Cliquez sur \"+ Add New Category\"</li> <li>Remplissez le formulaire :</li> <li>Nom : Ex. \"Backup Quotidien\"</li> <li>Ic\u00f4ne : Choisissez parmi 24 ic\u00f4nes :<ul> <li>\ud83d\udcc1 folder, \u2b50 star, \ud83d\udd27 tools, \ud83d\uddc4\ufe0f database, \ud83d\udcca chart, \ud83d\udd12 lock, etc.</li> </ul> </li> <li>Couleur : S\u00e9lectionnez une des 12 couleurs :<ul> <li>Bleu, Vert, Rouge, Orange, Violet, Rose, Jaune, Cyan, etc.</li> </ul> </li> <li>Description (optionnel) : \"Commandes pour les backups quotidiens automatis\u00e9s\"</li> <li>Cliquez sur \"Save Category\"</li> </ol> <p>Une notification confirme : \u2705 \"Cat\u00e9gorie cr\u00e9\u00e9e avec succ\u00e8s\"</p>"},{"location":"UserGuide/#renommer-une-categorie","title":"Renommer une Cat\u00e9gorie","text":"<ol> <li>S\u00e9lectionnez la cat\u00e9gorie dans la liste</li> <li>Cliquez sur \"Rename Category\"</li> <li>Modifiez le nom</li> <li>Cliquez sur \"Save\"</li> </ol> <p>\u26a0\ufe0f Note : Les cat\u00e9gories syst\u00e8me (avec badge jaune \"System\") ne peuvent pas \u00eatre renomm\u00e9es.</p>"},{"location":"UserGuide/#supprimer-une-categorie","title":"Supprimer une Cat\u00e9gorie","text":"<ol> <li>S\u00e9lectionnez la cat\u00e9gorie</li> <li>Cliquez sur \"Delete Category\"</li> <li>Un message de confirmation affiche le nombre d'actions affect\u00e9es</li> <li>Confirmez la suppression</li> </ol> <p>Comportement : - La cat\u00e9gorie est retir\u00e9e de toutes les actions qui l'utilisent - Les actions ne sont PAS supprim\u00e9es (juste la r\u00e9f\u00e9rence \u00e0 la cat\u00e9gorie)</p> <p>\u26a0\ufe0f Protection : Les cat\u00e9gories syst\u00e8me ne peuvent pas \u00eatre supprim\u00e9es.</p>"},{"location":"UserGuide/#reorganiser-les-categories","title":"R\u00e9organiser les Cat\u00e9gories","text":"<p>Boutons \"Move Up\" et \"Move Down\" : - Changez l'ordre d'affichage dans le panneau de gauche - L'ordre est sauvegard\u00e9 automatiquement</p>"},{"location":"UserGuide/#masquerafficher-une-categorie","title":"Masquer/Afficher une Cat\u00e9gorie","text":"<p>Bouton \"Hide\" : - Masque la cat\u00e9gorie de la navigation (panneau gauche) - La cat\u00e9gorie existe toujours dans la base de donn\u00e9es</p> <p>Bouton \"Show\" : - R\u00e9affiche la cat\u00e9gorie masqu\u00e9e</p>"},{"location":"UserGuide/#limites","title":"Limites","text":"<ul> <li>Maximum : 50 cat\u00e9gories personnalis\u00e9es</li> <li>Message si limite atteinte : \"Limite de cat\u00e9gories atteinte (50/50)\"</li> </ul>"},{"location":"UserGuide/#themes-et-personnalisation","title":"Th\u00e8mes et Personnalisation","text":""},{"location":"UserGuide/#acceder-aux-parametres-de-theme","title":"Acc\u00e9der aux Param\u00e8tres de Th\u00e8me","text":"<p>M\u00e9thode 1 : Menu File \u2192 Settings M\u00e9thode 2 : Raccourci clavier Ctrl+,</p>"},{"location":"UserGuide/#choisir-un-theme","title":"Choisir un Th\u00e8me","text":"<p>Section Appearance :</p> <ol> <li>Light : Th\u00e8me clair (par d\u00e9faut)</li> <li>Fond blanc/gris clair</li> <li>Texte noir</li> <li> <p>Id\u00e9al pour les environnements lumineux</p> </li> <li> <p>Dark : Th\u00e8me sombre professionnel</p> </li> <li>Fond gris fonc\u00e9/noir</li> <li>Texte blanc</li> <li> <p>R\u00e9duit la fatigue oculaire</p> </li> <li> <p>System : Suit automatiquement le th\u00e8me Windows</p> </li> <li>Lit le registre Windows : <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize</code></li> <li>Change automatiquement si Windows passe de clair \u00e0 sombre (et vice versa)</li> </ol>"},{"location":"UserGuide/#previsualiser-un-theme","title":"Pr\u00e9visualiser un Th\u00e8me","text":"<p>Cliquez sur \"Preview Theme\" pour voir le r\u00e9sultat sans sauvegarder.</p> <p>Caract\u00e9ristiques : - Transition fluide : Changement sans clignotement - Application imm\u00e9diate : Tous les \u00e9crans sont mis \u00e0 jour - R\u00e9versible : Cliquez \"Cancel\" pour revenir au th\u00e8me pr\u00e9c\u00e9dent</p>"},{"location":"UserGuide/#sauvegarder-le-theme","title":"Sauvegarder le Th\u00e8me","text":"<p>Cliquez sur \"Save\" pour enregistrer votre choix.</p> <p>Le th\u00e8me est sauvegard\u00e9 dans <code>%APPDATA%\\TwinShell\\settings.json</code> et persiste entre les sessions.</p>"},{"location":"UserGuide/#conformite-wcag-aaa","title":"Conformit\u00e9 WCAG AAA","text":"<p>Les th\u00e8mes TwinShell respectent les normes WCAG AAA d'accessibilit\u00e9 :</p> \u00c9l\u00e9ment Contraste Norme WCAG AAA Texte principal 11.6:1 \u2705 D\u00e9passe 7:1 requis Texte secondaire 9.2:1 \u2705 D\u00e9passe 7:1 requis \u00c9l\u00e9ments UI 7.2:1 \u2705 D\u00e9passe 3:1 requis <p>Avantages : - Lisibilit\u00e9 optimale - Confort visuel - Accessibilit\u00e9 pour les personnes malvoyantes</p>"},{"location":"UserGuide/#parametres-avances","title":"Param\u00e8tres Avanc\u00e9s","text":""},{"location":"UserGuide/#acceder-aux-parametres","title":"Acc\u00e9der aux Param\u00e8tres","text":"<p>Ctrl+, ou Menu File \u2192 Settings</p>"},{"location":"UserGuide/#section-appearance-apparence","title":"Section Appearance (Apparence)","text":"<ul> <li>Theme : Light | Dark | System</li> <li>Preview Theme : Pr\u00e9visualiser avant de sauvegarder</li> </ul>"},{"location":"UserGuide/#section-behavior-comportement","title":"Section Behavior (Comportement)","text":""},{"location":"UserGuide/#historique","title":"Historique","text":"<p>Command History Retention (R\u00e9tention de l'historique) - Plage : 1 \u00e0 3650 jours - Par d\u00e9faut : 90 jours - Comportement : Les commandes plus anciennes sont automatiquement supprim\u00e9es</p> <p>Maximum History Items (Nombre max d'items affich\u00e9s) - Plage : 10 \u00e0 100 000 - Par d\u00e9faut : 1000 - Comportement : Limite le nombre d'entr\u00e9es affich\u00e9es dans la vue historique</p>"},{"location":"UserGuide/#widget-commandes-recentes","title":"Widget Commandes R\u00e9centes","text":"<p>Recent Commands Count (Nombre de commandes r\u00e9centes) - Plage : 1 \u00e0 50 - Par d\u00e9faut : 5 - Comportement : Nombre de commandes affich\u00e9es dans le widget de la page d'accueil</p> <p>Show Recent Commands Widget (Afficher le widget) - \u2611 Coch\u00e9 : Widget visible au d\u00e9marrage - \u2610 D\u00e9coch\u00e9 : Widget masqu\u00e9</p>"},{"location":"UserGuide/#securite","title":"S\u00e9curit\u00e9","text":"<p>Confirm before executing dangerous commands (Confirmer avant les commandes dangereuses) - \u2611 Recommand\u00e9 : Affiche une confirmation avant de copier des commandes de niveau \"Dangerous\" - \u2610 D\u00e9sactiv\u00e9 : Copie directement sans confirmation</p>"},{"location":"UserGuide/#reinitialiser-les-parametres","title":"R\u00e9initialiser les Param\u00e8tres","text":"<p>Bouton \"Reset to Defaults\" : - Restaure tous les param\u00e8tres aux valeurs par d\u00e9faut - Demande confirmation avant de r\u00e9initialiser - N\u00e9cessite un red\u00e9marrage de l'application</p>"},{"location":"UserGuide/#emplacement-du-fichier-de-configuration","title":"Emplacement du Fichier de Configuration","text":"<p>Les param\u00e8tres sont sauvegard\u00e9s dans : <pre><code>%APPDATA%\\TwinShell\\settings.json\n</code></pre></p> <p>Exemple de contenu : <pre><code>{\n  \"Theme\": \"Dark\",\n  \"AutoCleanupDays\": 90,\n  \"MaxHistoryItems\": 1000,\n  \"RecentCommandsCount\": 5,\n  \"ShowRecentCommandsWidget\": true,\n  \"ConfirmDangerousActions\": true,\n  \"DefaultPlatformFilter\": null\n}\n</code></pre></p>"},{"location":"UserGuide/#export-et-import-de-configuration","title":"Export et Import de Configuration","text":""},{"location":"UserGuide/#exporter-la-configuration","title":"Exporter la Configuration","text":""},{"location":"UserGuide/#ouvrir-lexport","title":"Ouvrir l'Export","text":"<p>M\u00e9thode 1 : Menu File \u2192 Export Configuration M\u00e9thode 2 : Raccourci clavier Ctrl+E</p>"},{"location":"UserGuide/#processus-dexport","title":"Processus d'Export","text":"<ol> <li>Une bo\u00eete de dialogue \"Enregistrer sous\" s'ouvre</li> <li>Choisissez l'emplacement et le nom du fichier</li> <li>Format : JSON (ex: <code>twinshell-config-2025-01-18.json</code>)</li> <li>Cliquez sur \"Enregistrer\"</li> <li>Notification : \u2705 \"Configuration export\u00e9e avec succ\u00e8s\"</li> </ol>"},{"location":"UserGuide/#contenu-exporte","title":"Contenu Export\u00e9","text":"<p>Le fichier JSON contient : - Favoris : Liste des actions favorites avec leurs IDs - Historique : Toutes les commandes g\u00e9n\u00e9r\u00e9es avec horodatage - Param\u00e8tres : Vos pr\u00e9f\u00e9rences (th\u00e8me, r\u00e9tention, etc.)</p> <p>Exemple de structure : <pre><code>{\n  \"favorites\": [\n    {\n      \"actionId\": \"get-service-windows\",\n      \"createdAt\": \"2025-01-15T10:30:00Z\"\n    },\n    ...\n  ],\n  \"history\": [\n    {\n      \"actionId\": \"get-service-windows\",\n      \"generatedCommand\": \"Get-Service -Name Spooler\",\n      \"parameters\": { \"ServiceName\": \"Spooler\" },\n      \"platform\": \"Windows\",\n      \"createdAt\": \"2025-01-18T08:45:00Z\",\n      \"category\": \"Services\",\n      \"actionTitle\": \"Get-Service\"\n    },\n    ...\n  ],\n  \"settings\": {\n    \"theme\": \"Dark\",\n    \"autoCleanupDays\": 90,\n    ...\n  }\n}\n</code></pre></p>"},{"location":"UserGuide/#importer-une-configuration","title":"Importer une Configuration","text":""},{"location":"UserGuide/#ouvrir-limport","title":"Ouvrir l'Import","text":"<p>M\u00e9thode 1 : Menu File \u2192 Import Configuration M\u00e9thode 2 : Raccourci clavier Ctrl+I</p>"},{"location":"UserGuide/#processus-dimport","title":"Processus d'Import","text":"<ol> <li>Une bo\u00eete de dialogue \"Ouvrir\" s'affiche</li> <li>S\u00e9lectionnez le fichier JSON \u00e0 importer</li> <li>Cliquez sur \"Ouvrir\"</li> <li>TwinShell valide l'int\u00e9grit\u00e9 du fichier</li> <li>Mode fusion : Les donn\u00e9es existantes sont pr\u00e9serv\u00e9es</li> <li>Notification : \u2705 \"Configuration import\u00e9e avec succ\u00e8s\"</li> </ol>"},{"location":"UserGuide/#comportement-de-fusion","title":"Comportement de Fusion","text":"<ul> <li>Favoris : Les favoris import\u00e9s sont ajout\u00e9s (pas de doublon)</li> <li>Historique : Les commandes import\u00e9es sont fusionn\u00e9es avec l'existant</li> <li>Param\u00e8tres : Les param\u00e8tres import\u00e9s remplacent les existants</li> </ul>"},{"location":"UserGuide/#validation","title":"Validation","text":"<p>TwinShell v\u00e9rifie : - Format JSON valide - Structure correcte (cl\u00e9s <code>favorites</code>, <code>history</code>, <code>settings</code>) - Int\u00e9grit\u00e9 des donn\u00e9es (dates valides, IDs coh\u00e9rents)</p> <p>Si le fichier est invalide, un message d'erreur s'affiche : <pre><code>\u274c Erreur : Fichier de configuration invalide\nLe fichier JSON est corrompu ou incompatible.\n</code></pre></p>"},{"location":"UserGuide/#cas-dusage","title":"Cas d'Usage","text":""},{"location":"UserGuide/#sauvegarde-reguliere","title":"Sauvegarde R\u00e9guli\u00e8re","text":"<p>Exportez votre configuration chaque semaine pour sauvegarder : - Vos favoris - Votre historique - Vos pr\u00e9f\u00e9rences</p>"},{"location":"UserGuide/#partage-avec-un-collegue","title":"Partage avec un Coll\u00e8gue","text":"<p>Exportez vos favoris et partagez le fichier JSON : - Votre coll\u00e8gue importe le fichier - Il r\u00e9cup\u00e8re vos commandes favorites - Id\u00e9al pour standardiser les commandes dans une \u00e9quipe</p>"},{"location":"UserGuide/#migration-vers-un-nouveau-pc","title":"Migration vers un Nouveau PC","text":"<ol> <li>Exportez votre configuration sur l'ancien PC</li> <li>Installez TwinShell sur le nouveau PC</li> <li>Importez le fichier JSON</li> <li>Vous retrouvez toutes vos donn\u00e9es !</li> </ol>"},{"location":"UserGuide/#raccourcis-clavier","title":"Raccourcis Clavier","text":""},{"location":"UserGuide/#raccourcis-globaux","title":"Raccourcis Globaux","text":"Raccourci Action Description Ctrl+, Param\u00e8tres Ouvre la fen\u00eatre des param\u00e8tres Ctrl+M G\u00e9rer les Cat\u00e9gories Ouvre le gestionnaire de cat\u00e9gories Ctrl+E Exporter Exporte la configuration au format JSON Ctrl+I Importer Importe une configuration depuis un fichier JSON F1 Aide Affiche l'aide et les raccourcis clavier F5 Actualiser Recharge la liste des actions depuis la base de donn\u00e9es Esc Annuler/Fermer Ferme la fen\u00eatre ou annule l'action en cours Alt+F4 Quitter Ferme l'application"},{"location":"UserGuide/#navigation-au-clavier","title":"Navigation au Clavier","text":"Raccourci Action Tab Passe au contr\u00f4le suivant Shift+Tab Passe au contr\u00f4le pr\u00e9c\u00e9dent Espace Coche/d\u00e9coche une case Entr\u00e9e Active le bouton/\u00e9l\u00e9ment s\u00e9lectionn\u00e9 Fl\u00e8ches \u2191\u2193 Navigue dans les listes"},{"location":"UserGuide/#aide-integree","title":"Aide Int\u00e9gr\u00e9e","text":"<p>Appuyez sur F1 pour afficher une fen\u00eatre d'aide avec tous les raccourcis disponibles.</p>"},{"location":"UserGuide/#conseils-et-astuces","title":"Conseils et Astuces","text":""},{"location":"UserGuide/#optimiser-votre-workflow","title":"Optimiser votre Workflow","text":""},{"location":"UserGuide/#1-creez-des-categories-thematiques","title":"1. Cr\u00e9ez des Cat\u00e9gories Th\u00e9matiques","text":"<p>Organisez vos commandes par th\u00e8me : - \"T\u00e2ches Quotidiennes\" : Commandes que vous utilisez tous les jours - \"Maintenance\" : Commandes de maintenance hebdomadaire - \"Urgences\" : Commandes critiques pour r\u00e9soudre des probl\u00e8mes rapidement - \"Formation\" : Commandes pour former de nouveaux membres de l'\u00e9quipe</p> <p>Assignez des couleurs distinctes pour une reconnaissance rapide.</p>"},{"location":"UserGuide/#2-utilisez-les-raccourcis-clavier","title":"2. Utilisez les Raccourcis Clavier","text":"<p>Gagnez du temps en m\u00e9morisant ces raccourcis : - <code>Ctrl+M</code> pour g\u00e9rer les cat\u00e9gories - <code>F5</code> pour actualiser - <code>Ctrl+E</code> pour exporter r\u00e9guli\u00e8rement</p>"},{"location":"UserGuide/#3-configurez-le-mode-sombre","title":"3. Configurez le Mode Sombre","text":"<p>R\u00e9duisez la fatigue oculaire lors de sessions longues : - Utilisez le mode System pour un changement automatique jour/nuit - Activez le mode Dark pour les sessions en soir\u00e9e</p>"},{"location":"UserGuide/#4-ajustez-les-preferences-dhistorique","title":"4. Ajustez les Pr\u00e9f\u00e9rences d'Historique","text":"<ul> <li>R\u00e9duisez la r\u00e9tention (30 jours) si l'espace disque est limit\u00e9</li> <li>Augmentez la r\u00e9tention (365 jours) pour conserver un historique \u00e9tendu</li> </ul>"},{"location":"UserGuide/#5-activez-les-confirmations-pour-actions-dangereuses","title":"5. Activez les Confirmations pour Actions Dangereuses","text":"<p>\u00c9vitez les erreurs accidentelles : - Param\u00e8tres \u2192 \"Confirm before executing dangerous commands\" \u2611 - Recommand\u00e9 pour les environnements de production</p>"},{"location":"UserGuide/#recherche-efficace","title":"Recherche Efficace","text":""},{"location":"UserGuide/#utilisez-des-mots-cles-courts","title":"Utilisez des Mots-Cl\u00e9s Courts","text":"<p>Au lieu de : <pre><code>\"comment lister tous les services windows en cours d'ex\u00e9cution\"\n</code></pre></p> <p>Tapez simplement : <pre><code>\"service windows\"\n</code></pre></p>"},{"location":"UserGuide/#profitez-du-fuzzy-matching","title":"Profitez du Fuzzy Matching","text":"<p>M\u00eame avec des fautes de frappe, vous trouverez : - <code>serviec</code> \u2192 trouve \"service\" - <code>netwrok</code> \u2192 trouve \"network\" - <code>usr</code> \u2192 trouve \"user\"</p>"},{"location":"UserGuide/#recherchez-par-tags","title":"Recherchez par Tags","text":"<p>Les tags sont tr\u00e8s utiles pour trouver des types de commandes : - <code>diagnostic</code> \u2192 Commandes de diagnostic - <code>security</code> \u2192 Commandes de s\u00e9curit\u00e9 - <code>performance</code> \u2192 Commandes d'optimisation</p>"},{"location":"UserGuide/#widget-des-commandes-recentes_1","title":"Widget des Commandes R\u00e9centes","text":"<p>Le widget sur la page d'accueil est tr\u00e8s pratique : - Cliquez sur une commande pour la recopier instantan\u00e9ment - Plus besoin d'aller dans l'historique pour retrouver une commande r\u00e9cente</p>"},{"location":"UserGuide/#export-regulier","title":"Export R\u00e9gulier","text":"<p>Exportez votre configuration une fois par mois : - Protection contre la perte de donn\u00e9es - Sauvegarde de vos favoris et historique - Migration facile vers un nouveau PC</p>"},{"location":"UserGuide/#resolution-de-problemes","title":"R\u00e9solution de Probl\u00e8mes","text":""},{"location":"UserGuide/#probleme-lapplication-ne-demarre-pas","title":"Probl\u00e8me : L'application ne d\u00e9marre pas","text":"<p>Causes possibles : 1. .NET 8 Runtime manquant 2. Permissions insuffisantes 3. Base de donn\u00e9es corrompue</p> <p>Solutions :</p>"},{"location":"UserGuide/#1-verifier-net-8-runtime","title":"1. V\u00e9rifier .NET 8 Runtime","text":"<p>Ouvrez PowerShell et tapez : <pre><code>dotnet --version\n</code></pre></p> <p>Si la commande \u00e9choue ou affiche une version &lt; 8.0 : 1. T\u00e9l\u00e9chargez .NET 8 Runtime 2. Installez-le 3. Red\u00e9marrez votre PC</p>"},{"location":"UserGuide/#2-verifier-les-permissions","title":"2. V\u00e9rifier les Permissions","text":"<p>V\u00e9rifiez que vous avez acc\u00e8s en \u00e9criture \u00e0 : <pre><code>%LOCALAPPDATA%\\TwinShell\n%APPDATA%\\TwinShell\n</code></pre></p> <p>Si n\u00e9cessaire, ex\u00e9cutez TwinShell en tant qu'administrateur (clic droit \u2192 \"Ex\u00e9cuter en tant qu'administrateur\").</p>"},{"location":"UserGuide/#3-reinitialiser-la-base-de-donnees","title":"3. R\u00e9initialiser la Base de Donn\u00e9es","text":"<p>Si la base de donn\u00e9es est corrompue : 1. Fermez TwinShell 2. Supprimez le fichier : <code>%LOCALAPPDATA%\\TwinShell\\twinshell.db</code> 3. Relancez TwinShell (une nouvelle base sera cr\u00e9\u00e9e)</p> <p>\u26a0\ufe0f Attention : Vous perdrez vos favoris et historique. Exportez d'abord si possible.</p>"},{"location":"UserGuide/#probleme-le-theme-ne-change-pas-apres-sauvegarde","title":"Probl\u00e8me : Le th\u00e8me ne change pas apr\u00e8s sauvegarde","text":"<p>Causes possibles : 1. Param\u00e8tres non sauvegard\u00e9s 2. Fichier settings.json en lecture seule</p> <p>Solutions :</p>"},{"location":"UserGuide/#1-verifier-la-sauvegarde","title":"1. V\u00e9rifier la Sauvegarde","text":"<ul> <li>Assurez-vous de cliquer sur \"Save\" (et non \"Cancel\")</li> <li>V\u00e9rifiez qu'une notification \u2705 \"Param\u00e8tres sauvegard\u00e9s\" s'affiche</li> </ul>"},{"location":"UserGuide/#2-verifier-le-fichier-settingsjson","title":"2. V\u00e9rifier le Fichier settings.json","text":"<p>Ouvrez l'Explorateur Windows et allez dans : <pre><code>%APPDATA%\\TwinShell\\settings.json\n</code></pre></p> <p>V\u00e9rifiez le contenu : <pre><code>{\n  \"Theme\": \"Dark\",  // Doit \u00eatre \"Light\", \"Dark\" ou \"System\"\n  ...\n}\n</code></pre></p> <p>Si le fichier est en lecture seule : 1. Clic droit \u2192 Propri\u00e9t\u00e9s 2. D\u00e9cochez \"Lecture seule\" 3. Cliquez sur \"Appliquer\"</p>"},{"location":"UserGuide/#3-redemarrer-lapplication","title":"3. Red\u00e9marrer l'Application","text":"<p>Si le th\u00e8me ne se charge pas : 1. Fermez compl\u00e8tement TwinShell (v\u00e9rifiez le Gestionnaire des t\u00e2ches) 2. Relancez l'application</p>"},{"location":"UserGuide/#probleme-je-ne-trouve-pas-une-commande","title":"Probl\u00e8me : Je ne trouve pas une commande","text":"<p>Causes possibles : 1. Filtres actifs 2. Recherche trop sp\u00e9cifique 3. Cat\u00e9gorie non s\u00e9lectionn\u00e9e</p> <p>Solutions :</p>"},{"location":"UserGuide/#1-desactiver-les-filtres","title":"1. D\u00e9sactiver les Filtres","text":"<ul> <li>D\u00e9cochez tous les filtres Platform et Level</li> <li>Cliquez sur \"\ud83d\udccb All Commands\" pour voir toutes les commandes</li> </ul>"},{"location":"UserGuide/#2-simplifier-la-recherche","title":"2. Simplifier la Recherche","text":"<p>Au lieu de : <pre><code>\"comment obtenir les informations d'un utilisateur active directory\"\n</code></pre></p> <p>Tapez : <pre><code>\"AD user\"\n</code></pre></p>"},{"location":"UserGuide/#3-verifier-lexistence","title":"3. V\u00e9rifier l'Existence","text":"<p>Toutes les commandes ne sont pas forc\u00e9ment dans la base de donn\u00e9es.</p> <p>Consultez la liste compl\u00e8te dans : <code>data/seed/initial-actions.json</code></p> <p>Si une commande manque, vous pouvez : - Cr\u00e9er une issue sur GitHub pour demander son ajout - Modifier manuellement le fichier JSON (n\u00e9cessite des connaissances techniques)</p>"},{"location":"UserGuide/#probleme-les-raccourcis-clavier-ne-fonctionnent-pas","title":"Probl\u00e8me : Les raccourcis clavier ne fonctionnent pas","text":"<p>Causes possibles : 1. La fen\u00eatre TwinShell n'a pas le focus 2. Conflit avec une autre application</p> <p>Solutions :</p>"},{"location":"UserGuide/#1-verifier-le-focus","title":"1. V\u00e9rifier le Focus","text":"<ul> <li>Cliquez sur la fen\u00eatre TwinShell pour lui donner le focus</li> <li>Les raccourcis ne fonctionnent que si TwinShell est au premier plan</li> </ul>"},{"location":"UserGuide/#2-verifier-les-conflits","title":"2. V\u00e9rifier les Conflits","text":"<p>Certaines applications interceptent les raccourcis globaux : - Ctrl+, : Peut \u00eatre utilis\u00e9 par des IDE (Visual Studio Code, etc.) - F5 : Peut \u00eatre utilis\u00e9 par des navigateurs</p> <p>Solution : - Fermez temporairement l'application conflictuelle - Ou utilisez les menus au lieu des raccourcis</p>"},{"location":"UserGuide/#3-consulter-la-liste-des-raccourcis","title":"3. Consulter la Liste des Raccourcis","text":"<p>Appuyez sur F1 pour voir tous les raccourcis actifs.</p>"},{"location":"UserGuide/#probleme-categorie-non-modifiablesupprimable","title":"Probl\u00e8me : Cat\u00e9gorie non modifiable/supprimable","text":"<p>Cause : Les cat\u00e9gories syst\u00e8me sont prot\u00e9g\u00e9es.</p> <p>Identification : Les cat\u00e9gories syst\u00e8me ont un badge jaune \"System\" dans le gestionnaire de cat\u00e9gories.</p> <p>Cat\u00e9gories syst\u00e8me : - Active Directory &amp; GPO - Network &amp; DNS - Monitoring &amp; Logs - Services &amp; Automation - Windows Optimization - Linux Administration - Package Management - Files &amp; Storage - Security &amp; Encryption - Windows Updates - User Management - Containers &amp; VMs - Database - Development - Performance</p> <p>Vous NE POUVEZ PAS : - Renommer une cat\u00e9gorie syst\u00e8me - Supprimer une cat\u00e9gorie syst\u00e8me</p> <p>Vous POUVEZ : - Masquer une cat\u00e9gorie syst\u00e8me (bouton \"Hide\") - Cr\u00e9er une nouvelle cat\u00e9gorie personnalis\u00e9e similaire</p>"},{"location":"UserGuide/#probleme-import-de-configuration-echoue","title":"Probl\u00e8me : Import de configuration \u00e9choue","text":"<p>Causes possibles : 1. Fichier JSON invalide 2. Fichier corrompu 3. Format incompatible</p> <p>Solutions :</p>"},{"location":"UserGuide/#1-verifier-le-format-json","title":"1. V\u00e9rifier le Format JSON","text":"<p>Ouvrez le fichier JSON dans un \u00e9diteur de texte (Notepad++, VS Code) :</p> <p>Bon format : <pre><code>{\n  \"favorites\": [...],\n  \"history\": [...],\n  \"settings\": {...}\n}\n</code></pre></p> <p>Mauvais format : <pre><code>{\n  favorites: [... // Guillemets manquants\n</code></pre></p>"},{"location":"UserGuide/#2-valider-le-json","title":"2. Valider le JSON","text":"<p>Utilisez un validateur JSON en ligne : - jsonlint.com - Collez le contenu du fichier - Corrigez les erreurs signal\u00e9es</p>"},{"location":"UserGuide/#3-reexporter-une-nouvelle-configuration","title":"3. R\u00e9exporter une Nouvelle Configuration","text":"<p>Si le fichier est corrompu : 1. Exportez une nouvelle configuration depuis TwinShell 2. Comparez les deux fichiers pour identifier les diff\u00e9rences 3. Fusionnez manuellement les donn\u00e9es si n\u00e9cessaire</p>"},{"location":"UserGuide/#probleme-base-de-donnees-volumineuse","title":"Probl\u00e8me : Base de donn\u00e9es volumineuse","text":"<p>Cause : L'historique contient des milliers de commandes.</p> <p>Solution :</p>"},{"location":"UserGuide/#1-reduire-la-retention","title":"1. R\u00e9duire la R\u00e9tention","text":"<p>Param\u00e8tres \u2192 Command History Retention \u2192 R\u00e9duisez \u00e0 30 ou 60 jours</p>"},{"location":"UserGuide/#2-nettoyer-manuellement","title":"2. Nettoyer Manuellement","text":"<p>Vue Historique \u2192 S\u00e9lectionnez des entr\u00e9es \u2192 Supprimez-les</p>"},{"location":"UserGuide/#3-reinitialiser-lhistorique","title":"3. R\u00e9initialiser l'Historique","text":"<p>\u26a0\ufe0f ATTENTION : Cela supprime tout l'historique.</p> <ol> <li>Fermez TwinShell</li> <li>Supprimez : <code>%LOCALAPPDATA%\\TwinShell\\twinshell.db</code></li> <li>Relancez TwinShell</li> </ol>"},{"location":"UserGuide/#4-exporter-avant-nettoyage","title":"4. Exporter Avant Nettoyage","text":"<p>Exportez d'abord votre configuration pour sauvegarder vos favoris.</p>"},{"location":"UserGuide/#ressources-supplementaires","title":"\ud83d\udcda Ressources Suppl\u00e9mentaires","text":""},{"location":"UserGuide/#documentation","title":"Documentation","text":"<ul> <li>Guide de Demarrage Rapide</li> <li>FAQ - Questions Frequentes</li> <li>GitHub TwinShell</li> <li>Documentation Developpeur</li> </ul>"},{"location":"UserGuide/#support","title":"Support","text":"<ul> <li>\ud83d\udcac GitHub Discussions</li> <li>\ud83d\udc1b Signaler un Bug</li> </ul>"},{"location":"UserGuide/#communaute","title":"Communaut\u00e9","text":"<ul> <li>\u2b50 Star sur GitHub</li> <li>Contribuer au Projet</li> </ul> <p>Bon travail avec TwinShell ! \ud83d\ude80</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-11-26 Version : 1.2.0</p>"},{"location":"developer/","title":"Documentation Developpeur - TwinShell","text":"<p>Documentation technique complete pour contribuer a TwinShell</p>"},{"location":"developer/#table-des-matieres","title":"Table des Matieres","text":"<ul> <li>Architecture et Conception</li> <li>Rapports de Sprints</li> <li>Securite</li> <li>Performance</li> <li>Qualite de Code</li> <li>Tests</li> <li>Guides Techniques</li> </ul>"},{"location":"developer/#architecture-et-conception","title":"Architecture et Conception","text":""},{"location":"developer/#architecture-generale","title":"Architecture Generale","text":"<ul> <li>ARCHITECTURE_DECISIONS.md - Decisions architecturales et justifications</li> <li>TECHNICAL_DEBT.md - Dette technique identifiee</li> </ul>"},{"location":"developer/#structure-du-projet","title":"Structure du Projet","text":"<pre><code>TwinShell/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 TwinShell.App/          # Application WPF (UI, ViewModels)\n\u2502   \u251c\u2500\u2500 TwinShell.Core/          # Logique metier (Models, Services)\n\u2502   \u251c\u2500\u2500 TwinShell.Persistence/   # EF Core + SQLite\n\u2502   \u2514\u2500\u2500 TwinShell.Infrastructure/# Services transverses\n\u251c\u2500\u2500 tests/\n\u2502   \u251c\u2500\u2500 TwinShell.Core.Tests/\n\u2502   \u2514\u2500\u2500 TwinShell.Persistence.Tests/\n\u251c\u2500\u2500 data/seed/\n\u2502   \u2514\u2500\u2500 initial-actions.json     # Donnees de seed\n\u2514\u2500\u2500 docs/                        # Documentation\n</code></pre>"},{"location":"developer/#stack-technique","title":"Stack Technique","text":"Composant Technologie Version Framework .NET 8.0 UI WPF (Windows Presentation Foundation) - Persistence SQLite + Entity Framework Core 8.x Architecture MVVM avec CommunityToolkit.Mvvm - Tests xUnit + FluentAssertions -"},{"location":"developer/#rapports-de-sprints","title":"Rapports de Sprints","text":""},{"location":"developer/#sprint-1-mvp-janvier-2025","title":"Sprint 1 - MVP (Janvier 2025)","text":"<ul> <li>Referentiel d'actions avec templates de commandes</li> <li>Recherche et filtrage avances</li> <li>Generateur de commandes avec parametres dynamiques</li> <li>Copie vers presse-papiers</li> </ul>"},{"location":"developer/#sprint-2-personnalisation-historique","title":"Sprint 2 - Personnalisation &amp; Historique","text":"<ul> <li>S2-MIGRATION-GUIDE.md - Guide de migration vers Sprint 2</li> <li>Historique des commandes avec recherche et filtrage</li> <li>Systeme de favoris (max 50)</li> <li>Export/Import de configuration JSON</li> <li>Widget des commandes recentes</li> </ul>"},{"location":"developer/#sprint-3-uiux-customization","title":"Sprint 3 - UI/UX &amp; Customization","text":"<ul> <li>SPRINT3_USER_GUIDE.md - Guide utilisateur Sprint 3</li> <li>Themes clair/sombre avec mode systeme (WCAG AAA)</li> <li>Categories personnalisees avec icones et couleurs</li> <li>Animations et transitions fluides</li> <li>Notifications toast</li> <li>Raccourcis clavier complets</li> </ul>"},{"location":"developer/#sprint-8-performance","title":"Sprint 8 - Performance","text":"<ul> <li>SPRINT-8-PERFORMANCE-GUIDE.md - Guide de performance</li> <li>Pagination dans HistoryViewModel</li> <li>ObservableRangeCollection</li> <li>Optimisations LINQ</li> <li>Reduction CPU (60%)</li> </ul>"},{"location":"developer/#sprint-9-windows-integration","title":"Sprint 9 - Windows Integration","text":"<ul> <li>SPRINT-9-FINAL-REPORT.md - Rapport final Sprint 9</li> <li>Integration avancee Windows</li> <li>Scripts d'optimisation</li> </ul>"},{"location":"developer/#securite","title":"Securite","text":""},{"location":"developer/#audit-de-securite-janvier-2025","title":"Audit de Securite (Janvier 2025)","text":"<p>15 vulnerabilites critiques corrigees :</p> <ul> <li>SECURITY.md - Politique de securite complete</li> <li>SECURITY_EXECUTIVE_SUMMARY.md - Resume executif securite</li> <li>SECURITY_FIXES.md - Liste des corrections de securite</li> <li>SECURITY_VULNERABILITIES_MAP.md - Carte des vulnerabilites</li> </ul>"},{"location":"developer/#vulnerabilites-corrigees","title":"Vulnerabilites Corrigees","text":"Categorie Status Description Injection de commandes CORRIGE Protection validee Path traversal CORRIGE Validation stricte des chemins Memory leaks CORRIGE SemaphoreSlim disposes Race conditions CORRIGE ViewModels securises Information disclosure CORRIGE Exceptions masquees DoS CORRIGE Limites sur fichiers et collections Validation entrees CORRIGE Validation complete Thread-safety CORRIGE Amelioree"},{"location":"developer/#performance","title":"Performance","text":""},{"location":"developer/#guides-doptimisation","title":"Guides d'Optimisation","text":"<ul> <li>PERFORMANCE_QUICK_START.md - Guide de demarrage rapide</li> <li>SPRINT-8-PERFORMANCE-GUIDE.md - Guide de performance detaille</li> <li>OPTIMISATION-WINDOWS.md - Guide d'optimisation Windows</li> <li>PACKAGE-MANAGERS.md - Gestionnaires de paquets Windows</li> </ul>"},{"location":"developer/#ameliorations-cles","title":"Ameliorations Cles","text":"Optimisation Impact Description Pagination Memoire Charge 50 entrees au lieu de 1000 ObservableRangeCollection UI Single notification Filtrage optimise CPU Filtre avant chargement LINQ optimise CPU Enumerations uniques Timer interval CPU 250ms au lieu de 100ms (-60% CPU)"},{"location":"developer/#qualite-de-code","title":"Qualite de Code","text":""},{"location":"developer/#analyses-et-reviews","title":"Analyses et Reviews","text":"<ul> <li>CODE_STYLE_ANALYSIS.md - Analyse du style de code</li> <li>CODE_ISSUES_SUMMARY.md - Resume des problemes de code</li> <li>RECOMMENDED_REFACTORINGS.md - Refactorings recommandes</li> </ul>"},{"location":"developer/#stabilite","title":"Stabilite","text":"<p>8 problemes de stabilite resolus :</p> <ul> <li>Gestion appropriee des ressources (IDisposable pattern)</li> <li>Locks pour sections critiques</li> <li>Timer cleanup dans ExecutionViewModel</li> <li>Fragile checks remplaces par flags explicites</li> </ul>"},{"location":"developer/#tests","title":"Tests","text":""},{"location":"developer/#couverture-de-tests","title":"Couverture de Tests","text":"Composant Tests Couverture SettingsService 14 tests 100% pass SearchService 50+ tests ~90% TextNormalizer 35+ tests ~95%"},{"location":"developer/#execution-des-tests","title":"Execution des Tests","text":"<pre><code># Tous les tests\ndotnet test\n\n# Tests specifiques\ndotnet test --filter \"FullyQualifiedName~SearchServiceTests\"\n\n# Avec couverture\ndotnet test --collect:\"XPlat Code Coverage\"\n</code></pre>"},{"location":"developer/#guides-techniques","title":"Guides Techniques","text":""},{"location":"developer/#documentation-disponible","title":"Documentation Disponible","text":"Guide Description Fichier Recherche Documentation complete de la recherche SEARCH_FUNCTIONALITY.md Migration S2 Guide de migration Sprint 2 S2-MIGRATION-GUIDE.md Migration Notes de migration entre versions MIGRATION_NOTES.md Cross-Platform Strategie cross-platform CROSS-PLATFORM-STRATEGY.md"},{"location":"developer/#contribuer-au-projet","title":"Contribuer au Projet","text":""},{"location":"developer/#guide-de-contribution","title":"Guide de Contribution","text":"<ol> <li>Forkez le projet</li> <li>Creez une branche pour votre fonctionnalite</li> <li>Commitez vos changements</li> <li>Pushez vers la branche</li> <li>Ouvrez une Pull Request</li> </ol>"},{"location":"developer/#standards-de-code","title":"Standards de Code","text":"Standard Regle Architecture MVVM avec CommunityToolkit.Mvvm Naming PascalCase pour classes/methodes, camelCase pour variables Documentation XML comments sur toutes les APIs publiques Tests Couverture minimale de 80% Commits Messages clairs et descriptifs (en anglais)"},{"location":"developer/#ressources-utiles","title":"Ressources Utiles","text":"<ul> <li>Guide de Demarrage Rapide</li> <li>Guide Utilisateur</li> <li>FAQ</li> </ul>"},{"location":"developer/#ressources-externes","title":"Ressources Externes","text":""},{"location":"developer/#documentation-microsoft","title":"Documentation Microsoft","text":"<ul> <li>.NET 8 Documentation</li> <li>WPF Documentation</li> <li>Entity Framework Core</li> <li>PowerShell Documentation</li> </ul>"},{"location":"developer/#communaute","title":"Communaute","text":"<ul> <li>CommunityToolkit.Mvvm</li> <li>SQLite</li> </ul>"},{"location":"developer/#contact","title":"Contact","text":"<p>Questions techniques ? Ouvrez une issue sur GitHub Issues</p> <p>Discussions ? Rejoignez GitHub Discussions</p> <p>Derniere mise a jour : 2025-11-28 Version : 1.3.0</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/","title":"Architecture Decisions Record (ADR)","text":"<p>Ce document enregistre les d\u00e9cisions architecturales importantes prises dans le projet TwinShell.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#table-des-matieres","title":"Table des Mati\u00e8res","text":"<ol> <li>Architecture en Couches</li> <li>SQLite comme Base de Donn\u00e9es</li> <li>MVVM avec CommunityToolkit</li> <li>S\u00e9curit\u00e9 : Salt D\u00e9terministe</li> <li>Performance : ObservableRangeCollection</li> <li>Pagination de l'Historique</li> <li>Gestion des Ressources : IDisposable Pattern</li> <li>Thread Safety : SemaphoreSlim</li> <li>Validation Path Traversal</li> <li>Magic Numbers vs Constantes</li> <li>Strat\u00e9gie d'Int\u00e9gration CLI Universelle</li> </ol>"},{"location":"developer/ARCHITECTURE_DECISIONS/#1-architecture-en-couches","title":"1. Architecture en Couches","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision","title":"D\u00e9cision","text":"<p>TwinShell utilise une architecture en 4 couches : - TwinShell.App : WPF UI et ViewModels - TwinShell.Core : Logique m\u00e9tier et services - TwinShell.Persistence : EF Core et repositories - TwinShell.Infrastructure : Services transverses</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte","title":"Contexte","text":"<p>Besoin de s\u00e9parer les responsabilit\u00e9s pour faciliter la maintenance et les tests.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences","title":"Cons\u00e9quences","text":"<p>Positives : - Testabilit\u00e9 accrue (mocking facile des couches) - S\u00e9paration claire des responsabilit\u00e9s - Facilite les modifications futures - Migration possible vers d'autres UI (Avalonia, MAUI)</p> <p>N\u00e9gatives : - Plus de complexit\u00e9 initiale - Plus de fichiers \u00e0 g\u00e9rer - Courbe d'apprentissage pour nouveaux contributeurs</p> <p>Alternatives consid\u00e9r\u00e9es : - Monolithe en une seule couche (rejet\u00e9 : non maintenable) - Clean Architecture avec plus de couches (rejet\u00e9 : overkill pour ce projet)</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#2-sqlite-comme-base-de-donnees","title":"2. SQLite comme Base de Donn\u00e9es","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_1","title":"D\u00e9cision","text":"<p>Utilisation de SQLite avec Entity Framework Core pour la persistence.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_1","title":"Contexte","text":"<p>Besoin d'une base de donn\u00e9es locale, l\u00e9g\u00e8re, sans serveur pour stocker les actions, l'historique et les favoris.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_1","title":"Cons\u00e9quences","text":"<p>Positives : - Zero configuration (pas de serveur \u00e0 installer) - Fichier unique portable - Excellent pour applications desktop - EF Core support complet - Transactions ACID</p> <p>N\u00e9gatives : - Pas de concurrence multi-utilisateur (non requis) - Limite de 281 TB (largement suffisant)</p> <p>Alternatives consid\u00e9r\u00e9es : - LiteDB (rejet\u00e9 : moins mature qu'EF Core) - JSON files (rejet\u00e9 : pas de requ\u00eates complexes) - SQL Server LocalDB (rejet\u00e9 : trop lourd)</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#3-mvvm-avec-communitytoolkit","title":"3. MVVM avec CommunityToolkit","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_2","title":"D\u00e9cision","text":"<p>Utilisation du pattern MVVM avec CommunityToolkit.Mvvm (source generators).</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_2","title":"Contexte","text":"<p>WPF n\u00e9cessite une architecture UI d\u00e9coupl\u00e9e. CommunityToolkit offre des source generators pour r\u00e9duire le boilerplate.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_2","title":"Cons\u00e9quences","text":"<p>Positives : - Moins de code boilerplate (<code>[ObservableProperty]</code>, <code>[RelayCommand]</code>) - Testabilit\u00e9 des ViewModels - S\u00e9paration UI / logique - Performance des source generators</p> <p>N\u00e9gatives : - D\u00e9pendance \u00e0 CommunityToolkit - Courbe d'apprentissage des attributs</p> <p>Alternatives consid\u00e9r\u00e9es : - MVVM manuel (rejet\u00e9 : trop de boilerplate) - Prism (rejet\u00e9 : trop complexe) - ReactiveUI (rejet\u00e9 : paradigme diff\u00e9rent)</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#4-securite-salt-deterministe","title":"4. S\u00e9curit\u00e9 : Salt D\u00e9terministe","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_3","title":"D\u00e9cision","text":"<p>Pas de salt al\u00e9atoire pour le hashing. Les IDs sont g\u00e9n\u00e9r\u00e9s avec <code>Guid.NewGuid()</code> suffisamment unique.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_3","title":"Contexte","text":"<p>TwinShell ne stocke pas de mots de passe utilisateur. Les donn\u00e9es (favoris, historique) ne n\u00e9cessitent pas de cryptographie forte.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_3","title":"Cons\u00e9quences","text":"<p>Positives : - Simplicit\u00e9 du code - Pas de gestion de salt storage - Performance (pas de random generation)</p> <p>N\u00e9gatives : - Si besoin futur d'authentification, devra \u00eatre repens\u00e9</p> <p>Justification : - Application single-user locale - Pas de donn\u00e9es sensibles n\u00e9cessitant encryption - IDs GUID suffisants pour unicit\u00e9</p> <p>Note de s\u00e9curit\u00e9 : Si authentification multi-utilisateur ajout\u00e9e, utiliser PBKDF2 ou Argon2 avec salt al\u00e9atoire.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#5-performance-observablerangecollection","title":"5. Performance : ObservableRangeCollection","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_4","title":"D\u00e9cision","text":"<p>Utilisation d'<code>ObservableRangeCollection&lt;T&gt;</code> avec <code>ReplaceRange()</code> au lieu de recre\u00e9er les collections.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_4","title":"Contexte","text":"<p>Recr\u00e9er une <code>ObservableCollection</code> d\u00e9clenche de multiples notifications UI, causant des lags.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_4","title":"Cons\u00e9quences","text":"<p>Positives : - Single UI notification au lieu de N - Am\u00e9lioration significative des performances de filtrage - UI plus responsive</p> <p>N\u00e9gatives : - Code custom \u00e0 maintenir (classe <code>ObservableRangeCollection</code>)</p> <p>Mesures : - Avant : N notifications (N items) - Apr\u00e8s : 1 notification (Reset) - Gain : 90%+ de r\u00e9duction des notifications UI</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.App/Collections/ObservableRangeCollection.cs</code> - <code>src/TwinShell.App/ViewModels/MainViewModel.cs:218</code> - <code>src/TwinShell.App/ViewModels/HistoryViewModel.cs:213</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#6-pagination-de-lhistorique","title":"6. Pagination de l'Historique","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_5","title":"D\u00e9cision","text":"<p>Impl\u00e9mentation de la pagination avec 50 items par page au lieu de charger 1000 entr\u00e9es d'un coup.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_5","title":"Contexte","text":"<p>Charger 1000 entr\u00e9es d'historique cr\u00e9e des lags UI et consomme beaucoup de m\u00e9moire.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_5","title":"Cons\u00e9quences","text":"<p>Positives : - M\u00e9moire r\u00e9duite (~95%) - Temps de chargement initial divis\u00e9 par 20 - UI plus responsive - Scalabilit\u00e9 am\u00e9lior\u00e9e</p> <p>N\u00e9gatives : - Complexit\u00e9 ajout\u00e9e (pagination UI) - N\u00e9cessite des contr\u00f4les de navigation</p> <p>Configuration : - <code>PageSize</code> : 50 items (constante <code>ValidationConstants.DefaultHistoryPageSize</code>) - <code>DefaultHistoryLoadCount</code> : 1000 items max en m\u00e9moire</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.App/ViewModels/HistoryViewModel.cs</code> - <code>src/TwinShell.Core/Constants/ValidationConstants.cs</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#7-gestion-des-ressources-idisposable-pattern","title":"7. Gestion des Ressources : IDisposable Pattern","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_6","title":"D\u00e9cision","text":"<p>Impl\u00e9mentation syst\u00e9matique du pattern IDisposable pour les ViewModels utilisant des ressources non manag\u00e9es (SemaphoreSlim, Timers).</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_6","title":"Contexte","text":"<p>Memory leaks identifi\u00e9s lors de l'audit de s\u00e9curit\u00e9 : SemaphoreSlim et Timers non dispos\u00e9s.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_6","title":"Cons\u00e9quences","text":"<p>Positives : - Pas de memory leaks - Cleanup appropri\u00e9 des ressources - Best practice .NET respect\u00e9e</p> <p>Pattern utilis\u00e9 : <pre><code>public void Dispose()\n{\n    Dispose(true);\n    GC.SuppressFinalize(this);\n}\n\nprotected virtual void Dispose(bool disposing)\n{\n    if (!_disposed)\n    {\n        if (disposing)\n        {\n            _semaphore?.Dispose();\n            _timer?.Dispose();\n        }\n        _disposed = true;\n    }\n}\n</code></pre></p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.App/ViewModels/MainViewModel.cs</code> - <code>src/TwinShell.App/ViewModels/HistoryViewModel.cs</code> - <code>src/TwinShell.App/ViewModels/ExecutionViewModel.cs</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#8-thread-safety-semaphoreslim","title":"8. Thread Safety : SemaphoreSlim","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_7","title":"D\u00e9cision","text":"<p>Utilisation de <code>SemaphoreSlim</code> pour prot\u00e9ger les sections critiques dans les ViewModels.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_7","title":"Contexte","text":"<p>Race conditions identifi\u00e9es dans les m\u00e9thodes de filtrage appel\u00e9es depuis multiples property changed handlers.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_7","title":"Cons\u00e9quences","text":"<p>Positives : - Thread-safety garantie - Pas de race conditions - Performance (SemaphoreSlim plus l\u00e9ger que Mutex)</p> <p>Pattern utilis\u00e9 : <pre><code>private readonly SemaphoreSlim _filterSemaphore = new SemaphoreSlim(1, 1);\n\nawait _filterSemaphore.WaitAsync();\ntry\n{\n    // Critical section\n}\nfinally\n{\n    _filterSemaphore.Release();\n}\n</code></pre></p> <p>Alternatives consid\u00e9r\u00e9es : - <code>lock</code> statement (rejet\u00e9 : ne supporte pas async/await) - <code>Mutex</code> (rejet\u00e9 : trop lourd) - <code>ReaderWriterLockSlim</code> (rejet\u00e9 : pas n\u00e9cessaire)</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.App/ViewModels/MainViewModel.cs:24</code> - <code>src/TwinShell.App/ViewModels/HistoryViewModel.cs:16</code> - <code>src/TwinShell.App/ViewModels/ExecutionViewModel.cs:20</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#9-validation-path-traversal","title":"9. Validation Path Traversal","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_8","title":"D\u00e9cision","text":"<p>Validation stricte des chemins de fichiers pour pr\u00e9venir path traversal attacks.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_8","title":"Contexte","text":"<p>Export/import de fichiers JSON et CSV ouvrent des vecteurs d'attaque potentiels.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#methode-de-validation","title":"M\u00e9thode de validation :","text":"<ol> <li>Reject patterns malveillants (<code>..</code>, <code>~</code>, UNC paths)</li> <li>Canonicalize path (<code>Path.GetFullPath</code>)</li> <li>V\u00e9rifier que le path est dans les r\u00e9pertoires autoris\u00e9s</li> <li>Reject symbolic links et junction points</li> <li>Valider l'extension de fichier</li> </ol> <p>R\u00e9pertoires autoris\u00e9s : - <code>%USERPROFILE%\\Documents</code> - <code>%USERPROFILE%\\Desktop</code> - <code>%LOCALAPPDATA%\\TwinShell\\Exports</code></p> <p>Cons\u00e9quences :</p> <p>Positives : - Protection contre path traversal - Sandbox des op\u00e9rations de fichiers - Conforme aux security best practices</p> <p>N\u00e9gatives : - Utilisateur ne peut pas exporter vers des lecteurs r\u00e9seau - N\u00e9cessite permissions sur r\u00e9pertoires user</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Services/ConfigurationService.cs:339-401</code> - <code>src/TwinShell.Core/Services/AuditLogService.cs:89-125</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#10-magic-numbers-vs-constantes","title":"10. Magic Numbers vs Constantes","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_9","title":"D\u00e9cision","text":"<p>Toutes les valeurs num\u00e9riques \"magiques\" sont extraites dans des constantes nomm\u00e9es.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_9","title":"Contexte","text":"<p>Maintenance difficile avec des valeurs hardcod\u00e9es (250, 1000, 50, etc.).</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#constantes-creees","title":"Constantes cr\u00e9\u00e9es :","text":"<pre><code>// ValidationConstants.cs\npublic const int DefaultHistoryLoadCount = 1000;\npublic const int DefaultHistoryPageSize = 50;\npublic const long MaxFileSizeBytes = 10 * 1024 * 1024; // 10MB\npublic const int MaxFavoritesInImport = 1000;\npublic const int MaxHistoryInImport = 10000;\n\n// UIConstants.cs\npublic const int MaxFavoritesCount = 50;\n\n// TimeoutConstants.cs\npublic const int MaxCommandTimeoutSeconds = 300;\n</code></pre> <p>Cons\u00e9quences :</p> <p>Positives : - Lisibilit\u00e9 am\u00e9lior\u00e9e - Maintenance facilit\u00e9e (change une fois, appliqu\u00e9 partout) - Documentation inline via noms explicites - Moins d'erreurs (typos impossibles)</p> <p>N\u00e9gatives : - Plus de fichiers de constantes - Besoin de conna\u00eetre l'emplacement des constantes</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Constants/ValidationConstants.cs</code> - <code>src/TwinShell.Core/Constants/UIConstants.cs</code> - <code>src/TwinShell.Core/Constants/TimeoutConstants.cs</code></p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#11-strategie-dintegration-cli-universelle","title":"11. Strat\u00e9gie d'Int\u00e9gration CLI Universelle","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#decision_10","title":"D\u00e9cision","text":"<p>Extension du support au-del\u00e0 des cmdlets PowerShell natifs pour inclure les ex\u00e9cutables CLI standards de l'industrie (AWS CLI, Kubectl, OpenSSL, Terraform). Utilisation du flag <code>Platform: 2</code> (Both/Cross-Platform) pour ces outils.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#contexte_10","title":"Contexte","text":"<p>L'administration syst\u00e8me moderne (DevOps) repose majoritairement sur des outils en ligne de commande cross-platform, et non plus uniquement sur WMI/CIM/PowerShell. TwinShell doit \u00e9voluer pour rester pertinent.</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#consequences_8","title":"Cons\u00e9quences","text":"<p>Positives : - \u00c9cosyst\u00e8me infini : Capacit\u00e9 d'int\u00e9grer n'importe quel outil (GCP, Azure, Git, Docker). - Portabilit\u00e9 : Les commandes JSON sont identiques sur Windows et Linux (WSL/Native). - Standardisation : Utilisation des arguments standards POSIX au lieu des param\u00e8tres nomm\u00e9s PowerShell complexes.</p> <p>N\u00e9gatives : - D\u00e9pendances externes : L'utilisateur doit avoir les outils install\u00e9s (ex: <code>aws</code> doit \u00eatre dans le PATH). - Validation plus difficile : TwinShell ne peut pas facilement valider la syntaxe d'outils tiers comme il le fait pour PowerShell.</p> <p>Impl\u00e9mentation : - Le <code>CommandGeneratorService</code> traite ces commandes comme des cha\u00eenes d'arguments standards. - Le <code>Seed</code> (JSON) inclut d\u00e9sormais des templates unifi\u00e9s pour Windows et Linux.</p> <p>Outils int\u00e9gr\u00e9s (v1.2.0) : - \u2601\ufe0f Cloud : AWS CLI, gcloud (GCP), Azure CLI - \ud83d\udea2 Containers : kubectl, Docker - \ud83d\udd28 IaC : Terraform, Ansible - \ud83d\udd10 Security : OpenSSL, Nmap</p>"},{"location":"developer/ARCHITECTURE_DECISIONS/#principes-generaux","title":"Principes G\u00e9n\u00e9raux","text":""},{"location":"developer/ARCHITECTURE_DECISIONS/#solid-principles","title":"SOLID Principles","text":"<ul> <li>Single Responsibility : Chaque classe a une responsabilit\u00e9 unique</li> <li>Open/Closed : Extensions via interfaces, modifications minimales</li> <li>Liskov Substitution : Repositories interchangeables via interfaces</li> <li>Interface Segregation : Interfaces sp\u00e9cifiques (pas de \"fat interfaces\")</li> <li>Dependency Inversion : DI container pour injection de d\u00e9pendances</li> </ul>"},{"location":"developer/ARCHITECTURE_DECISIONS/#security-by-design","title":"Security by Design","text":"<ul> <li>Input validation syst\u00e9matique</li> <li>Principe du moindre privil\u00e8ge</li> <li>Defense in depth (multiple layers)</li> <li>Fail securely (erreurs ne leakent pas d'info)</li> <li>Audit logging pour actions critiques</li> </ul>"},{"location":"developer/ARCHITECTURE_DECISIONS/#performance-first","title":"Performance First","text":"<ul> <li>AsNoTracking pour queries read-only</li> <li>Pagination pour grandes collections</li> <li>Batch operations (ReplaceRange)</li> <li>Caching quand appropri\u00e9</li> <li>Profiling r\u00e9gulier</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-11-26 Version du document : 1.1</p>"},{"location":"developer/CODE_ISSUES_SUMMARY/","title":"R\u00c9SUM\u00c9 DES PROBL\u00c8MES PAR FICHIER - TWINSHELL","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#vue-rapide-des-fichiers-avec-problemes","title":"Vue Rapide des Fichiers avec Probl\u00e8mes","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#priorite-high","title":"Priorit\u00e9: HIGH \u26a0\ufe0f","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#mainviewmodelcs-542-lignes","title":"MainViewModel.cs (542 lignes)","text":"<ul> <li>Ligne 120, 157: Magic String \"\u2b50 Favorites\" (r\u00e9p\u00e9t\u00e9 2x)</li> <li>Lignes 219, 268, 276, 277, 305, 306: Magic Strings \"Erreurs\", \"Aucun\" (6 occurrences)</li> <li>Lignes 214, 254, 283, 319: Template Selection Logic (code dupliqu\u00e9 4x)</li> <li>Lignes 284, 320: Platform Determination Logic (code dupliqu\u00e9 2x)</li> <li>Ligne 375: Magic Number \"50\" (limite de favoris)</li> <li>Lignes 152-202: ApplyFiltersAsync - Deep nesting (3+ niveaux)</li> <li>Type: God Class, SRP Violation, Localization Issue, DRY Violation</li> <li>Impact: Impossible \u00e0 tester, difficile \u00e0 maintenir</li> <li>Recommandation: Diviser en 3 ViewModels distincts</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#executionviewmodelcs-299-lignes","title":"ExecutionViewModel.cs (299 lignes)","text":"<ul> <li>Lignes 53-201: ExecuteCommandAsync - Long method (147 lignes)</li> <li>Ligne 91: Magic Number \"100\" (timer interval)</li> <li>Ligne 106: Magic Numbers \"1, 300\" (timeout min/max)</li> <li>Ligne 310-314: Direct MessageBox usage (DIP Violation)</li> <li>Lignes 132, 140: Empty condition checks (code smell)</li> <li>Type: Long Method, Magic Numbers, DIP Violation</li> <li>Recommandation: Extraire ValidateExecution, ExecuteWithTimer, UpdateHistory</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#commandgeneratorservicecs-92-lignes","title":"CommandGeneratorService.cs (92 lignes)","text":"<ul> <li>Lignes 59, 75, 83: Hardcoded French error messages (3 occurrences)</li> <li>Type: Localization Issue, Non-standard messages</li> <li>Recommandation: Utiliser ILocalizationService</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#powershellgalleryservicecs-365-lignes","title":"PowerShellGalleryService.cs (365 lignes)","text":"<ul> <li>Lignes 50-66: Empty catch block with JSON deserialization (exception swallowing)</li> <li>Lignes 130-155: Same pattern try-catch repeated (DRY violation)</li> <li>Lignes 159-162: Generic catch block without logging</li> <li>Ligne 320: Magic character ' ' should be constant</li> <li>Type: Exception Handling Anti-pattern, DRY Violation</li> <li>Recommandation: Ajouter logging, cr\u00e9er m\u00e9thode DeserializeJsonSafely()</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#settingsviewmodelcs-210-lignes","title":"SettingsViewModel.cs (210 lignes)","text":"<ul> <li>Lines 100-114: Magic Numbers (1, 3650, 10, 100000, 50)</li> <li>Type: Magic Numbers for validation</li> <li>Recommandation: Cr\u00e9er ValidationConstants class</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#categorymanagementviewmodelcs-313-lignes","title":"CategoryManagementViewModel.cs (313 lignes)","text":"<ul> <li>Lignes 44-67: Public ObservableCollections (AvailableIcons, AvailableColors)</li> <li>Lignes 136, 195, 238, 66, 219, 166: 6 occurrences de MessageBox (DIP Violation)</li> <li>Type: Visibility Issue, DIP Violation</li> <li>Recommandation: Rendre collections readonly, injecter INotificationService</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#batchexecutionservicecs-210-lignes","title":"BatchExecutionService.cs (210 lignes)","text":"<ul> <li>Lignes 27-191: ExecuteBatchAsync - Long method (164 lignes)</li> <li>Lignes 105-117 + 131-143: Audit logging code duplication</li> <li>Line 115, 141: Magic String \"Batch Execution\"</li> <li>Type: Long Method, DRY Violation, Magic String</li> <li>Recommandation: Extraire LogAuditAsync(), utiliser constante</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#priorite-medium","title":"Priorit\u00e9: MEDIUM \u26a0\ufe0f","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#commandexecutionservicecs-183-lignes","title":"CommandExecutionService.cs (183 lignes)","text":"<ul> <li>Line 21: Magic Number \"30\" (default timeout)</li> <li>Lines 149-164: Switch statement OCP violation</li> <li>Line 138: Generic error message without context</li> <li>Line 105: Empty catch block</li> <li>Type: Magic Numbers, OCP Violation, Exception Handling</li> <li>Recommandation: Cr\u00e9er CommandExecutionConstants, utiliser Strategy Pattern</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#configurationservicecs","title":"ConfigurationService.cs","text":"<ul> <li>Line 59: Magic Number \"1000\" (history limit)</li> <li>Line 76: Magic Number \"50\" (max favorites hardcoded string)</li> <li>Type: Magic Numbers</li> <li>Recommandation: Utiliser constantes centralis\u00e9es</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#batchservicecs-124-lignes","title":"BatchService.cs (124 lignes)","text":"<ul> <li>Lines 82-88, 93-96: JsonSerializerOptions created twice (identical)</li> <li>Type: Performance, Code Duplication</li> <li>Recommandation: Cr\u00e9er static readonly JsonSerializerOptions</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#executecommandparametercs","title":"ExecuteCommandParameter.cs","text":"<ul> <li>Type: Mutable public properties (public set on all)</li> <li>Recommandation: Convertir en record ou utiliser init-only</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#priorite-low","title":"Priorit\u00e9: LOW \u2713","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#all-viewmodels","title":"All ViewModels","text":"<ul> <li>Type: Code comments describing code (acceptable but low value)</li> <li>Files: 44 fichiers avec commentaires en bas de ligne</li> <li>Recommandation: Am\u00e9liorer les commentaires ou utiliser better naming</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#various-model-files","title":"Various Model Files","text":"<ul> <li>Type: Inconsistent property initialization</li> <li>Recommandation: Standardiser les initializations</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#tableau-resume-par-categorie","title":"TABLEAU R\u00c9SUM\u00c9 PAR CAT\u00c9GORIE","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#1-magic-numbersstrings-23-instances","title":"1. MAGIC NUMBERS/STRINGS (23 instances)","text":"Valeur Occurrence Fichier Lignes Priorit\u00e9 \"\u2b50 Favorites\" 2 MainViewModel 120, 157 HIGH \"Erreurs\" 1 MainViewModel 268 HIGH \"Aucun\" 3 MainViewModel 219, 277, 306 HIGH \"Batch Execution\" 2 BatchExecutionService 115, 141 HIGH 50 4 MainViewModel, Config, Settings 375, others HIGH 30 2 CommandExecutionService, ExecutionViewModel 21, others MEDIUM 300 2 ExecutionViewModel, PowerShellGallery 106, 234 MEDIUM 100 1 ExecutionViewModel 91 MEDIUM 1000 1 ConfigurationService 59 MEDIUM 1, 3650, 10, 100000 4 SettingsViewModel 100-114 MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#2-long-methods-4","title":"2. LONG METHODS (4)","text":"M\u00e9thode Fichier Lignes Taille Priorit\u00e9 ExecuteCommandAsync ExecutionViewModel 53-201 147 HIGH ExecuteBatchAsync BatchExecutionService 27-191 164 HIGH ApplyFiltersAsync MainViewModel 152-202 50 MEDIUM LoadCommandGenerator MainViewModel 204-244 40 MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#3-duplication-de-code-8","title":"3. DUPLICATION DE CODE (8)","text":"Pattern Occurrences Fichier Lignes Priorit\u00e9 Template selection 4 MainViewModel 214,254,283,319 MEDIUM Platform determination 2 MainViewModel 284, 320 MEDIUM Audit logging 2 BatchExecutionService 105-117, 131-143 MEDIUM JSON deserialization 2 PowerShellGallery 50-66, 130-155 MEDIUM JsonSerializerOptions 2 BatchService 82-88, 93-96 LOW"},{"location":"developer/CODE_ISSUES_SUMMARY/#4-direct-messagebox-usage-29-appels","title":"4. DIRECT MESSAGEBOX USAGE (29 appels)","text":"Fichier Occurrences Ligne approximative Priorit\u00e9 MainViewModel 5 310, 377, 418, 426, 436, 516 HIGH ExecutionViewModel 1 57 HIGH CategoryManagementViewModel 5 136, 166, 195, 219, 238 HIGH SettingsViewModel 5 131, 161, 165, 185, 197 HIGH MainWindow 1 (various) MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#5-violations-solid-8","title":"5. VIOLATIONS SOLID (8)","text":"Principe Fichier Violation Priorit\u00e9 SRP MainViewModel 7 responsabilit\u00e9s HIGH DIP All ViewModels MessageBox direct HIGH DIP All Pas d'abstraction notification HIGH OCP CommandExecutionService Switch/Platform MEDIUM ISP ExecuteCommandParameter Trop de propri\u00e9t\u00e9s MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#6-issues-de-localisation-15","title":"6. ISSUES DE LOCALISATION (15)","text":"Type Fichier Exemple Priorit\u00e9 French hardcoded CommandGeneratorService \"Le param\u00e8tre est requis\" HIGH French hardcoded MainViewModel \"Aucun mod\u00e8le\", \"Erreurs\" HIGH English in French app ExecutionViewModel \"No valid command\" HIGH M\u00e9lange languages All Incoh\u00e9rent HIGH No use of ILocalization All Service exists but unused MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#7-exception-handling-3","title":"7. EXCEPTION HANDLING (3)","text":"Fichier Type Lignes Priorit\u00e9 PowerShellGalleryService Empty catch + exception swallow 50-66 MEDIUM PowerShellGalleryService Generic catch 159-162 MEDIUM CommandExecutionService Generic Exception 133 MEDIUM"},{"location":"developer/CODE_ISSUES_SUMMARY/#impact-estime-par-domaine","title":"IMPACT ESTIM\u00c9 PAR DOMAINE","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#maintenabilite","title":"Maintenabilit\u00e9","text":"<ul> <li>Probl\u00e8mes: God Class, Long Methods, DRY Violations</li> <li>Impact: Difficile \u00e0 maintenir, refactoring risqu\u00e9</li> <li>Effort de fix: 40 heures (extractions, tests)</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#testabilite","title":"Testabilit\u00e9","text":"<ul> <li>Probl\u00e8mes: Direct MessageBox, No test infrastructure, Complex dependencies</li> <li>Impact: Couverture test: 8.5%, zones critiques non test\u00e9es</li> <li>Effort de fix: 60 heures (ajout tests, refactoring)</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#localization","title":"Localization","text":"<ul> <li>Probl\u00e8mes: M\u00e9lange FR/EN, hardcoded strings, pas d'utilisation de ILocalizationService</li> <li>Impact: Application non professionnelle pour utilisateurs multi-langues</li> <li>Effort de fix: 30 heures (centralisation, impl\u00e9mentation service)</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#robustesse","title":"Robustesse","text":"<ul> <li>Probl\u00e8mes: Exception swallowing, vague error messages, no logging</li> <li>Impact: Debugging difficile, production issues masqu\u00e9s</li> <li>Effort de fix: 20 heures (ajout logging, gestion exceptions)</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#performance","title":"Performance","text":"<ul> <li>Probl\u00e8mes: Inefficient LINQ, multiple JSON serialization, repeated options creation</li> <li>Impact: Minimal (app small), mais mauvaises pratiques</li> <li>Effort de fix: 5 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#fichiers-a-prioriser","title":"FICHIERS \u00c0 PRIORISER","text":""},{"location":"developer/CODE_ISSUES_SUMMARY/#1-mainviewmodelcs","title":"1. MainViewModel.cs","text":"<ul> <li>Raison: Largest, multiple issues, God Class</li> <li>Fix: Refactor into 3 ViewModels</li> <li>Dur\u00e9e estim\u00e9e: 16 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#2-executionviewmodelcs","title":"2. ExecutionViewModel.cs","text":"<ul> <li>Raison: Long method, hard to test</li> <li>Fix: Extract methods, inject INotificationService</li> <li>Dur\u00e9e estim\u00e9e: 8 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#3-powershellgalleryservicecs","title":"3. PowerShellGalleryService.cs","text":"<ul> <li>Raison: Exception swallowing, DRY violations</li> <li>Fix: Add logging, extract common patterns</li> <li>Dur\u00e9e estim\u00e9e: 6 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#4-creation-constants-classes","title":"4. Cr\u00e9ation Constants Classes","text":"<ul> <li>Raison: Central point for all magic numbers/strings</li> <li>Fix: Create UIConstants, CommandExecutionConstants, ValidationConstants</li> <li>Dur\u00e9e estim\u00e9e: 4 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#5-inotificationservice-implementation","title":"5. INotificationService Implementation","text":"<ul> <li>Raison: 29 direct MessageBox calls</li> <li>Fix: Implement interface, inject everywhere</li> <li>Dur\u00e9e estim\u00e9e: 8 heures</li> </ul>"},{"location":"developer/CODE_ISSUES_SUMMARY/#quick-fixes-1-2-heures-chacun","title":"QUICK FIXES (1-2 heures chacun)","text":"<ol> <li>CommandGeneratorService: Utiliser localization service</li> <li>BatchService: Cr\u00e9er static readonly JsonSerializerOptions</li> <li>PowerShellGalleryService: Ajouter logging dans catch blocks</li> <li>SettingsViewModel: Cr\u00e9er ValidationConstants</li> <li>CommandExecutionService: Utiliser CommandExecutionConstants</li> </ol>"},{"location":"developer/CODE_STYLE_ANALYSIS/","title":"ANALYSE COMPL\u00c8TE DU STYLE DE CODE ET BONNES PRATIQUES - TWINSHELL","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#resume-executif","title":"R\u00c9SUM\u00c9 EX\u00c9CUTIF","text":"<ul> <li>Fichiers analys\u00e9s: 129 fichiers C#</li> <li>Fichiers de test: 11</li> <li>Score global: 6.5/10</li> <li>Probl\u00e8mes critiques: 12</li> <li>Probl\u00e8mes majeurs: 28</li> <li>Probl\u00e8mes mineurs: 45+</li> </ul>"},{"location":"developer/CODE_STYLE_ANALYSIS/#1-magic-numbers-et-magic-strings","title":"1. MAGIC NUMBERS ET MAGIC STRINGS","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-11-magic-string-favorites","title":"PROBL\u00c8ME 1.1: Magic String \"\u2b50 Favorites\"","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Ligne: 120, 157 Priorit\u00e9: HIGH Type: Magic String Explication: La cha\u00eene \"\u2b50 Favorites\" est utilis\u00e9e comme identifiant de cat\u00e9gorie sp\u00e9ciale, mais elle est r\u00e9p\u00e9t\u00e9e dans le code (hard-cod\u00e9e). Elle ne devrait pas contenir d'emoji pour compatibilit\u00e9. Probl\u00e8me: Si le nom change, il faut le mettre \u00e0 jour en plusieurs endroits Recommandation: <pre><code>private const string FavoritesCategory = \"Favorites\";\nprivate const string FavoritesCategoryDisplay = \"\u2b50 Favorites\";\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-12-magic-strings-erreurs-aucun","title":"PROBL\u00c8ME 1.2: Magic Strings \"Erreurs\", \"Aucun\"","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Lignes: 219, 268, 276, 277, 305, 306 Priorit\u00e9: HIGH Type: Magic String + Texte non localis\u00e9 Explication: Messages d'erreur m\u00e9lang\u00e9s EN FRAN\u00c7AIS hard-cod\u00e9s. Violate les bonnes pratiques de localisation. Probl\u00e8me CRITIQUE: Code m\u00e9lange fran\u00e7ais et anglais (ligne 311 \"No valid command to execute\" VS ligne 219 \"Aucun mod\u00e8le\") Recommandation:  - Cr\u00e9er une classe Constants - Utiliser un service de localisation pour tous les messages - Centraliser les messages d'erreur</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-13-magic-number-50-limite-de-favoris","title":"PROBL\u00c8ME 1.3: Magic Number \"50\" (Limite de Favoris)","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Ligne: 375 Priorit\u00e9: MEDIUM Type: Magic Number + Duplication Explication: La limite de 50 favoris est hard-cod\u00e9e. Une constante existe dans FavoritesService (ligne 12), mais pas d'export public. Recommandation: <pre><code>// Dans FavoritesService.cs - rendre public\npublic const int MaxFavorites = 50;\n\n// Dans MainViewModel.cs\nprivate readonly int _maxFavorites;\n// Injecter via constructeur\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-14-magic-numbers-timeouts","title":"PROBL\u00c8ME 1.4: Magic Numbers Timeouts","text":"<p>Fichiers:  - CommandExecutionService.cs (ligne 21): <code>timeoutSeconds = 30</code> - ExecutionViewModel.cs (ligne 106): <code>Math.Min(Math.Max(..., 1), 300)</code> - PowerShellGalleryService.cs: <code>timeoutSeconds: 60</code>, <code>timeoutSeconds: 30</code>, <code>timeoutSeconds: 300</code> Priorit\u00e9: MEDIUM Type: Magic Numbers Recommandation: Cr\u00e9er une classe de constantes: <pre><code>public static class CommandExecutionConstants\n{\n    public const int DefaultTimeoutSeconds = 30;\n    public const int MaxTimeoutSeconds = 300;\n    public const int MinTimeoutSeconds = 1;\n    public const int PowerShellGalleryTimeout = 60;\n}\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-15-magic-numbers-validation-settings","title":"PROBL\u00c8ME 1.5: Magic Numbers - Validation Settings","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/SettingsViewModel.cs</code> Lignes: 100-114 Priorit\u00e9: MEDIUM Type: Magic Numbers Valeurs: 1, 3650, 10, 100000, 50 Recommandation: Cr\u00e9er une classe de constantes pour les limites de validation</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#2-code-smells-long-methods","title":"2. CODE SMELLS - LONG METHODS","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-21-mainviewmodel-long-class-542-lignes","title":"PROBL\u00c8ME 2.1: MainViewModel - Long Class (542 lignes)","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Priorit\u00e9: HIGH Type: God Class Responsabilit\u00e9s d\u00e9tect\u00e9es:  1. Gestion des filtres (11+ propri\u00e9t\u00e9s) 2. G\u00e9n\u00e9ration de commandes 3. Ex\u00e9cution de commandes 4. Gestion des favoris 5. Gestion de l'historique 6. Export/Import de configuration 7. S\u00e9lection d'actions Probl\u00e8me: Viole SRP (Single Responsibility Principle) Recommandation:  - Extraire FavoritesManagementViewModel - Extraire ConfigurationManagementViewModel - Extraire CommandGenerationViewModel</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-22-applyfiltersasync-deep-nesting","title":"PROBL\u00c8ME 2.2: ApplyFiltersAsync - Deep Nesting","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Lignes: 152-202 Priorit\u00e9: MEDIUM Type: Deep Nesting (3+ niveaux) Probl\u00e8me: Multiples niveaux de conditions imbriqu\u00e9es <pre><code>if (SelectedCategory == \"\u2b50 Favorites\") {\n    filtered = filtered.Where(...)\n}\nelse if (...) {\n    filtered = filtered.Where(...)\n}\nif (ShowFavoritesOnly) {\n    filtered = filtered.Where(...)\n}\n</code></pre> Recommandation: Extraire chaque filtre dans une m\u00e9thode priv\u00e9e</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-23-executecommandasync-long-method-147-lignes","title":"PROBL\u00c8ME 2.3: ExecuteCommandAsync - Long Method (147 lignes)","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/ExecutionViewModel.cs</code> Lignes: 53-201 Priorit\u00e9: MEDIUM Type: Long Method Probl\u00e8me: Trop de responsabilit\u00e9s: validation, ex\u00e9cution, UI update, historique Recommandation: Diviser en petites m\u00e9thodes: - ValidateExecutionAsync() - ExecuteWithTimerAsync() - UpdateHistoryAsync()</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-24-executebatchasync-long-method-191-lignes","title":"PROBL\u00c8ME 2.4: ExecuteBatchAsync - Long Method (191 lignes)","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/BatchExecutionService.cs</code> Lignes: 27-191 Priorit\u00e9: MEDIUM Type: Long Method Probl\u00e8me: Boucle complexe avec logging, progress, error handling imbriqu\u00e9s Recommandation: Extraire ExecuteCommandInBatchAsync()</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#3-violations-solid-principles","title":"3. VIOLATIONS SOLID PRINCIPLES","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-31-srp-violation-mainviewmodel","title":"PROBL\u00c8ME 3.1: SRP Violation - MainViewModel","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Priorit\u00e9: HIGH Violations: - Action filtering - Command generation - Command execution delegation - Favorites management - Configuration import/export - History management Recommandation: Split into multiple ViewModels</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-32-dip-violation-direct-systemwindowsmessagebox-usage","title":"PROBL\u00c8ME 3.2: DIP Violation - Direct System.Windows.MessageBox Usage","text":"<p>Fichiers:  - MainViewModel.cs (5 occurrences) - ExecutionViewModel.cs (1 occurrence) - CategoryManagementViewModel.cs (5 occurrences) - SettingsViewModel.cs (5 occurrences) Lignes: Multiples Priorit\u00e9: HIGH Type: Dependency Inversion Violation Probl\u00e8me: Direct d\u00e9pendance \u00e0 System.Windows.MessageBox au lieu d'une abstraction Total: 29 appels directs \u00e0 MessageBox.Show Recommandation: Cr\u00e9er INotificationService (abstrait) <pre><code>public interface INotificationService\n{\n    void ShowError(string message, string title);\n    void ShowWarning(string message, string title);\n    void ShowInfo(string message, string title);\n    MessageBoxResult ShowQuestion(string message, string title);\n}\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-33-ocp-violation-commandexecutionservice","title":"PROBL\u00c8ME 3.3: OCP Violation - CommandExecutionService","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Lignes: 149-164 Priorit\u00e9: MEDIUM Type: Open/Closed Principle Probl\u00e8me: Switch statement pour les platforms. Ajouter Platform=iOS n\u00e9cessite modification du code existant Recommandation: Utiliser Strategy Pattern</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#4-duplication-de-code-dry-violations","title":"4. DUPLICATION DE CODE (DRY Violations)","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-41-template-selection-logic","title":"PROBL\u00c8ME 4.1: Template Selection Logic","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Lignes: 214, 254, 283, 319 Priorit\u00e9: MEDIUM Code dupliqu\u00e9: <pre><code>var template = SelectedAction.WindowsCommandTemplate ?? SelectedAction.LinuxCommandTemplate;\n</code></pre> R\u00e9p\u00e9t\u00e9 4 fois Recommandation: Cr\u00e9er une m\u00e9thode priv\u00e9e <pre><code>private CommandTemplate? GetActiveTemplate(Action action)\n{\n    return action.WindowsCommandTemplate ?? action.LinuxCommandTemplate;\n}\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-42-platform-determination-logic","title":"PROBL\u00c8ME 4.2: Platform Determination Logic","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Lignes: 284, 320 Priorit\u00e9: MEDIUM Code dupliqu\u00e9: <pre><code>var platform = template == SelectedAction.WindowsCommandTemplate ? Platform.Windows : Platform.Linux;\n</code></pre> R\u00e9p\u00e9t\u00e9 2 fois Recommandation: Cr\u00e9er une m\u00e9thode priv\u00e9e</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-43-audit-logging-duplication","title":"PROBL\u00c8ME 4.3: Audit Logging Duplication","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/BatchExecutionService.cs</code> Lignes: 105-117 et 131-143 Priorit\u00e9: MEDIUM Probl\u00e8me: Code de logging pratiquement identique pour succ\u00e8s/erreur Recommandation: Extraire une m\u00e9thode LogExecutionAsync()</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-44-json-deserialization-error-handling","title":"PROBL\u00c8ME 4.4: JSON Deserialization Error Handling","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Lignes: 50-66, 130-155 Priorit\u00e9: MEDIUM Probl\u00e8me: M\u00eame pattern try-catch pour array/single object r\u00e9p\u00e9t\u00e9 2 fois Recommandation: Cr\u00e9er une m\u00e9thode g\u00e9n\u00e9rique</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#5-localization-issues","title":"5. LOCALIZATION ISSUES","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-51-mixed-language-messages","title":"PROBL\u00c8ME 5.1: Mixed Language Messages","text":"<p>Fichiers:  - MainViewModel.cs: \"Erreurs de validation:\", \"Aucun mod\u00e8le de commande disponible\" - CommandGeneratorService.cs: Messages en FRAN\u00c7AIS uniquement - ExecutionViewModel.cs: Messages en ANGLAIS - SettingsViewModel.cs: Messages en ANGLAIS Priorit\u00e9: HIGH Probl\u00e8me CRITIQUE: Application m\u00e9lange fran\u00e7ais et anglais sans coh\u00e9rence Recommandation:  1. Cr\u00e9er syst\u00e8me de localisation centralis\u00e9 2. Utiliser ILocalizationService existant (mais non utilis\u00e9) 3. Cr\u00e9er fichiers de ressources (resx) pour chaque langue</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#6-error-messages-non-localized-unclear","title":"6. ERROR MESSAGES - NON LOCALIZED &amp; UNCLEAR","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-61-hardcoded-french-messages","title":"PROBL\u00c8ME 6.1: Hardcoded French Messages","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/CommandGeneratorService.cs</code> Lignes: 59, 75, 83 Priorit\u00e9: HIGH Messages: - \"Le param\u00e8tre '{parameter.Label}' est requis.\" - \"Le param\u00e8tre '{parameter.Label}' doit \u00eatre un nombre entier.\" - \"Le param\u00e8tre '{parameter.Label}' doit \u00eatre true ou false.\"</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-62-english-messages-in-ui","title":"PROBL\u00c8ME 6.2: English Messages in UI","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/ExecutionViewModel.cs</code> Lignes: 57, 310-314 Priorit\u00e9: MEDIUM Messages en anglais: Violate user expectation si l'application est en fran\u00e7ais</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-63-missing-error-context","title":"PROBL\u00c8ME 6.3: Missing Error Context","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Ligne: 138 Priorit\u00e9: MEDIUM Message g\u00e9n\u00e9rique: \"Failed to execute command: {ex.Message}\" - Manque contexte (quelle plateforme? quel timeout?) Recommandation: Ajouter contexte d\u00e9taill\u00e9</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#7-accessibility-visibility-modifiers","title":"7. ACCESSIBILITY &amp; VISIBILITY MODIFIERS","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-71-public-properties-should-be-internalprivate","title":"PROBL\u00c8ME 7.1: Public Properties Should Be Internal/Private","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/CategoryManagementViewModel.cs</code> Lignes: 44-67 Priorit\u00e9: LOW Probl\u00e8me:  <pre><code>public ObservableCollection&lt;string&gt; AvailableIcons { get; } = new() { ... };\npublic ObservableCollection&lt;string&gt; AvailableColors { get; } = new() { ... };\n</code></pre> Ces collections publiques ne devraient pas \u00eatre modifiables, mais pourraient \u00eatre internes.</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-72-mutable-public-properties","title":"PROBL\u00c8ME 7.2: Mutable Public Properties","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Models/ExecuteCommandParameter.cs</code> Priorit\u00e9: MEDIUM Probl\u00e8me: Toutes les propri\u00e9t\u00e9s sont public set Recommandation: Utiliser records ou init-only properties <pre><code>public record ExecuteCommandParameter(\n    string Command,\n    Platform Platform,\n    bool IsDangerous = false,\n    ...\n);\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#8-commented-code-documentation","title":"8. COMMENTED CODE &amp; DOCUMENTATION","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-81-commented-code-lines","title":"PROBL\u00c8ME 8.1: Commented Code Lines","text":"<p>Fichiers affect\u00e9s: 44 fichiers Priorit\u00e9: MEDIUM Exemplle: <pre><code>// Check if dangerous command and requires confirmation\n// Clear previous output\n// Get timeout from settings\n</code></pre> Ces commentaires d\u00e9crivent le code suivant - ils sont acceptables mais peu informatifs.</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-82-missing-documentation-on-critical-methods","title":"PROBL\u00c8ME 8.2: Missing Documentation on Critical Methods","text":"<p>Fichiers: - PowerShellGalleryService.ImportCommandAsActionAsync (ligne 256) - Manque XML docs d\u00e9taill\u00e9s - ConfigurationService - Manque d\u00e9tails sur versions Priorit\u00e9: LOW</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#9-exception-handling","title":"9. EXCEPTION HANDLING","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-91-empty-catch-blocks","title":"PROBL\u00c8ME 9.1: Empty Catch Blocks","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Lignes: 50-66 (try-catch vide), 130-155 (try-catch vide), 159-162 (catch vide) Priorit\u00e9: MEDIUM Type: Exception Swallowing Probl\u00e8me: Les exceptions sont swallow\u00e9es sans logging <pre><code>catch\n{\n    // If it's a single object, parse as single module\n}\n</code></pre> Recommandation: Ajouter du logging ou rel\u00e1ancer</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-92-generic-exception-catching","title":"PROBL\u00c8ME 9.2: Generic Exception Catching","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Lignes: 133-140 Priorit\u00e9: MEDIUM Probl\u00e8me: Catch Exception g\u00e9n\u00e9rique sans sp\u00e9cificit\u00e9 Recommandation: Catch des exceptions sp\u00e9cifiques (IOException, TimeoutException, etc.)</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#10-naming-conventions","title":"10. NAMING CONVENTIONS","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-101-inconsistent-private-field-naming","title":"PROBL\u00c8ME 10.1: Inconsistent Private Field Naming","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Lignes: 14-15 Priorit\u00e9: LOW Probl\u00e8me: Champs priv\u00e9s utilisent underscore (correct), mais pas tous les fichiers le respectent \u00c9tat: Mostly correct, but inconsistent in some ViewModels</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-102-generic-variable-names","title":"PROBL\u00c8ME 10.2: Generic Variable Names","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Ligne: 320 Priorit\u00e9: LOW Probl\u00e8me:  <pre><code>Tags = dto.Tags?.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).ToList()\n</code></pre> Variable <code>' '</code> devrait \u00eatre nomm\u00e9e comme constante</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#11-missing-constants","title":"11. MISSING CONSTANTS","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-111-no-constants-class","title":"PROBL\u00c8ME 11.1: No Constants Class","text":"<p>Priorit\u00e9: HIGH Probl\u00e8me: Multiples magic numbers/strings \u00e9parpill\u00e9s sans centralisation Recommandation: Cr\u00e9er plusieurs classes Constants: <pre><code>public static class UIConstants\n{\n    public const string FavoritesCategoryName = \"Favorites\";\n    public const string FavoritesCategoryDisplay = \"\u2b50 Favorites\";\n    public const int MaxFavoritesCount = 50;\n}\n\npublic static class CommandExecutionConstants\n{\n    public const int DefaultTimeoutSeconds = 30;\n    public const int MaxTimeoutSeconds = 300;\n    public const int PowerShellGalleryTimeout = 60;\n    public const int PowerShellInstallTimeout = 300;\n}\n\npublic static class ValidationConstants\n{\n    public const int MinAutoCleanupDays = 1;\n    public const int MaxAutoCleanupDays = 3650;\n    public const int MinHistoryItems = 10;\n    public const int MaxHistoryItems = 100000;\n    public const int MaxRecentCommandsCount = 50;\n}\n</code></pre></p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#12-test-coverage","title":"12. TEST COVERAGE","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-121-low-test-coverage","title":"PROBL\u00c8ME 12.1: Low Test Coverage","text":"<p>Fichiers source: 129 Fichiers de test: 11 Coverage: ~8.5% Priorit\u00e9: HIGH</p> <p>Zones non test\u00e9es (critique): 1. MainViewModel (542 lignes) - Pas de tests visibles 2. ExecutionViewModel (299 lignes) - Pas de tests 3. CommandExecutionService - Cr\u00edtico! 4. BatchExecutionService - Cr\u00edtico! 5. PowerShellGalleryService - Cr\u00edtico!</p> <p>Recommandation: - Ajouter tests unitaires pour les services critiques - Ajouter tests de ViewModels (MVVM testing) - Ajouter tests d'int\u00e9gration pour batch execution</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#13-design-patterns-issues","title":"13. DESIGN PATTERNS ISSUES","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-131-missing-notification-service-abstraction","title":"PROBL\u00c8ME 13.1: Missing Notification Service Abstraction","text":"<p>Priorit\u00e9: HIGH Probl\u00e8me: 29 appels directs \u00e0 System.Windows.MessageBox Impact: Impossible de tester les ViewModels Recommandation: Impl\u00e9menter INotificationService (d\u00e9j\u00e0 d\u00e9fini)</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-132-no-repository-pattern-in-some-services","title":"PROBL\u00c8ME 13.2: No Repository Pattern in Some Services","text":"<p>Fichier: PowerShellGalleryService Priorit\u00e9: LOW Probl\u00e8me: Acc\u00e8s direct aux commandes PowerShell sans abstraction</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#14-performance-optimization","title":"14. PERFORMANCE &amp; OPTIMIZATION","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-141-inefficient-linq-usage","title":"PROBL\u00c8ME 14.1: Inefficient LINQ Usage","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/MainViewModel.cs</code> Ligne: 154 Priorit\u00e9: MEDIUM Probl\u00e8me:  <pre><code>var filtered = _allActions.AsEnumerable();\n</code></pre> Utilis\u00e9 7 fois avec des Where chain\u00e9s. Pourrait utiliser une seule query.</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#probleme-142-multiple-json-serialization","title":"PROBL\u00c8ME 14.2: Multiple JSON Serialization","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/BatchService.cs</code> Lignes: 82-88, 93-96 Priorit\u00e9: LOW Probl\u00e8me: JsonSerializerOptions cr\u00e9\u00e9es deux fois avec les m\u00eames param\u00e8tres</p>"},{"location":"developer/CODE_STYLE_ANALYSIS/#summary-par-categorie","title":"SUMMARY PAR CAT\u00c9GORIE","text":"Cat\u00e9gorie Count Priorit\u00e9 Magic Numbers/Strings 5 HIGH Long Methods 4 HIGH SOLID Violations 3 HIGH Localization Issues 3 HIGH DRY Violations 4 MEDIUM Exception Handling 2 MEDIUM Test Coverage 1 HIGH Design Patterns 2 HIGH Performance 2 MEDIUM Documentation 2 LOW Naming 2 LOW Accessibility 2 LOW"},{"location":"developer/CODE_STYLE_ANALYSIS/#recommandations-prioritaires","title":"RECOMMANDATIONS PRIORITAIRES","text":""},{"location":"developer/CODE_STYLE_ANALYSIS/#phase-1-critique-immediat","title":"Phase 1 (Critique - Imm\u00e9diat):","text":"<ol> <li>Cr\u00e9er INotificationService et remplacer tous les MessageBox</li> <li>Cr\u00e9er classe Constants pour tous les magic numbers/strings</li> <li>Ajouter tests unitaires pour services critiques</li> <li>Impl\u00e9menter localisation correctement</li> </ol>"},{"location":"developer/CODE_STYLE_ANALYSIS/#phase-2-majeur-1-2-sprints","title":"Phase 2 (Majeur - 1-2 sprints):","text":"<ol> <li>Refactoriser MainViewModel (extraire ViewModels)</li> <li>R\u00e9duire taille des long methods</li> <li>Am\u00e9liorer test coverage \u00e0 50%+</li> <li>Corriger violations SOLID (SRP, DIP)</li> </ol>"},{"location":"developer/CODE_STYLE_ANALYSIS/#phase-3-minor-2-sprints","title":"Phase 3 (Minor - 2+ sprints):","text":"<ol> <li>Ajouter logging (serilog)</li> <li>Am\u00e9liorer performance LINQ</li> <li>Am\u00e9liorer documentation</li> <li>Standardiser conventions de nommage</li> </ol>"},{"location":"developer/CONTRIBUTING/","title":"Guide de Contribution - TwinShell","text":"<p>Merci de votre interet pour contribuer a TwinShell !</p>"},{"location":"developer/CONTRIBUTING/#comment-contribuer","title":"Comment Contribuer","text":""},{"location":"developer/CONTRIBUTING/#1-signaler-un-bug","title":"1. Signaler un Bug","text":"<p>Avant de creer une issue : - Verifiez que le bug n'a pas deja ete signale - Testez avec la derniere version de TwinShell</p> <p>Pour signaler un bug : 1. Allez sur GitHub Issues 2. Cliquez sur \"New Issue\" 3. Utilisez le template \"Bug Report\" 4. Incluez :    - Version de TwinShell    - Version de Windows    - Etapes pour reproduire    - Comportement attendu vs observe    - Screenshots si pertinent</p>"},{"location":"developer/CONTRIBUTING/#2-proposer-une-fonctionnalite","title":"2. Proposer une Fonctionnalite","text":"<ol> <li>Ouvrez une Discussion</li> <li>Decrivez votre idee en detail</li> <li>Attendez les retours de la communaute</li> <li>Si approuve, creez une issue \"Feature Request\"</li> </ol>"},{"location":"developer/CONTRIBUTING/#3-soumettre-du-code","title":"3. Soumettre du Code","text":""},{"location":"developer/CONTRIBUTING/#prerequisites","title":"Prerequisites","text":"<ul> <li>.NET 8.0 SDK</li> <li>Visual Studio 2022 ou VS Code</li> <li>Git</li> </ul>"},{"location":"developer/CONTRIBUTING/#workflow","title":"Workflow","text":"<pre><code># 1. Fork le projet sur GitHub\n\n# 2. Clonez votre fork\ngit clone https://github.com/VOTRE-USERNAME/TwinShell.git\ncd TwinShell\n\n# 3. Creez une branche\ngit checkout -b feature/ma-fonctionnalite\n\n# 4. Faites vos modifications\n\n# 5. Lancez les tests\ndotnet test\n\n# 6. Commitez\ngit add .\ngit commit -m \"feat: description de la fonctionnalite\"\n\n# 7. Pushez\ngit push origin feature/ma-fonctionnalite\n\n# 8. Creez une Pull Request sur GitHub\n</code></pre>"},{"location":"developer/CONTRIBUTING/#standards-de-code","title":"Standards de Code","text":""},{"location":"developer/CONTRIBUTING/#architecture","title":"Architecture","text":"<ul> <li>MVVM : Model-View-ViewModel avec CommunityToolkit.Mvvm</li> <li>Services : Injection de dependances via constructeur</li> <li>Async : Utilisez async/await pour les operations I/O</li> </ul>"},{"location":"developer/CONTRIBUTING/#conventions-de-nommage","title":"Conventions de Nommage","text":"Element Convention Exemple Classes PascalCase <code>SearchService</code> Methodes PascalCase <code>ExecuteSearch()</code> Variables privees _camelCase <code>_searchText</code> Variables locales camelCase <code>searchResult</code> Constantes UPPER_CASE <code>MAX_RESULTS</code> Interfaces IPascalCase <code>ISearchService</code>"},{"location":"developer/CONTRIBUTING/#documentation","title":"Documentation","text":"<ul> <li>XML comments sur toutes les APIs publiques</li> <li>Commentaires en anglais dans le code</li> <li>Documentation utilisateur en francais</li> </ul> <pre><code>/// &lt;summary&gt;\n/// Executes a search query against the action repository.\n/// &lt;/summary&gt;\n/// &lt;param name=\"query\"&gt;The search query string.&lt;/param&gt;\n/// &lt;returns&gt;A collection of matching actions.&lt;/returns&gt;\npublic async Task&lt;IEnumerable&lt;Action&gt;&gt; SearchAsync(string query)\n{\n    // Implementation\n}\n</code></pre>"},{"location":"developer/CONTRIBUTING/#tests","title":"Tests","text":"<ul> <li>Couverture minimale : 80%</li> <li>Framework : xUnit + FluentAssertions</li> <li>Nommage : <code>MethodName_Scenario_ExpectedResult</code></li> </ul> <pre><code>[Fact]\npublic void Search_WithEmptyQuery_ReturnsAllActions()\n{\n    // Arrange\n    var service = new SearchService();\n\n    // Act\n    var results = service.Search(\"\");\n\n    // Assert\n    results.Should().NotBeEmpty();\n}\n</code></pre>"},{"location":"developer/CONTRIBUTING/#structure-des-commits","title":"Structure des Commits","text":"<p>Utilisez les Conventional Commits :</p> Type Description <code>feat</code> Nouvelle fonctionnalite <code>fix</code> Correction de bug <code>docs</code> Documentation <code>style</code> Formatage (pas de changement de code) <code>refactor</code> Refactoring <code>test</code> Ajout/modification de tests <code>chore</code> Maintenance (build, deps, etc.) <p>Exemples : <pre><code>feat: add fuzzy search capability\nfix: resolve memory leak in SearchService\ndocs: update installation guide\nrefactor: extract validation logic to separate service\n</code></pre></p>"},{"location":"developer/CONTRIBUTING/#pull-requests","title":"Pull Requests","text":""},{"location":"developer/CONTRIBUTING/#checklist","title":"Checklist","text":"<p>Avant de soumettre votre PR, verifiez :</p> <ul> <li>[ ] Le code compile sans erreurs</li> <li>[ ] Tous les tests passent (<code>dotnet test</code>)</li> <li>[ ] Le code suit les conventions de style</li> <li>[ ] La documentation est mise a jour si necessaire</li> <li>[ ] Les commits suivent la convention</li> <li>[ ] La PR a une description claire</li> </ul>"},{"location":"developer/CONTRIBUTING/#template-de-pr","title":"Template de PR","text":"<pre><code>## Description\n\nDecrivez vos changements ici.\n\n## Type de changement\n\n- [ ] Bug fix\n- [ ] New feature\n- [ ] Breaking change\n- [ ] Documentation update\n\n## Tests\n\nDecrivez les tests effectues.\n\n## Checklist\n\n- [ ] Mon code suit les standards du projet\n- [ ] J'ai effectue une auto-review\n- [ ] J'ai commente le code si necessaire\n- [ ] J'ai mis a jour la documentation\n- [ ] Mes changements ne generent pas de warnings\n- [ ] J'ai ajoute des tests\n- [ ] Tous les tests passent\n</code></pre>"},{"location":"developer/CONTRIBUTING/#questions","title":"Questions ?","text":"<ul> <li>GitHub Discussions</li> <li>Issues</li> </ul> <p>Derniere mise a jour : 2025-11-28</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/","title":"Strat\u00e9gie Cross-Platform pour TwinShell","text":"<p>Date: 2025-11-19 Auteur: Architecture Review Statut: Recommandation</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#1-etat-actuel-limitations","title":"1. \u00c9tat actuel - Limitations","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#11-architecture-actuelle","title":"1.1 Architecture actuelle","text":"<ul> <li>Framework UI: WPF (Windows Presentation Foundation)</li> <li>Runtime: .NET 8.0-windows</li> <li>Installeur: Inno Setup 6 (<code>.iss</code>)</li> <li>Plateforme cible: Windows 10+ x64 uniquement</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#12-problematiques-identifiees","title":"1.2 Probl\u00e9matiques identifi\u00e9es","text":"<p>\u2705 Forces: - .NET 8 est intrins\u00e8quement cross-platform - Architecture en couches bien s\u00e9par\u00e9e (Core/Persistence/Infrastructure) - Logique m\u00e9tier ind\u00e9pendante de l'UI (MVVM strict)</p> <p>\u26a0\ufe0f Limitations: - WPF est Windows-only (pas de portage Linux/macOS possible) - Inno Setup ne g\u00e9n\u00e8re que des installeurs Windows - Les commandes PowerShell sont majoritairement Windows-centric - D\u00e9pendance \u00e0 <code>Environment.SpecialFolder</code> Windows-specific</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#2-analyse-technique-inno-setup-vs-alternatives","title":"2. Analyse technique - Inno Setup vs. Alternatives","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#21-inno-setup-actuel-build-installeriss","title":"2.1 Inno Setup actuel (build-installer.iss)","text":"<pre><code>[Setup]\nMinVersion=10.0                          # Windows 10+ requis\nArchitecturesAllowed=x64                # x64 uniquement\nOutputBaseFilename=TwinShell-v{#MyAppVersion}-Setup-win-x64\n</code></pre> <p>Limitations: - Aucun support Linux/macOS - N\u00e9cessite compilation Windows pour g\u00e9n\u00e9ration du setup - Pas de packaging portable (ZIP/tarball)</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#22-alternatives-modernes","title":"2.2 Alternatives modernes","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#option-a-dotnet-publish-deja-disponible","title":"Option A: <code>dotnet publish</code> (d\u00e9j\u00e0 disponible)","text":"<pre><code># Windows (actuel)\ndotnet publish -c Release -r win-x64 --self-contained\n\n# Linux (potentiel futur)\ndotnet publish -c Release -r linux-x64 --self-contained\n\n# macOS (potentiel futur)\ndotnet publish -c Release -r osx-x64 --self-contained\n</code></pre> <p>Avantages: - \u2705 G\u00e9n\u00e8re des binaires autonomes (inclut .NET runtime) - \u2705 Portable (ZIP pour distribution) - \u2705 Cross-platform ready</p> <p>Limitations: - \u274c WPF ne compilera pas pour linux-x64/osx-x64 - \u274c N\u00e9cessite migration UI vers framework cross-platform</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#3-recommandations-strategiques","title":"3. Recommandations strat\u00e9giques","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#31-phase-1-court-terme-immediat","title":"3.1 PHASE 1 - Court terme (IMM\u00c9DIAT)","text":"<p>Objectif: Am\u00e9liorer la distribution Windows sans r\u00e9\u00e9criture</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#actions-recommandees","title":"Actions recommand\u00e9es:","text":"<ol> <li>Conserver Inno Setup pour l'installeur Windows officiel</li> <li>Ajouter distribution portable (ZIP) via GitHub Actions    <pre><code># Ajout au workflow CI/CD\n- name: Create portable package\n  run: |\n    dotnet publish src/TwinShell.App/TwinShell.App.csproj `\n      -c Release -r win-x64 --self-contained `\n      -o ./portable\n    Compress-Archive -Path ./portable/* `\n      -DestinationPath TwinShell-v$VERSION-Portable-win-x64.zip\n</code></pre></li> <li>Documenter les Runtime Identifiers support\u00e9s dans README</li> </ol>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#benefices","title":"B\u00e9n\u00e9fices:","text":"<ul> <li>Distribution sans installation (USB, r\u00e9seaux restreints)</li> <li>Test facile sans privil\u00e8ges admin</li> <li>Pr\u00e9paration infrastructure pour futurs RID</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#32-phase-2-moyen-terme-3-6-mois","title":"3.2 PHASE 2 - Moyen terme (3-6 mois)","text":"<p>Objectif: Refactoring UI pour cross-platform readiness</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#migration-ui-recommandee-avalonia-ui","title":"Migration UI recommand\u00e9e: Avalonia UI","text":"<p>Pourquoi Avalonia ? - \u2705 Syntaxe quasi-identique \u00e0 WPF (XAML compatible) - \u2705 Supporte Windows, Linux, macOS, WebAssembly - \u2705 MVVM natif (CommunityToolkit.Mvvm compatible) - \u2705 Migration progressive possible (Views une par une) - \u2705 Mature et production-ready (GitHub Desktop l'utilise)</p> <p>Plan de migration: <pre><code>TwinShell/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 TwinShell.Core/           # \u2705 Aucune modification (d\u00e9j\u00e0 cross-platform)\n\u2502   \u251c\u2500\u2500 TwinShell.Persistence/    # \u2705 SQLite fonctionne partout\n\u2502   \u251c\u2500\u2500 TwinShell.Infrastructure/ # \u26a0\ufe0f \u00c0 adapter (ClipboardService, etc.)\n\u2502   \u251c\u2500\u2500 TwinShell.App.WPF/        # \ud83d\udd04 Renommer projet actuel\n\u2502   \u2514\u2500\u2500 TwinShell.App.Avalonia/   # \ud83c\udd95 Nouveau projet cross-platform\n</code></pre></p> <p>Effort estim\u00e9: 40-60 heures (migration UI uniquement)</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#packaging-multi-plateforme","title":"Packaging multi-plateforme:","text":"<ul> <li>Windows: Inno Setup + MSIX (Microsoft Store)</li> <li>Linux: AppImage, .deb (Debian/Ubuntu), .rpm (Fedora/RHEL)</li> <li>macOS: .dmg + \u00e9ventuel notarization Apple</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#33-phase-3-long-terme-6-12-mois","title":"3.3 PHASE 3 - Long terme (6-12 mois)","text":"<p>Objectif: Support natif Bash/zsh pour Linux/macOS</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#evolutions-fonctionnelles","title":"\u00c9volutions fonctionnelles:","text":"<ol> <li>Adapter le catalogue de commandes:</li> <li>PowerShell \u2192 Disponible aussi sur Linux/macOS (pwsh)</li> <li>Ajouter \u00e9quivalents Bash/zsh pour commandes syst\u00e8me</li> <li> <p>Cat\u00e9gorie \"Cross-platform\" pour commandes universelles</p> </li> <li> <p>Storage paths cross-platform:    <pre><code>// Actuel (Windows-specific)\nEnvironment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData)\n// \u2192 C:\\Users\\&lt;user&gt;\\AppData\\Local\\TwinShell\n\n// Cross-platform (\u00e0 impl\u00e9menter)\nvar appDataPath = OperatingSystem.IsWindows()\n    ? Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData)\n    : Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile), \".local\", \"share\");\n// Windows: C:\\Users\\&lt;user&gt;\\AppData\\Local\\TwinShell\n// Linux:   /home/&lt;user&gt;/.local/share/TwinShell\n// macOS:   /Users/&lt;user&gt;/.local/share/TwinShell\n</code></pre></p> </li> <li> <p>CI/CD multi-OS:    <pre><code>strategy:\n  matrix:\n    os: [windows-latest, ubuntu-latest, macos-latest]\n    include:\n      - os: windows-latest\n        rid: win-x64\n      - os: ubuntu-latest\n        rid: linux-x64\n      - os: macos-latest\n        rid: osx-x64\n</code></pre></p> </li> </ol>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#4-decision-immediate-recommandee","title":"4. D\u00e9cision imm\u00e9diate recommand\u00e9e","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#action-prioritaire-a-implementer-maintenant","title":"\u2705 ACTION PRIORITAIRE (\u00e0 impl\u00e9menter maintenant):","text":"<p>Modifier le workflow GitHub Actions pour g\u00e9n\u00e9rer 2 artefacts Windows: 1. Installeur (via Inno Setup) \u2192 pour distribution officielle 2. Portable (ZIP) \u2192 pour utilisateurs avanc\u00e9s, tests, USB</p>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#code-a-ajouter-au-githubworkflowsdotnet-desktopyml","title":"Code \u00e0 ajouter au <code>.github/workflows/dotnet-desktop.yml</code>:","text":"<pre><code>    # Apr\u00e8s l'\u00e9tape \"Publish application\"\n    - name: Create portable ZIP package\n      run: Compress-Archive -Path ./publish/* -DestinationPath ./TwinShell-v${{ github.ref_name }}-Portable-win-x64.zip\n\n    - name: Upload portable package\n      uses: actions/upload-artifact@v4\n      with:\n        name: TwinShell-Portable-win-x64\n        path: ./TwinShell-v*.zip\n        retention-days: 30\n\n    # FUTUR: G\u00e9n\u00e9ration de l'installeur Inno Setup (n\u00e9cessite setup ISCC.exe)\n    # - name: Build Inno Setup installer\n    #   run: iscc.exe build-installer.iss\n    #   if: startsWith(github.ref, 'refs/tags/v')\n</code></pre>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#5-benefices-attendus","title":"5. B\u00e9n\u00e9fices attendus","text":""},{"location":"developer/CROSS-PLATFORM-STRATEGY/#court-terme-phase-1","title":"Court terme (Phase 1):","text":"<ul> <li>\u2705 Distribution portable sans installation</li> <li>\u2705 Infrastructure CI/CD compl\u00e8te</li> <li>\u2705 Pr\u00e9paration pour futurs RID</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#moyen-terme-phase-2","title":"Moyen terme (Phase 2):","text":"<ul> <li>\u2705 Support Linux/macOS (millions d'utilisateurs potentiels)</li> <li>\u2705 Positionnement \"Universal Command Library\"</li> <li>\u2705 Communaut\u00e9 open-source \u00e9largie</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#long-terme-phase-3","title":"Long terme (Phase 3):","text":"<ul> <li>\u2705 Catalogue unifi\u00e9 PowerShell/Bash/Zsh</li> <li>\u2705 Leadership sur le march\u00e9 des outils DevOps multi-OS</li> <li>\u2705 Adoption entreprise (environnements hybrides Windows/Linux)</li> </ul>"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#6-risques-et-mitigation","title":"6. Risques et mitigation","text":"Risque Impact Probabilit\u00e9 Mitigation Migration Avalonia \u00e9choue \u00c9lev\u00e9 Faible POC sur 1 vue isol\u00e9e avant full migration Perte fonctionnalit\u00e9s WPF Moyen Moyen Audit complet features WPF vs. Avalonia Fragmentation codebase Moyen \u00c9lev\u00e9 Maintenir architecture en couches stricte Commandes Linux non pertinentes Faible Faible Curration communautaire, votes utilisateurs"},{"location":"developer/CROSS-PLATFORM-STRATEGY/#7-conclusion","title":"7. Conclusion","text":"<p>Recommandation finale: Impl\u00e9menter Phase 1 imm\u00e9diatement (portable ZIP), planifier Phase 2 (Avalonia) dans 3-6 mois si adoption Windows confirm\u00e9e.</p> <p>TwinShell poss\u00e8de d\u00e9j\u00e0 une architecture saine pour le cross-platform. La migration UI vers Avalonia est le seul verrou technique majeur, et elle est faisable et ma\u00eetris\u00e9e avec un effort raisonnable.</p> <p>Prochaines actions: - [ ] Ajouter g\u00e9n\u00e9ration ZIP portable au workflow CI/CD - [ ] Cr\u00e9er POC Avalonia (MainWindow uniquement) - [ ] Documenter les commandes PowerShell portables Linux/macOS - [ ] Analyser effort migration compl\u00e8te Avalonia</p>"},{"location":"developer/MIGRATION_NOTES/","title":"EF Core Migration Instructions","text":""},{"location":"developer/MIGRATION_NOTES/#create-migration-for-custom-categories","title":"Create Migration for Custom Categories","text":"<p>Since the dotnet CLI is not available in this environment, the migration needs to be created manually or when you have access to the dotnet tools.</p>"},{"location":"developer/MIGRATION_NOTES/#command-to-run","title":"Command to Run:","text":"<pre><code>cd src/TwinShell.Persistence\ndotnet ef migrations add AddCustomCategories --startup-project ../TwinShell.App\n</code></pre>"},{"location":"developer/MIGRATION_NOTES/#migration-details","title":"Migration Details:","text":"<p>This migration should create two new tables:</p> <ol> <li>CustomCategories</li> <li>Id (string, PK)</li> <li>Name (string, required, max 100 chars, indexed)</li> <li>IconKey (string, required, max 50 chars)</li> <li>ColorHex (string, required, max 7 chars)</li> <li>IsSystemCategory (bool, required)</li> <li>DisplayOrder (int, required, indexed)</li> <li>IsHidden (bool, required)</li> <li>Description (string, nullable, max 500 chars)</li> <li>CreatedAt (DateTime, required)</li> <li> <p>ModifiedAt (DateTime, nullable)</p> </li> <li> <p>ActionCategoryMappings</p> </li> <li>Id (string, PK)</li> <li>ActionId (string, required, FK to Actions)</li> <li>CategoryId (string, required, FK to CustomCategories)</li> <li>CreatedAt (DateTime, required)</li> <li>Unique constraint on (ActionId, CategoryId)</li> </ol>"},{"location":"developer/MIGRATION_NOTES/#database-will-be-auto-migrated-on-application-startup","title":"Database will be auto-migrated on application startup","text":"<p>The migration will be applied automatically when the application starts thanks to: <pre><code>await context.Database.MigrateAsync();\n</code></pre></p>"},{"location":"developer/MIGRATION_NOTES/#seed-system-categories-optional","title":"Seed System Categories (Optional)","text":"<p>You may want to seed some default system categories: - \"Active Directory\" (icon: \"user\", color: \"#2196F3\") - \"DNS\" (icon: \"network\", color: \"#4CAF50\") - \"Security\" (icon: \"shield\", color: \"#F44336\") - \"Backup\" (icon: \"archive\", color: \"#FF9800\")</p>"},{"location":"developer/OPTIMISATION-WINDOWS/","title":"Guide d'optimisation Windows - TwinShell","text":"<p>Guide complet pour optimiser et nettoyer votre installation Windows \u00e0 l'aide de TwinShell.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#table-des-matieres","title":"Table des mati\u00e8res","text":"<ol> <li>Introduction</li> <li>Qu'est-ce que l'optimisation Windows?</li> <li>Pourquoi utiliser TwinShell?</li> <li>Debloating Windows</li> <li>Confidentialit\u00e9 Windows</li> <li>Performance Windows</li> <li>Presets - Configurations pr\u00e9d\u00e9finies</li> <li>Pr\u00e9cautions et recommandations</li> <li>Rollback et r\u00e9cup\u00e9ration</li> <li>FAQ et troubleshooting</li> <li>Annexes</li> </ol>"},{"location":"developer/OPTIMISATION-WINDOWS/#introduction","title":"Introduction","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#quest-ce-que-loptimisation-windows","title":"Qu'est-ce que l'optimisation Windows?","text":"<p>L'optimisation Windows est l'ensemble des techniques et modifications syst\u00e8me permettant d'am\u00e9liorer les performances, la confidentialit\u00e9 et l'efficacit\u00e9 de votre syst\u00e8me d'exploitation Windows. Cette optimisation se d\u00e9cline en trois axes majeurs:</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#1-debloating-nettoyage","title":"1. Debloating (Nettoyage)","text":"<p>Suppression des applications et composants pr\u00e9install\u00e9s non d\u00e9sir\u00e9s (\"bloatware\"): - Applications tierces: Candy Crush, Spotify, Netflix, Disney+ pr\u00e9install\u00e9s - Applications Microsoft: 3D Builder, Xbox, M\u00e9t\u00e9o, Actualit\u00e9s - Composants syst\u00e8me optionnels: OneDrive, Copilot, Widgets, Microsoft Store - Extensions m\u00e9dia: Codecs HEIF, VP9, WebP, AV1</p> <p>B\u00e9n\u00e9fices: - \ud83d\uddd1\ufe0f Lib\u00e9ration d'espace disque (2-15 GB selon le niveau) - \u26a1 R\u00e9duction de la consommation RAM et CPU - \ud83d\ude80 Am\u00e9lioration du temps de d\u00e9marrage - \ud83e\uddf9 Interface utilisateur \u00e9pur\u00e9e</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-confidentialite-privacy","title":"2. Confidentialit\u00e9 (Privacy)","text":"<p>Contr\u00f4le et limitation de la collecte de donn\u00e9es par Microsoft et applications tierces: - T\u00e9l\u00e9m\u00e9trie Windows: Collecte de donn\u00e9es d'utilisation, diagnostics, rapports d'erreur - Permissions applications: Acc\u00e8s localisation, cam\u00e9ra, microphone, fichiers - Synchronisation cloud: Param\u00e8tres, mots de passe, favoris, th\u00e8mes - Services de tracking: Activity Feed, publicit\u00e9s cibl\u00e9es, reconnaissance vocale</p> <p>B\u00e9n\u00e9fices: - \ud83d\udd12 Protection de la vie priv\u00e9e - \u2705 Conformit\u00e9 RGPD (entreprises europ\u00e9ennes) - \ud83c\udf10 R\u00e9duction du trafic r\u00e9seau en arri\u00e8re-plan - \ud83d\udee1\ufe0f Contr\u00f4le total sur vos donn\u00e9es personnelles</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-performance-optimisation-systeme","title":"3. Performance (Optimisation syst\u00e8me)","text":"<p>Optimisation des param\u00e8tres syst\u00e8me pour maximiser les performances: - Services Windows: D\u00e9sactivation de 200+ services non essentiels - Plans d'alimentation: Activation du mode Ultimate Performance - DNS: Configuration de DNS rapides (Cloudflare 1.1.1.1) - Fonctionnalit\u00e9s syst\u00e8me: D\u00e9sactivation hibernation, indexation, Superfetch - Optimisations gaming: Game Mode, latence GPU, HAGS</p> <p>B\u00e9n\u00e9fices: - \ud83c\udfae Augmentation FPS dans les jeux (5-25% selon config) - \u26a1 R\u00e9duction latence r\u00e9seau et p\u00e9riph\u00e9riques - \ud83d\udca8 Am\u00e9lioration r\u00e9activit\u00e9 syst\u00e8me - \ud83d\udd0b Optimisation consommation \u00e9nerg\u00e9tique (serveurs)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#pourquoi-utiliser-twinshell","title":"Pourquoi utiliser TwinShell?","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#avantages-de-twinshell-vs-modifications-manuelles","title":"Avantages de TwinShell vs modifications manuelles","text":"<p>1. Tra\u00e7abilit\u00e9 et Audit - \u2705 Toutes les actions sont enregistr\u00e9es dans un log d'audit - \u2705 Export de configuration avant/apr\u00e8s pour comparaison - \u2705 Documentation automatique des modifications registre - \u2705 Conformit\u00e9 aux exigences r\u00e9glementaires (RGPD, CCPA)</p> <p>2. R\u00e9versibilit\u00e9 - \ud83d\udd04 Actions de rollback int\u00e9gr\u00e9es pour la plupart des modifications - \ud83d\udd04 Sauvegarde automatique des cl\u00e9s registre modifi\u00e9es - \ud83d\udd04 Scripts de restauration pr\u00eats \u00e0 l'emploi - \ud83d\udd04 Compatible avec les points de restauration syst\u00e8me</p> <p>3. S\u00e9curit\u00e9 - \ud83d\udee1\ufe0f Actions test\u00e9es sur 10+ configurations Windows diff\u00e9rentes - \ud83d\udee1\ufe0f Validation PowerShell avec gestion d'erreurs robuste - \ud83d\udee1\ufe0f Niveaux de criticit\u00e9 (Info, Run, Dangerous) clairement indiqu\u00e9s - \ud83d\udee1\ufe0f Pr\u00e9vention des modifications syst\u00e8me critiques par d\u00e9faut</p> <p>4. Efficacit\u00e9 - \u26a1 Ex\u00e9cution automatis\u00e9e de dizaines d'actions en un clic - \u26a1 Batches pr\u00e9d\u00e9finis pour cas d'usage courants - \u26a1 Mode d'ex\u00e9cution s\u00e9quentiel avec StopOnError - \u26a1 Pas besoin d'expertise PowerShell avanc\u00e9e</p> <p>5. \u00c9volutivit\u00e9 - \ud83d\udce6 Base de donn\u00e9es de 100+ actions maintenue \u00e0 jour - \ud83d\udce6 Support des nouvelles versions Windows (10, 11, Server) - \ud83d\udce6 Ajout r\u00e9gulier de nouvelles optimisations - \ud83d\udce6 Communaut\u00e9 open-source active</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#comparaison-avec-dautres-outils","title":"Comparaison avec d'autres outils","text":"Crit\u00e8re TwinShell Scripts manuels O&amp;O ShutUp10++ Chris Titus Tech Tra\u00e7abilit\u00e9 \u2705 Compl\u00e8te \u274c Aucune \u26a0\ufe0f Limit\u00e9e \u26a0\ufe0f Limit\u00e9e Audit RGPD \u2705 Export complet \u274c Manuel \u274c Non \u274c Non R\u00e9versibilit\u00e9 \u2705 Int\u00e9gr\u00e9e \u26a0\ufe0f Manuelle \u2705 Oui \u26a0\ufe0f Partielle Batches pr\u00e9d\u00e9finis \u2705 6 presets \u274c Non \u2705 Oui \u2705 Oui Actions custom \u2705 Oui \u2705 Oui \u274c Non \u26a0\ufe0f Limit\u00e9es Gestion packages \u2705 winget/choco \u274c Non \u274c Non \u2705 winget Open source \u2705 MIT License N/A \u274c Propri\u00e9taire \u2705 Open source Interface \ud83d\udda5\ufe0f Terminal TUI \ud83d\udcbb PowerShell \ud83d\uddb1\ufe0f GUI \ud83d\uddb1\ufe0f GUI Scripting \u2705 JSON + PS \u2705 PowerShell \u274c Non \u26a0\ufe0f Limit\u00e9"},{"location":"developer/OPTIMISATION-WINDOWS/#cas-dusage-recommandes","title":"Cas d'usage recommand\u00e9s","text":"<p>TwinShell est particuli\u00e8rement adapt\u00e9 pour:</p> <p>\u2705 Entreprises et organisations - D\u00e9ploiement standardis\u00e9 sur parc informatique - Conformit\u00e9 RGPD et audit des modifications - Documentation compl\u00e8te pour DSI/RSSI - Int\u00e9gration dans scripts d'installation automatis\u00e9e</p> <p>\u2705 Administrateurs syst\u00e8me - Optimisation de serveurs Windows - Cr\u00e9ation de templates Windows optimis\u00e9s - D\u00e9sactivation massive de services non n\u00e9cessaires - Gestion centralis\u00e9e des configurations</p> <p>\u2705 Gamers et power users - Optimisation FPS et latence - Suppression bloatware pour lib\u00e9rer ressources - Batches pr\u00e9d\u00e9finis pour gaming - R\u00e9glages fins des performances</p> <p>\u2705 Utilisateurs soucieux de confidentialit\u00e9 - Configuration RGPD stricte - D\u00e9sactivation t\u00e9l\u00e9m\u00e9trie compl\u00e8te - Contr\u00f4le des permissions applications - Export de configuration pour audit personnel</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#architecture-twinshell","title":"Architecture TwinShell","text":"<pre><code>TwinShell/\n\u251c\u2500\u2500 Core Engine (C#/.NET)\n\u2502   \u251c\u2500\u2500 Action Repository (100+ actions)\n\u2502   \u251c\u2500\u2500 Batch Manager (6 presets + custom)\n\u2502   \u251c\u2500\u2500 PowerShell Executor (s\u00e9curis\u00e9)\n\u2502   \u2514\u2500\u2500 Audit Logger (tra\u00e7abilit\u00e9)\n\u2502\n\u251c\u2500\u2500 Data Layer\n\u2502   \u251c\u2500\u2500 initial-actions.json (d\u00e9finitions actions)\n\u2502   \u251c\u2500\u2500 initial-batches.json (presets)\n\u2502   \u2514\u2500\u2500 SQLite DB (historique, favoris)\n\u2502\n\u251c\u2500\u2500 Services\n\u2502   \u251c\u2500\u2500 WinScript Service (optimisations Windows)\n\u2502   \u251c\u2500\u2500 Package Managers (winget, choco, scoop)\n\u2502   \u251c\u2500\u2500 Localization (FR/EN/ES)\n\u2502   \u2514\u2500\u2500 Settings Manager\n\u2502\n\u2514\u2500\u2500 Terminal UI (Spectre.Console)\n    \u251c\u2500\u2500 Interactive Menus\n    \u251c\u2500\u2500 Progress Bars\n    \u251c\u2500\u2500 Rich Formatting\n    \u2514\u2500\u2500 Error Handling\n</code></pre> <p>Workflow typique: 1. S\u00e9lection \u2192 Choisir un batch pr\u00e9d\u00e9fini ou actions individuelles 2. Validation \u2192 Revue des actions \u00e0 ex\u00e9cuter et avertissements 3. Ex\u00e9cution \u2192 PowerShell s\u00e9curis\u00e9 avec gestion d'erreurs 4. Audit \u2192 Logging complet dans base de donn\u00e9es 5. V\u00e9rification \u2192 Tests post-ex\u00e9cution recommand\u00e9s</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#debloating-windows","title":"Debloating Windows","text":"<p>Le debloating consiste \u00e0 supprimer les applications pr\u00e9install\u00e9es et composants Windows non essentiels pour: - Lib\u00e9rer de l'espace disque - Am\u00e9liorer les performances syst\u00e8me - R\u00e9duire la consommation de ressources - Am\u00e9liorer la confidentialit\u00e9</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#avertissement-important","title":"\u26a0\ufe0f AVERTISSEMENT IMPORTANT","text":"<p>Les actions de debloating peuvent \u00eatre irr\u00e9versibles!</p> <p>Avant de proc\u00e9der: 1. Cr\u00e9ez un point de restauration syst\u00e8me 2. Sauvegardez vos donn\u00e9es importantes 3. Documentez vos actions pour pouvoir les annuler si n\u00e9cessaire 4. Testez d'abord sur une machine virtuelle ou de test</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#categories-dactions-disponibles","title":"Cat\u00e9gories d'actions disponibles","text":"<p>TwinShell propose 22 actions de debloating organis\u00e9es en 4 cat\u00e9gories:</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#1-bloatware-tiers-3-actions","title":"1. \ud83e\uddf9 Bloatware Tiers (3 actions)","text":"<p>Actions pour supprimer les applications tierces pr\u00e9install\u00e9es.</p> Action ID Description Level Notes WIN-DEBLOAT-001 Supprimer tous les bloatwares tiers Run Candy Crush, Spotify, Disney+, Netflix WIN-DEBLOAT-002 Supprimer les extensions m\u00e9dia Run HEIF, VP9, WebP, AV1 codecs WIN-DEBLOAT-003 Lister les applications tierces Info Commande d'information uniquement <p>Recommandation: Commencez par WIN-DEBLOAT-003 pour identifier les apps install\u00e9es avant de supprimer.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-applications-microsoft-5-actions","title":"2. \ud83d\udcf1 Applications Microsoft (5 actions)","text":"<p>Actions pour supprimer les applications Microsoft non essentielles.</p> Action ID Description Level Apps concern\u00e9es WIN-DEBLOAT-101 Supprimer les apps Microsoft inutiles Run 38+ apps (3D Builder, Alarms, BingNews, etc.) WIN-DEBLOAT-102 Supprimer uniquement les apps de jeux Run Solitaire, Candy Crush, Xbox Game Bar WIN-DEBLOAT-103 Supprimer les apps de communication Run Skype, People, Mail, Calendar WIN-DEBLOAT-104 Supprimer les apps m\u00e9t\u00e9o/actualit\u00e9s Run M\u00e9t\u00e9o, Actualit\u00e9s, Sports, Finance WIN-DEBLOAT-105 Liste personnalis\u00e9e d'apps Run Sp\u00e9cifier votre propre liste <p>Recommandation: Utilisez WIN-DEBLOAT-102/103/104 pour une suppression cibl\u00e9e, ou WIN-DEBLOAT-101 pour un nettoyage complet.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-composants-systeme-6-actions-toutes-dangerous","title":"3. \u26a0\ufe0f Composants Syst\u00e8me (6 actions) - TOUTES DANGEROUS","text":"<p>ATTENTION: Ces actions sont irr\u00e9versibles et peuvent affecter les fonctionnalit\u00e9s Windows!</p> Action ID Description Impact Cons\u00e9quences WIN-DEBLOAT-201 D\u00e9sinstaller Microsoft Store \ud83d\udd34 Critique Impossible d'installer des apps du Store WIN-DEBLOAT-202 D\u00e9sinstaller OneDrive (complet) \ud83d\udd34 Critique Perte de la synchro cloud, nettoyage registre WIN-DEBLOAT-203 D\u00e9sinstaller Microsoft Edge \ud83d\udd34 Critique Certaines fonctions Windows 11 affect\u00e9es WIN-DEBLOAT-204 D\u00e9sinstaller Copilot \ud83d\udfe1 Mod\u00e9r\u00e9 Perte de l'assistant IA Windows WIN-DEBLOAT-205 Supprimer Xbox (tous composants) \ud83d\udfe1 Mod\u00e9r\u00e9 Perte Game Bar et services Xbox WIN-DEBLOAT-206 Supprimer Widgets \ud83d\udfe1 Mod\u00e9r\u00e9 Retire les Widgets de la barre des t\u00e2ches <p>Recommandation: - NE PAS UTILISER sans sauvegarde compl\u00e8te du syst\u00e8me - Tester d'abord sur une VM ou machine de test - Cr\u00e9er un point de restauration avant chaque action - Documenter chaque action effectu\u00e9e</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#4-fonctionnalites-windows-4-actions","title":"4. \u2699\ufe0f Fonctionnalit\u00e9s Windows (4 actions)","text":"<p>Actions pour d\u00e9sactiver des fonctionnalit\u00e9s Windows optionnelles.</p> Action ID Description Level Impact WIN-DEBLOAT-301 D\u00e9sactiver Consumer Features Run Bloque l'installation auto d'apps sugg\u00e9r\u00e9es WIN-DEBLOAT-302 D\u00e9sactiver Recall Run D\u00e9sactive l'enregistrement d'activit\u00e9 IA WIN-DEBLOAT-303 D\u00e9sactiver Internet Explorer Run D\u00e9sactive IE11 (legacy) WIN-DEBLOAT-304 D\u00e9sactiver Hyper-V Run D\u00e9sactive la virtualisation <p>Recommandation: WIN-DEBLOAT-301 est fortement recommand\u00e9 pour \u00e9viter la r\u00e9installation de bloatware.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#5-optimisation-edge-4-actions","title":"5. \ud83c\udf10 Optimisation Edge (4 actions)","text":"<p>Actions pour optimiser Microsoft Edge (si vous le conservez).</p> Action ID Description B\u00e9n\u00e9fice WIN-DEBLOAT-401 D\u00e9sactiver les recommandations Edge Moins de distractions WIN-DEBLOAT-402 D\u00e9sactiver le shopping assistant Pas de notifications de coupons WIN-DEBLOAT-403 D\u00e9sactiver la t\u00e9l\u00e9m\u00e9trie Edge Am\u00e9lioration de la confidentialit\u00e9 WIN-DEBLOAT-404 D\u00e9sactiver le crypto wallet D\u00e9sactive les fonctionnalit\u00e9s Web3 <p>Recommandation: Appliquez toutes les actions Edge si vous utilisez Edge mais souhaitez une exp\u00e9rience plus \"propre\".</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#confidentialite-windows","title":"Confidentialit\u00e9 Windows","text":"<p>La confidentialit\u00e9 Windows permet de contr\u00f4ler la collecte de donn\u00e9es, la t\u00e9l\u00e9m\u00e9trie et les permissions des applications. Ces actions sont essentielles pour la conformit\u00e9 RGPD.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#conformite-rgpd-et-protection-des-donnees","title":"\ud83d\udd12 Conformit\u00e9 RGPD et protection des donn\u00e9es","text":"<p>TwinShell Sprint 7 - Confidentialit\u00e9 Windows offre 28 actions organis\u00e9es en 4 cat\u00e9gories pour une protection maximale de vos donn\u00e9es personnelles conform\u00e9ment au RGPD (R\u00e8glement G\u00e9n\u00e9ral sur la Protection des Donn\u00e9es).</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#avertissement-important-rgpd","title":"\u26a0\ufe0f AVERTISSEMENT IMPORTANT - RGPD","text":"<p>Ces actions d\u00e9sactivent la collecte de donn\u00e9es par Microsoft et des applications tierces. Elles sont particuli\u00e8rement importantes pour: - Entreprises europ\u00e9ennes soumises au RGPD - Utilisateurs soucieux de leur vie priv\u00e9e - Organisations manipulant des donn\u00e9es sensibles - Conformit\u00e9 aux r\u00e9glementations de protection des donn\u00e9es</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#categories-dactions-de-confidentialite","title":"Cat\u00e9gories d'actions de confidentialit\u00e9","text":"<p>TwinShell propose 28 actions de confidentialit\u00e9 organis\u00e9es en 4 cat\u00e9gories :</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#1-permissions-applications-10-actions-win-privacy-001-a-010","title":"1. \ud83d\udd10 Permissions Applications (10 actions - WIN-PRIVACY-001 \u00e0 010)","text":"<p>Contr\u00f4le granulaire des permissions d'acc\u00e8s des applications Windows.</p> Action ID Description Scope Impact RGPD WIN-PRIVACY-001 D\u00e9sactiver l'acc\u00e8s localisation CurrentUser/AllUsers RGPD Art. 6 - Donn\u00e9es de localisation WIN-PRIVACY-002 D\u00e9sactiver l'acc\u00e8s cam\u00e9ra CurrentUser/AllUsers RGPD Art. 25 - Protection d\u00e8s la conception WIN-PRIVACY-003 D\u00e9sactiver l'acc\u00e8s microphone CurrentUser/AllUsers Protection contre \u00e9coute non autoris\u00e9e WIN-PRIVACY-004 D\u00e9sactiver l'acc\u00e8s syst\u00e8me de fichiers CurrentUser/AllUsers Protection des documents sensibles WIN-PRIVACY-005 D\u00e9sactiver l'acc\u00e8s contacts CurrentUser/AllUsers Protection des donn\u00e9es personnelles de tiers WIN-PRIVACY-006 D\u00e9sactiver l'acc\u00e8s calendrier CurrentUser/AllUsers Protection de la vie priv\u00e9e professionnelle WIN-PRIVACY-007 D\u00e9sactiver l'acc\u00e8s emails CurrentUser/AllUsers Confidentialit\u00e9 des communications WIN-PRIVACY-008 D\u00e9sactiver l'acc\u00e8s notifications CurrentUser/AllUsers R\u00e9duction du tracking WIN-PRIVACY-009 D\u00e9sactiver TOUTES les permissions Run \u26a0\ufe0f Configuration maximale - Level Dangerous WIN-PRIVACY-010 Restaurer les permissions par d\u00e9faut Run Action de rollback <p>Recommandation: - Utilisez les actions 001-008 individuellement pour un contr\u00f4le pr\u00e9cis - WIN-PRIVACY-009 pour une s\u00e9curit\u00e9 maximale (d\u00e9sactive tout) - WIN-PRIVACY-010 pour annuler si trop restrictif - Le param\u00e8tre <code>Scope</code> permet de choisir entre CurrentUser (utilisateur actuel) ou AllUsers (tous les utilisateurs)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-synchronisation-cloud-6-actions-win-privacy-101-a-106","title":"2. \u2601\ufe0f Synchronisation Cloud (6 actions - WIN-PRIVACY-101 \u00e0 106)","text":"<p>Contr\u00f4le de la synchronisation avec le cloud Microsoft.</p> Action ID Description Level Donn\u00e9es concern\u00e9es WIN-PRIVACY-101 D\u00e9sactiver toute synchronisation cloud Dangerous TOUTES (param\u00e8tres, mots de passe, th\u00e8mes, navigateur) WIN-PRIVACY-102 D\u00e9sactiver sync des param\u00e8tres Run Pr\u00e9f\u00e9rences Windows, accessibilit\u00e9 WIN-PRIVACY-103 D\u00e9sactiver sync des th\u00e8mes Run Fonds d'\u00e9cran, personnalisation WIN-PRIVACY-104 D\u00e9sactiver sync des mots de passe Dangerous Identifiants, credentials WIN-PRIVACY-105 D\u00e9sactiver sync du navigateur Run Favoris, historique, onglets Edge WIN-PRIVACY-106 Restaurer la synchronisation Run Action de rollback <p>Impact RGPD: - Article 44 RGPD: Emp\u00eache le transfert de donn\u00e9es vers les serveurs Microsoft (potentiellement hors UE) - Article 5 RGPD: Limitation de la collecte de donn\u00e9es au strict n\u00e9cessaire - WIN-PRIVACY-101 recommand\u00e9e pour les entreprises soumises au RGPD strict</p> <p>Recommandation: - WIN-PRIVACY-101 pour d\u00e9sactiver toute synchronisation (entreprises RGPD) - Actions 102-105 pour un contr\u00f4le granulaire - WIN-PRIVACY-104 particuli\u00e8rement critique pour la s\u00e9curit\u00e9</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-telemetrie-et-tracking-8-actions-win-privacy-201-a-208","title":"3. \ud83d\udcca T\u00e9l\u00e9m\u00e9trie et Tracking (8 actions - WIN-PRIVACY-201 \u00e0 208)","text":"<p>D\u00e9sactivation de la t\u00e9l\u00e9m\u00e9trie Windows et des services de tracking.</p> Action ID Description Level Cl\u00e9s registre modifi\u00e9es WIN-PRIVACY-201 D\u00e9sactiver Activity Feed Run 3+ cl\u00e9s (chronologie Windows) WIN-PRIVACY-202 D\u00e9sactiver Game DVR Run 4+ cl\u00e9s (Xbox, enregistrement) WIN-PRIVACY-203 D\u00e9sactiver notifications publicitaires Run 7+ cl\u00e9s (suggestions, ads) WIN-PRIVACY-204 D\u00e9sactiver suivi de localisation Run 5+ cl\u00e9s (GPS, capteurs) WIN-PRIVACY-205 Configuration minimale t\u00e9l\u00e9m\u00e9trie Dangerous 50+ cl\u00e9s + t\u00e2ches planifi\u00e9es WIN-PRIVACY-206 D\u00e9sactiver reconnaissance vocale cloud Run 8+ cl\u00e9s (Cortana, dict\u00e9e) WIN-PRIVACY-207 D\u00e9sactiver services biom\u00e9triques Dangerous 3+ cl\u00e9s (Windows Hello, empreintes) WIN-PRIVACY-208 D\u00e9sactiver cam\u00e9ra \u00e9cran verrouillage Run 1 cl\u00e9 (s\u00e9curit\u00e9 lockscreen) <p>D\u00e9tails WIN-PRIVACY-205 (T\u00e9l\u00e9m\u00e9trie minimale):</p> <p>Cette action est LA PLUS IMPORTANTE pour la conformit\u00e9 RGPD stricte: - Configure la t\u00e9l\u00e9m\u00e9trie au niveau Security (0) - le minimum absolu - D\u00e9sactive 50+ cl\u00e9s de registre dans HKLM et HKCU - D\u00e9sactive 6+ t\u00e2ches planifi\u00e9es de collecte de donn\u00e9es:   - Microsoft Compatibility Appraiser   - ProgramDataUpdater   - Customer Experience Improvement Program   - Disk Diagnostic Data Collector   - Et plus... - Niveau recommand\u00e9 pour toutes les entreprises europ\u00e9ennes</p> <p>Impact RGPD: - Article 5 RGPD: Minimisation des donn\u00e9es - Article 25 RGPD: Protection d\u00e8s la conception - Article 32 RGPD: S\u00e9curit\u00e9 du traitement</p> <p>Recommandation: - WIN-PRIVACY-205 est OBLIGATOIRE pour conformit\u00e9 RGPD entreprise - WIN-PRIVACY-201, 203, 204, 206 fortement recommand\u00e9es - WIN-PRIVACY-207 si donn\u00e9es biom\u00e9triques sensibles (Article 9 RGPD)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#4-telemetrie-applications-tierces-4-actions-win-privacy-301-a-304","title":"4. \ud83d\udd27 T\u00e9l\u00e9m\u00e9trie Applications Tierces (4 actions - WIN-PRIVACY-301 \u00e0 304)","text":"<p>D\u00e9sactivation de la t\u00e9l\u00e9m\u00e9trie des applications tierces courantes.</p> Action ID Description Applications concern\u00e9es Services d\u00e9sactiv\u00e9s WIN-PRIVACY-301 D\u00e9sactiver t\u00e9l\u00e9m\u00e9trie Adobe Creative Cloud, Acrobat AdobeUpdateService, AGMService, Analytics WIN-PRIVACY-302 D\u00e9sactiver t\u00e9l\u00e9m\u00e9trie VS Code Visual Studio Code Telemetry, Crash Reporter WIN-PRIVACY-303 D\u00e9sactiver t\u00e9l\u00e9m\u00e9trie Google Chrome, Google Update gupdate, gupdatem, MetricsReporting WIN-PRIVACY-304 D\u00e9sactiver t\u00e9l\u00e9m\u00e9trie Nvidia GeForce Experience, pilotes NvTelemetryContainer, t\u00e2ches planifi\u00e9es <p>D\u00e9tails par application:</p> <p>Adobe (WIN-PRIVACY-301): - D\u00e9sactive Adobe Analytics - Stoppe AdobeUpdateService, AGMService, AGSService - Configure OptOut pour SuiteCloud - R\u00e9duit utilisation r\u00e9seau et CPU</p> <p>VS Code (WIN-PRIVACY-302): - Modifie <code>settings.json</code> utilisateur - <code>telemetry.telemetryLevel: off</code> - <code>telemetry.enableTelemetry: false</code> - <code>telemetry.enableCrashReporter: false</code></p> <p>Google Chrome (WIN-PRIVACY-303): - D\u00e9sactive MetricsReporting - Stoppe services gupdate/gupdatem - Bloque ChromeCleanup reporting - D\u00e9sactive UserFeedback</p> <p>Nvidia (WIN-PRIVACY-304): - Stoppe NvTelemetryContainer - D\u00e9sactive t\u00e2ches planifi\u00e9es (CrashReport, DriverUpdateCheck) - Configure <code>SendTelemetryData: 0</code> - N'affecte PAS les performances graphiques</p> <p>Recommandation: - Appliquez les actions pour les applications que vous avez install\u00e9es - Ces actions am\u00e9liorent aussi les performances (moins de services en arri\u00e8re-plan)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#batch-predefini-confidentialite-maximale","title":"\ud83c\udfaf Batch Pr\u00e9d\u00e9fini: \"\ud83d\udd12 Confidentialit\u00e9 maximale\"","text":"<p>TwinShell inclut un batch pr\u00e9d\u00e9fini combinant les actions les plus critiques:</p> <p>Actions incluses (8 commandes): 1. WIN-PRIVACY-009 - D\u00e9sactiver toutes les permissions applications 2. WIN-PRIVACY-101 - D\u00e9sactiver toute synchronisation cloud 3. WIN-PRIVACY-205 - Configuration minimale de t\u00e9l\u00e9m\u00e9trie (Security) 4. WIN-PRIVACY-207 - D\u00e9sactiver services biom\u00e9triques 5. WIN-PRIVACY-201 - D\u00e9sactiver Activity Feed 6. WIN-PRIVACY-203 - D\u00e9sactiver notifications publicitaires 7. WIN-PRIVACY-204 - D\u00e9sactiver suivi de localisation 8. WIN-PRIVACY-206 - D\u00e9sactiver reconnaissance vocale cloud</p> <p>Utilisation: <pre><code># Via TwinShell - S\u00e9lectionner le batch \"\ud83d\udd12 Confidentialit\u00e9 maximale\"\n# Ex\u00e9cution s\u00e9quentielle avec mode StopOnError\n</code></pre></p> <p>Recommandation: - Entreprises RGPD: Ex\u00e9cutez ce batch sur tous les postes Windows - Utilisateurs avanc\u00e9s: Configuration optimale pour vie priv\u00e9e maximale - Attention: Certaines fonctionnalit\u00e9s seront d\u00e9sactiv\u00e9es (Windows Hello, synchronisation, etc.)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#cles-de-registre-modifiees-liste-complete","title":"\ud83d\udccb Cl\u00e9s de registre modifi\u00e9es (Liste compl\u00e8te)","text":"<p>Pour transparence et conformit\u00e9 RGPD, voici la liste compl\u00e8te des cl\u00e9s modifi\u00e9es:</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#permissions-applications-001-009","title":"Permissions Applications (001-009)","text":"<pre><code>HKCU/HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\\n\u251c\u2500\u2500 location\n\u251c\u2500\u2500 webcam\n\u251c\u2500\u2500 microphone\n\u251c\u2500\u2500 documentsLibrary\n\u251c\u2500\u2500 broadFileSystemAccess\n\u251c\u2500\u2500 contacts\n\u251c\u2500\u2500 appointments\n\u251c\u2500\u2500 email\n\u251c\u2500\u2500 userNotificationListener\n\u251c\u2500\u2500 phoneCall\n\u251c\u2500\u2500 radios\n\u2514\u2500\u2500 chat\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#synchronisation-cloud-101-106","title":"Synchronisation Cloud (101-106)","text":"<pre><code>HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\\n\u251c\u2500\u2500 SyncPolicy\n\u2514\u2500\u2500 Groups\\\n    \u251c\u2500\u2500 Personalization\n    \u251c\u2500\u2500 BrowserSettings\n    \u251c\u2500\u2500 Credentials\n    \u251c\u2500\u2500 Accessibility\n    \u2514\u2500\u2500 Windows\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#telemetrie-windows-201-208","title":"T\u00e9l\u00e9m\u00e9trie Windows (201-208)","text":"<pre><code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\\n\u251c\u2500\u2500 System (ActivityFeed, PublishUserActivities)\n\u251c\u2500\u2500 GameDVR (AllowGameDVR)\n\u251c\u2500\u2500 LocationAndSensors (DisableLocation)\n\u251c\u2500\u2500 DataCollection (AllowTelemetry, MaxTelemetryAllowed)\n\u251c\u2500\u2500 InputPersonalization\n\u251c\u2500\u2500 Biometrics\n\u2514\u2500\u2500 Personalization (NoLockScreenCamera)\n\nHKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager\\\n\u251c\u2500\u2500 SilentInstalledAppsEnabled\n\u251c\u2500\u2500 SystemPaneSuggestionsEnabled\n\u251c\u2500\u2500 SubscribedContent-*\n\u2514\u2500\u2500 (7+ cl\u00e9s publicitaires)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#applications-tierces-301-304","title":"Applications Tierces (301-304)","text":"<pre><code>Adobe:\nHKLM:\\SOFTWARE\\Policies\\Adobe\\Adobe Acrobat\\DC\\FeatureLockDown\nHKLM:\\SOFTWARE\\Adobe\\Adobe Desktop Common\\ADS\nHKLM:\\SOFTWARE\\Adobe\\SuiteCloud\n\nGoogle Chrome:\nHKLM:\\SOFTWARE\\Policies\\Google\\Chrome\nHKLM:\\SOFTWARE\\Policies\\Google\\Update\n\nNvidia:\nHKLM:\\SOFTWARE\\NVIDIA Corporation\\NvControlPanel2\\Client\nHKLM:\\SYSTEM\\CurrentControlSet\\Services\\nvlddmkm\\Global\\Startup\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#export-de-configuration-avantapres","title":"\ud83d\udd04 Export de configuration avant/apr\u00e8s","text":"<p>Pour conformit\u00e9 RGPD, documentez vos changements:</p> <p>Avant ex\u00e9cution: <pre><code># Export complet du registre de confidentialit\u00e9\n$date = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$backupPath = \"C:\\TwinShell_Backup\\Privacy_$date\"\nNew-Item -Path $backupPath -ItemType Directory -Force\n\n# Export cl\u00e9s permissions\nreg export \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\" \"$backupPath\\permissions.reg\" /y\n\n# Export cl\u00e9s synchronisation\nreg export \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\" \"$backupPath\\sync.reg\" /y\n\n# Export cl\u00e9s t\u00e9l\u00e9m\u00e9trie\nreg export \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" \"$backupPath\\telemetry.reg\" /y\n\n# Liste des t\u00e2ches planifi\u00e9es actives\nGet-ScheduledTask | Where-Object {$_.State -eq 'Ready'} | Export-Csv \"$backupPath\\scheduled_tasks.csv\"\n\nWrite-Host \"Backup cr\u00e9\u00e9 dans: $backupPath\"\n</code></pre></p> <p>Apr\u00e8s ex\u00e9cution: <pre><code># V\u00e9rification des modifications\n$verifyPath = \"C:\\TwinShell_Backup\\Privacy_Verify_$date\"\nNew-Item -Path $verifyPath -ItemType Directory -Force\n\n# Export post-configuration\nreg export \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\" \"$verifyPath\\permissions_after.reg\" /y\nreg export \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\" \"$verifyPath\\sync_after.reg\" /y\nreg export \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" \"$verifyPath\\telemetry_after.reg\" /y\n\n# Comparaison avant/apr\u00e8s\nWrite-Host \"Comparez les fichiers .reg dans $backupPath et $verifyPath\"\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#tests-de-conformite-rgpd","title":"\ud83d\udcca Tests de conformit\u00e9 RGPD","text":"<p>Tests recommand\u00e9s apr\u00e8s configuration:</p> <ol> <li> <p>V\u00e9rifier t\u00e9l\u00e9m\u00e9trie d\u00e9sactiv\u00e9e: <pre><code>Get-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name AllowTelemetry\n# R\u00e9sultat attendu: 0\n</code></pre></p> </li> <li> <p>V\u00e9rifier services arr\u00eat\u00e9s: <pre><code>Get-Service | Where-Object {$_.Name -like \"*Telemetry*\" -or $_.Name -like \"*DiagTrack*\"}\n# R\u00e9sultat attendu: Stopped/Disabled\n</code></pre></p> </li> <li> <p>V\u00e9rifier t\u00e2ches planifi\u00e9es d\u00e9sactiv\u00e9es: <pre><code>Get-ScheduledTask | Where-Object {$_.TaskName -like \"*Compatibility Appraiser*\"}\n# R\u00e9sultat attendu: Disabled\n</code></pre></p> </li> <li> <p>V\u00e9rifier permissions applications: <pre><code>Get-ItemProperty \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\location\" -Name Value\n# R\u00e9sultat attendu: \"Deny\"\n</code></pre></p> </li> </ol>"},{"location":"developer/OPTIMISATION-WINDOWS/#recommandations-par-type-dorganisation","title":"\ud83c\udfe2 Recommandations par type d'organisation","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#entreprises-soumises-au-rgpd-strict","title":"Entreprises soumises au RGPD strict","text":"<p>Actions OBLIGATOIRES: - WIN-PRIVACY-009 (Toutes permissions) - WIN-PRIVACY-101 (Toute synchronisation) - WIN-PRIVACY-205 (T\u00e9l\u00e9m\u00e9trie minimale) - WIN-PRIVACY-207 (Biom\u00e9trie - si donn\u00e9es sensibles Art. 9)</p> <p>Actions RECOMMAND\u00c9ES: - WIN-PRIVACY-201, 203, 204, 206 (Tracking) - WIN-PRIVACY-301-304 (T\u00e9l\u00e9m\u00e9trie apps tierces)</p> <p>Batch \u00e0 utiliser: \"\ud83d\udd12 Confidentialit\u00e9 maximale\"</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#utilisateurs-professionnels","title":"Utilisateurs professionnels","text":"<p>Actions RECOMMAND\u00c9ES: - WIN-PRIVACY-001, 002, 003 (Localisation, cam\u00e9ra, micro) - WIN-PRIVACY-101 ou 104 (Sync cloud ou mots de passe) - WIN-PRIVACY-205 (T\u00e9l\u00e9m\u00e9trie minimale) - WIN-PRIVACY-203 (Publicit\u00e9s)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#utilisateurs-personnels-soucieux-de-leur-vie-privee","title":"Utilisateurs personnels soucieux de leur vie priv\u00e9e","text":"<p>Actions SUGG\u00c9R\u00c9ES: - WIN-PRIVACY-001 (Localisation) - WIN-PRIVACY-203 (Publicit\u00e9s) - WIN-PRIVACY-204 (Tracking localisation) - WIN-PRIVACY-206 (Reconnaissance vocale) - Actions 301-304 selon apps install\u00e9es</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#impacts-et-limitations","title":"\u26a0\ufe0f Impacts et limitations","text":"<p>Fonctionnalit\u00e9s d\u00e9sactiv\u00e9es par les actions de confidentialit\u00e9:</p> Action Fonctionnalit\u00e9s affect\u00e9es Alternatives WIN-PRIVACY-001 GPS, localisation dans apps Activer manuellement si besoin WIN-PRIVACY-002 Webcam pour toutes les apps Activer pour apps sp\u00e9cifiques WIN-PRIVACY-003 Micro pour toutes les apps Activer pour Teams, Zoom, etc. WIN-PRIVACY-009 TOUTES les permissions R\u00e9activer individuellement WIN-PRIVACY-101 Sync entre appareils Utiliser OneDrive manuel WIN-PRIVACY-104 Sync mots de passe Utiliser gestionnaire de mots de passe WIN-PRIVACY-205 Certaines fonctionnalit\u00e9s Windows Update Fonctionne quand m\u00eame WIN-PRIVACY-206 Cortana, dict\u00e9e cloud Dict\u00e9e locale disponible WIN-PRIVACY-207 Windows Hello Utiliser PIN ou mot de passe <p>Compatible avec: - Windows 10 (build 1809+) - Windows 11 (toutes versions) - Environnements Active Directory - GPO existantes (les actions TwinShell peuvent \u00eatre remplac\u00e9es par GPO)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#conformite-reglementaire","title":"\ud83d\udd10 Conformit\u00e9 r\u00e9glementaire","text":"<p>RGPD (UE): - Article 5: Minimisation des donn\u00e9es \u2705 - Article 6: Lic\u00e9it\u00e9 du traitement \u2705 - Article 25: Protection d\u00e8s la conception \u2705 - Article 32: S\u00e9curit\u00e9 du traitement \u2705 - Article 44: Transfert de donn\u00e9es hors UE \u2705</p> <p>Autres r\u00e9glementations: - CCPA (Californie): Contr\u00f4le des donn\u00e9es personnelles - PIPEDA (Canada): Protection des renseignements personnels - DPA 2018 (UK): UK Data Protection Act</p> <p>Audit et tra\u00e7abilit\u00e9: - Toutes les actions sont logg\u00e9es - Export de configuration possible - Comparaison avant/apr\u00e8s disponible - Conformit\u00e9 aux exigences d'audit RGPD</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#performance-windows","title":"Performance Windows","text":"<p>L'optimisation des performances Windows est essentielle pour maximiser la r\u00e9activit\u00e9, la fluidit\u00e9 et l'efficacit\u00e9 de votre syst\u00e8me. TwinShell Sprint 8 offre 42 actions de performance r\u00e9parties en 5 cat\u00e9gories.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#vue-densemble-des-optimisations","title":"\ud83c\udfaf Vue d'ensemble des optimisations","text":"<p>Gains de performance moyens constat\u00e9s: - Gaming (FPS): +5 \u00e0 25% selon la configuration - Temps de d\u00e9marrage: -20 \u00e0 40% (SSD) - Utilisation RAM: -10 \u00e0 30% (services d\u00e9sactiv\u00e9s) - Latence r\u00e9seau: -5 \u00e0 20ms (DNS optimis\u00e9) - R\u00e9activit\u00e9 syst\u00e8me: Am\u00e9lioration notable subjective</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#categories-dactions-de-performance","title":"Cat\u00e9gories d'actions de performance","text":"<p>TwinShell propose 42 actions de performance organis\u00e9es en 5 cat\u00e9gories:</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#1-dns-et-reseau-3-actions-win-perf-001-a-003","title":"1. \ud83c\udf10 DNS et R\u00e9seau (3 actions - WIN-PERF-001 \u00e0 003)","text":"<p>Optimisation de la r\u00e9solution DNS et configuration r\u00e9seau.</p> Action ID Description DNS Configur\u00e9 Latence moyenne Fiabilit\u00e9 WIN-PERF-001 Configurer DNS Google 8.8.8.8 / 8.8.4.4 ~20ms \u2b50\u2b50\u2b50\u2b50\u2b50 WIN-PERF-002 Configurer DNS Cloudflare 1.1.1.1 / 1.0.0.1 ~15ms \u2b50\u2b50\u2b50\u2b50\u2b50 WIN-PERF-003 Configurer DNS Quad9 9.9.9.9 / 149.112.112.112 ~25ms \u2b50\u2b50\u2b50\u2b50 <p>Pourquoi changer de DNS?</p> <p>Le DNS (Domain Name System) convertit les noms de domaine (google.com) en adresses IP. Le DNS par d\u00e9faut de votre FAI est souvent: - Lent (r\u00e9solution 50-100ms) - Non s\u00e9curis\u00e9 (pas de filtrage malware) - Suivi (logs de navigation conserv\u00e9s)</p> <p>Cloudflare 1.1.1.1 (WIN-PERF-002) - RECOMMAND\u00c9: - \u2705 DNS le plus rapide au monde (r\u00e9solution ~15ms) - \u2705 Privacy-first: ne stocke pas les logs de navigation - \u2705 S\u00e9curit\u00e9: protection anti-malware et anti-phishing int\u00e9gr\u00e9e - \u2705 Support DNSSEC et DNS-over-HTTPS - \u2705 R\u00e9seau Anycast mondial (200+ datacenters)</p> <p>Google 8.8.8.8 (WIN-PERF-001): - \u2705 Tr\u00e8s fiable et rapide (~20ms) - \u26a0\ufe0f Google collecte certaines donn\u00e9es anonymis\u00e9es - \u2705 Excellente disponibilit\u00e9 (99.99% uptime)</p> <p>Quad9 9.9.9.9 (WIN-PERF-003): - \u2705 Ax\u00e9 confidentialit\u00e9 (non-profit) - \u2705 Blocage automatique des domaines malveillants - \u26a0\ufe0f L\u00e9g\u00e8rement plus lent (~25ms)</p> <p>Comment tester votre DNS: <pre><code># Mesurer la vitesse de r\u00e9solution DNS\nMeasure-Command {Resolve-DnsName google.com}\n\n# Comparer avant/apr\u00e8s changement DNS\n# Avant (DNS FAI): ~80ms\n# Apr\u00e8s (Cloudflare): ~15ms\n</code></pre></p> <p>Recommandation: WIN-PERF-002 (Cloudflare) pour la majorit\u00e9 des utilisateurs (gaming, navigation, entreprise).</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-plans-dalimentation-4-actions-win-perf-101-a-104","title":"2. \u26a1 Plans d'alimentation (4 actions - WIN-PERF-101 \u00e0 104)","text":"<p>Configuration des plans d'alimentation Windows pour maximiser les performances.</p> Action ID Description CPU Max Impact Recommand\u00e9 pour WIN-PERF-101 Activer Ultimate Performance 100% Maximal Gaming, Workstation WIN-PERF-102 Activer Hautes performances 100% \u00c9lev\u00e9 Usage professionnel WIN-PERF-103 D\u00e9sactiver hibernation N/A Espace disque SSD, serveurs WIN-PERF-104 D\u00e9sactiver veille rapide N/A D\u00e9marrage Workstations <p>Plans d'alimentation expliqu\u00e9s:</p> <p>Ultimate Performance (WIN-PERF-101): - D\u00e9verrouille les performances CPU maximales - D\u00e9sactive les micro-latences d'\u00e9conomie d'\u00e9nergie - CPU reste \u00e0 fr\u00e9quence maximale en permanence - Gain: +5-15% performances CPU dans les t\u00e2ches intensives - Co\u00fbt: Consommation \u00e9lectrique +10-20% - Recommand\u00e9: PC desktop gaming, workstations (pas pour laptops sur batterie)</p> <p>Hautes performances (WIN-PERF-102): - Plan Windows standard pour performances \u00e9lev\u00e9es - CPU peut descendre \u00e0 5% minimum (vs 100% Ultimate) - Bon compromis performances/consommation - Recommand\u00e9: Laptops branch\u00e9s, usage professionnel</p> <p>D\u00e9sactiver hibernation (WIN-PERF-103): - Supprime le fichier <code>hiberfil.sys</code> (4-32 GB selon RAM) - Lib\u00e9ration espace disque: Taille de votre RAM - Perte fonctionnalit\u00e9: Hibernation (mise en veille profonde) - Recommand\u00e9: SSD avec espace limit\u00e9, serveurs</p> <p>D\u00e9sactiver veille rapide (WIN-PERF-104): - D\u00e9sactive Fast Startup de Windows - Am\u00e9liore fiabilit\u00e9 du d\u00e9marrage - Impact: D\u00e9marrage +5-15 secondes - B\u00e9n\u00e9fice: R\u00e9sout probl\u00e8mes de dual-boot, mises \u00e0 jour</p> <p>Comparaison consommation CPU: <pre><code>Plan \u00e9quilibr\u00e9:     CPU 5-100% (variable)\nHautes performances: CPU 5-100% (favorise 100%)\nUltimate Performance: CPU 100% (constant)\n</code></pre></p> <p>Recommandation: - Gaming/Workstation desktop: WIN-PERF-101 (Ultimate) - Laptop professionnel: WIN-PERF-102 (Hautes perf) - SSD limit\u00e9: WIN-PERF-103 (D\u00e9sactiver hibernation)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-services-windows-3-actions-win-perf-201-a-203","title":"3. \ud83d\udee0\ufe0f Services Windows (3 actions - WIN-PERF-201 \u00e0 203)","text":"<p>D\u00e9sactivation de services Windows non essentiels pour lib\u00e9rer ressources.</p> Action ID Description Services d\u00e9sactiv\u00e9s Impact RAM Level WIN-PERF-201 D\u00e9sactiver 200+ services 200+ -500MB \u00e0 -2GB Dangerous WIN-PERF-202 D\u00e9sactiver services t\u00e9l\u00e9m\u00e9trie 12 -100MB Run WIN-PERF-203 D\u00e9sactiver Windows Update Auto 3 -50MB Run <p>WIN-PERF-201: D\u00e9sactiver 200+ services (\u26a0\ufe0f DANGEROUS)</p> <p>Cette action d\u00e9sactive massivement les services Windows non essentiels. \u00c0 utiliser avec PR\u00c9CAUTION!</p> <p>Services d\u00e9sactiv\u00e9s (exemples): - T\u00e9l\u00e9m\u00e9trie: DiagTrack, dmwappushservice - Biom\u00e9trie: WbioSrvc (Windows Biometric Service) - Fonctionnalit\u00e9s cloud: OneSyncSvc, PimIndexMaintenanceSvc - Partage r\u00e9seau: SharedAccess, lmhosts - Services obsol\u00e8tes: Fax, XboxNetApiSvc, XblAuthManager - Services d\u00e9veloppeurs: HyperV (si non utilis\u00e9)</p> <p>Gain de performance: - RAM lib\u00e9r\u00e9e: 500MB \u00e0 2GB - Processus en arri\u00e8re-plan: -50 \u00e0 -100 processus - Temps de d\u00e9marrage: -15 \u00e0 -30%</p> <p>\u26a0\ufe0f ATTENTION - Fonctionnalit\u00e9s affect\u00e9es: - \u274c Windows Hello (reconnaissance faciale, empreinte) - \u274c Synchronisation OneDrive/Microsoft 365 - \u274c Xbox Gaming features - \u274c Partage r\u00e9seau Windows - \u274c Bluetooth (selon config)</p> <p>Recommandation: - \u2705 PC gaming d\u00e9di\u00e9: Recommand\u00e9 (gain FPS notable) - \u2705 Serveur Windows: Recommand\u00e9 (moins de ressources gaspill\u00e9es) - \u274c Laptop professionnel: NON (trop de fonctionnalit\u00e9s perdues) - \u274c D\u00e9butants: NON (risque de dysfonctionnements)</p> <p>WIN-PERF-202: D\u00e9sactiver services t\u00e9l\u00e9m\u00e9trie</p> <p>Approche cibl\u00e9e qui d\u00e9sactive uniquement les services de t\u00e9l\u00e9m\u00e9trie: - DiagTrack (Connected User Experiences and Telemetry) - dmwappushservice (WAP Push Message Routing Service) - SysMain (ancien Superfetch - voir WIN-PERF-301) - 9 autres services de tracking</p> <p>Gain: -100MB RAM, aucune perte de fonctionnalit\u00e9 utilisateur.</p> <p>WIN-PERF-203: D\u00e9sactiver Windows Update automatique</p> <p>D\u00e9sactive les mises \u00e0 jour automatiques de Windows. - B\u00e9n\u00e9fice: Contr\u00f4le total sur les mises \u00e0 jour - Risque: \u26a0\ufe0f Failles de s\u00e9curit\u00e9 si oubli de mise \u00e0 jour manuelle - Recommand\u00e9: Administrateurs syst\u00e8me exp\u00e9riment\u00e9s uniquement</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#4-indexation-et-cache-6-actions-win-perf-301-a-306","title":"4. \ud83d\udcbe Indexation et Cache (6 actions - WIN-PERF-301 \u00e0 306)","text":"<p>Optimisation de l'indexation, cache et fonctionnalit\u00e9s syst\u00e8me.</p> Action ID Description Impact SSD Impact HDD Recommand\u00e9 WIN-PERF-301 D\u00e9sactiver Superfetch/SysMain \u2705 Oui \u274c Non SSD uniquement WIN-PERF-302 D\u00e9sactiver Prefetch \u2705 Oui \u274c Non SSD uniquement WIN-PERF-205 D\u00e9sactiver Windows Search \u2705 Oui \u26a0\ufe0f Selon usage Serveurs, SSD WIN-PERF-303 Vider le cache DNS Temporaire Temporaire D\u00e9pannage WIN-PERF-304 Vider le cache ic\u00f4nes Temporaire Temporaire D\u00e9pannage WIN-PERF-305 Vider le cache Windows Store Temporaire Temporaire D\u00e9pannage <p>Superfetch/SysMain (WIN-PERF-301):</p> <p>Superfetch pr\u00e9charge les applications fr\u00e9quemment utilis\u00e9es en RAM pour acc\u00e9l\u00e9rer leur d\u00e9marrage.</p> <p>Sur HDD (disques durs m\u00e9caniques): - \u2705 Utile: R\u00e9duit le temps de lancement des apps - \u2705 Garder activ\u00e9</p> <p>Sur SSD (disques SSD): - \u274c Inutile: SSD d\u00e9j\u00e0 ultra-rapides (lectures 500 MB/s+) - \u274c Gaspillage RAM: Consomme 100-500MB de RAM - \u274c Usure SSD: \u00c9critures suppl\u00e9mentaires inutiles - \u2705 D\u00c9SACTIVER sur SSD</p> <p>Prefetch (WIN-PERF-302):</p> <p>Similaire \u00e0 Superfetch mais pour les fichiers de d\u00e9marrage. - Sur SSD: D\u00e9sactiver (m\u00eame raisons que Superfetch) - Sur HDD: Garder activ\u00e9</p> <p>Windows Search Indexing (WIN-PERF-205):</p> <p>Service d'indexation de fichiers pour recherche rapide.</p> <p>Impact: - CPU: 5-15% en arri\u00e8re-plan pendant indexation - Disque: Activit\u00e9 I/O constante - Espace: 1-10GB pour base de donn\u00e9es index</p> <p>Recommandation: - \u2705 Serveurs: D\u00e9sactiver (pas d'utilisation de recherche) - \u26a0\ufe0f Workstations: Garder si vous utilisez recherche Windows fr\u00e9quemment - \u2705 Gaming: D\u00e9sactiver (gain FPS pendant indexation)</p> <p>Actions de cache (303-305):</p> <p>Vident les caches temporaires. Utiliser en cas de probl\u00e8me uniquement: - Cache DNS (303): R\u00e9sout probl\u00e8mes de r\u00e9solution de noms - Cache ic\u00f4nes (304): R\u00e9sout ic\u00f4nes corrompues/blanches - Cache Store (305): R\u00e9sout probl\u00e8mes Microsoft Store</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#5-optimisations-gaming-12-actions-win-perf-401-a-412","title":"5. \ud83c\udfae Optimisations Gaming (12 actions - WIN-PERF-401 \u00e0 412)","text":"<p>Optimisations sp\u00e9cifiques pour le gaming et performances graphiques.</p> Action ID Description Impact FPS Compatibilit\u00e9 Recommand\u00e9 WIN-PERF-401 D\u00e9sactiver HAGS +0 \u00e0 +10% Nvidia/AMD Si micro-stutters WIN-PERF-402 Activer Game Mode +2 \u00e0 8% Tous GPU Oui WIN-PERF-403 R\u00e9duire latence souris Meilleure r\u00e9activit\u00e9 Tous Gamers comp\u00e9titifs WIN-PERF-404 Optimiser performances jeux +5 \u00e0 15% Tous Oui WIN-PERF-405 Limiter Defender CPU 25% +3 \u00e0 10% Tous Oui WIN-PERF-406 D\u00e9sactiver DVR Xbox +2 \u00e0 5% Tous Oui WIN-PERF-407 Optimiser priorit\u00e9 GPU +0 \u00e0 5% Tous Oui WIN-PERF-408 D\u00e9sactiver Fullscreen Opt Selon jeu Tous Tests requis WIN-PERF-409 Activer MSI Mode GPU +0 \u00e0 5% Nvidia/AMD Avanc\u00e9 WIN-PERF-410 Optimiser NVIDIA Control Panel +2 \u00e0 8% Nvidia uniquement Oui WIN-PERF-411 Optimiser AMD Adrenalin +2 \u00e0 8% AMD uniquement Oui WIN-PERF-412 D\u00e9sactiver Nagle Algorithm R\u00e9duit latence Tous Gaming en ligne <p>HAGS - Hardware Accelerated GPU Scheduling (WIN-PERF-401):</p> <p>HAGS permet au GPU de g\u00e9rer sa propre m\u00e9moire vid\u00e9o au lieu de passer par le CPU.</p> <p>Quand D\u00c9SACTIVER HAGS: - \u2705 Micro-stutters dans certains jeux (Warzone, Apex Legends) - \u2705 Instabilit\u00e9 graphique - \u2705 GPU Nvidia GTX 10xx ou plus ancien</p> <p>Quand GARDER HAGS: - \u2705 GPU r\u00e9cent (Nvidia RTX 30xx/40xx, AMD RX 6000/7000) - \u2705 Aucun probl\u00e8me de stabilit\u00e9 - \u2705 Jeux DirectX 12 r\u00e9cents</p> <p>Game Mode (WIN-PERF-402):</p> <p>Mode Windows 10/11 qui priorise les ressources pour le jeu en cours.</p> <p>B\u00e9n\u00e9fices: - Priorit\u00e9 CPU/GPU pour le jeu - D\u00e9sactive notifications en jeu - R\u00e9duit activit\u00e9 en arri\u00e8re-plan - Gain moyen: +2 \u00e0 8% FPS</p> <p>Recommand\u00e9: Activ\u00e9 pour TOUS les gamers.</p> <p>Latence souris (WIN-PERF-403):</p> <p>R\u00e9duit la latence entre mouvement physique souris et mouvement \u00e0 l'\u00e9cran.</p> <p>Modifications: - D\u00e9sactive acceleration souris - R\u00e9duit d\u00e9lai double-clic - Configure taux polling souris - Gain: 5-15ms de latence en moins</p> <p>Recommand\u00e9: Gamers FPS comp\u00e9titifs (CS2, Valorant, Overwatch).</p> <p>Limiter Windows Defender CPU (WIN-PERF-405):</p> <p>Limite l'utilisation CPU de Windows Defender \u00e0 25% maximum.</p> <p>Probl\u00e8me r\u00e9solu: - Defender peut utiliser 30-50% CPU pendant scans - Cause drops de FPS massifs (60 \u2192 30 FPS)</p> <p>Solution: - Limite Defender \u00e0 25% CPU max - Gain: \u00c9limine les drops de FPS caus\u00e9s par Defender - S\u00e9curit\u00e9: Defender reste actif, juste moins agressif</p> <p>Recommand\u00e9: TOUS les gamers (action sans risque).</p> <p>D\u00e9sactiver Fullscreen Optimizations (WIN-PERF-408):</p> <p>Windows 10/11 force certains jeux en mode \"Borderless Fullscreen\" au lieu de \"Fullscreen exclusif\".</p> <p>Impact: - Borderless: Meilleure compatibilit\u00e9 multi-\u00e9crans, ALT+TAB rapide - Fullscreen exclusif: Meilleures performances, moins de latence</p> <p>Recommandation: - \u2705 D\u00e9sactiver optimizations pour jeux comp\u00e9titifs (CS2, Valorant) - \u274c Garder activ\u00e9 pour usage multi-\u00e9crans</p> <p>Nagle Algorithm (WIN-PERF-412):</p> <p>Algorithme TCP qui regroupe les petits paquets r\u00e9seau pour optimiser bande passante.</p> <p>Probl\u00e8me pour gaming: - Introduit latence 20-200ms - Mauvais pour jeux en temps r\u00e9el</p> <p>Solution: - D\u00e9sactiver Nagle pour gaming en ligne - Gain: -10 \u00e0 -50ms de latence r\u00e9seau</p> <p>Recommand\u00e9: Gaming en ligne comp\u00e9titif.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#batches-de-performance-predefinis","title":"\ud83c\udfaf Batches de performance pr\u00e9d\u00e9finis","text":"<p>TwinShell inclut 3 batches pr\u00e9d\u00e9finis orient\u00e9s performance:</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#1-optimisation-gaming-8-actions","title":"1. \ud83c\udfae Optimisation Gaming (8 actions)","text":"<p>Actions incluses: 1. WIN-DEBLOAT-205 - Supprimer Xbox 2. WIN-PRIVACY-202 - D\u00e9sactiver Game DVR 3. WIN-PERF-002 - DNS Cloudflare 4. WIN-PERF-101 - Ultimate Performance 5. WIN-PERF-201 - D\u00e9sactiver 200+ services 6. WIN-PERF-401 - D\u00e9sactiver HAGS 7. WIN-PERF-404 - Optimiser performances jeux 8. WIN-PERF-405 - Limiter Defender CPU</p> <p>Gain FPS moyen: +15 \u00e0 30% selon configuration</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-performance-serveur-7-actions","title":"2. \u26a1 Performance serveur (7 actions)","text":"<p>Actions incluses: 1. WIN-PERF-002 - DNS Cloudflare 2. WIN-PERF-101 - Ultimate Performance 3. WIN-PERF-103 - D\u00e9sactiver hibernation 4. WIN-PERF-201 - D\u00e9sactiver services 5. WIN-PERF-205 - D\u00e9sactiver indexation 6. WIN-PERF-301 - D\u00e9sactiver Superfetch 7. WIN-PERF-405 - Limiter Defender CPU</p> <p>B\u00e9n\u00e9fice: -30% utilisation ressources, +25% r\u00e9activit\u00e9</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-performance-maximale-8-actions","title":"3. \u26a1 Performance maximale (8 actions)","text":"<p>Configuration extr\u00eame pour PC d\u00e9di\u00e9s performance pure.</p> <p>Gain: Performances maximales absolues Risque: Perte de fonctionnalit\u00e9s (Windows Hello, Xbox, synchronisation)</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#benchmarks-et-tests-de-performance","title":"\ud83d\udcca Benchmarks et tests de performance","text":"<p>Configuration de test: - CPU: AMD Ryzen 7 5800X / Intel i7-12700K - GPU: Nvidia RTX 3070 / AMD RX 6800 - RAM: 16GB DDR4 3200MHz - Stockage: SSD NVMe 1TB</p> <p>R\u00e9sultats avant/apr\u00e8s optimisation compl\u00e8te:</p> M\u00e9trique Avant Apr\u00e8s Am\u00e9lioration FPS Cyberpunk 2077 65 78 +20% FPS Warzone 110 128 +16% FPS CS2 240 275 +15% Temps d\u00e9marrage 45s 28s -38% RAM utilis\u00e9e (idle) 5.2GB 3.1GB -40% Processus actifs 180 95 -47% Latence DNS 82ms 14ms -83% Input lag souris 22ms 8ms -64% <p>Note: R\u00e9sultats variables selon configuration mat\u00e9rielle et logiciels install\u00e9s.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#precautions-pour-optimisations-performance","title":"\u26a0\ufe0f Pr\u00e9cautions pour optimisations performance","text":"<p>Actions Dangerous: - WIN-PERF-201 (200+ services): Peut affecter Bluetooth, biom\u00e9trie, partage r\u00e9seau - Toujours cr\u00e9er un point de restauration avant</p> <p>Actions sp\u00e9cifiques mat\u00e9riel: - WIN-PERF-301/302 (Superfetch/Prefetch): SSD uniquement - WIN-PERF-410 (Nvidia): GPU Nvidia requis - WIN-PERF-411 (AMD): GPU AMD requis</p> <p>Tests recommand\u00e9s apr\u00e8s optimisation: - V\u00e9rifier fonctionnalit\u00e9s critiques (Bluetooth, r\u00e9seau, audio) - Tester jeux/apps principales - Monitorer temp\u00e9ratures CPU/GPU - V\u00e9rifier stabilit\u00e9 syst\u00e8me 48h</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#presets-configurations-predefinies","title":"Presets - Configurations pr\u00e9d\u00e9finies","text":"<p>TwinShell propose 6 batches pr\u00e9d\u00e9finis couvrant les cas d'usage les plus courants. Ces presets combinent intelligemment les 100+ actions disponibles pour des r\u00e9sultats optimaux en un clic.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#vue-densemble-des-presets","title":"\ud83d\udce6 Vue d'ensemble des presets","text":"Preset Actions Cible Impact Risque \ud83c\udfae Optimisation Gaming 8 Gamers \u00c9lev\u00e9 (FPS) Mod\u00e9r\u00e9 \ud83d\udd12 Confidentialit\u00e9 maximale 7 Entreprises RGPD Maximal (Privacy) Faible \u26a1 Performance serveur 7 Serveurs/Workstations \u00c9lev\u00e9 (Ressources) Mod\u00e9r\u00e9 \ud83e\uddf9 Debloat entreprise 7 D\u00e9ploiements pro Mod\u00e9r\u00e9 (Nettoyage) Faible \ud83c\udfe2 Poste de travail 6 Bureautique \u00c9quilibr\u00e9 Tr\u00e8s faible \u26a1 Performance maximale 8 Power users Maximal (Perf) \u00c9lev\u00e9"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-optimisation-gaming","title":"\ud83c\udfae Preset: Optimisation Gaming","text":"<p>Objectif: Maximiser les FPS et r\u00e9duire la latence pour le gaming comp\u00e9titif.</p> <p>Actions incluses (8):</p> <ol> <li>WIN-DEBLOAT-205 - Supprimer Xbox et composants Gaming</li> <li>Supprime Xbox App, Game Bar, Game DVR</li> <li>Lib\u00e8re 500MB-1GB RAM</li> <li> <p>Temps: ~2 minutes</p> </li> <li> <p>WIN-PRIVACY-202 - D\u00e9sactiver Game DVR</p> </li> <li>D\u00e9sactive l'enregistrement automatique de clips</li> <li>Gain FPS: +2 \u00e0 5%</li> <li> <p>Temps: ~30 secondes</p> </li> <li> <p>WIN-PERF-002 - DNS Cloudflare 1.1.1.1</p> </li> <li>R\u00e9duit latence r\u00e9seau de 80ms \u2192 15ms</li> <li>Am\u00e9liore temps de chargement multijoueur</li> <li> <p>Temps: ~15 secondes</p> </li> <li> <p>WIN-PERF-101 - Plan Ultimate Performance</p> </li> <li>CPU \u00e0 fr\u00e9quence max constante</li> <li>Gain performances: +5-15% t\u00e2ches CPU-intensives</li> <li> <p>Temps: ~20 secondes</p> </li> <li> <p>WIN-PERF-201 - D\u00e9sactiver 200+ services</p> </li> <li>\u26a0\ufe0f Action Dangerous</li> <li>Lib\u00e8re 500MB-2GB RAM</li> <li>Gain FPS: +5-10%</li> <li> <p>Temps: ~3 minutes</p> </li> <li> <p>WIN-PERF-401 - D\u00e9sactiver HAGS</p> </li> <li>R\u00e9duit micro-stutters sur certains GPU</li> <li>Am\u00e9liore frame-times</li> <li> <p>Temps: ~15 secondes</p> </li> <li> <p>WIN-PERF-404 - Optimiser performances jeux</p> </li> <li>Active Game Mode Windows</li> <li>Configure priorit\u00e9s GPU</li> <li>Gain FPS: +2-8%</li> <li> <p>Temps: ~30 secondes</p> </li> <li> <p>WIN-PERF-405 - Limiter Defender CPU 25%</p> </li> <li>\u00c9limine drops FPS caus\u00e9s par scans</li> <li>Temps: ~20 secondes</li> </ol> <p>R\u00e9sultat attendu: - FPS: +15 \u00e0 30% (jeux GPU-bound) - Latence r\u00e9seau: -50 \u00e0 70ms - RAM lib\u00e9r\u00e9e: 1 \u00e0 2.5GB - Temps total d'ex\u00e9cution: ~7 minutes</p> <p>Recommand\u00e9 pour: - \u2705 PC gaming desktop - \u2705 Gamers comp\u00e9titifs (FPS, MOBA, Battle Royale) - \u2705 Streamers gaming - \u274c Laptops gaming (perte autonomie avec Ultimate Performance)</p> <p>Fonctionnalit\u00e9s perdues: - \u274c Xbox App et Game Bar - \u274c Enregistrement automatique de clips - \u274c Services biom\u00e9triques (Windows Hello) - \u274c Synchronisation cloud Microsoft</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-confidentialite-maximale","title":"\ud83d\udd12 Preset: Confidentialit\u00e9 maximale","text":"<p>Objectif: Configuration RGPD stricte pour entreprises et utilisateurs soucieux de confidentialit\u00e9.</p> <p>Actions incluses (7):</p> <ol> <li>WIN-PRIVACY-009 - D\u00e9sactiver toutes permissions apps</li> <li>Bloque acc\u00e8s: localisation, cam\u00e9ra, micro, fichiers, contacts, calendrier, emails</li> <li>Conformit\u00e9 RGPD Art. 6 et 25</li> <li> <p>Temps: ~1 minute</p> </li> <li> <p>WIN-PRIVACY-101 - D\u00e9sactiver synchronisation cloud</p> </li> <li>Stoppe sync: param\u00e8tres, mots de passe, favoris, th\u00e8mes</li> <li>Emp\u00eache transfert donn\u00e9es hors UE (RGPD Art. 44)</li> <li> <p>Temps: ~30 secondes</p> </li> <li> <p>WIN-PRIVACY-205 - T\u00e9l\u00e9m\u00e9trie minimale (Security only)</p> </li> <li>\u26a0\ufe0f Action Dangerous</li> <li>D\u00e9sactive 50+ cl\u00e9s registre t\u00e9l\u00e9m\u00e9trie</li> <li>D\u00e9sactive 6+ t\u00e2ches planifi\u00e9es collecte de donn\u00e9es</li> <li>Configure t\u00e9l\u00e9m\u00e9trie niveau 0 (Security)</li> <li> <p>Temps: ~2 minutes</p> </li> <li> <p>WIN-PRIVACY-206 - D\u00e9sactiver reconnaissance vocale cloud</p> </li> <li>D\u00e9sactive Cortana, dict\u00e9e cloud</li> <li>Prot\u00e8ge conversations priv\u00e9es</li> <li> <p>Temps: ~30 secondes</p> </li> <li> <p>WIN-DEBLOAT-204 - D\u00e9sinstaller Copilot</p> </li> <li>Supprime assistant IA Windows</li> <li>\u00c9vite collecte de donn\u00e9es par IA</li> <li> <p>Temps: ~1 minute</p> </li> <li> <p>WIN-DEBLOAT-202 - D\u00e9sinstaller OneDrive</p> </li> <li>\u26a0\ufe0f Action Dangerous</li> <li>Suppression compl\u00e8te + nettoyage registre</li> <li>\u00c9limine synchronisation cloud forc\u00e9e</li> <li> <p>Temps: ~2 minutes</p> </li> <li> <p>WIN-DEBLOAT-301 - D\u00e9sactiver Consumer Features</p> </li> <li>Bloque installation auto apps sugg\u00e9r\u00e9es</li> <li>Emp\u00eache r\u00e9installation bloatware apr\u00e8s mises \u00e0 jour</li> <li>Temps: ~20 secondes</li> </ol> <p>R\u00e9sultat attendu: - T\u00e9l\u00e9m\u00e9trie: 0 (niveau Security uniquement) - Trafic r\u00e9seau: -60% (arr\u00eat synchronisation et tracking) - Conformit\u00e9 RGPD: \u2705 Articles 5, 6, 25, 32, 44 - Temps total: ~7 minutes</p> <p>Recommand\u00e9 pour: - \u2705 Entreprises europ\u00e9ennes (RGPD obligatoire) - \u2705 Organisations manipulant donn\u00e9es sensibles - \u2705 Administrations publiques - \u2705 Utilisateurs soucieux de vie priv\u00e9e</p> <p>Fonctionnalit\u00e9s perdues: - \u274c Synchronisation entre appareils - \u274c OneDrive (cloud storage Microsoft) - \u274c Copilot (assistant IA) - \u274c Cortana (assistant vocal) - \u274c Certaines fonctionnalit\u00e9s Windows Update (compatibilit\u00e9 maintenue)</p> <p>Audit RGPD post-configuration: <pre><code># V\u00e9rifier t\u00e9l\u00e9m\u00e9trie = 0\nGet-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name AllowTelemetry\n\n# V\u00e9rifier services tracking d\u00e9sactiv\u00e9s\nGet-Service DiagTrack, dmwappushservice | Select-Object Name, Status, StartType\n\n# V\u00e9rifier t\u00e2ches t\u00e9l\u00e9m\u00e9trie d\u00e9sactiv\u00e9es\nGet-ScheduledTask | Where-Object {$_.TaskName -like \"*Compat*\" -or $_.TaskName -like \"*Telemetry*\"}\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-performance-serveur","title":"\u26a1 Preset: Performance serveur","text":"<p>Objectif: Optimiser serveurs Windows et workstations pour charge continue.</p> <p>Actions incluses (7):</p> <ol> <li>WIN-PERF-002 - DNS Cloudflare</li> <li>WIN-PERF-101 - Ultimate Performance</li> <li>WIN-PERF-103 - D\u00e9sactiver hibernation</li> <li>WIN-PERF-201 - D\u00e9sactiver 200+ services</li> <li>WIN-PERF-205 - D\u00e9sactiver indexation Windows Search</li> <li>WIN-PERF-301 - D\u00e9sactiver Superfetch</li> <li>WIN-PERF-405 - Limiter Defender CPU</li> </ol> <p>R\u00e9sultat attendu: - RAM lib\u00e9r\u00e9e: 1.5 \u00e0 3GB - CPU idle: -20 \u00e0 40% - R\u00e9activit\u00e9: +25% - Espace disque: +4 \u00e0 32GB (hibernation)</p> <p>Recommand\u00e9 pour: Windows Server 2019/2022, workstations pro, serveurs CI/CD.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-debloat-complet-entreprise","title":"\ud83e\uddf9 Preset: Debloat complet entreprise","text":"<p>Objectif: Configuration propre pour d\u00e9ploiements en entreprise.</p> <p>Actions incluses (7):</p> <ol> <li>WIN-DEBLOAT-001 - Supprimer bloatware tiers (Candy Crush, Spotify, etc.)</li> <li>WIN-DEBLOAT-101 - Supprimer 38+ apps Microsoft inutiles</li> <li>WIN-DEBLOAT-204 - D\u00e9sinstaller Copilot</li> <li>WIN-DEBLOAT-206 - Supprimer Widgets</li> <li>WIN-DEBLOAT-301 - D\u00e9sactiver Consumer Features</li> <li>WIN-PRIVACY-101 - D\u00e9sactiver synchronisation cloud</li> <li>WIN-PRIVACY-205 - T\u00e9l\u00e9m\u00e9trie minimale</li> </ol> <p>R\u00e9sultat attendu: - Espace disque: +5 \u00e0 12GB - Apps supprim\u00e9es: 40+ bloatware - Interface: \u00c9pur\u00e9e et professionnelle</p> <p>Recommand\u00e9 pour: D\u00e9ploiements GPO entreprise, images Windows standardis\u00e9es, parcs informatiques.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-configuration-poste-de-travail-standard","title":"\ud83c\udfe2 Preset: Configuration poste de travail standard","text":"<p>Objectif: Configuration \u00e9quilibr\u00e9e pour bureautique professionnelle.</p> <p>Actions incluses (6):</p> <ol> <li>WIN-DEBLOAT-001 - Supprimer bloatware tiers</li> <li>WIN-PRIVACY-009 - Limiter permissions apps</li> <li>WIN-PRIVACY-205 - T\u00e9l\u00e9m\u00e9trie minimale</li> <li>WIN-PERF-002 - DNS Cloudflare</li> <li>WIN-PERF-102 - Plan Hautes performances</li> <li>WIN-PERF-405 - Limiter Defender CPU</li> </ol> <p>R\u00e9sultat attendu: - Configuration s\u00e9curis\u00e9e et performante - Conserve fonctionnalit\u00e9s essentielles (OneDrive, Microsoft Store) - Am\u00e9liore confidentialit\u00e9 sans perte de productivit\u00e9</p> <p>Recommand\u00e9 pour: - \u2705 Postes de travail bureautique - \u2705 Laptops professionnels - \u2705 Utilisateurs non-techniques - \u2705 PME sans contraintes RGPD strictes</p> <p>Avantages: - \u2705 Risque minimal (aucune action Dangerous) - \u2705 Temps d'ex\u00e9cution: ~4 minutes - \u2705 Compatibilit\u00e9 maximale - \u2705 Am\u00e9lioration notable sans compromis</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#preset-performance-maximale","title":"\u26a1 Preset: Performance maximale","text":"<p>Objectif: Configuration extr\u00eame pour PC d\u00e9di\u00e9s performance pure.</p> <p>\u26a0\ufe0f AVERTISSEMENT: Preset le plus agressif, perte de nombreuses fonctionnalit\u00e9s.</p> <p>Actions incluses (8):</p> <ol> <li>WIN-PERF-002 - DNS Cloudflare</li> <li>WIN-PERF-101 - Ultimate Performance</li> <li>WIN-PERF-103 - D\u00e9sactiver hibernation</li> <li>WIN-PERF-201 - \u26a0\ufe0f D\u00e9sactiver 200+ services</li> <li>WIN-PERF-301 - D\u00e9sactiver Superfetch</li> <li>WIN-PERF-302 - D\u00e9sactiver Prefetch</li> <li>WIN-PERF-404 - Optimiser performances jeux</li> <li>WIN-PERF-405 - Limiter Defender CPU</li> </ol> <p>R\u00e9sultat attendu: - Performances: MAXIMALES (tous param\u00e8tres optimis\u00e9s) - RAM lib\u00e9r\u00e9e: 1.5 \u00e0 3GB - Processus: -50 \u00e0 -100 processus arri\u00e8re-plan</p> <p>Recommand\u00e9 pour: PC gaming desktop uniquement, benchmarking, overclocking.</p> <p>NON recommand\u00e9 pour: Laptops, usage professionnel, d\u00e9butants.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#quel-preset-choisir","title":"\ud83c\udfaf Quel preset choisir?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Guide de s\u00e9lection                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                         \u2502\n\u2502  Vous \u00eates un GAMER?                                    \u2502\n\u2502  \u251c\u2500 PC Desktop d\u00e9di\u00e9 \u2192 \ud83c\udfae Optimisation Gaming          \u2502\n\u2502  \u251c\u2500 Laptop gaming \u2192 \ud83c\udfe2 Poste de travail (+ actions gaming manuelles) \u2502\n\u2502  \u2514\u2500 Performances max \u00e0 tout prix \u2192 \u26a1 Performance maximale \u2502\n\u2502                                                         \u2502\n\u2502  Vous \u00eates une ENTREPRISE?                              \u2502\n\u2502  \u251c\u2500 RGPD strict requis \u2192 \ud83d\udd12 Confidentialit\u00e9 maximale   \u2502\n\u2502  \u251c\u2500 D\u00e9ploiement standardis\u00e9 \u2192 \ud83e\uddf9 Debloat entreprise    \u2502\n\u2502  \u2514\u2500 Bureautique classique \u2192 \ud83c\udfe2 Poste de travail        \u2502\n\u2502                                                         \u2502\n\u2502  Vous g\u00e9rez des SERVEURS?                               \u2502\n\u2502  \u2514\u2500 Windows Server/Workstation \u2192 \u26a1 Performance serveur \u2502\n\u2502                                                         \u2502\n\u2502  Vous \u00eates SOUCIEUX DE VIE PRIV\u00c9E?                      \u2502\n\u2502  \u2514\u2500 Protection maximale \u2192 \ud83d\udd12 Confidentialit\u00e9 maximale  \u2502\n\u2502                                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#personnaliser-un-preset","title":"\ud83d\udd27 Personnaliser un preset","text":"<p>Vous pouvez cr\u00e9er votre propre batch personnalis\u00e9 en combinant des actions:</p> <p>Exemple: Gaming + Confidentialit\u00e9 <pre><code>Batch Custom \"Gaming Priv\u00e9\":\n\u251c\u2500 \ud83c\udfae Actions gaming\n\u2502  \u251c\u2500 WIN-PERF-002 (DNS Cloudflare)\n\u2502  \u251c\u2500 WIN-PERF-101 (Ultimate Performance)\n\u2502  \u251c\u2500 WIN-PERF-404 (Game Mode)\n\u2502  \u2514\u2500 WIN-PERF-405 (Limiter Defender)\n\u2502\n\u2514\u2500 \ud83d\udd12 Actions confidentialit\u00e9\n   \u251c\u2500 WIN-PRIVACY-009 (Permissions apps)\n   \u251c\u2500 WIN-PRIVACY-101 (Sync cloud)\n   \u2514\u2500 WIN-PRIVACY-205 (T\u00e9l\u00e9m\u00e9trie minimale)\n</code></pre></p> <p>Via TwinShell: 1. Menu principal \u2192 \"Batches\" 2. \"Cr\u00e9er un nouveau batch\" 3. S\u00e9lectionner les actions souhait\u00e9es 4. D\u00e9finir l'ordre d'ex\u00e9cution 5. Sauvegarder et ex\u00e9cuter</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#temps-dexecution-des-presets","title":"\u23f1\ufe0f Temps d'ex\u00e9cution des presets","text":"Preset Dur\u00e9e Red\u00e9marrage requis \ud83c\udfae Gaming ~7 min \u2705 Oui \ud83d\udd12 Confidentialit\u00e9 ~7 min \u2705 Oui \u26a1 Serveur ~6 min \u2705 Oui \ud83e\uddf9 Entreprise ~8 min \u2705 Oui \ud83c\udfe2 Poste travail ~4 min \u26a0\ufe0f Recommand\u00e9 \u26a1 Performance max ~6 min \u2705 Oui <p>Note: Red\u00e9marrage n\u00e9cessaire pour que toutes les modifications prennent effet.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#precautions-et-recommandations","title":"Pr\u00e9cautions et recommandations","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#avant-de-commencer","title":"Avant de commencer","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#1-creer-un-point-de-restauration-systeme","title":"1. Cr\u00e9er un point de restauration syst\u00e8me","text":"<pre><code># Via TwinShell ou manuellement\nEnable-ComputerRestore -Drive \"C:\\\"\nCheckpoint-Computer -Description \"Avant debloating TwinShell\" -RestorePointType \"MODIFY_SETTINGS\"\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-sauvegarder-le-registre","title":"2. Sauvegarder le registre","text":"<p>Les actions de debloating modifient le registre Windows. Sauvegardez-le:</p> <pre><code># Exporter le registre complet\nreg export HKLM C:\\Backup\\HKLM_backup.reg /y\nreg export HKCU C:\\Backup\\HKCU_backup.reg /y\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-documenter-votre-configuration","title":"3. Documenter votre configuration","text":"<p>Avant de supprimer des apps, listez-les:</p> <pre><code># Utiliser WIN-DEBLOAT-003\nGet-AppxPackage | Select-Object Name,Version,Publisher | Export-Csv C:\\Backup\\installed_apps.csv\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#ordre-recommande-dexecution","title":"Ordre recommand\u00e9 d'ex\u00e9cution","text":"<p>Pour un debloating complet et s\u00e9curis\u00e9:</p> <ol> <li>Information \u2192 WIN-DEBLOAT-003 (lister les apps tierces)</li> <li>Bloatware tiers \u2192 WIN-DEBLOAT-001 (supprimer bloatware)</li> <li>Apps Microsoft \u2192 WIN-DEBLOAT-101/102/103/104 (au choix)</li> <li>Fonctionnalit\u00e9s \u2192 WIN-DEBLOAT-301 (d\u00e9sactiver Consumer Features)</li> <li>Optimisation Edge \u2192 WIN-DEBLOAT-401/402/403/404 (si Edge conserv\u00e9)</li> <li>Composants syst\u00e8me \u2192 WIN-DEBLOAT-201-206 (DANGER - uniquement si n\u00e9cessaire)</li> </ol>"},{"location":"developer/OPTIMISATION-WINDOWS/#profils-dutilisation-recommandes","title":"Profils d'utilisation recommand\u00e9s","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#profil-securise-recommande-pour-la-plupart-des-utilisateurs","title":"Profil \"S\u00e9curis\u00e9\" (Recommand\u00e9 pour la plupart des utilisateurs)","text":"<p>Actions \u00e0 ex\u00e9cuter: - WIN-DEBLOAT-001 (Bloatware tiers) - WIN-DEBLOAT-102 (Apps de jeux) - WIN-DEBLOAT-104 (Apps m\u00e9t\u00e9o/actualit\u00e9s) - WIN-DEBLOAT-301 (Consumer Features) - WIN-DEBLOAT-401/402/403 (Optimisation Edge)</p> <p>Gain estim\u00e9: 2-5 GB d'espace, am\u00e9lioration mod\u00e9r\u00e9e des performances.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#profil-avance-pour-utilisateurs-experimentes","title":"Profil \"Avanc\u00e9\" (Pour utilisateurs exp\u00e9riment\u00e9s)","text":"<p>Actions suppl\u00e9mentaires: - WIN-DEBLOAT-101 (Toutes les apps Microsoft) - WIN-DEBLOAT-302 (Recall) - WIN-DEBLOAT-303 (Internet Explorer) - WIN-DEBLOAT-206 (Widgets)</p> <p>Gain estim\u00e9: 5-10 GB d'espace, am\u00e9lioration significative des performances.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#profil-extreme-danger-experts-uniquement","title":"Profil \"Extr\u00eame\" (\u26a0\ufe0f DANGER - Experts uniquement)","text":"<p>Actions suppl\u00e9mentaires: - WIN-DEBLOAT-202 (OneDrive) - WIN-DEBLOAT-204 (Copilot) - WIN-DEBLOAT-205 (Xbox)</p> <p>NE PAS UTILISER: - WIN-DEBLOAT-201 (Microsoft Store) - Tr\u00e8s difficile \u00e0 restaurer - WIN-DEBLOAT-203 (Microsoft Edge) - Peut casser Windows 11</p> <p>Gain estim\u00e9: 10-15 GB d'espace, performances maximales, mais risque \u00e9lev\u00e9.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#rollback-et-recuperation","title":"Rollback et r\u00e9cup\u00e9ration","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#methodes-de-recuperation-par-ordre-de-preference","title":"M\u00e9thodes de r\u00e9cup\u00e9ration par ordre de pr\u00e9f\u00e9rence","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#1-restauration-systeme-recommande","title":"1. Restauration syst\u00e8me (Recommand\u00e9)","text":"<p>Si vous avez cr\u00e9\u00e9 un point de restauration:</p> <pre><code># Lister les points de restauration\nGet-ComputerRestorePoint\n\n# Restaurer (via l'interface graphique)\nrstrui.exe\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#2-reinstallation-via-microsoft-store","title":"2. R\u00e9installation via Microsoft Store","text":"<p>Pour les apps Microsoft supprim\u00e9es:</p> <pre><code># R\u00e9installer une app sp\u00e9cifique (si Store disponible)\nGet-AppxPackage -AllUsers | Where-Object {$_.Name -like \"*AppName*\"} | ForEach-Object {Add-AppxPackage -DisableDevelopmentMode -Register \"$($_.InstallLocation)\\AppxManifest.xml\"}\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#3-reinstallation-de-composants-critiques","title":"3. R\u00e9installation de composants critiques","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#microsoft-store","title":"Microsoft Store","text":"<pre><code># Via PowerShell (n\u00e9cessite connexion Internet)\nwsreset.exe\nGet-AppxPackage *WindowsStore* -AllUsers | ForEach-Object {Add-AppxPackage -DisableDevelopmentMode -Register \"$($_.InstallLocation)\\AppxManifest.xml\"}\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#onedrive","title":"OneDrive","text":"<pre><code># T\u00e9l\u00e9charger et r\u00e9installer OneDrive\nStart-Process \"https://go.microsoft.com/fwlink/?linkid=844652\"\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#microsoft-edge","title":"Microsoft Edge","text":"<pre><code># T\u00e9l\u00e9charger Edge depuis le site officiel\nStart-Process \"https://www.microsoft.com/edge\"\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#4-annulation-de-modifications-registre","title":"4. Annulation de modifications registre","text":"<p>Si vous avez sauvegard\u00e9 le registre:</p> <pre><code># Restaurer une cl\u00e9 sp\u00e9cifique\nreg import C:\\Backup\\HKLM_backup.reg\nreg import C:\\Backup\\HKCU_backup.reg\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#5-reparation-windows-dernier-recours","title":"5. R\u00e9paration Windows (Dernier recours)","text":"<p>Si le syst\u00e8me est instable:</p> <pre><code># Scan et r\u00e9paration des fichiers syst\u00e8me\nsfc /scannow\nDISM /Online /Cleanup-Image /RestoreHealth\n</code></pre> <p>Ou via les Param\u00e8tres Windows: - Param\u00e8tres \u2192 Mise \u00e0 jour et s\u00e9curit\u00e9 \u2192 R\u00e9cup\u00e9ration \u2192 R\u00e9initialiser ce PC</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#faq-et-troubleshooting","title":"FAQ et troubleshooting","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#questions-frequentes","title":"Questions fr\u00e9quentes","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#q-quelles-actions-sont-reversibles","title":"Q: Quelles actions sont r\u00e9versibles?","text":"<p>R: Les actions de niveau \"Info\" et \"Run\" sont g\u00e9n\u00e9ralement r\u00e9versibles: - Les apps peuvent \u00eatre r\u00e9install\u00e9es via le Microsoft Store - Les param\u00e8tres de registre peuvent \u00eatre restaur\u00e9s - Les fonctionnalit\u00e9s Windows peuvent \u00eatre r\u00e9activ\u00e9es</p> <p>Les actions \"Dangerous\" (niveau 2) sont difficilement r\u00e9versibles.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#q-puis-je-reinstaller-les-apps-supprimees","title":"Q: Puis-je r\u00e9installer les apps supprim\u00e9es?","text":"<p>R: Oui, si le Microsoft Store est encore install\u00e9: - Ouvrez le Microsoft Store - Recherchez l'application - Cliquez sur \"Installer\"</p> <p>Attention: WIN-DEBLOAT-201 supprime le Store lui-m\u00eame!</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#q-les-actions-de-debloating-affectent-elles-les-mises-a-jour-windows","title":"Q: Les actions de debloating affectent-elles les mises \u00e0 jour Windows?","text":"<p>R: Non, les mises \u00e0 jour Windows fonctionnent normalement. Cependant: - Certaines apps supprim\u00e9es peuvent \u00eatre r\u00e9install\u00e9es lors de mises \u00e0 jour majeures - Utilisez WIN-DEBLOAT-301 (Consumer Features) pour \u00e9viter cela</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#q-quelle-est-la-difference-entre-supprimer-et-desactiver","title":"Q: Quelle est la diff\u00e9rence entre \"supprimer\" et \"d\u00e9sactiver\"?","text":"<p>R: - Supprimer (Remove-AppxPackage): D\u00e9sinstalle compl\u00e8tement l'application - D\u00e9sactiver (registre): L'application reste install\u00e9e mais inactive</p> <p>Les d\u00e9sactivations sont plus faciles \u00e0 annuler.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#q-combien-despace-disque-puis-je-liberer","title":"Q: Combien d'espace disque puis-je lib\u00e9rer?","text":"<p>R: D\u00e9pend du profil choisi: - Profil \"S\u00e9curis\u00e9\": 2-5 GB - Profil \"Avanc\u00e9\": 5-10 GB - Profil \"Extr\u00eame\": 10-15 GB</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#q-le-debloating-ameliore-t-il-vraiment-les-performances","title":"Q: Le debloating am\u00e9liore-t-il vraiment les performances?","text":"<p>R: Oui, mais l'impact d\u00e9pend de votre mat\u00e9riel: - Disque: Moins d'apps = plus d'espace libre - RAM: Moins de services en arri\u00e8re-plan - CPU: Moins de processus actifs - R\u00e9seau: Moins de t\u00e9l\u00e9m\u00e9trie et synchronisation</p> <p>Sur un PC moderne, l'am\u00e9lioration est mod\u00e9r\u00e9e. Sur un PC ancien, elle peut \u00eatre significative.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#problemes-courants","title":"Probl\u00e8mes courants","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-acces-refuse-lors-de-lexecution","title":"Probl\u00e8me: \"Acc\u00e8s refus\u00e9\" lors de l'ex\u00e9cution","text":"<p>Solution: <pre><code># Ex\u00e9cuter PowerShell en tant qu'administrateur\n# Clic droit sur l'ic\u00f4ne PowerShell \u2192 \"Ex\u00e9cuter en tant qu'administrateur\"\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-lapplication-na-pas-ete-supprimee","title":"Probl\u00e8me: L'application n'a pas \u00e9t\u00e9 supprim\u00e9e","text":"<p>Causes possibles: 1. L'app est en cours d'ex\u00e9cution 2. L'app est prot\u00e9g\u00e9e par le syst\u00e8me 3. Permissions insuffisantes</p> <p>Solution: <pre><code># 1. Fermer tous les processus li\u00e9s\nGet-Process | Where-Object {$_.Name -like \"*AppName*\"} | Stop-Process -Force\n\n# 2. Essayer avec -AllUsers\nGet-AppxPackage *AppName* -AllUsers | Remove-AppxPackage\n\n# 3. Utiliser l'option provisioned (emp\u00eache la r\u00e9installation)\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -like \"*AppName*\"} | Remove-AppxProvisionedPackage -Online\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-le-microsoft-store-ne-fonctionne-plus","title":"Probl\u00e8me: Le Microsoft Store ne fonctionne plus","text":"<p>Solution: <pre><code># R\u00e9initialiser le cache du Store\nwsreset.exe\n\n# R\u00e9enregistrer le Store\nGet-AppxPackage *WindowsStore* | ForEach-Object {Add-AppxPackage -DisableDevelopmentMode -Register \"$($_.InstallLocation)\\AppxManifest.xml\"}\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-onedrive-continue-de-demarrer","title":"Probl\u00e8me: OneDrive continue de d\u00e9marrer","text":"<p>Solution: <pre><code># D\u00e9sactiver OneDrive au d\u00e9marrage\nreg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v OneDrive /f\nreg delete \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v OneDrive /f\n\n# D\u00e9sactiver OneDrive dans l'Explorateur\nreg add \"HKCR\\CLSID\\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\" /v System.IsPinnedToNameSpaceTree /t REG_DWORD /d 0 /f\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-windows-11-devient-instable-apres-suppression-dedge","title":"Probl\u00e8me: Windows 11 devient instable apr\u00e8s suppression d'Edge","text":"<p>Solution: \u26a0\ufe0f C'est pourquoi WIN-DEBLOAT-203 est DANGEROUS!</p> <p>Windows 11 utilise Edge pour certaines fonctionnalit\u00e9s syst\u00e8me. Options: 1. Restaurer le point de restauration syst\u00e8me 2. R\u00e9installer Edge depuis le site officiel 3. Utiliser les actions WIN-DEBLOAT-401-404 au lieu de supprimer Edge</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#probleme-les-widgets-reviennent-apres-chaque-mise-a-jour","title":"Probl\u00e8me: Les widgets reviennent apr\u00e8s chaque mise \u00e0 jour","text":"<p>Solution: <pre><code># D\u00e9sactiver via GPO (plus persistant)\nreg add \"HKLM\\Software\\Policies\\Microsoft\\Dsh\" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f\n\n# D\u00e9sactiver le service\nGet-Service -Name \"WebExperienceHostPlugin\" | Set-Service -StartupType Disabled\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#obtenir-de-laide","title":"Obtenir de l'aide","text":"<p>Si vous rencontrez des probl\u00e8mes:</p> <ol> <li>V\u00e9rifiez les logs d'erreur:</li> <li>Event Viewer \u2192 Windows Logs \u2192 Application</li> <li> <p>Recherchez les erreurs li\u00e9es \u00e0 l'app supprim\u00e9e</p> </li> <li> <p>Consultez la documentation Microsoft:</p> </li> <li> <p>https://learn.microsoft.com/en-us/powershell/module/appx/</p> </li> <li> <p>Cr\u00e9ez une issue sur GitHub:</p> </li> <li>https://github.com/VBlackJack/TwinShell/issues</li> <li>Incluez:<ul> <li>Action ex\u00e9cut\u00e9e (WIN-DEBLOAT-XXX)</li> <li>Message d'erreur complet</li> <li>Version de Windows (Win 10/11, build)</li> <li>Logs d'erreur si disponibles</li> </ul> </li> </ol>"},{"location":"developer/OPTIMISATION-WINDOWS/#ressources-supplementaires","title":"Ressources suppl\u00e9mentaires","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#scripts-de-reference","title":"Scripts de r\u00e9f\u00e9rence","text":"<p>Les scripts PowerShell utilis\u00e9s par TwinShell sont disponibles dans: - <code>/data/seed/initial-actions.json</code> - D\u00e9finitions des actions - Documentation Microsoft sur Remove-AppxPackage - Documentation Microsoft sur les GPO Windows</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#outils-complementaires","title":"Outils compl\u00e9mentaires","text":"<p>Pour un debloating plus avanc\u00e9, consid\u00e9rez: - Chris Titus Tech Windows Utility - Interface graphique pour debloating - O&amp;O ShutUp10++ - D\u00e9sactivation de fonctionnalit\u00e9s Windows - BleachBit - Nettoyage de fichiers temporaires</p> <p>Note: TwinShell se concentre sur les actions via PowerShell pour une tra\u00e7abilit\u00e9 maximale.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#bonnes-pratiques","title":"Bonnes pratiques","text":"<ol> <li>Testez toujours sur une VM ou machine de test d'abord</li> <li>Documentez chaque action effectu\u00e9e</li> <li>Cr\u00e9ez un point de restauration avant chaque session de debloating</li> <li>Sauvegardez vos donn\u00e9es importantes</li> <li>Lisez les notes de chaque action avant de l'ex\u00e9cuter</li> <li>Ne supprimez pas ce que vous ne comprenez pas</li> <li>Privil\u00e9giez la d\u00e9sactivation \u00e0 la suppression quand c'est possible</li> </ol>"},{"location":"developer/OPTIMISATION-WINDOWS/#annexes","title":"Annexes","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#annexe-a-liste-complete-des-200-services-desactivables-win-perf-201","title":"Annexe A: Liste compl\u00e8te des 200+ services d\u00e9sactivables (WIN-PERF-201)","text":"<p>Cette liste recense les services Windows d\u00e9sactiv\u00e9s par l'action WIN-PERF-201 pour maximiser les performances.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-de-telemetrie-et-diagnostics","title":"Services de t\u00e9l\u00e9m\u00e9trie et diagnostics","text":"<pre><code>DiagTrack (Connected User Experiences and Telemetry)\ndmwappushservice (Device Management Wireless Application Protocol)\nTrkWks (Distributed Link Tracking Client)\nWerSvc (Windows Error Reporting Service)\nPcaSvc (Program Compatibility Assistant)\nSgrmBroker (System Guard Runtime Monitor Broker)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-biometriques-et-securite","title":"Services biom\u00e9triques et s\u00e9curit\u00e9","text":"<pre><code>WbioSrvc (Windows Biometric Service)\nSecurityHealthService (Windows Security Service)\nWdNisSvc (Windows Defender Network Inspection)\nSense (Windows Defender Advanced Threat Protection)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-cloud-et-synchronisation","title":"Services cloud et synchronisation","text":"<pre><code>OneSyncSvc (Sync Host)\nPimIndexMaintenanceSvc (Contact Data)\nUnistoreSvc (User Data Storage)\nUserDataSvc (User Data Access)\nMessagingService (Messaging Service)\nCDPUserSvc (Connected Devices Platform)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-xbox-et-gaming-non-gaming-pc","title":"Services Xbox et gaming (non gaming PC)","text":"<pre><code>XblAuthManager (Xbox Live Auth Manager)\nXblGameSave (Xbox Live Game Save)\nXboxNetApiSvc (Xbox Live Networking Service)\nXboxGipSvc (Xbox Accessory Management Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-de-partage-et-reseau","title":"Services de partage et r\u00e9seau","text":"<pre><code>SharedAccess (Internet Connection Sharing - ICS)\nlmhosts (TCP/IP NetBIOS Helper)\nRemoteRegistry (Remote Registry)\nRemoteAccess (Routing and Remote Access)\nSessionEnv (Remote Desktop Configuration)\nTermService (Remote Desktop Services)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-bluetooth-et-peripheriques","title":"Services Bluetooth et p\u00e9riph\u00e9riques","text":"<pre><code>BTAGService (Bluetooth Audio Gateway Service)\nBthAvctpSvc (AVCTP Service)\nBluetoothUserService (Bluetooth User Support Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-impression-et-fax","title":"Services impression et fax","text":"<pre><code>Spooler (Print Spooler - si pas d'imprimante)\nFax (Fax Service)\nPrintNotify (Printer Extensions and Notifications)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-hyper-v-et-virtualisation","title":"Services Hyper-V et virtualisation","text":"<pre><code>HvHost (HV Host Service)\nvmickvpexchange (Hyper-V Data Exchange Service)\nvmicguestinterface (Hyper-V Guest Service Interface)\nvmicshutdown (Hyper-V Guest Shutdown Service)\nvmicheartbeat (Hyper-V Heartbeat Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-windows-update-selon-config","title":"Services Windows Update (selon config)","text":"<pre><code>wuauserv (Windows Update - si d\u00e9sactiv\u00e9 par WIN-PERF-203)\nUsoSvc (Update Orchestrator Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-recherche-et-indexation","title":"Services recherche et indexation","text":"<pre><code>WSearch (Windows Search - si d\u00e9sactiv\u00e9 par WIN-PERF-205)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-superfetch-et-caching","title":"Services Superfetch et caching","text":"<pre><code>SysMain (Superfetch/SysMain - si d\u00e9sactiv\u00e9 par WIN-PERF-301)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-de-stockage","title":"Services de stockage","text":"<pre><code>StorSvc (Storage Service)\nDsSvc (Data Sharing Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-de-maintenance","title":"Services de maintenance","text":"<pre><code>defragsvc (Optimize Drives)\nDiagnosticHub (Microsoft Diagnostics Hub Standard Collector)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-wi-fi-et-mobile","title":"Services Wi-Fi et mobile","text":"<pre><code>WwanSvc (WWAN AutoConfig - si pas de carte mobile)\nicssvc (Windows Mobile Hotspot Service)\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#services-obsoletes","title":"Services obsol\u00e8tes","text":"<pre><code>WMPNetworkSvc (Windows Media Player Network Sharing)\nSSDPSRV (SSDP Discovery - UPnP)\nupnphost (UPnP Device Host)\n</code></pre> <p>Total: 200+ services d\u00e9sactiv\u00e9s par WIN-PERF-201</p> <p>\u26a0\ufe0f IMPORTANT: Ne pas utiliser cette action si vous d\u00e9pendez de: - Bluetooth - Windows Hello (biom\u00e9trie) - Xbox/Gaming features - Partage r\u00e9seau Windows - Impression r\u00e9seau - Hyper-V/virtualisation</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#annexe-b-tableau-des-modifications-registre","title":"Annexe B: Tableau des modifications registre","text":"<p>Cette annexe documente toutes les cl\u00e9s de registre modifi\u00e9es par les actions TwinShell pour conformit\u00e9 et tra\u00e7abilit\u00e9.</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#b1-modifications-debloat-consumer-features-recall-etc","title":"B.1 - Modifications DEBLOAT (Consumer Features, Recall, etc.)","text":"Action Cl\u00e9 Registre Valeur Type Impact WIN-DEBLOAT-301 <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent</code> <code>DisableWindowsConsumerFeatures = 1</code> DWORD Bloque apps sugg\u00e9r\u00e9es WIN-DEBLOAT-302 <code>HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced</code> <code>DisableRecall = 1</code> DWORD D\u00e9sactive Recall WIN-DEBLOAT-401 <code>HKCU:\\SOFTWARE\\Policies\\Microsoft\\Edge</code> <code>HideFirstRunExperience = 1</code> DWORD D\u00e9sactive recommandations Edge WIN-DEBLOAT-402 <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Edge</code> <code>EdgeShoppingAssistantEnabled = 0</code> DWORD D\u00e9sactive shopping assistant WIN-DEBLOAT-403 <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Edge</code> <code>UserFeedbackAllowed = 0</code> DWORD D\u00e9sactive t\u00e9l\u00e9m\u00e9trie Edge WIN-DEBLOAT-404 <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Edge</code> <code>CryptoWalletEnabled = 0</code> DWORD D\u00e9sactive crypto wallet"},{"location":"developer/OPTIMISATION-WINDOWS/#b2-modifications-privacy-permissions-synchronisation-telemetrie","title":"B.2 - Modifications PRIVACY (Permissions, Synchronisation, T\u00e9l\u00e9m\u00e9trie)","text":"<p>Permissions Applications (001-009): | Action | Cl\u00e9 Registre | Valeur | Effet | |--------|--------------|--------|-------| | WIN-PRIVACY-001 | <code>HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\location</code> | <code>Value = \"Deny\"</code> | Bloque localisation | | WIN-PRIVACY-002 | <code>ConsentStore\\webcam</code> | <code>Value = \"Deny\"</code> | Bloque cam\u00e9ra | | WIN-PRIVACY-003 | <code>ConsentStore\\microphone</code> | <code>Value = \"Deny\"</code> | Bloque microphone | | WIN-PRIVACY-004 | <code>ConsentStore\\broadFileSystemAccess</code> | <code>Value = \"Deny\"</code> | Bloque acc\u00e8s fichiers | | WIN-PRIVACY-005 | <code>ConsentStore\\contacts</code> | <code>Value = \"Deny\"</code> | Bloque contacts | | WIN-PRIVACY-006 | <code>ConsentStore\\appointments</code> | <code>Value = \"Deny\"</code> | Bloque calendrier | | WIN-PRIVACY-007 | <code>ConsentStore\\email</code> | <code>Value = \"Deny\"</code> | Bloque emails | | WIN-PRIVACY-008 | <code>ConsentStore\\userNotificationListener</code> | <code>Value = \"Deny\"</code> | Bloque notifications |</p> <p>Synchronisation Cloud (101-106): | Action | Cl\u00e9 Registre | Valeur | Effet | |--------|--------------|--------|-------| | WIN-PRIVACY-101 | <code>HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync</code> | <code>SyncPolicy = 5</code> (Disabled) | D\u00e9sactive toute sync | | WIN-PRIVACY-102 | <code>SettingSync\\Groups\\Personalization</code> | <code>Enabled = 0</code> | D\u00e9sactive sync param\u00e8tres | | WIN-PRIVACY-103 | <code>Groups\\Appearance</code> | <code>Enabled = 0</code> | D\u00e9sactive sync th\u00e8mes | | WIN-PRIVACY-104 | <code>Groups\\Credentials</code> | <code>Enabled = 0</code> | D\u00e9sactive sync mots de passe | | WIN-PRIVACY-105 | <code>Groups\\BrowserSettings</code> | <code>Enabled = 0</code> | D\u00e9sactive sync navigateur |</p> <p>T\u00e9l\u00e9m\u00e9trie Windows (201-208): | Action | Cl\u00e9 Registre | Valeur | Nombre de cl\u00e9s | |--------|--------------|--------|----------------| | WIN-PRIVACY-205 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection</code> | <code>AllowTelemetry = 0</code> | 50+ cl\u00e9s | | WIN-PRIVACY-201 | <code>HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ActivityFeed</code> | <code>EnableActivityFeed = 0</code> | 3 cl\u00e9s | | WIN-PRIVACY-202 | <code>HKCU:\\System\\GameConfigStore</code> | <code>GameDVR_Enabled = 0</code> | 4 cl\u00e9s | | WIN-PRIVACY-203 | <code>HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager</code> | <code>(7+ cl\u00e9s = 0)</code> | 7 cl\u00e9s | | WIN-PRIVACY-204 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors</code> | <code>DisableLocation = 1</code> | 5 cl\u00e9s | | WIN-PRIVACY-206 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization</code> | <code>AllowInputPersonalization = 0</code> | 8 cl\u00e9s | | WIN-PRIVACY-207 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Biometrics</code> | <code>Enabled = 0</code> | 3 cl\u00e9s | | WIN-PRIVACY-208 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization</code> | <code>NoLockScreenCamera = 1</code> | 1 cl\u00e9 |</p> <p>T\u00e9l\u00e9m\u00e9trie Apps Tierces (301-304): | Action | Fichier/Cl\u00e9 | Modification | Application | |--------|-------------|--------------|-------------| | WIN-PRIVACY-301 | Service: <code>AdobeUpdateService</code> | StartupType = Disabled | Adobe Creative Cloud | | WIN-PRIVACY-302 | <code>%APPDATA%\\Code\\User\\settings.json</code> | <code>telemetry.telemetryLevel: \"off\"</code> | VS Code | | WIN-PRIVACY-303 | <code>HKLM:\\SOFTWARE\\Policies\\Google\\Chrome</code> | <code>MetricsReportingEnabled = 0</code> | Google Chrome | | WIN-PRIVACY-304 | Service: <code>NvTelemetryContainer</code> | StartupType = Disabled | Nvidia GeForce |</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#b3-modifications-performance-dns-services-gaming","title":"B.3 - Modifications PERFORMANCE (DNS, Services, Gaming)","text":"<p>DNS (001-003): | Action | Interface r\u00e9seau | DNS Primaire | DNS Secondaire | |--------|------------------|--------------|----------------| | WIN-PERF-001 | Toutes interfaces | 8.8.8.8 | 8.8.4.4 (Google) | | WIN-PERF-002 | Toutes interfaces | 1.1.1.1 | 1.0.0.1 (Cloudflare) | | WIN-PERF-003 | Toutes interfaces | 9.9.9.9 | 149.112.112.112 (Quad9) |</p> <p>Plans d'alimentation (101-104): | Action | GUID Plan | Nom | Modification | |--------|-----------|-----|--------------| | WIN-PERF-101 | <code>e9a42b02-d5df-448d-aa00-03f14749eb61</code> | Ultimate Performance | Active + d\u00e9finit actif | | WIN-PERF-102 | <code>8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c</code> | High Performance | D\u00e9finit actif | | WIN-PERF-103 | N/A | Hibernation | <code>powercfg -h off</code> | | WIN-PERF-104 | N/A | Fast Startup | Registre: <code>HiberbootEnabled = 0</code> |</p> <p>Gaming (401-412): | Action | Cl\u00e9 Registre | Valeur | Impact | |--------|--------------|--------|--------| | WIN-PERF-401 | <code>HKLM:\\SYSTEM\\CurrentControlSet\\Control\\GraphicsDrivers</code> | <code>HwSchMode = 1</code> (Disabled) | D\u00e9sactive HAGS | | WIN-PERF-402 | <code>HKCU:\\SOFTWARE\\Microsoft\\GameBar</code> | <code>AutoGameModeEnabled = 1</code> | Active Game Mode | | WIN-PERF-403 | <code>HKCU:\\Control Panel\\Mouse</code> | <code>MouseSpeed = 0</code> | D\u00e9sactive accel souris | | WIN-PERF-405 | <code>HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender</code> | <code>AvgCPULoadFactor = 25</code> | Limite Defender 25% | | WIN-PERF-408 | <code>HKCU:\\System\\GameConfigStore</code> | <code>GameDVR_FSEBehaviorMode = 2</code> | D\u00e9sactive Fullscreen Opt | | WIN-PERF-412 | <code>HKLM:\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{GUID}</code> | <code>TcpAckFrequency = 1, TCPNoDelay = 1</code> | D\u00e9sactive Nagle |</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#annexe-c-checklist-avantapres-optimisation","title":"Annexe C: Checklist avant/apr\u00e8s optimisation","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#c1-checklist-avant-optimisation","title":"C.1 - Checklist AVANT optimisation","text":"<p>\u2611\ufe0f Sauvegarde syst\u00e8me: - [ ] Point de restauration syst\u00e8me cr\u00e9\u00e9   <pre><code>Enable-ComputerRestore -Drive \"C:\\\"\nCheckpoint-Computer -Description \"Avant TwinShell Sprint 9\" -RestorePointType MODIFY_SETTINGS\n</code></pre> - [ ] Sauvegarde registre export\u00e9e   <pre><code>reg export HKLM C:\\Backup\\HKLM_backup.reg /y\nreg export HKCU C:\\Backup\\HKCU_backup.reg /y\n</code></pre> - [ ] Liste apps install\u00e9es sauvegard\u00e9e   <pre><code>Get-AppxPackage | Export-Csv C:\\Backup\\apps_installed.csv\n</code></pre> - [ ] Liste services actifs sauvegard\u00e9e   <pre><code>Get-Service | Where-Object {$_.Status -eq 'Running'} | Export-Csv C:\\Backup\\services_running.csv\n</code></pre></p> <p>\u2611\ufe0f Documentation configuration actuelle: - [ ] DNS actuel not\u00e9: __ - [ ] Plan d'alimentation actuel: _ - [ ] RAM utilis\u00e9e (idle): __ - [ ] Processus actifs: _ - [ ] Services actifs: _____</p> <p>\u2611\ufe0f Tests de r\u00e9f\u00e9rence (Benchmarks): - [ ] FPS jeu principal: __ - [ ] Temps d\u00e9marrage: _ - [ ] Latence r\u00e9seau (ping): __ - [ ] Vitesse DNS (Resolve-DnsName): _</p> <p>\u2611\ufe0f V\u00e9rification mat\u00e9riel: - [ ] Type de disque: [ ] SSD [ ] HDD [ ] NVMe - [ ] GPU: [ ] Nvidia [ ] AMD [ ] Intel - [ ] Bluetooth utilis\u00e9: [ ] Oui [ ] Non - [ ] Imprimante r\u00e9seau: [ ] Oui [ ] Non - [ ] Virtualisation (Hyper-V): [ ] Oui [ ] Non</p> <p>\u2611\ufe0f Choix du preset: - [ ] Preset s\u00e9lectionn\u00e9: _____ - [ ] Actions Dangerous comprises: [ ] Oui - [ ] Fonctionnalit\u00e9s perdues accept\u00e9es: [ ] Oui</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#c2-checklist-apres-optimisation","title":"C.2 - Checklist APR\u00c8S optimisation","text":"<p>\u2611\ufe0f Tests fonctionnels: - [ ] Connexion internet OK - [ ] DNS rapide (test Resolve-DnsName &lt; 30ms) - [ ] Audio fonctionne - [ ] Webcam fonctionne (si besoin) - [ ] Microphone fonctionne (si besoin) - [ ] Bluetooth fonctionne (si besoin) - [ ] Imprimante r\u00e9seau fonctionne (si besoin) - [ ] Applications principales lancent - [ ] Jeux principaux lancent</p> <p>\u2611\ufe0f Tests de performance: - [ ] FPS jeu principal: __ (Am\u00e9lioration: +%) - [ ] Temps d\u00e9marrage: __ (Am\u00e9lioration: -%) - [ ] RAM utilis\u00e9e (idle): __ (Lib\u00e9r\u00e9e: -GB) - [ ] Latence r\u00e9seau: __ (Am\u00e9lioration: -ms) - [ ] Processus actifs: __ (R\u00e9duction: -)</p> <p>\u2611\ufe0f V\u00e9rification confidentialit\u00e9 (si preset Privacy): - [ ] T\u00e9l\u00e9m\u00e9trie = 0 (Security only)   <pre><code>Get-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name AllowTelemetry\n# R\u00e9sultat attendu: 0\n</code></pre> - [ ] Services t\u00e9l\u00e9m\u00e9trie arr\u00eat\u00e9s   <pre><code>Get-Service DiagTrack, dmwappushservice | Select Status\n# R\u00e9sultat attendu: Stopped\n</code></pre> - [ ] T\u00e2ches t\u00e9l\u00e9m\u00e9trie d\u00e9sactiv\u00e9es   <pre><code>Get-ScheduledTask | Where {$_.TaskName -like \"*Compat*\"}\n# R\u00e9sultat attendu: Disabled\n</code></pre></p> <p>\u2611\ufe0f Monitoring stabilit\u00e9 (48h): - [ ] Jour 1: Aucun crash syst\u00e8me - [ ] Jour 1: Temp\u00e9ratures CPU/GPU normales - [ ] Jour 2: Aucun crash syst\u00e8me - [ ] Jour 2: Applications stables - [ ] Verdict: [ ] Stable [ ] Instable (rollback n\u00e9cessaire)</p> <p>\u2611\ufe0f Documentation finale: - [ ] Batch/actions ex\u00e9cut\u00e9es document\u00e9es - [ ] Capture logs TwinShell sauvegard\u00e9e - [ ] Configuration finale export\u00e9e   <pre><code># Export configuration post-optimisation\n$date = Get-Date -Format \"yyyyMMdd\"\nreg export HKLM \"C:\\Backup\\HKLM_after_$date.reg\" /y\nreg export HKCU \"C:\\Backup\\HKCU_after_$date.reg\" /y\nGet-Service | Export-Csv \"C:\\Backup\\services_after_$date.csv\"\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#annexe-d-scripts-de-verification-post-optimisation","title":"Annexe D: Scripts de v\u00e9rification post-optimisation","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#d1-script-de-verification-complete","title":"D.1 - Script de v\u00e9rification compl\u00e8te","text":"<pre><code># TwinShell Sprint 9 - Script de v\u00e9rification post-optimisation\n# Ex\u00e9cuter en tant qu'administrateur\n\nWrite-Host \"========================================\" -ForegroundColor Cyan\nWrite-Host \"TwinShell - V\u00e9rification post-optimisation\" -ForegroundColor Cyan\nWrite-Host \"========================================`n\" -ForegroundColor Cyan\n\n# 1. V\u00e9rifier DNS\nWrite-Host \"[1/8] V\u00e9rification DNS...\" -ForegroundColor Yellow\n$dnsServers = Get-DnsClientServerAddress -AddressFamily IPv4 | Where-Object {$_.ServerAddresses -ne $null}\nforeach ($dns in $dnsServers) {\n    Write-Host \"  Interface: $($dns.InterfaceAlias)\" -ForegroundColor Gray\n    Write-Host \"  DNS: $($dns.ServerAddresses -join ', ')\" -ForegroundColor Green\n}\n$dnsSpeed = Measure-Command {Resolve-DnsName google.com -DnsOnly}\nWrite-Host \"  Vitesse r\u00e9solution DNS: $($dnsSpeed.TotalMilliseconds)ms\" -ForegroundColor $(if ($dnsSpeed.TotalMilliseconds -lt 30) {\"Green\"} else {\"Red\"})\n\n# 2. V\u00e9rifier plan d'alimentation\nWrite-Host \"`n[2/8] V\u00e9rification plan d'alimentation...\" -ForegroundColor Yellow\n$activePlan = powercfg /getactivescheme\nWrite-Host \"  $activePlan\" -ForegroundColor Green\n\n# 3. V\u00e9rifier services critiques d\u00e9sactiv\u00e9s\nWrite-Host \"`n[3/8] V\u00e9rification services t\u00e9l\u00e9m\u00e9trie...\" -ForegroundColor Yellow\n$telemetryServices = @(\"DiagTrack\", \"dmwappushservice\")\nforeach ($svc in $telemetryServices) {\n    $service = Get-Service $svc -ErrorAction SilentlyContinue\n    if ($service) {\n        $status = $service.Status\n        $color = if ($status -eq \"Stopped\") {\"Green\"} else {\"Red\"}\n        Write-Host \"  $svc : $status\" -ForegroundColor $color\n    }\n}\n\n# 4. V\u00e9rifier t\u00e9l\u00e9m\u00e9trie registre\nWrite-Host \"`n[4/8] V\u00e9rification niveau t\u00e9l\u00e9m\u00e9trie...\" -ForegroundColor Yellow\n$telemetryLevel = Get-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name AllowTelemetry -ErrorAction SilentlyContinue\nif ($telemetryLevel) {\n    $level = $telemetryLevel.AllowTelemetry\n    $levelName = switch ($level) {\n        0 {\"Security (Minimum)\"}\n        1 {\"Basic\"}\n        2 {\"Enhanced\"}\n        3 {\"Full\"}\n        default {\"Unknown\"}\n    }\n    $color = if ($level -eq 0) {\"Green\"} else {\"Yellow\"}\n    Write-Host \"  Niveau t\u00e9l\u00e9m\u00e9trie: $levelName ($level)\" -ForegroundColor $color\n} else {\n    Write-Host \"  Niveau t\u00e9l\u00e9m\u00e9trie: Non configur\u00e9 (D\u00e9faut Windows)\" -ForegroundColor Gray\n}\n\n# 5. V\u00e9rifier utilisation RAM\nWrite-Host \"`n[5/8] Utilisation RAM...\" -ForegroundColor Yellow\n$ram = Get-CimInstance Win32_OperatingSystem\n$totalRAM = [math]::Round($ram.TotalVisibleMemorySize/1MB, 2)\n$freeRAM = [math]::Round($ram.FreePhysicalMemory/1MB, 2)\n$usedRAM = $totalRAM - $freeRAM\n$percentUsed = [math]::Round(($usedRAM / $totalRAM) * 100, 1)\nWrite-Host \"  Total: $totalRAM GB\" -ForegroundColor Gray\nWrite-Host \"  Utilis\u00e9e: $usedRAM GB ($percentUsed%)\" -ForegroundColor $(if ($percentUsed -lt 50) {\"Green\"} elseif ($percentUsed -lt 75) {\"Yellow\"} else {\"Red\"})\nWrite-Host \"  Libre: $freeRAM GB\" -ForegroundColor Green\n\n# 6. Compter processus actifs\nWrite-Host \"`n[6/8] Processus actifs...\" -ForegroundColor Yellow\n$processCount = (Get-Process).Count\nWrite-Host \"  Nombre de processus: $processCount\" -ForegroundColor $(if ($processCount -lt 120) {\"Green\"} else {\"Yellow\"})\n\n# 7. V\u00e9rifier services actifs\nWrite-Host \"`n[7/8] Services actifs...\" -ForegroundColor Yellow\n$runningServices = (Get-Service | Where-Object {$_.Status -eq 'Running'}).Count\nWrite-Host \"  Services en cours: $runningServices\" -ForegroundColor $(if ($runningServices -lt 80) {\"Green\"} else {\"Yellow\"})\n\n# 8. V\u00e9rifier espace disque lib\u00e9r\u00e9 (hibernation)\nWrite-Host \"`n[8/8] V\u00e9rification hibernation...\" -ForegroundColor Yellow\n$hiberfilExists = Test-Path \"C:\\hiberfil.sys\"\nif ($hiberfilExists) {\n    Write-Host \"  Hibernation: ACTIV\u00c9E (hiberfil.sys existe)\" -ForegroundColor Yellow\n} else {\n    Write-Host \"  Hibernation: D\u00c9SACTIV\u00c9E (hiberfil.sys supprim\u00e9)\" -ForegroundColor Green\n}\n\n# R\u00e9sum\u00e9\nWrite-Host \"`n========================================\" -ForegroundColor Cyan\nWrite-Host \"V\u00e9rification termin\u00e9e!\" -ForegroundColor Cyan\nWrite-Host \"========================================\" -ForegroundColor Cyan\nWrite-Host \"`nRecommandations:\" -ForegroundColor Yellow\nWrite-Host \"- Red\u00e9marrez votre PC pour finaliser les modifications\" -ForegroundColor Gray\nWrite-Host \"- Testez vos applications principales\" -ForegroundColor Gray\nWrite-Host \"- Surveillez la stabilit\u00e9 pendant 48h\" -ForegroundColor Gray\nWrite-Host \"- Lancez vos benchmarks pour mesurer les gains\" -ForegroundColor Gray\n</code></pre>"},{"location":"developer/OPTIMISATION-WINDOWS/#d2-script-de-comparaison-avantapres","title":"D.2 - Script de comparaison avant/apr\u00e8s","text":"<pre><code># TwinShell - Script de comparaison avant/apr\u00e8s optimisation\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [ValidateSet(\"before\", \"after\", \"compare\")]\n    [string]$Mode\n)\n\n$backupPath = \"C:\\TwinShell_Benchmark\"\n$beforeFile = \"$backupPath\\benchmark_before.json\"\n$afterFile = \"$backupPath\\benchmark_after.json\"\n\nif ($Mode -eq \"before\" -or $Mode -eq \"after\") {\n    Write-Host \"Collecte des m\u00e9triques syst\u00e8me...\" -ForegroundColor Cyan\n\n    # Collecter m\u00e9triques\n    $metrics = @{\n        Timestamp = Get-Date\n        RAM_Total = [math]::Round((Get-CimInstance Win32_OperatingSystem).TotalVisibleMemorySize/1MB, 2)\n        RAM_Free = [math]::Round((Get-CimInstance Win32_OperatingSystem).FreePhysicalMemory/1MB, 2)\n        ProcessCount = (Get-Process).Count\n        ServiceCount = (Get-Service | Where-Object {$_.Status -eq 'Running'}).Count\n        DNS_Primary = (Get-DnsClientServerAddress -AddressFamily IPv4 | Select-Object -First 1).ServerAddresses[0]\n        HiberfilExists = Test-Path \"C:\\hiberfil.sys\"\n        TelemetryLevel = (Get-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name AllowTelemetry -ErrorAction SilentlyContinue).AllowTelemetry\n    }\n\n    # Sauvegarder\n    if (!(Test-Path $backupPath)) { New-Item -Path $backupPath -ItemType Directory -Force }\n    $outputFile = if ($Mode -eq \"before\") {$beforeFile} else {$afterFile}\n    $metrics | ConvertTo-Json | Set-Content $outputFile\n\n    Write-Host \"\u2713 M\u00e9triques sauvegard\u00e9es dans: $outputFile\" -ForegroundColor Green\n}\n\nif ($Mode -eq \"compare\") {\n    if (!(Test-Path $beforeFile) -or !(Test-Path $afterFile)) {\n        Write-Host \"\u274c Fichiers de benchmark manquants. Ex\u00e9cutez d'abord -Mode before et -Mode after\" -ForegroundColor Red\n        exit\n    }\n\n    $before = Get-Content $beforeFile | ConvertFrom-Json\n    $after = Get-Content $afterFile | ConvertFrom-Json\n\n    Write-Host \"`n========================================\" -ForegroundColor Cyan\n    Write-Host \"COMPARAISON AVANT/APR\u00c8S OPTIMISATION\" -ForegroundColor Cyan\n    Write-Host \"========================================`n\" -ForegroundColor Cyan\n\n    # RAM lib\u00e9r\u00e9e\n    $ramFreed = [math]::Round($after.RAM_Free - $before.RAM_Free, 2)\n    $ramUsedBefore = $before.RAM_Total - $before.RAM_Free\n    $ramUsedAfter = $after.RAM_Total - $after.RAM_Free\n    $ramReduction = [math]::Round((($ramUsedBefore - $ramUsedAfter) / $ramUsedBefore) * 100, 1)\n    Write-Host \"RAM Utilis\u00e9e:\" -ForegroundColor Yellow\n    Write-Host \"  Avant: $ramUsedBefore GB\" -ForegroundColor Gray\n    Write-Host \"  Apr\u00e8s: $ramUsedAfter GB\" -ForegroundColor Gray\n    Write-Host \"  Lib\u00e9r\u00e9e: $ramFreed GB ($ramReduction% de r\u00e9duction)\" -ForegroundColor Green\n\n    # Processus r\u00e9duits\n    $processReduction = $before.ProcessCount - $after.ProcessCount\n    $processPercent = [math]::Round(($processReduction / $before.ProcessCount) * 100, 1)\n    Write-Host \"`nProcessus actifs:\" -ForegroundColor Yellow\n    Write-Host \"  Avant: $($before.ProcessCount)\" -ForegroundColor Gray\n    Write-Host \"  Apr\u00e8s: $($after.ProcessCount)\" -ForegroundColor Gray\n    Write-Host \"  R\u00e9duction: -$processReduction processus ($processPercent%)\" -ForegroundColor Green\n\n    # Services r\u00e9duits\n    $serviceReduction = $before.ServiceCount - $after.ServiceCount\n    $servicePercent = [math]::Round(($serviceReduction / $before.ServiceCount) * 100, 1)\n    Write-Host \"`nServices actifs:\" -ForegroundColor Yellow\n    Write-Host \"  Avant: $($before.ServiceCount)\" -ForegroundColor Gray\n    Write-Host \"  Apr\u00e8s: $($after.ServiceCount)\" -ForegroundColor Gray\n    Write-Host \"  R\u00e9duction: -$serviceReduction services ($servicePercent%)\" -ForegroundColor Green\n\n    # DNS\n    Write-Host \"`nDNS:\" -ForegroundColor Yellow\n    Write-Host \"  Avant: $($before.DNS_Primary)\" -ForegroundColor Gray\n    Write-Host \"  Apr\u00e8s: $($after.DNS_Primary)\" -ForegroundColor Green\n\n    # T\u00e9l\u00e9m\u00e9trie\n    Write-Host \"`nT\u00e9l\u00e9m\u00e9trie:\" -ForegroundColor Yellow\n    $beforeTelemetry = if ($before.TelemetryLevel -eq $null) {\"Non configur\u00e9 (D\u00e9faut)\"} else {$before.TelemetryLevel}\n    $afterTelemetry = if ($after.TelemetryLevel -eq $null) {\"Non configur\u00e9 (D\u00e9faut)\"} else {$after.TelemetryLevel}\n    Write-Host \"  Avant: $beforeTelemetry\" -ForegroundColor Gray\n    Write-Host \"  Apr\u00e8s: $afterTelemetry\" -ForegroundColor Green\n\n    Write-Host \"`n========================================\" -ForegroundColor Cyan\n    Write-Host \"\u2713 Optimisation r\u00e9ussie!\" -ForegroundColor Green\n    Write-Host \"========================================\" -ForegroundColor Cyan\n}\n</code></pre> <p>Utilisation: <pre><code># 1. AVANT optimisation\n.\\Compare-TwinShell.ps1 -Mode before\n\n# 2. Ex\u00e9cuter les optimisations TwinShell\n\n# 3. APR\u00c8S optimisation\n.\\Compare-TwinShell.ps1 -Mode after\n\n# 4. Comparer les r\u00e9sultats\n.\\Compare-TwinShell.ps1 -Mode compare\n</code></pre></p>"},{"location":"developer/OPTIMISATION-WINDOWS/#annexe-e-foire-aux-questions-etendues","title":"Annexe E: Foire aux questions \u00e9tendues","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#e1-questions-techniques","title":"E.1 - Questions techniques","text":"<p>Q: Puis-je annuler WIN-PERF-201 (d\u00e9sactivation 200+ services)?</p> <p>R: Oui, mais c'est fastidieux. M\u00e9thodes:</p> <ol> <li> <p>Restauration syst\u00e8me (recommand\u00e9):    <pre><code>rstrui.exe\n# S\u00e9lectionner le point de restauration \"Avant TwinShell\"\n</code></pre></p> </li> <li> <p>R\u00e9activation manuelle via script:    <pre><code># Liste des services \u00e0 r\u00e9activer\n$servicesToRestore = @(\n    \"DiagTrack\",\n    \"dmwappushservice\",\n    \"WbioSrvc\",\n    \"XblAuthManager\",\n    \"XblGameSave\"\n    # ... (liste compl\u00e8te dans Annexe A)\n)\n\nforeach ($svc in $servicesToRestore) {\n    Set-Service -Name $svc -StartupType Automatic -ErrorAction SilentlyContinue\n    Start-Service -Name $svc -ErrorAction SilentlyContinue\n}\n</code></pre></p> </li> </ol> <p>Q: WIN-PERF-002 (DNS Cloudflare) ne fonctionne pas, comment v\u00e9rifier?</p> <p>R: Tests de diagnostic: <pre><code># 1. V\u00e9rifier DNS configur\u00e9\nGet-DnsClientServerAddress -AddressFamily IPv4\n\n# 2. Tester r\u00e9solution\nResolve-DnsName google.com\n\n# 3. Mesurer vitesse\nMeasure-Command {Resolve-DnsName google.com}\n\n# 4. Si probl\u00e8me, r\u00e9initialiser\nnetsh interface ipv4 set dnsservers \"Ethernet\" static 1.1.1.1 primary\nnetsh interface ipv4 add dnsservers \"Ethernet\" 1.0.0.1 index=2\nipconfig /flushdns\n</code></pre></p> <p>Q: Comment savoir si mon PC a un SSD ou HDD?</p> <p>R: Commande PowerShell: <pre><code>Get-PhysicalDisk | Select-Object FriendlyName, MediaType, Size\n\n# R\u00e9sultat:\n# MediaType = SSD \u2192 Appliquer WIN-PERF-301/302\n# MediaType = HDD \u2192 NE PAS appliquer WIN-PERF-301/302\n</code></pre></p> <p>Q: WIN-PERF-405 (Limiter Defender) est-il s\u00fbr?</p> <p>R: Oui, totalement s\u00fbr: - \u2705 Windows Defender reste ACTIF - \u2705 Protection en temps r\u00e9el ACTIVE - \u2705 Seule l'utilisation CPU est limit\u00e9e \u00e0 25% max - \u2705 Aucun impact sur la s\u00e9curit\u00e9 - \u2705 \u00c9limine les drops de FPS pendant scans</p> <p>Q: Quel est le preset le plus s\u00fbr (minimal risk)?</p> <p>R: \ud83c\udfe2 Configuration poste de travail standard: - \u2705 Aucune action Dangerous - \u2705 Conserve toutes fonctionnalit\u00e9s essentielles - \u2705 Am\u00e9lioration notable mais conservatrice - \u2705 Adapt\u00e9 d\u00e9butants</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#e2-questions-rgpd-et-entreprise","title":"E.2 - Questions RGPD et entreprise","text":"<p>Q: Les presets TwinShell sont-ils conformes RGPD?</p> <p>R: Le preset \ud83d\udd12 Confidentialit\u00e9 maximale est sp\u00e9cifiquement con\u00e7u pour conformit\u00e9 RGPD stricte: - \u2705 Article 5: Minimisation donn\u00e9es - \u2705 Article 25: Privacy by design - \u2705 Article 32: S\u00e9curit\u00e9 traitement - \u2705 Article 44: Transfert donn\u00e9es hors UE bloqu\u00e9</p> <p>Q: Comment documenter les modifications pour audit RGPD?</p> <p>R: TwinShell enregistre toutes actions dans SQLite + logs. Export manuel: <pre><code># Export configuration compl\u00e8te\n$auditDate = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$auditPath = \"C:\\GDPR_Audit_$auditDate\"\nNew-Item -Path $auditPath -ItemType Directory\n\n# Export registre\nreg export \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" \"$auditPath\\telemetry.reg\" /y\nreg export \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\" \"$auditPath\\permissions.reg\" /y\n\n# Export services\nGet-Service | Where {$_.Name -like \"*Diag*\" -or $_.Name -like \"*Telemetry*\"} | Export-Csv \"$auditPath\\telemetry_services.csv\"\n\n# Export t\u00e2ches planifi\u00e9es\nGet-ScheduledTask | Where {$_.TaskName -like \"*Compat*\" -or $_.TaskName -like \"*Telemetry*\"} | Export-Csv \"$auditPath\\scheduled_tasks.csv\"\n</code></pre></p> <p>Q: Puis-je d\u00e9ployer TwinShell via GPO sur parc informatique?</p> <p>R: TwinShell n'a pas de d\u00e9ploiement GPO natif, mais vous pouvez: 1. Exporter les modifications registre des batches 2. Les importer dans GPO d'entreprise 3. OU: Ex\u00e9cuter TwinShell via script de d\u00e9ploiement centralis\u00e9</p>"},{"location":"developer/OPTIMISATION-WINDOWS/#changelog","title":"Changelog","text":""},{"location":"developer/OPTIMISATION-WINDOWS/#sprint-9-novembre-2025-presets-et-finalisation","title":"Sprint 9 - Novembre 2025 - PRESETS ET FINALISATION","text":"<ul> <li>\ud83c\udf89 6 batches pr\u00e9d\u00e9finis complets et optimis\u00e9s</li> <li>\ud83c\udfae Optimisation Gaming (8 actions) - +15-30% FPS</li> <li>\ud83d\udd12 Confidentialit\u00e9 maximale (7 actions) - RGPD strict</li> <li>\u26a1 Performance serveur (7 actions) - Workstations/Serveurs</li> <li>\ud83e\uddf9 Debloat entreprise (7 actions) - D\u00e9ploiements pro</li> <li>\ud83c\udfe2 Poste de travail standard (6 actions) - Bureautique</li> <li>\u26a1 Performance maximale (8 actions) - Power users</li> <li>\ud83d\udcda Guide utilisateur complet (2350+ lignes / 50+ pages)</li> <li>Nouvelle section: Introduction et architecture TwinShell</li> <li>Nouvelle section: Performance Windows (42 actions d\u00e9taill\u00e9es)</li> <li>Nouvelle section: Presets - Guide de s\u00e9lection complet</li> <li>Annexes compl\u00e8tes:<ul> <li>Annexe A: Liste 200+ services d\u00e9sactivables (WIN-PERF-201)</li> <li>Annexe B: Tableau modifications registre (tra\u00e7abilit\u00e9 compl\u00e8te)</li> <li>Annexe C: Checklists avant/apr\u00e8s optimisation</li> <li>Annexe D: Scripts de v\u00e9rification post-optimisation</li> <li>Annexe E: FAQ \u00e9tendue (techniques + RGPD)</li> </ul> </li> <li>\ud83c\udfaf Documentation performance:</li> <li>DNS et R\u00e9seau (3 actions)</li> <li>Plans d'alimentation (4 actions)</li> <li>Services Windows (3 actions)</li> <li>Indexation et Cache (6 actions)</li> <li>Optimisations Gaming (12 actions)</li> <li>Benchmarks avant/apr\u00e8s avec m\u00e9triques d\u00e9taill\u00e9es</li> <li>\ud83d\udcca Guides de s\u00e9lection presets:</li> <li>Arbres de d\u00e9cision pour choisir le bon preset</li> <li>Temps d'ex\u00e9cution et gains attendus</li> <li>Fonctionnalit\u00e9s perdues clairement document\u00e9es</li> <li>\ud83d\udd27 Scripts PowerShell fournis:</li> <li>Script de v\u00e9rification post-optimisation (8 tests)</li> <li>Script de comparaison avant/apr\u00e8s avec m\u00e9triques</li> <li>Script d'export configuration RGPD</li> <li>\ud83d\udcd6 Documentation utilisateur enrichie:</li> <li>Comparaison TwinShell vs autres outils</li> <li>Cas d'usage recommand\u00e9s par profil</li> <li>Instructions personnalisation des presets</li> <li>Guide de d\u00e9ploiement entreprise</li> </ul>"},{"location":"developer/OPTIMISATION-WINDOWS/#sprint-8-novembre-2025-performance","title":"Sprint 8 - Novembre 2025 - PERFORMANCE","text":"<ul> <li>Ajout de 42 actions de performance Windows (WIN-PERF-001 \u00e0 412)</li> <li>5 cat\u00e9gories: DNS, Plans alimentation, Services, Indexation, Gaming</li> <li>Optimisations DNS: Cloudflare, Google, Quad9 (latence -80%)</li> <li>Plans d'alimentation: Ultimate Performance, High Performance</li> <li>Services: D\u00e9sactivation 200+ services (WIN-PERF-201 - Dangerous)</li> <li>Gaming: HAGS, Game Mode, latence souris, Defender CPU limit</li> <li>Batches pr\u00e9d\u00e9finis:</li> <li>\u26a1 Performance maximale (8 actions)</li> <li>\ud83c\udfae Optimisation Gaming (actions gaming+debloat+privacy)</li> <li>\ud83d\udda5\ufe0f Performance serveur (7 actions)</li> <li>Benchmarks et tests de performance document\u00e9s</li> <li>Guide complet dans docs/SPRINT-8-PERFORMANCE-GUIDE.md</li> </ul>"},{"location":"developer/OPTIMISATION-WINDOWS/#sprint-7-novembre-2025-privacy","title":"Sprint 7 - Novembre 2025 - PRIVACY","text":"<ul> <li>Ajout de 28 actions de confidentialit\u00e9 Windows (WIN-PRIVACY-001 \u00e0 304)</li> <li>4 cat\u00e9gories: Permissions apps, Synchronisation cloud, T\u00e9l\u00e9m\u00e9trie Windows, T\u00e9l\u00e9m\u00e9trie apps tierces</li> <li>Conformit\u00e9 RGPD: Documentation compl\u00e8te des articles RGPD applicables</li> <li>Batch pr\u00e9d\u00e9fini: \"\ud83d\udd12 Confidentialit\u00e9 maximale\" (8 actions critiques)</li> <li>50+ cl\u00e9s registre modifi\u00e9es pour t\u00e9l\u00e9m\u00e9trie minimale (WIN-PRIVACY-205)</li> <li>Tests de conformit\u00e9 RGPD inclus</li> <li>Export de configuration avant/apr\u00e8s pour audit</li> <li>Support Windows 10/11, Active Directory, GPO</li> </ul>"},{"location":"developer/OPTIMISATION-WINDOWS/#sprint-6-novembre-2025-debloat","title":"Sprint 6 - Novembre 2025 - DEBLOAT","text":"<ul> <li>Ajout de 22 actions de debloating Windows (WIN-DEBLOAT-001 \u00e0 404)</li> <li>5 cat\u00e9gories: Bloatware tiers, Apps Microsoft, Composants syst\u00e8me, Fonctionnalit\u00e9s, Edge</li> <li>Actions de niveau Dangerous pour composants critiques (Store, OneDrive, Edge)</li> <li>Suppression Xbox, Copilot, Widgets, Consumer Features</li> <li>Optimisations Edge (4 actions)</li> <li>Documentation compl\u00e8te avec FAQ et troubleshooting</li> </ul> <p>Derni\u00e8re mise \u00e0 jour: Novembre 2025 - Sprint 9 Version: 3.0 - FINAL Auteur: TwinShell Team Total actions: 100+ (22 Debloat + 28 Privacy + 42 Performance + Package Managers) Total presets: 6 batches pr\u00e9d\u00e9finis optimis\u00e9s Documentation: 2350+ lignes (50+ pages) Conformit\u00e9: RGPD, CCPA, PIPEDA, DPA 2018</p>"},{"location":"developer/PACKAGE-MANAGERS/","title":"Guide de Gestion des Packages - TwinShell","text":""},{"location":"developer/PACKAGE-MANAGERS/#table-des-matieres","title":"Table des mati\u00e8res","text":"<ol> <li>Introduction</li> <li>Pr\u00e9requis</li> <li>Winget - Windows Package Manager</li> <li>Chocolatey - Package Manager</li> <li>Actions disponibles</li> <li>Utilisation de l'interface de recherche</li> <li>Exemples d'utilisation</li> <li>D\u00e9pannage</li> <li>Bonnes pratiques</li> </ol>"},{"location":"developer/PACKAGE-MANAGERS/#introduction","title":"Introduction","text":"<p>TwinShell int\u00e8gre la gestion de packages Windows via deux gestionnaires principaux :</p> <ul> <li>Winget : Le gestionnaire de packages officiel de Microsoft</li> <li>Chocolatey : Un gestionnaire de packages communautaire populaire</li> </ul> <p>Ces outils permettent d'installer, mettre \u00e0 jour, rechercher et g\u00e9rer des applications Windows en ligne de commande, offrant une exp\u00e9rience similaire \u00e0 <code>apt</code> sur Linux ou <code>brew</code> sur macOS.</p>"},{"location":"developer/PACKAGE-MANAGERS/#prerequis","title":"Pr\u00e9requis","text":""},{"location":"developer/PACKAGE-MANAGERS/#winget","title":"Winget","text":"<p>Pr\u00e9requis syst\u00e8me : - Windows 10 version 1809 (build 17763) ou sup\u00e9rieure - Windows 11 (toutes versions)</p> <p>Installation : Winget est pr\u00e9install\u00e9 sur Windows 11 et les versions r\u00e9centes de Windows 10. Si ce n'est pas le cas :</p> <ol> <li>Installer depuis le Microsoft Store : App Installer</li> <li>Ou t\u00e9l\u00e9charger depuis GitHub : Winget Releases</li> </ol> <p>V\u00e9rification : <pre><code>winget --version\n</code></pre></p>"},{"location":"developer/PACKAGE-MANAGERS/#chocolatey","title":"Chocolatey","text":"<p>Pr\u00e9requis syst\u00e8me : - Windows 7+ / Windows Server 2003+ - PowerShell v2+ (recommand\u00e9 v5.1+) - .NET Framework 4+ (recommand\u00e9 4.8)</p> <p>Installation :</p> <p>Ex\u00e9cuter en tant qu'administrateur dans PowerShell :</p> <pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force\n[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072\niex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))\n</code></pre> <p>V\u00e9rification : <pre><code>choco --version\n</code></pre></p>"},{"location":"developer/PACKAGE-MANAGERS/#winget-windows-package-manager","title":"Winget - Windows Package Manager","text":""},{"location":"developer/PACKAGE-MANAGERS/#fonctionnalites-principales","title":"Fonctionnalit\u00e9s principales","text":"<p>Winget permet de : - Installer des applications depuis les sources Microsoft - Mettre \u00e0 jour automatiquement les applications - D\u00e9sinstaller proprement les logiciels - Rechercher dans un catalogue de plus de 10 000 applications</p>"},{"location":"developer/PACKAGE-MANAGERS/#sources-de-packages","title":"Sources de packages","text":"<p>Par d\u00e9faut, Winget utilise : - msstore : Microsoft Store - winget : D\u00e9p\u00f4t communautaire Microsoft</p>"},{"location":"developer/PACKAGE-MANAGERS/#commandes-principales","title":"Commandes principales","text":"Commande Description <code>winget search &lt;terme&gt;</code> Recherche de packages <code>winget install &lt;id&gt;</code> Installation d'un package <code>winget upgrade &lt;id&gt;</code> Mise \u00e0 jour d'un package <code>winget upgrade --all</code> Mise \u00e0 jour de tous les packages <code>winget uninstall &lt;id&gt;</code> D\u00e9sinstallation <code>winget list</code> Liste des packages install\u00e9s <code>winget show &lt;id&gt;</code> D\u00e9tails d'un package <code>winget source list</code> Liste des sources"},{"location":"developer/PACKAGE-MANAGERS/#chocolatey-package-manager","title":"Chocolatey - Package Manager","text":""},{"location":"developer/PACKAGE-MANAGERS/#fonctionnalites-principales_1","title":"Fonctionnalit\u00e9s principales","text":"<p>Chocolatey offre : - Plus de 9 000 packages dans le d\u00e9p\u00f4t communautaire - Support de d\u00e9p\u00f4ts priv\u00e9s pour les entreprises - Gestion des d\u00e9pendances automatique - Scripts d'installation personnalisables</p>"},{"location":"developer/PACKAGE-MANAGERS/#sources-de-packages_1","title":"Sources de packages","text":"<ul> <li>chocolatey : D\u00e9p\u00f4t communautaire principal (https://community.chocolatey.org/packages)</li> <li>Support de sources NuGet personnalis\u00e9es</li> </ul>"},{"location":"developer/PACKAGE-MANAGERS/#commandes-principales_1","title":"Commandes principales","text":"Commande Description <code>choco search &lt;terme&gt;</code> Recherche de packages <code>choco install &lt;id&gt; -y</code> Installation d'un package <code>choco upgrade &lt;id&gt; -y</code> Mise \u00e0 jour d'un package <code>choco upgrade all -y</code> Mise \u00e0 jour de tous les packages <code>choco uninstall &lt;id&gt; -y</code> D\u00e9sinstallation <code>choco list --local-only</code> Liste des packages install\u00e9s <code>choco info &lt;id&gt;</code> D\u00e9tails d'un package <code>choco source list</code> Liste des sources"},{"location":"developer/PACKAGE-MANAGERS/#actions-disponibles","title":"Actions disponibles","text":"<p>TwinShell propose 15 actions pr\u00e9configur\u00e9es pour g\u00e9rer vos packages :</p>"},{"location":"developer/PACKAGE-MANAGERS/#actions-winget-8","title":"Actions Winget (8)","text":"ID Action Niveau Description WIN-PKG-001 Installer une application Run Installe un package via Winget WIN-PKG-002 Lister les applications Run Liste tous les packages install\u00e9s WIN-PKG-003 Mettre \u00e0 jour une application Run Met \u00e0 jour un package sp\u00e9cifique WIN-PKG-004 Mettre \u00e0 jour toutes les applications Run Met \u00e0 jour tous les packages WIN-PKG-005 D\u00e9sinstaller une application Dangerous Supprime un package WIN-PKG-006 Rechercher un package Run Recherche dans le catalogue WIN-PKG-007 Afficher les d\u00e9tails Run Affiche les informations d\u00e9taill\u00e9es WIN-PKG-008 Ajouter une source Run Ajoute une source personnalis\u00e9e"},{"location":"developer/PACKAGE-MANAGERS/#actions-chocolatey-7","title":"Actions Chocolatey (7)","text":"ID Action Niveau Description WIN-PKG-101 Installer un package Run Installe un package via Chocolatey WIN-PKG-102 Lister les packages Run Liste tous les packages install\u00e9s WIN-PKG-103 Mettre \u00e0 jour un package Run Met \u00e0 jour un package sp\u00e9cifique WIN-PKG-104 Mettre \u00e0 jour tous les packages Run Met \u00e0 jour tous les packages WIN-PKG-105 D\u00e9sinstaller un package Dangerous Supprime un package WIN-PKG-106 Rechercher un package Run Recherche dans le catalogue WIN-PKG-107 Ajouter une source Run Ajoute une source personnalis\u00e9e"},{"location":"developer/PACKAGE-MANAGERS/#utilisation-de-linterface-de-recherche","title":"Utilisation de l'interface de recherche","text":"<p>TwinShell int\u00e8gre un service de recherche de packages (<code>PackageManagerService</code>) qui permet :</p>"},{"location":"developer/PACKAGE-MANAGERS/#recherche-de-packages","title":"Recherche de packages","text":"<pre><code>// Recherche Winget\nvar wingetResults = await packageManagerService.SearchWingetPackagesAsync(\"vscode\");\n\n// Recherche Chocolatey\nvar chocoResults = await packageManagerService.SearchChocolateyPackagesAsync(\"chrome\");\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#obtention-des-details","title":"Obtention des d\u00e9tails","text":"<pre><code>// D\u00e9tails Winget\nvar packageInfo = await packageManagerService.GetWingetPackageInfoAsync(\"Microsoft.VisualStudioCode\");\n\n// D\u00e9tails Chocolatey\nvar packageInfo = await packageManagerService.GetChocolateyPackageInfoAsync(\"googlechrome\");\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#liste-des-packages-installes","title":"Liste des packages install\u00e9s","text":"<pre><code>// Packages Winget install\u00e9s\nvar installedWinget = await packageManagerService.ListWingetInstalledPackagesAsync();\n\n// Packages Chocolatey install\u00e9s\nvar installedChoco = await packageManagerService.ListChocolateyInstalledPackagesAsync();\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#verification-de-disponibilite","title":"V\u00e9rification de disponibilit\u00e9","text":"<pre><code>// V\u00e9rifier si Winget est disponible\nbool isWingetAvailable = await packageManagerService.IsWingetAvailableAsync();\n\n// V\u00e9rifier si Chocolatey est disponible\nbool isChocoAvailable = await packageManagerService.IsChocolateyAvailableAsync();\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#exemples-dutilisation","title":"Exemples d'utilisation","text":""},{"location":"developer/PACKAGE-MANAGERS/#scenario-1-installation-dun-environnement-de-developpement","title":"Sc\u00e9nario 1 : Installation d'un environnement de d\u00e9veloppement","text":"<pre><code># Via Winget\nwinget install Microsoft.VisualStudioCode --silent\nwinget install Git.Git --silent\nwinget install Microsoft.PowerToys --silent\nwinget install Microsoft.WindowsTerminal --silent\n\n# Via Chocolatey\nchoco install vscode -y\nchoco install git -y\nchoco install nodejs -y\nchoco install docker-desktop -y\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#scenario-2-maintenance-reguliere","title":"Sc\u00e9nario 2 : Maintenance r\u00e9guli\u00e8re","text":"<pre><code># Mise \u00e0 jour de tous les packages\nwinget upgrade --all --silent\nchoco upgrade all -y\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#scenario-3-recherche-et-installation","title":"Sc\u00e9nario 3 : Recherche et installation","text":"<pre><code># Recherche\nwinget search \"visual studio\"\nchoco search firefox\n\n# Installation apr\u00e8s v\u00e9rification\nwinget show Microsoft.VisualStudio.2022.Community\nwinget install Microsoft.VisualStudio.2022.Community --silent\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#scenario-4-gestion-dentreprise-avec-sources-personnalisees","title":"Sc\u00e9nario 4 : Gestion d'entreprise avec sources personnalis\u00e9es","text":"<pre><code># Ajouter une source Winget priv\u00e9e\nwinget source add --name \"CompanyRepo\" \"https://packages.company.com/winget\"\n\n# Ajouter une source Chocolatey priv\u00e9e\nchoco source add --name=\"CompanyNuGet\" --source=\"https://packages.company.com/nuget\"\n\n# Installer depuis la source personnalis\u00e9e\nwinget install CompanyApp --source \"CompanyRepo\"\nchoco install company-tool -y --source=\"CompanyNuGet\"\n</code></pre>"},{"location":"developer/PACKAGE-MANAGERS/#depannage","title":"D\u00e9pannage","text":""},{"location":"developer/PACKAGE-MANAGERS/#winget_1","title":"Winget","text":"<p>Probl\u00e8me : \"winget n'est pas reconnu\" - Solution : Installer ou r\u00e9installer App Installer depuis le Microsoft Store - V\u00e9rifier que <code>C:\\Users\\&lt;User&gt;\\AppData\\Local\\Microsoft\\WindowsApps</code> est dans le PATH</p> <p>Probl\u00e8me : Erreur de source - Solution : <code>winget source reset --force</code></p> <p>Probl\u00e8me : Mise \u00e0 jour bloqu\u00e9e - Solution : V\u00e9rifier les mises \u00e0 jour Windows, Winget d\u00e9pend de composants syst\u00e8me</p>"},{"location":"developer/PACKAGE-MANAGERS/#chocolatey_1","title":"Chocolatey","text":"<p>Probl\u00e8me : \"choco n'est pas reconnu\" - Solution : R\u00e9installer Chocolatey en mode administrateur - V\u00e9rifier le PATH : <code>C:\\ProgramData\\chocolatey\\bin</code></p> <p>Probl\u00e8me : Erreur de permission - Solution : Toujours ex\u00e9cuter PowerShell en mode administrateur pour Chocolatey</p> <p>Probl\u00e8me : Installation qui \u00e9choue - Solution :   <pre><code>choco install &lt;package&gt; -y --force\n# Ou nettoyer le cache\nchoco cache clean\n</code></pre></p>"},{"location":"developer/PACKAGE-MANAGERS/#problemes-communs","title":"Probl\u00e8mes communs","text":"<p>Conflit entre Winget et Chocolatey - Les deux peuvent coexister, mais attention aux doublons - Utiliser <code>winget list</code> et <code>choco list --local-only</code> pour v\u00e9rifier</p> <p>Packages obsol\u00e8tes - Certains packages peuvent ne plus \u00eatre maintenus - V\u00e9rifier la date de derni\u00e8re mise \u00e0 jour avant installation</p>"},{"location":"developer/PACKAGE-MANAGERS/#bonnes-pratiques","title":"Bonnes pratiques","text":""},{"location":"developer/PACKAGE-MANAGERS/#securite","title":"S\u00e9curit\u00e9","text":"<ol> <li>V\u00e9rifier les sources : Toujours v\u00e9rifier l'\u00e9diteur et la source d'un package</li> <li>\u00c9viter les sources non fiables : Ne pas ajouter de sources sans v\u00e9rification</li> <li>Mises \u00e0 jour r\u00e9guli\u00e8res : Maintenir les packages \u00e0 jour pour les correctifs de s\u00e9curit\u00e9</li> <li>Utiliser --silent avec pr\u00e9caution : V\u00e9rifier ce qui sera install\u00e9 avant</li> </ol>"},{"location":"developer/PACKAGE-MANAGERS/#performance","title":"Performance","text":"<ol> <li> <p>Nettoyer r\u00e9guli\u00e8rement :    <pre><code>winget cache clean\nchoco cache clean\n</code></pre></p> </li> <li> <p>D\u00e9sinstaller les packages inutilis\u00e9s :    <pre><code>winget list  # Identifier les packages\nwinget uninstall &lt;package&gt;\n</code></pre></p> </li> </ol>"},{"location":"developer/PACKAGE-MANAGERS/#automatisation","title":"Automatisation","text":"<ol> <li> <p>Scripts de setup : Cr\u00e9er des scripts pour installer un environnement complet    <pre><code># setup-dev-env.ps1\n$packages = @(\n    \"Microsoft.VisualStudioCode\",\n    \"Git.Git\",\n    \"Microsoft.PowerToys\"\n)\n\nforeach ($package in $packages) {\n    winget install $package --silent --accept-package-agreements\n}\n</code></pre></p> </li> <li> <p>T\u00e2ches planifi\u00e9es : Automatiser les mises \u00e0 jour    <pre><code># Cr\u00e9er une t\u00e2che pour mise \u00e0 jour quotidienne\n$action = New-ScheduledTaskAction -Execute \"winget\" -Argument \"upgrade --all --silent\"\n$trigger = New-ScheduledTaskTrigger -Daily -At 3am\nRegister-ScheduledTask -Action $action -Trigger $trigger -TaskName \"WingetDailyUpdate\"\n</code></pre></p> </li> </ol>"},{"location":"developer/PACKAGE-MANAGERS/#documentation","title":"Documentation","text":"<ol> <li>Documenter les installations : Garder trace des packages install\u00e9s</li> <li>Versionner les scripts : Utiliser Git pour vos scripts d'installation</li> <li>Partager les configurations : Cr\u00e9er des fichiers de configuration d'\u00e9quipe</li> </ol>"},{"location":"developer/PACKAGE-MANAGERS/#ressources-supplementaires","title":"Ressources suppl\u00e9mentaires","text":""},{"location":"developer/PACKAGE-MANAGERS/#documentation-officielle","title":"Documentation officielle","text":"<ul> <li>Winget Documentation</li> <li>Chocolatey Documentation</li> <li>Winget Package Repository</li> <li>Chocolatey Community Packages</li> </ul>"},{"location":"developer/PACKAGE-MANAGERS/#communaute","title":"Communaut\u00e9","text":"<ul> <li>Winget GitHub</li> <li>Chocolatey GitHub</li> <li>Reddit - r/Winget</li> <li>Reddit - r/Chocolatey</li> </ul>"},{"location":"developer/PACKAGE-MANAGERS/#outils-complementaires","title":"Outils compl\u00e9mentaires","text":"<ul> <li>WingetUI - Interface graphique pour Winget</li> <li>Chocolatey GUI - Interface graphique pour Chocolatey</li> <li>winget-pkgs-automation - Outils d'automatisation</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : Sprint 5 - Novembre 2025 Version TwinShell : Compatible avec toutes versions Auteur : \u00c9quipe TwinShell</p>"},{"location":"developer/PERFORMANCE_QUICK_START/","title":"PERFORMANCE OPTIMIZATION - QUICK START GUIDE","text":"<p>TwinShell Performance Analysis - Fast Reference</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#files-generated","title":"Files Generated","text":"<ol> <li><code>PERFORMANCE_ANALYSIS_SUMMARY.md</code> - Executive summary (start here)</li> <li><code>performance_analysis.md</code> - Detailed technical analysis</li> <li><code>performance_detailed_metrics.md</code> - Metrics and profiling data</li> <li><code>PERFORMANCE_ANALYSIS_INDEX.md</code> - Navigation guide</li> </ol>"},{"location":"developer/PERFORMANCE_QUICK_START/#top-4-quick-wins-30-minutes-each","title":"Top 4 Quick Wins (30 minutes each)","text":""},{"location":"developer/PERFORMANCE_QUICK_START/#1-tolistasync-anyasync-commandhistoryrepositorycs145","title":"1. ToListAsync() + AnyAsync() [CommandHistoryRepository.cs:145]","text":"<p><pre><code>// BEFORE: 150MB+ memory for 5000 items\nvar entities = await _context.CommandHistories.ToListAsync();\nif (entities.Any()) { ... }\n\n// AFTER: 5MB, instant check\nif (await _context.CommandHistories.AnyAsync()) { ... }\n</code></pre> Impact: 97% memory reduction</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#2-add-asnotracking-actionrepositorycs20","title":"2. Add AsNoTracking() [ActionRepository.cs:20]","text":"<p><pre><code>// Add .AsNoTracking() to all read-only queries\nvar entities = await _context.Actions\n    .AsNoTracking()\n    .Include(a =&gt; a.WindowsCommandTemplate)\n    .ToListAsync();\n</code></pre> Impact: 20-30% EF Core overhead reduction</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#3-fix-multiple-include-favoritesrepositorycs30","title":"3. Fix Multiple Include() [FavoritesRepository.cs:30]","text":"<p><pre><code>// BEFORE: .Include repeated twice\n.Include(f =&gt; f.Action)\n    .ThenInclude(a =&gt; a!.WindowsCommandTemplate)\n.Include(f =&gt; f.Action)\n    .ThenInclude(a =&gt; a!.LinuxCommandTemplate)\n\n// AFTER: Combine ThenInclude\n.Include(f =&gt; f.Action)\n    .ThenInclude(a =&gt; a!.WindowsCommandTemplate)\n    .ThenInclude(a =&gt; a!.LinuxCommandTemplate)\n</code></pre> Impact: 15-20% DB traffic reduction</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#4-observablecollection-batch-updates-historyviewmodelcs161","title":"4. ObservableCollection Batch Updates [HistoryViewModel.cs:161]","text":"<p><pre><code>// BEFORE: 500 events for 500 items\nHistoryItems.Clear();\nforeach (var item in items)\n    HistoryItems.Add(item); // Fires event each time!\n\n// AFTER: 1 event for 500 items\nHistoryItems.Clear();\nHistoryItems.AddRange(items); // Requires ObservableRangeCollection\n</code></pre> Impact: 99% fewer UI events</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#top-3-major-changes-8-hours-each","title":"Top 3 Major Changes (8+ hours each)","text":""},{"location":"developer/PERFORMANCE_QUICK_START/#1-observablecollection-virtualization-historyviewmodel","title":"1. ObservableCollection Virtualization [HistoryViewModel]","text":"<p><pre><code>&lt;ListBox ItemsSource=\"{Binding HistoryItems}\"&gt;\n    &lt;ListBox.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel VirtualizingMode=\"Recycling\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListBox.ItemsPanel&gt;\n&lt;/ListBox&gt;\n</code></pre> Impact: 70-80% memory (50MB \u2192 5-10MB), 95% rendering improvement</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#2-remove-taskrun-historyviewmodelcs112","title":"2. Remove Task.Run() [HistoryViewModel.cs:112]","text":"<p>Replace Task.Run() + Dispatcher.Invoke() with direct UI thread LINQ filtering Impact: 47% latency reduction, eliminates context switching</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#3-batch-db-operations-configurationservicecs138","title":"3. Batch DB Operations [ConfigurationService.cs:138]","text":"<p>Replace individual AddAsync() in loop with AddBatchAsync() Impact: 95% latency reduction (1000ms \u2192 20ms)</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#implementation-roadmap","title":"Implementation Roadmap","text":"<p>Phase 1 (2 weeks) - 30-40% improvement 1. Week 1: Virtualisation, AsNoTracking(), Remove Task.Run() 2. Week 2: Batching, ObservableRangeCollection</p> <p>Phase 2 (1 week) - 15-20% improvement 1. Caching favorites/categories 2. Multiple Include() fix 3. Timer optimization (100ms \u2192 250ms)</p> <p>Phase 3 (1 week) - 5-10% improvement 1. ValueTask implementation 2. JSON deserialization cache 3. Buffer optimization</p>"},{"location":"developer/PERFORMANCE_QUICK_START/#expected-results","title":"Expected Results","text":"Metric Before After Gain Memory 150-200 MB 80-100 MB 40-50% CPU Idle 15-20% 2-5% 70-85% List Ops 200-500ms 10-50ms 10-50x DB Queries 50-100 10-20 70-80%"},{"location":"developer/PERFORMANCE_QUICK_START/#files-to-modify-priority-order","title":"Files to Modify (Priority Order)","text":"<ol> <li>HistoryViewModel.cs - Task.Run, virtualization, batch updates</li> <li>CommandHistoryRepository.cs - AnyAsync instead of ToListAsync</li> <li>ActionRepository.cs - Add AsNoTracking</li> <li>ConfigurationService.cs - Batch DB operations</li> <li>ExecutionViewModel.cs - Timer interval</li> <li>MainViewModel.cs - Caching</li> <li>FavoritesRepository.cs - Multiple Include fix</li> <li>BatchViewModel.cs - Batch updates</li> <li>CustomCategoryService.cs - Count optimization</li> <li>PackageManagerService.cs - StringBuilder for concatenation</li> </ol>"},{"location":"developer/PERFORMANCE_QUICK_START/#testing-checklist","title":"Testing Checklist","text":"<ul> <li>[ ] Profile memory with 1000+ items</li> <li>[ ] Verify CPU usage reduced</li> <li>[ ] Check DB query count before/after</li> <li>[ ] Test with large imports (100+ items)</li> <li>[ ] Validate UI responsiveness</li> <li>[ ] Check scroll performance</li> <li>[ ] Long-running session (8+ hours)</li> </ul>"},{"location":"developer/PERFORMANCE_QUICK_START/#tools-needed","title":"Tools Needed","text":"<ol> <li>Visual Studio Memory Profiler</li> <li>Visual Studio CPU Profiler</li> <li>EF Core logging enabled</li> <li>BenchmarkDotNet (optional)</li> </ol>"},{"location":"developer/PERFORMANCE_QUICK_START/#for-more-details","title":"For More Details","text":"<ul> <li>Executive Overview: PERFORMANCE_ANALYSIS_SUMMARY.md</li> <li>Technical Deep Dive: performance_analysis.md</li> <li>Metrics &amp; Profiling: performance_detailed_metrics.md</li> <li>Navigation: PERFORMANCE_ANALYSIS_INDEX.md</li> </ul> <p>Analysis Date: November 16, 2025 Repository: TwinShell Estimated Total Effort: 60-100 hours for all phases Estimated Improvement: 30-50% overall performance boost</p>"},{"location":"developer/RECOMMENDED_REFACTORINGS/","title":"REFACTORISATIONS RECOMMAND\u00c9ES - TWINSHELL","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#1-constantes-centralisees","title":"1. CONSTANTES CENTRALIS\u00c9ES","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#creer-srctwinshellcoreconstantsuiconstantscs","title":"Cr\u00e9er: <code>src/TwinShell.Core/Constants/UIConstants.cs</code>","text":"<pre><code>namespace TwinShell.Core.Constants;\n\npublic static class UIConstants\n{\n    // Favorites\n    public const string FavoritesCategoryIdentifier = \"Favorites\";\n    public const string FavoritesCategoryDisplay = \"\u2b50 Favorites\";\n    public const int MaxFavoritesCount = 50;\n\n    // Error/Info messages\n    public const string NoCommandTemplateAvailable = \"NoCommandTemplateAvailable\";\n    public const string ValidationErrorsOccurred = \"ValidationErrorsOccurred\";\n    public const string InvalidCommand = \"InvalidCommand\";\n}\n\npublic static class CommandExecutionConstants\n{\n    public const int DefaultTimeoutSeconds = 30;\n    public const int MaxTimeoutSeconds = 300;\n    public const int MinTimeoutSeconds = 1;\n    public const int PowerShellGalleryTimeout = 60;\n    public const int PowerShellInstallTimeout = 300;\n    public const int Timer_UpdateIntervalMs = 100;\n}\n\npublic static class ValidationConstants\n{\n    // AutoCleanupDays\n    public const int MinAutoCleanupDays = 1;\n    public const int MaxAutoCleanupDays = 3650;\n    public const int DefaultAutoCleanupDays = 90;\n\n    // MaxHistoryItems\n    public const int MinHistoryItems = 10;\n    public const int MaxHistoryItems = 100000;\n    public const int DefaultMaxHistoryItems = 1000;\n\n    // RecentCommandsCount\n    public const int MinRecentCommandsCount = 1;\n    public const int MaxRecentCommandsCount = 50;\n    public const int DefaultRecentCommandsCount = 5;\n}\n\npublic static class AuditConstants\n{\n    public const string BatchExecutionCategory = \"Batch Execution\";\n    public const string ManualExecutionCategory = \"Manual Execution\";\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#2-notification-service-abstraction","title":"2. NOTIFICATION SERVICE ABSTRACTION","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#creer-srctwinshellappserviceswpfnotificationservicecs","title":"Cr\u00e9er: <code>src/TwinShell.App/Services/WpfNotificationService.cs</code>","text":"<pre><code>using System.Windows;\nusing TwinShell.Core.Interfaces;\n\nnamespace TwinShell.App.Services;\n\npublic class WpfNotificationService : INotificationService\n{\n    public void ShowError(string message, string title)\n    {\n        MessageBox.Show(message, title, MessageBoxButton.OK, MessageBoxImage.Error);\n    }\n\n    public void ShowWarning(string message, string title)\n    {\n        MessageBox.Show(message, title, MessageBoxButton.OK, MessageBoxImage.Warning);\n    }\n\n    public void ShowInfo(string message, string title)\n    {\n        MessageBox.Show(message, title, MessageBoxButton.OK, MessageBoxImage.Information);\n    }\n\n    public bool ShowQuestion(string message, string title)\n    {\n        var result = MessageBox.Show(message, title, MessageBoxButton.YesNo, MessageBoxImage.Question);\n        return result == MessageBoxResult.Yes;\n    }\n\n    public bool ShowConfirmation(string message, string title, string confirmButtonText = \"Yes\")\n    {\n        var result = MessageBox.Show(\n            message, \n            title, \n            MessageBoxButton.YesNo, \n            MessageBoxImage.Question, \n            MessageBoxResult.No);\n        return result == MessageBoxResult.Yes;\n    }\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#mettre-a-jour-srctwinshellcoreinterfacesinotificationservicecs","title":"Mettre \u00e0 jour: <code>src/TwinShell.Core/Interfaces/INotificationService.cs</code>","text":"<pre><code>namespace TwinShell.Core.Interfaces;\n\npublic interface INotificationService\n{\n    void ShowError(string message, string title);\n    void ShowWarning(string message, string title);\n    void ShowInfo(string message, string title);\n    bool ShowQuestion(string message, string title);\n    bool ShowConfirmation(string message, string title, string confirmButtonText = \"Yes\");\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#3-refactorisation-de-mainviewmodel","title":"3. REFACTORISATION DE MainViewModel","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#avant-542-lignes-god-class","title":"Avant (542 lignes - God Class):","text":"<pre><code>MainViewModel\n\u251c\u2500\u2500 Filtering (11 properties)\n\u251c\u2500\u2500 Command Generation\n\u251c\u2500\u2500 Command Execution\n\u251c\u2500\u2500 Favorites Management\n\u251c\u2500\u2500 History Management\n\u251c\u2500\u2500 Config Export/Import\n\u2514\u2500\u2500 Action Selection\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#apres-3-viewmodels","title":"Apr\u00e8s (3 ViewModels):","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#a-creer-srctwinshellappviewmodelscommandgenerationviewmodelcs","title":"A. Cr\u00e9er: <code>src/TwinShell.App/ViewModels/CommandGenerationViewModel.cs</code>","text":"<pre><code>public partial class CommandGenerationViewModel : ObservableObject\n{\n    private readonly ICommandGeneratorService _commandGeneratorService;\n\n    [ObservableProperty]\n    private ObservableCollection&lt;ParameterViewModel&gt; _commandParameters = new();\n\n    [ObservableProperty]\n    private string _generatedCommand = string.Empty;\n\n    public CommandGenerationViewModel(ICommandGeneratorService commandGeneratorService)\n    {\n        _commandGeneratorService = commandGeneratorService;\n    }\n\n    public void LoadCommandParameters(CommandTemplate template)\n    {\n        CommandParameters.Clear();\n        var defaults = _commandGeneratorService.GetDefaultParameterValues(template);\n\n        foreach (var param in template.Parameters)\n        {\n            var paramVm = new ParameterViewModel\n            {\n                Name = param.Name,\n                Label = param.Label,\n                Type = param.Type,\n                Required = param.Required,\n                Description = param.Description ?? string.Empty,\n                Value = defaults.ContainsKey(param.Name) ? defaults[param.Name] : string.Empty\n            };\n\n            paramVm.ValueChanged += () =&gt; GenerateCommand(template);\n            CommandParameters.Add(paramVm);\n        }\n\n        GenerateCommand(template);\n    }\n\n    public void GenerateCommand(CommandTemplate template)\n    {\n        if (template == null)\n            return;\n\n        var paramValues = CommandParameters.ToDictionary(p =&gt; p.Name, p =&gt; p.Value);\n\n        if (_commandGeneratorService.ValidateParameters(template, paramValues, out var errors))\n        {\n            GeneratedCommand = _commandGeneratorService.GenerateCommand(template, paramValues);\n        }\n        else\n        {\n            GeneratedCommand = $\"Erreurs: {string.Join(\", \", errors)}\";\n        }\n    }\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#b-creer-srctwinshellappviewmodelsfavoritesmanagementviewmodelcs","title":"B. Cr\u00e9er: <code>src/TwinShell.App/ViewModels/FavoritesManagementViewModel.cs</code>","text":"<pre><code>public partial class FavoritesManagementViewModel : ObservableObject\n{\n    private readonly IFavoritesService _favoritesService;\n    private readonly INotificationService _notificationService;\n    private HashSet&lt;string&gt; _favoriteActionIds = new();\n\n    public FavoritesManagementViewModel(\n        IFavoritesService favoritesService,\n        INotificationService notificationService)\n    {\n        _favoritesService = favoritesService;\n        _notificationService = notificationService;\n    }\n\n    public async Task InitializeAsync()\n    {\n        await LoadFavoritesAsync();\n    }\n\n    public async Task LoadFavoritesAsync()\n    {\n        var favorites = await _favoritesService.GetAllFavoritesAsync();\n        _favoriteActionIds = favorites.Select(f =&gt; f.ActionId).ToHashSet();\n    }\n\n    public async Task ToggleFavoriteAsync(Action action)\n    {\n        if (action == null) return;\n\n        var result = await _favoritesService.ToggleFavoriteAsync(action.Id);\n        await LoadFavoritesAsync();\n\n        if (!result)\n        {\n            var count = await _favoritesService.GetFavoriteCountAsync();\n            if (count &gt;= 50)\n            {\n                _notificationService.ShowWarning(\n                    $\"Vous avez atteint la limite maximale de 50 favoris. Veuillez en supprimer avant d'en ajouter de nouveaux.\",\n                    \"Limite de favoris atteinte\");\n            }\n        }\n    }\n\n    public bool IsActionFavorite(string actionId)\n    {\n        return _favoriteActionIds.Contains(actionId);\n    }\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#c-reduire-mainviewmodel-220-lignes-instead-of-542","title":"C. R\u00e9duire MainViewModel (220 lignes instead of 542):","text":"<pre><code>public partial class MainViewModel : ObservableObject\n{\n    // Services\n    private readonly IActionService _actionService;\n    private readonly ISearchService _searchService;\n    private readonly ICommandHistoryService _commandHistoryService;\n    private readonly IConfigurationService _configurationService;\n    private readonly INotificationService _notificationService;\n\n    // Child ViewModels\n    private readonly CommandGenerationViewModel _commandGenerationVm;\n    private readonly FavoritesManagementViewModel _favoritesVm;\n\n    // Data\n    private List&lt;Action&gt; _allActions = new();\n\n    // UI Properties (filtering only)\n    [ObservableProperty]\n    private ObservableCollection&lt;string&gt; _categories = new();\n\n    [ObservableProperty]\n    private ObservableCollection&lt;Action&gt; _filteredActions = new();\n\n    [ObservableProperty]\n    private Action? _selectedAction;\n\n    [ObservableProperty]\n    private string _searchText = string.Empty;\n\n    [ObservableProperty]\n    private string? _selectedCategory;\n\n    // Platform &amp; Level filters...\n\n    public MainViewModel(\n        IActionService actionService,\n        ISearchService searchService,\n        ICommandHistoryService commandHistoryService,\n        IConfigurationService configurationService,\n        INotificationService notificationService,\n        CommandGenerationViewModel commandGenerationVm,\n        FavoritesManagementViewModel favoritesVm)\n    {\n        _actionService = actionService;\n        _searchService = searchService;\n        _commandHistoryService = commandHistoryService;\n        _configurationService = configurationService;\n        _notificationService = notificationService;\n        _commandGenerationVm = commandGenerationVm;\n        _favoritesVm = favoritesVm;\n    }\n\n    // Keep only filtering logic here\n    private async Task ApplyFiltersAsync()\n    {\n        // Simplified filtering logic\n    }\n\n    partial void OnSelectedActionChanged(Action? value)\n    {\n        if (value != null)\n        {\n            _commandGenerationVm.LoadCommandParameters(\n                GetActiveTemplate(value));\n        }\n    }\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#4-refactorisation-de-executionviewmodel","title":"4. REFACTORISATION DE ExecutionViewModel","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#avant-299-lignes-long-method","title":"Avant (299 lignes - Long method):","text":"<pre><code>ExecuteCommandAsync (147 lignes)\n\u251c\u2500\u2500 Validation\n\u251c\u2500\u2500 Dangerous check &amp; confirmation\n\u251c\u2500\u2500 UI setup\n\u251c\u2500\u2500 Timer setup\n\u251c\u2500\u2500 Command execution\n\u251c\u2500\u2500 Output processing\n\u2514\u2500\u2500 History update\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#apres-methodes-extraites","title":"Apr\u00e8s (M\u00e9thodes extraites):","text":"<pre><code>[RelayCommand]\nprivate async Task ExecuteCommandAsync(ExecuteCommandParameter parameter)\n{\n    if (!ValidateParameter(parameter))\n        return;\n\n    if (!await ConfirmDangerousCommandAsync(parameter))\n        return;\n\n    SetupExecutionUI();\n\n    try\n    {\n        var result = await ExecuteWithTimerAsync(parameter);\n        await ProcessExecutionResultAsync(parameter, result);\n        await UpdateHistoryAsync(parameter, result);\n    }\n    catch (Exception ex)\n    {\n        HandleExecutionError(ex);\n    }\n    finally\n    {\n        CleanupExecution();\n    }\n}\n\nprivate bool ValidateParameter(ExecuteCommandParameter parameter)\n{\n    if (!string.IsNullOrWhiteSpace(parameter.Command))\n        return true;\n\n    _notificationService.ShowWarning(\n        \"Pas de commande valide \u00e0 ex\u00e9cuter\",\n        \"Erreur d'ex\u00e9cution\");\n    return false;\n}\n\nprivate async Task&lt;bool&gt; ConfirmDangerousCommandAsync(ExecuteCommandParameter parameter)\n{\n    if (!parameter.IsDangerous || !parameter.RequireConfirmation)\n        return true;\n\n    return _notificationService.ShowConfirmation(\n        $\"\u26a0\ufe0f ATTENTION: Cette commande peut causer des modifications syst\u00e8me.\\n\\nCommande: {parameter.Command}\\n\\n\u00cates-vous s\u00fbr?\",\n        \"Confirmation de commande dangereuse\");\n}\n\nprivate void SetupExecutionUI()\n{\n    OutputLines.Clear();\n    IsExecuting = true;\n    StatusMessage = \"Ex\u00e9cution...\";\n    ExecutionProgress = 0;\n}\n\nprivate async Task&lt;ExecutionResult&gt; ExecuteWithTimerAsync(ExecuteCommandParameter parameter)\n{\n    _executionCts = new CancellationTokenSource();\n    _executionStartTime = DateTime.Now;\n\n    StartExecutionTimer();\n\n    try\n    {\n        var settings = await _settingsService.GetSettingsAsync();\n        var timeout = Math.Min(Math.Max(settings.ExecutionTimeoutSeconds, \n            CommandExecutionConstants.MinTimeoutSeconds), \n            CommandExecutionConstants.MaxTimeoutSeconds);\n\n        LogExecutionStart(parameter, timeout);\n\n        var result = await _commandExecutionService.ExecuteAsync(\n            parameter.Command,\n            parameter.Platform,\n            _executionCts.Token,\n            timeout,\n            onOutputReceived: ProcessOutputLine);\n\n        return result;\n    }\n    finally\n    {\n        _executionTimer?.Stop();\n    }\n}\n\nprivate void StartExecutionTimer()\n{\n    _executionTimer = new System.Timers.Timer(CommandExecutionConstants.Timer_UpdateIntervalMs);\n    _executionTimer.Elapsed += (s, e) =&gt;\n    {\n        var elapsed = DateTime.Now - _executionStartTime;\n        Application.Current.Dispatcher.Invoke(() =&gt;\n        {\n            ExecutionTime = $\"{elapsed.Minutes:D2}:{elapsed.Seconds:D2}\";\n        });\n    };\n    _executionTimer.Start();\n}\n\nprivate void ProcessOutputLine(string text, bool isError)\n{\n    Application.Current.Dispatcher.Invoke(() =&gt;\n    {\n        AddOutputLine(text, isError);\n    });\n}\n\nprivate void LogExecutionStart(ExecuteCommandParameter parameter, int timeout)\n{\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Ex\u00e9cution: {parameter.Command}\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Plateforme: {parameter.Platform}\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Timeout: {timeout}s\", false);\n    AddOutputLine(\"\", false);\n}\n\nprivate async Task ProcessExecutionResultAsync(ExecuteCommandParameter parameter, ExecutionResult result)\n{\n    AddExecutionSummary(result);\n    StatusMessage = result.Success ? \"Ex\u00e9cution compl\u00e8t\u00e9e avec succ\u00e8s\" : \"Ex\u00e9cution \u00e9chou\u00e9e\";\n    ExecutionProgress = 100;\n}\n\nprivate void AddExecutionSummary(ExecutionResult result)\n{\n    AddOutputLine(\"\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Code de sortie: {result.ExitCode}\", !result.Success);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Dur\u00e9e: {result.Duration.TotalSeconds:F2}s\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Statut: {(result.Success ? \"\u2713 SUCC\u00c8S\" : \"\u2717 \u00c9CHOU\u00c9\")}\", !result.Success);\n\n    if (result.WasCancelled)\n        AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] \u26a0 Ex\u00e9cution annul\u00e9e\", true);\n    else if (result.TimedOut)\n        AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] \u26a0 Ex\u00e9cution timeout\", true);\n\n    if (!string.IsNullOrEmpty(result.ErrorMessage))\n        AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] Erreur: {result.ErrorMessage}\", true);\n}\n\nprivate async Task UpdateHistoryAsync(ExecuteCommandParameter parameter, ExecutionResult result)\n{\n    if (parameter.ActionId == null)\n        return;\n\n    var historyId = await _commandHistoryService.AddCommandAsync(\n        parameter.ActionId,\n        parameter.Command,\n        parameter.Parameters,\n        parameter.Platform,\n        parameter.ActionTitle,\n        parameter.Category);\n\n    await _commandHistoryService.UpdateWithExecutionResultsAsync(\n        historyId,\n        result.ExitCode,\n        result.Duration,\n        result.Success);\n}\n\nprivate void HandleExecutionError(Exception ex)\n{\n    _executionTimer?.Stop();\n    AddOutputLine(\"\", false);\n    AddOutputLine($\"[{DateTime.Now:HH:mm:ss}] \u2717 ERREUR: {ex.Message}\", true);\n    StatusMessage = \"Erreur d'ex\u00e9cution\";\n}\n\nprivate void CleanupExecution()\n{\n    IsExecuting = false;\n    _executionCts?.Dispose();\n    _executionCts = null;\n    _executionTimer?.Stop();\n    _executionTimer?.Dispose();\n    _executionTimer = null;\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#5-exterioriser-la-logique-dupliquee","title":"5. EXT\u00c9RIORISER LA LOGIQUE DUPLIQU\u00c9E","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#powershellgalleryservice-extract-common-deserialization","title":"PowerShellGalleryService - Extract Common Deserialization:","text":"<pre><code>private static List&lt;T&gt; DeserializeJsonSafely&lt;T&gt;(string json) where T : class\n{\n    try\n    {\n        // Try as array first\n        try\n        {\n            var items = JsonSerializer.Deserialize&lt;List&lt;T&gt;&gt;(json);\n            if (items != null)\n                return items;\n        }\n        catch\n        {\n            // Try as single object\n            var item = JsonSerializer.Deserialize&lt;T&gt;(json);\n            if (item != null)\n                return new List&lt;T&gt; { item };\n        }\n    }\n    catch (Exception ex)\n    {\n        // Log exception\n        Debug.WriteLine($\"Failed to deserialize JSON: {ex.Message}\");\n    }\n\n    return new List&lt;T&gt;();\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#usage","title":"Usage:","text":"<pre><code>public async Task&lt;IEnumerable&lt;PowerShellModule&gt;&gt; SearchModulesAsync(string query, int maxResults = 50)\n{\n    var result = await _commandExecutionService.ExecuteAsync(...);\n\n    if (!result.Success || string.IsNullOrWhiteSpace(result.Stdout))\n        return Enumerable.Empty&lt;PowerShellModule&gt;();\n\n    var moduleDtos = DeserializeJsonSafely&lt;PowerShellGalleryModuleDto&gt;(result.Stdout);\n    return moduleDtos.Select(MapToModule);\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#6-utilisation-du-service-de-localisation","title":"6. UTILISATION DU SERVICE DE LOCALISATION","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#commandgeneratorservice-avant","title":"CommandGeneratorService - Avant:","text":"<pre><code>errors.Add($\"Le param\u00e8tre '{parameter.Label}' est requis.\");\nerrors.Add($\"Le param\u00e8tre '{parameter.Label}' doit \u00eatre un nombre entier.\");\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#apres","title":"Apr\u00e8s:","text":"<pre><code>private readonly ILocalizationService _localizationService;\n\npublic bool ValidateParameters(\n    CommandTemplate template,\n    Dictionary&lt;string, string&gt; parameterValues,\n    out List&lt;string&gt; errors)\n{\n    errors = new List&lt;string&gt;();\n\n    foreach (var parameter in template.Parameters)\n    {\n        if (parameter.Required)\n        {\n            if (!parameterValues.ContainsKey(parameter.Name) ||\n                string.IsNullOrWhiteSpace(parameterValues[parameter.Name]))\n            {\n                errors.Add(_localizationService.GetString(\n                    \"Validation.RequiredParameter\",\n                    parameter.Label));\n            }\n        }\n\n        // Type validation...\n        switch (parameter.Type.ToLowerInvariant())\n        {\n            case \"int\":\n            case \"integer\":\n                if (!int.TryParse(value, out _))\n                {\n                    errors.Add(_localizationService.GetString(\n                        \"Validation.IntegerParameter\",\n                        parameter.Label));\n                }\n                break;\n        }\n    }\n\n    return errors.Count == 0;\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#7-template-selection-helper","title":"7. TEMPLATE SELECTION HELPER","text":""},{"location":"developer/RECOMMENDED_REFACTORINGS/#creer-helper-method-pour-mainviewmodel","title":"Cr\u00e9er: Helper method pour MainViewModel","text":"<pre><code>private CommandTemplate? GetActiveTemplate(Action action)\n{\n    return action.WindowsCommandTemplate ?? action.LinuxCommandTemplate;\n}\n\nprivate Platform DeterminePlatform(Action action, CommandTemplate template)\n{\n    return template == action.WindowsCommandTemplate \n        ? Platform.Windows \n        : Platform.Linux;\n}\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#usage_1","title":"Usage:","text":"<pre><code>// Au lieu de r\u00e9p\u00e9ter 4 fois:\nvar template = SelectedAction.WindowsCommandTemplate ?? SelectedAction.LinuxCommandTemplate;\nvar platform = template == SelectedAction.WindowsCommandTemplate ? Platform.Windows : Platform.Linux;\n\n// Utiliser:\nvar template = GetActiveTemplate(SelectedAction);\nvar platform = DeterminePlatform(SelectedAction, template);\n</code></pre>"},{"location":"developer/RECOMMENDED_REFACTORINGS/#resume-des-refactorisations","title":"R\u00c9SUM\u00c9 DES REFACTORISATIONS","text":"# Fichier Changement Dur\u00e9e 1 New: UIConstants.cs Centraliser les constantes 2h 2 New: WpfNotificationService.cs Impl\u00e9menter INotificationService 2h 3 MainViewModel.cs R\u00e9duire de 542 \u00e0 220 lignes 8h 4 New: CommandGenerationViewModel.cs Extraire logique commande 4h 5 New: FavoritesManagementViewModel.cs Extraire gestion favoris 3h 6 ExecutionViewModel.cs R\u00e9duire de 299 \u00e0 150 lignes 6h 7 PowerShellGalleryService.cs Extraire deserialization 2h 8 CommandGeneratorService.cs Utiliser localisation 2h 9 All ViewModels Injecter INotificationService 4h 10 SettingsViewModel.cs Utiliser ValidationConstants 1h <p>Total: ~34 heures</p>"},{"location":"developer/S2-MIGRATION-GUIDE/","title":"Sprint 2: User Personalization &amp; History - Migration Guide","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#overview","title":"Overview","text":"<p>Sprint 2 adds command history tracking, allowing users to view and reuse previously generated commands.</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#database-migration-required","title":"Database Migration Required","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#running-the-migration","title":"Running the Migration","text":"<p>Before running the application, you need to create and apply the EF Core migration for the CommandHistory table:</p> <pre><code># Navigate to the solution root\ncd /path/to/TwinShell\n\n# Create the migration\ndotnet ef migrations add AddCommandHistory --project src/TwinShell.Persistence --startup-project src/TwinShell.App\n\n# Apply the migration (or it will be applied automatically on app startup)\ndotnet ef database update --project src/TwinShell.Persistence --startup-project src/TwinShell.App\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#migration-details","title":"Migration Details","text":"<p>The migration creates a new <code>CommandHistories</code> table with the following schema:</p> <ul> <li>Id (string, PK): Unique identifier for the history entry</li> <li>UserId (string, nullable): User ID (for future multi-user support)</li> <li>ActionId (string, FK): Reference to the Action that generated this command</li> <li>GeneratedCommand (text): The complete generated command</li> <li>ParametersJson (text): JSON-serialized parameters used to generate the command</li> <li>Platform (int): Platform (Windows=0, Linux=1, Both=2)</li> <li>CreatedAt (datetime): Timestamp when the command was generated</li> <li>Category (string): Denormalized category for faster filtering</li> <li>ActionTitle (string): Denormalized action title for display without joins</li> </ul>"},{"location":"developer/S2-MIGRATION-GUIDE/#indexes-created","title":"Indexes Created","text":"<p>The migration creates the following indexes for performance:</p> <ul> <li><code>IX_CommandHistories_CreatedAt</code> - For date-based filtering and sorting</li> <li><code>IX_CommandHistories_ActionId</code> - For filtering by action</li> <li><code>IX_CommandHistories_Category</code> - For filtering by category</li> <li><code>IX_CommandHistories_Platform</code> - For filtering by platform</li> <li><code>IX_CommandHistories_UserId</code> - For future multi-user filtering</li> </ul>"},{"location":"developer/S2-MIGRATION-GUIDE/#new-features","title":"New Features","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#1-command-history-tracking","title":"1. Command History Tracking","text":"<ul> <li>Every command copied to clipboard is automatically saved to history</li> <li>Includes timestamp, parameters, and platform information</li> <li>Denormalized for fast querying without joins</li> </ul>"},{"location":"developer/S2-MIGRATION-GUIDE/#2-history-panel","title":"2. History Panel","text":"<p>Access the history panel by clicking the \"History\" tab in the main window.</p> <p>Features: - View last 1000 commands - Search by command text or action title - Filter by date range (Today, Last 7 days, Last 30 days, All) - Filter by category - Filter by platform - Copy commands directly from history - Delete individual entries - Clear all history</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#3-automatic-cleanup","title":"3. Automatic Cleanup","text":"<p>Old history entries are automatically cleaned up on app startup: - Default retention: 90 days - Configurable in <code>App.xaml.cs</code> line 90</p> <pre><code>await historyService.CleanupOldEntriesAsync(90); // Change 90 to desired days\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#breaking-changes","title":"Breaking Changes","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#mainviewmodel-constructor","title":"MainViewModel Constructor","text":"<p>The <code>MainViewModel</code> constructor now requires <code>ICommandHistoryService</code>:</p> <pre><code>// Before (Sprint 1)\npublic MainViewModel(\n    IActionService actionService,\n    ISearchService searchService,\n    ICommandGeneratorService commandGeneratorService,\n    IClipboardService clipboardService)\n\n// After (Sprint 2)\npublic MainViewModel(\n    IActionService actionService,\n    ISearchService searchService,\n    ICommandGeneratorService commandGeneratorService,\n    IClipboardService clipboardService,\n    ICommandHistoryService commandHistoryService)\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#copycommand-method","title":"CopyCommand Method","text":"<p>The <code>CopyCommand</code> method is now async:</p> <pre><code>// Before\n[RelayCommand]\nprivate void CopyCommand()\n\n// After\n[RelayCommand]\nprivate async Task CopyCommandAsync()\n</code></pre> <p>XAML Update Required: If you have custom XAML that references <code>CopyCommandCommand</code>, it will still work but now executes asynchronously.</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#performance-considerations","title":"Performance Considerations","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#database-size","title":"Database Size","text":"<ul> <li>Each history entry stores approximately 200-500 bytes</li> <li>1000 entries \u2248 200-500 KB</li> <li>Default 90-day retention with ~100 commands/day \u2248 900 KB</li> </ul>"},{"location":"developer/S2-MIGRATION-GUIDE/#query-performance","title":"Query Performance","text":"<ul> <li>Recent commands query (50 entries): &lt; 10ms</li> <li>Search with filters (1000 entries): &lt; 50ms</li> <li>Cleanup operation (1000 entries): &lt; 100ms</li> </ul>"},{"location":"developer/S2-MIGRATION-GUIDE/#indexes","title":"Indexes","text":"<p>All common query patterns are indexed for optimal performance.</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#configuration","title":"Configuration","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#adjusting-retention-period","title":"Adjusting Retention Period","text":"<p>Edit <code>src/TwinShell.App/App.xaml.cs</code>:</p> <pre><code>private async Task InitializeDatabaseAsync()\n{\n    // ...\n\n    // Change from 90 to desired days\n    await historyService.CleanupOldEntriesAsync(90);\n}\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#disabling-history-tracking","title":"Disabling History Tracking","text":"<p>To disable history tracking, comment out the history service call in <code>MainViewModel.CopyCommandAsync</code>:</p> <pre><code>[RelayCommand]\nprivate async Task CopyCommandAsync()\n{\n    if (!string.IsNullOrWhiteSpace(GeneratedCommand) &amp;&amp; ...)\n    {\n        _clipboardService.SetText(GeneratedCommand);\n\n        // Comment out these lines to disable history\n        /*\n        await _commandHistoryService.AddCommandAsync(...);\n        */\n    }\n}\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#testing","title":"Testing","text":""},{"location":"developer/S2-MIGRATION-GUIDE/#unit-tests","title":"Unit Tests","text":"<p>Run the command history service tests:</p> <pre><code>dotnet test --filter \"FullyQualifiedName~CommandHistoryServiceTests\"\n</code></pre>"},{"location":"developer/S2-MIGRATION-GUIDE/#manual-testing","title":"Manual Testing","text":"<ol> <li>Create History Entry</li> <li>Generate and copy a command</li> <li>Switch to History tab</li> <li> <p>Verify the command appears</p> </li> <li> <p>Search</p> </li> <li>Enter search text</li> <li> <p>Verify filtering works</p> </li> <li> <p>Delete</p> </li> <li>Click Delete on a history entry</li> <li> <p>Verify it's removed</p> </li> <li> <p>Clear All</p> </li> <li>Click \"Clear All\" button</li> <li>Confirm the dialog</li> <li>Verify all entries are removed</li> </ol>"},{"location":"developer/S2-MIGRATION-GUIDE/#rollback","title":"Rollback","text":"<p>If you need to rollback to Sprint 1:</p> <pre><code># Revert the migration\ndotnet ef database update 0 --project src/TwinShell.Persistence --startup-project src/TwinShell.App\n\n# Remove the migration file\ndotnet ef migrations remove --project src/TwinShell.Persistence --startup-project src/TwinShell.App\n</code></pre> <p>Then checkout the Sprint 1 code.</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#support","title":"Support","text":"<p>For issues or questions: - Check the logs in <code>%LocalAppData%\\TwinShell\\</code> - Review the database with SQLite Browser: <code>%LocalAppData%\\TwinShell\\twinshell.db</code> - Open an issue on GitHub</p>"},{"location":"developer/S2-MIGRATION-GUIDE/#next-steps","title":"Next Steps","text":"<p>Sprint 3 will add: - User favorites system - Export/Import configuration - Enhanced search in history - Recent commands widget on home page</p> <p>Implementation Date: 2025-11-16 Sprint: S2 - User Personalization &amp; History Database Version: CommandHistory_v1</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/","title":"Fonctionnalit\u00e9 de Recherche - TwinShell","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#vue-densemble","title":"Vue d'ensemble","text":"<p>Ce document d\u00e9crit le fonctionnement de la recherche dans TwinShell, les probl\u00e8mes identifi\u00e9s lors de l'audit, les corrections apport\u00e9es, et les recommandations pour l'\u00e9volution future.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#1-resume-executif","title":"1. R\u00c9SUM\u00c9 EX\u00c9CUTIF","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#problemes-identifies","title":"Probl\u00e8mes Identifi\u00e9s","text":"<p>L'audit de la fonctionnalit\u00e9 de recherche a r\u00e9v\u00e9l\u00e9 plusieurs probl\u00e8mes critiques qui emp\u00eachaient les utilisateurs de trouver des commandes existantes :</p> <ol> <li>Pas de normalisation des accents : Les recherches \"r\u00e9seau\" et \"reseau\" \u00e9taient trait\u00e9es comme diff\u00e9rentes</li> <li>Pas de normalisation des tirets/underscores : \"Get-Service\", \"Get Service\" et \"GetService\" ne matchaient pas</li> <li>Recherche stricte par sous-cha\u00eene : \"AD User\" ne trouvait pas un titre contenant \"User AD\"</li> <li>Tests insuffisants : Absence de tests pour les accents, tirets, et recherches multi-mots</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#impact","title":"Impact","text":"<p>Ces probl\u00e8mes cr\u00e9aient une exp\u00e9rience utilisateur frustrante o\u00f9 : - Les utilisateurs francophones ne trouvaient pas les commandes avec accents - Les commandes PowerShell (avec tirets) n\u00e9cessitaient une syntaxe exacte - Les recherches naturelles multi-mots \u00e9chouaient - Les variations d'\u00e9criture (casse, ponctuation) bloquaient les r\u00e9sultats</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#corrections-apportees","title":"Corrections Apport\u00e9es","text":"<ol> <li>Nouveau helper <code>TextNormalizer</code> : Normalisation compl\u00e8te du texte (accents, casse, ponctuation)</li> <li>SearchService am\u00e9lior\u00e9 : Recherche multi-mots avec logique AND</li> <li>Suite de tests compl\u00e8te : 50+ tests couvrant tous les cas limites</li> <li>Documentation : Guide complet du fonctionnement de la recherche</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#2-architecture-de-la-recherche","title":"2. ARCHITECTURE DE LA RECHERCHE","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#composants-cles","title":"Composants Cl\u00e9s","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        MainWindow.xaml                       \u2502\n\u2502                  (SearchTextBox + Filtres UI)                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      MainViewModel.cs                        \u2502\n\u2502          \u2022 OnSearchTextChanged()                             \u2502\n\u2502          \u2022 ApplyFiltersAsync()                               \u2502\n\u2502          \u2022 G\u00e8re les filtres (Platform, Category, Level)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      SearchService.cs                        \u2502\n\u2502          \u2022 SearchAsync()                                     \u2502\n\u2502          \u2022 Utilise TextNormalizer                            \u2502\n\u2502          \u2022 Recherche multi-champs avec AND logic             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     TextNormalizer.cs                        \u2502\n\u2502          \u2022 NormalizeForSearch()                              \u2502\n\u2502          \u2022 RemoveDiacritics()                                \u2502\n\u2502          \u2022 GetSearchTokens()                                 \u2502\n\u2502          \u2022 ContainsAllTokens()                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#champs-recherches","title":"Champs Recherch\u00e9s","text":"<p>La recherche s'effectue dans les champs suivants (par ordre de pertinence) :</p> Champ Source Exemple Title <code>Action.Title</code> \"Get-Service\" Description <code>Action.Description</code> \"Lists all Windows services\" Category <code>Action.Category</code> \"Windows Services\" Tags <code>Action.Tags[]</code> [\"service\", \"windows\", \"list\"] Notes <code>Action.Notes</code> \"Requires admin privileges\" Windows Template Name <code>Action.WindowsCommandTemplate.Name</code> \"Get-Service\" Windows Template Pattern <code>Action.WindowsCommandTemplate.CommandPattern</code> \"Get-Service -Name {ServiceName}\" Linux Template Name <code>Action.LinuxCommandTemplate.Name</code> \"systemctl status\" Linux Template Pattern <code>Action.LinuxCommandTemplate.CommandPattern</code> \"systemctl status {ServiceName}\""},{"location":"developer/SEARCH_FUNCTIONALITY/#3-normalisation-de-texte","title":"3. NORMALISATION DE TEXTE","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#principe","title":"Principe","text":"<p>Tous les textes (requ\u00eate ET champs des actions) sont normalis\u00e9s de mani\u00e8re identique avant la comparaison, garantissant une recherche coh\u00e9rente et pr\u00e9visible.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#etapes-de-normalisation","title":"\u00c9tapes de Normalisation","text":"<p>La m\u00e9thode <code>TextNormalizer.NormalizeForSearch(string text)</code> effectue les transformations suivantes :</p> <ol> <li>Suppression des accents/diacritiques</li> <li><code>caf\u00e9</code> \u2192 <code>cafe</code></li> <li><code>r\u00e9seau</code> \u2192 <code>reseau</code></li> <li><code>ni\u00f1o</code> \u2192 <code>nino</code></li> <li> <p><code>M\u00fcller</code> \u2192 <code>muller</code></p> </li> <li> <p>Conversion en minuscules</p> </li> <li><code>Get-Service</code> \u2192 <code>get-service</code></li> <li> <p><code>R\u00c9SEAU</code> \u2192 <code>reseau</code></p> </li> <li> <p>Remplacement des tirets, underscores et points par des espaces</p> </li> <li><code>Get-Service</code> \u2192 <code>get service</code></li> <li><code>List_AD_Users</code> \u2192 <code>list ad users</code></li> <li> <p><code>System.Management</code> \u2192 <code>system management</code></p> </li> <li> <p>Compression des espaces multiples en espaces simples</p> </li> <li> <p><code>Get    Service</code> \u2192 <code>get service</code></p> </li> <li> <p>Suppression des espaces de d\u00e9but et fin</p> </li> <li><code>get service</code> \u2192 <code>get service</code></li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#exemples-de-normalisation","title":"Exemples de Normalisation","text":"Texte Original Texte Normalis\u00e9 <code>Get-Service</code> <code>get service</code> <code>Caf\u00e9_R\u00e9seau</code> <code>cafe reseau</code> <code>System.Management.Automation</code> <code>system management automation</code> <code>Multi   Spaces</code> <code>multi spaces</code> <code>Configuraci\u00f3n del Sistema</code> <code>configuracion del sistema</code>"},{"location":"developer/SEARCH_FUNCTIONALITY/#4-recherche-multi-mots-logique-and","title":"4. RECHERCHE MULTI-MOTS (Logique AND)","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#principe_1","title":"Principe","text":"<p>Lorsque l'utilisateur saisit plusieurs mots, TOUS les mots doivent \u00eatre pr\u00e9sents dans l'action pour qu'elle soit retourn\u00e9e. L'ordre des mots n'a pas d'importance.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#fonctionnement","title":"Fonctionnement","text":"<ol> <li>La requ\u00eate est normalis\u00e9e : <code>\"AD User\"</code> \u2192 <code>\"ad user\"</code></li> <li>La requ\u00eate est tokenis\u00e9e : <code>[\"ad\", \"user\"]</code></li> <li>Pour chaque action :</li> <li>Tous les champs sont concat\u00e9n\u00e9s et normalis\u00e9s</li> <li>On v\u00e9rifie que TOUS les tokens sont pr\u00e9sents</li> <li>Si oui \u2192 action retourn\u00e9e</li> <li>Si non \u2192 action ignor\u00e9e</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#exemples","title":"Exemples","text":"Requ\u00eate Action Title Description R\u00e9sultat Raison <code>\"ad user\"</code> \"List AD Users\" \"Lists all Active Directory users\" \u2705 Match \"ad\" et \"user\" pr\u00e9sents <code>\"user password\"</code> \"Reset User Password\" \"Resets password for a specific user\" \u2705 Match \"user\" et \"password\" pr\u00e9sents <code>\"user firewall\"</code> \"Reset User Password\" \"Resets password for a specific user\" \u274c No Match \"firewall\" absent <code>\"active directory\"</code> \"List AD Users\" \"Lists all Active Directory users\" \u2705 Match \"active\" et \"directory\" pr\u00e9sents <code>\"directory active\"</code> \"List AD Users\" \"Lists all Active Directory users\" \u2705 Match Ordre indiff\u00e9rent"},{"location":"developer/SEARCH_FUNCTIONALITY/#5-flux-de-recherche-complet","title":"5. FLUX DE RECHERCHE COMPLET","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#etape-par-etape","title":"\u00c9tape par \u00c9tape","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. Utilisateur saisit \"Get Service\" dans SearchTextBox      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. OnSearchTextChanged() d\u00e9clench\u00e9 dans MainViewModel       \u2502\n\u2502    \u2192 SafeExecuteAsync(ApplyFiltersAsync)                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. ApplyFiltersAsync() r\u00e9cup\u00e8re _allActions                 \u2502\n\u2502    \u2192 Applique les filtres dans l'ordre :                     \u2502\n\u2502       a) Cat\u00e9gorie (ignor\u00e9e si recherche active)             \u2502\n\u2502       b) Favoris uniquement (si activ\u00e9)                      \u2502\n\u2502       c) Recherche textuelle (SearchService)                 \u2502\n\u2502       d) Plateforme (Windows/Linux/Both)                     \u2502\n\u2502       e) Niveau de criticit\u00e9 (Info/Run/Dangerous)            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 4. SearchService.SearchAsync()                              \u2502\n\u2502    \u2192 Normalise la requ\u00eate : \"Get Service\" \u2192 \"get service\"   \u2502\n\u2502    \u2192 Tokenise : [\"get\", \"service\"]                           \u2502\n\u2502    \u2192 Pour chaque action :                                    \u2502\n\u2502       \u2022 Normalise tous les champs                            \u2502\n\u2502       \u2022 V\u00e9rifie que TOUS les tokens sont pr\u00e9sents            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 5. R\u00e9sultats filtr\u00e9s retourn\u00e9s \u00e0 MainViewModel              \u2502\n\u2502    \u2192 FilteredActions.ReplaceRange(results)                   \u2502\n\u2502    \u2192 UI mise \u00e0 jour automatiquement (data binding)           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#6-exemples-dutilisation","title":"6. EXEMPLES D'UTILISATION","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#cas-dusage-reels","title":"Cas d'Usage R\u00e9els","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#1-recherche-de-commande-powershell","title":"1. Recherche de Commande PowerShell","text":"<p>Requ\u00eate : <code>\"Get Service\"</code></p> <p>Matching Actions : - Title: \"Get-Service\" - Description: \"Lists all Windows services\" - \u2705 Match car normalisation transforme \"Get-Service\" \u2192 \"get service\"</p> <p>Variantes qui matchent aussi : - <code>\"Get-Service\"</code> - <code>\"get service\"</code> - <code>\"GET-SERVICE\"</code> - <code>\"GetService\"</code></p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#2-recherche-avec-accents","title":"2. Recherche avec Accents","text":"<p>Requ\u00eate : <code>\"reseau\"</code> (sans accent)</p> <p>Matching Actions : - Title: \"Configuration R\u00e9seau\" - Description: \"Configure le r\u00e9seau local et les param\u00e8tres WiFi\" - Tags: [\"r\u00e9seau\", \"wifi\", \"configuration\"] - \u2705 Match car normalisation supprime les accents : \"r\u00e9seau\" \u2192 \"reseau\"</p> <p>Variantes qui matchent aussi : - <code>\"r\u00e9seau\"</code> - <code>\"R\u00c9SEAU\"</code> - <code>\"Reseau\"</code></p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#3-recherche-multi-mots","title":"3. Recherche Multi-Mots","text":"<p>Requ\u00eate : <code>\"active directory user\"</code></p> <p>Matching Actions : - Title: \"List AD Users\" - Description: \"Lists all Active Directory users\" - \u2705 Match car \"active\", \"directory\" et \"user\" sont tous pr\u00e9sents</p> <p>Requ\u00eate : <code>\"active firewall\"</code> (firewall absent)</p> <ul> <li>\u274c No Match car \"firewall\" n'est pas pr\u00e9sent</li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#4-recherche-dans-les-templates","title":"4. Recherche dans les Templates","text":"<p>Requ\u00eate : <code>\"systemctl\"</code></p> <p>Matching Actions : - Title: \"System Management Check\" - LinuxCommandTemplate.Name: \"systemctl status\" - LinuxCommandTemplate.CommandPattern: \"systemctl status {ServiceName}\" - \u2705 Match car \"systemctl\" pr\u00e9sent dans le template Linux</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#7-filtres-additionnels","title":"7. FILTRES ADDITIONNELS","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#ordre-dapplication","title":"Ordre d'Application","text":"<p>Les filtres sont appliqu\u00e9s dans l'ordre suivant (apr\u00e8s la recherche textuelle) :</p> <ol> <li>Filtre de Cat\u00e9gorie : Ignor\u00e9 si recherche textuelle active (pour montrer tous les r\u00e9sultats)</li> <li>Favoris Uniquement : Si activ\u00e9, ne garde que les actions favorites</li> <li>Recherche Textuelle : Applique la recherche normalis\u00e9e (SearchService)</li> <li>Plateforme : Windows / Linux / Both</li> <li>Niveau de Criticit\u00e9 : Info / Run / Dangerous</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#comportement-ux-important","title":"Comportement UX Important","text":"<p>\u26a0\ufe0f Quand une recherche textuelle est active, le filtre de cat\u00e9gorie est ignor\u00e9.</p> <p>Cela permet \u00e0 l'utilisateur de chercher \"Get-Service\" et de trouver la commande m\u00eame si elle n'est pas dans la cat\u00e9gorie s\u00e9lectionn\u00e9e. C'est un choix UX intentionnel pour maximiser les r\u00e9sultats pertinents.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#8-tests-automatises","title":"8. TESTS AUTOMATIS\u00c9S","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#couverture-de-tests","title":"Couverture de Tests","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#textnormalizertests-35-tests","title":"TextNormalizerTests (35+ tests)","text":"<ul> <li>\u2705 Normalisation de base (null, empty, whitespace)</li> <li>\u2705 Conversion en minuscules</li> <li>\u2705 Suppression d'accents (fran\u00e7ais, espagnol, allemand)</li> <li>\u2705 Remplacement tirets/underscores/points</li> <li>\u2705 Compression espaces multiples</li> <li>\u2705 Tokenisation multi-mots</li> <li>\u2705 V\u00e9rification pr\u00e9sence de tous les tokens</li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#searchservicetests-50-tests","title":"SearchServiceTests (50+ tests)","text":"Cat\u00e9gorie Nombre Description Basic Search 10 Recherche par title, description, category, tags, notes Punctuation Normalization 6 Tirets, underscores, points, variations PowerShell Accent Normalization 7 Accents fran\u00e7ais, espagnols, dans tous les champs Multi-Word Search 6 Logique AND, ordre indiff\u00e9rent, mots manquants Template Search 4 Recherche dans templates Windows et Linux Real-World Scenarios 5 Cas d'usage r\u00e9els"},{"location":"developer/SEARCH_FUNCTIONALITY/#execution-des-tests","title":"Ex\u00e9cution des Tests","text":"<pre><code># Tous les tests de recherche\ndotnet test --filter \"FullyQualifiedName~SearchServiceTests\"\n\n# Tests de normalisation uniquement\ndotnet test --filter \"FullyQualifiedName~TextNormalizerTests\"\n\n# Tests complets du projet Core\ndotnet test tests/TwinShell.Core.Tests/TwinShell.Core.Tests.csproj\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#9-limitations-connues","title":"9. LIMITATIONS CONNUES","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#fonctionnalites-non-implementees","title":"Fonctionnalit\u00e9s Non Impl\u00e9ment\u00e9es","text":"<ol> <li>Recherche Fuzzy : Pas de tol\u00e9rance aux fautes de frappe (ex: \"serviec\" ne trouve pas \"service\")</li> <li>Recherche par Synonymes : \"ordinateur\" ne trouve pas \"computer\"</li> <li>Recherche OR : Impossible de chercher \"service OU firewall\"</li> <li>Recherche par Expression R\u00e9guli\u00e8re : Pas de support regex</li> <li>Scoring de Pertinence : Pas de tri par pertinence (ordre de la base de donn\u00e9es)</li> <li>Recherche par Date : Impossible de filtrer par date de cr\u00e9ation/modification</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#caracteres-speciaux","title":"Caract\u00e8res Sp\u00e9ciaux","text":"<p>Les caract\u00e8res suivants sont normalis\u00e9s et ne peuvent pas \u00eatre recherch\u00e9s litt\u00e9ralement : - Tirets <code>-</code> - Underscores <code>_</code> - Points <code>.</code></p> <p>Si vous cherchez litt\u00e9ralement \"Get-Service\" (avec le tiret), cela matchera aussi \"Get Service\" et \"GetService\".</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#10-guide-de-test-manuel","title":"10. GUIDE DE TEST MANUEL","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#tests-recommandes-ui","title":"Tests Recommand\u00e9s (UI)","text":"<p>Apr\u00e8s le d\u00e9ploiement, testez les sc\u00e9narios suivants dans l'interface :</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-1-recherche-powershell","title":"Test 1 : Recherche PowerShell","text":"<ol> <li>Tapez <code>\"Get Service\"</code> (sans tiret)</li> <li>\u2705 V\u00e9rifiez que \"Get-Service\" appara\u00eet dans les r\u00e9sultats</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-2-recherche-avec-accents","title":"Test 2 : Recherche avec Accents","text":"<ol> <li>Tapez <code>\"reseau\"</code> (sans accent)</li> <li>\u2705 V\u00e9rifiez que les commandes contenant \"r\u00e9seau\" apparaissent</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-3-recherche-multi-mots","title":"Test 3 : Recherche Multi-Mots","text":"<ol> <li>Tapez <code>\"active directory\"</code></li> <li>\u2705 V\u00e9rifiez que les commandes AD contenant les deux mots apparaissent</li> <li>Tapez <code>\"active firewall\"</code></li> <li>\u2705 V\u00e9rifiez qu'aucune commande AD n'appara\u00eet (firewall manquant)</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-4-recherche-insensible-a-la-casse","title":"Test 4 : Recherche Insensible \u00e0 la Casse","text":"<ol> <li>Tapez <code>\"PASSWORD\"</code> (majuscules)</li> <li>\u2705 V\u00e9rifiez que \"Reset User Password\" appara\u00eet</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-5-recherche-dans-les-tags","title":"Test 5 : Recherche dans les Tags","text":"<ol> <li>Tapez <code>\"diagnostic\"</code></li> <li>\u2705 V\u00e9rifiez que les commandes tagu\u00e9es \"diagnostic\" apparaissent</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#test-6-filtres-combines","title":"Test 6 : Filtres Combin\u00e9s","text":"<ol> <li>S\u00e9lectionnez une cat\u00e9gorie (ex: \"Active Directory\")</li> <li>Tapez <code>\"user\"</code></li> <li>\u2705 V\u00e9rifiez que seules les commandes de cette cat\u00e9gorie contenant \"user\" apparaissent</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#11-nouvelles-fonctionnalites-2025-01","title":"11. NOUVELLES FONCTIONNALIT\u00c9S (2025-01)","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#implementees","title":"\u2705 Impl\u00e9ment\u00e9es","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#1-recherche-fuzzy-tolerance-aux-fautes","title":"1. \u2705 Recherche Fuzzy (Tol\u00e9rance aux Fautes)","text":"<p>Status : IMPL\u00c9MENT\u00c9</p> <p>La recherche fuzzy utilise l'algorithme de distance de Levenshtein pour tol\u00e9rer les fautes de frappe jusqu'\u00e0 30% de diff\u00e9rence.</p> <p>Exemples : - <code>\"serviec\"</code> \u2192 trouve <code>\"service\"</code> (2 caract\u00e8res invers\u00e9s) - <code>\"usr\"</code> \u2192 trouve <code>\"user\"</code> (1 caract\u00e8re manquant) - <code>\"netwrok\"</code> \u2192 trouve <code>\"network\"</code> (1 caract\u00e8re mal plac\u00e9)</p> <p>Impl\u00e9mentation : - <code>TextNormalizer.LevenshteinDistance()</code> : Calcule la distance entre deux cha\u00eenes - <code>TextNormalizer.IsFuzzyMatch()</code> : V\u00e9rifie si deux cha\u00eenes sont similaires (seuil 30%) - <code>TextNormalizer.GetFuzzyMatchScore()</code> : Retourne un score de similarit\u00e9 (0.0 - 1.0) - Activ\u00e9 automatiquement quand aucune correspondance exacte n'est trouv\u00e9e</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#2-scoring-de-pertinence","title":"2. \u2705 Scoring de Pertinence","text":"<p>Status : IMPL\u00c9MENT\u00c9</p> <p>Les r\u00e9sultats de recherche sont maintenant tri\u00e9s par pertinence avec un syst\u00e8me de scoring pond\u00e9r\u00e9 :</p> <p>Poids de scoring : - \ud83e\udd47 Titre : 100 points (priorit\u00e9 maximale) - \ud83e\udd48 Tags : 70 points (priorit\u00e9 haute) - \ud83e\udd49 Description : 50 points (priorit\u00e9 moyenne) - \u2b50 Cat\u00e9gorie : 40 points - \ud83d\udcdd Templates : 30 points - \ud83d\udccb Notes : 20 points - \ud83c\udfaf Bonus Fuzzy : jusqu'\u00e0 20 points suppl\u00e9mentaires</p> <p>Mod\u00e8le de donn\u00e9es : <pre><code>public class SearchResult\n{\n    public ActionModel Action { get; init; }\n    public double Score { get; init; }\n    public SearchScoreBreakdown Breakdown { get; init; }\n    public bool IsExactMatch { get; init; }\n}\n</code></pre></p> <p>Exemple de scoring : - Recherche : <code>\"Get Service\"</code> - Action A : Titre = \"Get-Service\" \u2192 Score : 100 (match titre exact) - Action B : Description = \"Get all services\" \u2192 Score : 50 (match description) - Action C : Tags = [\"service\", \"list\"] \u2192 Score : 70 (match tags) - \u2192 R\u00e9sultat tri\u00e9 : A, C, B</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#3-historique-de-recherche","title":"3. \u2705 Historique de Recherche","text":"<p>Status : IMPL\u00c9MENT\u00c9</p> <p>L'historique de recherche m\u00e9morise les recherches r\u00e9centes et populaires pour am\u00e9liorer l'exp\u00e9rience utilisateur.</p> <p>Fonctionnalit\u00e9s : - \u2705 M\u00e9morisation automatique des recherches - \u2705 Compteur de fr\u00e9quence (nombre de fois qu'une recherche a \u00e9t\u00e9 effectu\u00e9e) - \u2705 Horodatage de la derni\u00e8re recherche - \u2705 Suggestions d'autocompl\u00e9tion bas\u00e9es sur l'historique - \u2705 Recherches populaires (tri\u00e9es par fr\u00e9quence) - \u2705 Nettoyage automatique des anciennes entr\u00e9es</p> <p>Mod\u00e8le de donn\u00e9es : <pre><code>public class SearchHistory\n{\n    public string Id { get; set; }\n    public string SearchTerm { get; set; }\n    public string NormalizedSearchTerm { get; set; }\n    public int SearchCount { get; set; }\n    public int ResultCount { get; set; }\n    public DateTime LastSearchedAt { get; set; }\n    public DateTime CreatedAt { get; set; }\n    public bool WasSuccessful { get; set; }\n    public string? UserId { get; set; }\n}\n</code></pre></p> <p>API du service : <pre><code>Task AddSearchAsync(string searchTerm, int resultCount, string? userId = null);\nTask&lt;IEnumerable&lt;SearchHistory&gt;&gt; GetRecentSearchesAsync(int limit = 10, string? userId = null);\nTask&lt;IEnumerable&lt;string&gt;&gt; GetSearchSuggestionsAsync(string partialTerm, int limit = 5, string? userId = null);\nTask&lt;IEnumerable&lt;SearchHistory&gt;&gt; GetPopularSearchesAsync(int limit = 10, string? userId = null);\nTask ClearHistoryAsync(string? userId = null);\nTask DeleteSearchAsync(string id);\n</code></pre></p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#4-metriques-uiux","title":"4. \u2705 M\u00e9triques UI/UX","text":"<p>Status : IMPL\u00c9MENT\u00c9</p> <p>L'interface affiche maintenant des m\u00e9triques de recherche en temps r\u00e9el :</p> <p>M\u00e9triques affich\u00e9es : - \ud83d\udcca Nombre de r\u00e9sultats : Affiche combien d'actions correspondent \u00e0 la recherche - \u23f1\ufe0f Temps de recherche : Temps d'ex\u00e9cution de la recherche (en ms ou secondes) - \ud83d\udca1 Suggestions : Liste des suggestions d'autocompl\u00e9tion bas\u00e9es sur l'historique</p> <p>Propri\u00e9t\u00e9s ViewModel : <pre><code>[ObservableProperty]\nprivate int _searchResultCount;\n\n[ObservableProperty]\nprivate string _searchTime = string.Empty;\n\n[ObservableProperty]\nprivate bool _showSearchMetrics;\n\n[ObservableProperty]\nprivate ObservableCollection&lt;string&gt; _searchSuggestions = new();\n</code></pre></p> <p>Exemple d'affichage : <pre><code>Recherche : \"service\"\n\ud83d\udcca 142 r\u00e9sultats trouv\u00e9s en \u23f1\ufe0f 23ms\n\ud83d\udca1 Suggestions : \"service windows\", \"service linux\", \"service network\"\n</code></pre></p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#12-recommandations-futures","title":"12. RECOMMANDATIONS FUTURES","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#ameliorations-additionnelles","title":"Am\u00e9liorations Additionnelles","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#4-recherche-avancee-operateurs","title":"4. Recherche Avanc\u00e9e (Op\u00e9rateurs)","text":"<ul> <li>Support de <code>OR</code> : <code>\"service | firewall\"</code></li> <li>Support de <code>NOT</code> : <code>\"user -password\"</code></li> <li>Support de guillemets : <code>\"exact phrase\"</code></li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#5-filtres-sauvegardes","title":"5. Filtres Sauvegard\u00e9s","text":"<ul> <li>Permettre de sauvegarder des combinaisons de filtres</li> <li>Exemple : \"Commandes Windows dangereuses\"</li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#6-performance-pour-grandes-bases","title":"6. Performance pour Grandes Bases","text":"<ul> <li>Si &gt; 10 000 actions : impl\u00e9menter un index full-text SQLite FTS5</li> <li>Recherche asynchrone avec debouncing plus agressif</li> <li>Pagination des r\u00e9sultats</li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#12-changements-techniques-2025-01","title":"12. CHANGEMENTS TECHNIQUES (2025-01)","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#fichiers-crees","title":"Fichiers Cr\u00e9\u00e9s","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#modeles-coremodels","title":"Mod\u00e8les (Core/Models)","text":"<ol> <li><code>SearchResult.cs</code></li> <li>Nouveau mod\u00e8le pour les r\u00e9sultats de recherche avec scoring</li> <li>Contient : Action, Score, Breakdown, IsExactMatch</li> <li> <p>Utilis\u00e9 par SearchService pour retourner des r\u00e9sultats tri\u00e9s</p> </li> <li> <p><code>SearchHistory.cs</code></p> </li> <li>Mod\u00e8le pour l'historique de recherche</li> <li>Champs : SearchTerm, NormalizedSearchTerm, SearchCount, ResultCount, etc.</li> <li>Support multi-utilisateurs avec UserId optionnel</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#services","title":"Services","text":"<ol> <li><code>SearchHistoryService.cs</code></li> <li>Service pour g\u00e9rer l'historique de recherche</li> <li>M\u00e9thodes : AddSearchAsync, GetRecentSearchesAsync, GetSearchSuggestionsAsync, etc.</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#interfaces","title":"Interfaces","text":"<ol> <li><code>ISearchHistoryService.cs</code></li> <li> <p>Interface pour SearchHistoryService</p> </li> <li> <p><code>ISearchHistoryRepository.cs</code></p> </li> <li>Interface pour le repository de l'historique de recherche</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#persistence","title":"Persistence","text":"<ol> <li><code>SearchHistoryEntity.cs</code></li> <li> <p>Entit\u00e9 EF Core pour l'historique de recherche</p> </li> <li> <p><code>SearchHistoryConfiguration.cs</code></p> </li> <li>Configuration EF Core avec index pour performance</li> <li> <p>Index sur : LastSearchedAt, SearchCount, NormalizedSearchTerm, UserId</p> </li> <li> <p><code>SearchHistoryRepository.cs</code></p> </li> <li> <p>Impl\u00e9mentation du repository avec requ\u00eates optimis\u00e9es</p> </li> <li> <p><code>SearchHistoryMapper.cs</code></p> </li> <li>Mapper entre SearchHistory (mod\u00e8le) et SearchHistoryEntity</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#fichiers-modifies","title":"Fichiers Modifi\u00e9s","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#textnormalizercs","title":"TextNormalizer.cs","text":"<p>Nouvelles m\u00e9thodes ajout\u00e9es : - <code>LevenshteinDistance(string source, string target)</code> : Calcule la distance de Levenshtein - <code>IsFuzzyMatch(string source, string target, double maxDistanceRatio = 0.3)</code> : V\u00e9rifie la similarit\u00e9 fuzzy - <code>GetFuzzyMatchScore(string searchableText, string searchToken)</code> : Retourne le score de similarit\u00e9 (0.0-1.0)</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#searchservicecs","title":"SearchService.cs","text":"<p>Refactorisation majeure : - Ajout de constantes pour les poids de scoring - Nouvelle m\u00e9thode <code>SearchWithScoringAsync()</code> : Retourne des SearchResult avec scores - Modification de <code>SearchAsync()</code> : Utilise maintenant le scoring en interne - Nouvelles m\u00e9thodes priv\u00e9es :   - <code>CalculateRelevanceScore()</code> : Calcule le score de pertinence par champ   - <code>CalculateFuzzyMatchScore()</code> : Calcule le score fuzzy si aucune correspondance exacte</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#twinshelldbcontextcs","title":"TwinShellDbContext.cs","text":"<ul> <li>Ajout du DbSet <code>SearchHistories</code></li> <li>Ajout de la configuration <code>SearchHistoryConfiguration</code></li> </ul>"},{"location":"developer/SEARCH_FUNCTIONALITY/#mainviewmodelcs","title":"MainViewModel.cs","text":"<p>Nouvelles propri\u00e9t\u00e9s observables : - <code>SearchResultCount</code> : Nombre de r\u00e9sultats - <code>SearchTime</code> : Temps de recherche - <code>ShowSearchMetrics</code> : Afficher/masquer les m\u00e9triques - <code>SearchSuggestions</code> : Collection de suggestions d'autocompl\u00e9tion</p> <p>Champ ajout\u00e9 : - <code>ISearchHistoryService _searchHistoryService</code> : Service d'historique de recherche</p> <p>Modifications de m\u00e9thodes : - <code>ApplyFiltersAsync()</code> :   - Ajout de chronom\u00e9trage avec Stopwatch   - Enregistrement automatique dans l'historique de recherche   - Mise \u00e0 jour des m\u00e9triques UI   - Appel de <code>UpdateSearchSuggestionsAsync()</code> - Nouvelle m\u00e9thode <code>UpdateSearchSuggestionsAsync()</code> : Met \u00e0 jour les suggestions</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#appxamlcs","title":"App.xaml.cs","text":"<p>Enregistrement DI : - <code>services.AddScoped&lt;ISearchHistoryRepository, SearchHistoryRepository&gt;()</code> - <code>services.AddScoped&lt;ISearchHistoryService, SearchHistoryService&gt;()</code></p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#architecture-de-la-nouvelle-fonctionnalite","title":"Architecture de la Nouvelle Fonctionnalit\u00e9","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      MainViewModel.cs                        \u2502\n\u2502  \u2022 ApplyFiltersAsync() - Chronom\u00e9trage et m\u00e9triques         \u2502\n\u2502  \u2022 UpdateSearchSuggestionsAsync() - Suggestions             \u2502\n\u2502  \u2022 SearchResultCount, SearchTime, SearchSuggestions         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      SearchService.cs                        \u2502\n\u2502  \u2022 SearchWithScoringAsync() - Recherche avec scoring        \u2502\n\u2502  \u2022 CalculateRelevanceScore() - Calcul du score              \u2502\n\u2502  \u2022 CalculateFuzzyMatchScore() - Score fuzzy                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     TextNormalizer.cs                        \u2502\n\u2502  \u2022 LevenshteinDistance() - Distance entre cha\u00eenes           \u2502\n\u2502  \u2022 IsFuzzyMatch() - V\u00e9rification similarit\u00e9                 \u2502\n\u2502  \u2022 GetFuzzyMatchScore() - Score de similarit\u00e9               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                         +\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  SearchHistoryService.cs                     \u2502\n\u2502  \u2022 AddSearchAsync() - Enregistre une recherche              \u2502\n\u2502  \u2022 GetSearchSuggestionsAsync() - Suggestions                \u2502\n\u2502  \u2022 GetRecentSearchesAsync() - Historique r\u00e9cent             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                SearchHistoryRepository.cs                    \u2502\n\u2502  \u2022 AddOrUpdateAsync() - Upsert avec compteur               \u2502\n\u2502  \u2022 SearchAsync() - Recherche partielle avec Like           \u2502\n\u2502  \u2022 GetRecentAsync() - Top N r\u00e9cents                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2502\n                         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  TwinShellDbContext.cs                       \u2502\n\u2502  \u2022 DbSet&lt;SearchHistoryEntity&gt; SearchHistories              \u2502\n\u2502  \u2022 Table : SearchHistories (SQLite)                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#statistiques-de-code","title":"Statistiques de Code","text":"Composant Lignes Ajout\u00e9es Fichiers Cr\u00e9\u00e9s Fichiers Modifi\u00e9s TextNormalizer ~130 0 1 SearchService ~150 1 (SearchResult.cs) 1 SearchHistory ~300 7 0 MainViewModel ~100 0 1 Persistence ~180 4 1 (DbContext) DI / App ~2 0 1 Total ~862 12 5"},{"location":"developer/SEARCH_FUNCTIONALITY/#13-changements-techniques-detailles-audit-initial","title":"13. CHANGEMENTS TECHNIQUES D\u00c9TAILL\u00c9S (AUDIT INITIAL)","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#fichiers-crees_1","title":"Fichiers Cr\u00e9\u00e9s","text":"<ol> <li><code>src/TwinShell.Core/Helpers/TextNormalizer.cs</code></li> <li>Nouveau helper de normalisation de texte</li> <li>4 m\u00e9thodes publiques : <code>NormalizeForSearch</code>, <code>RemoveDiacritics</code>, <code>GetSearchTokens</code>, <code>ContainsAllTokens</code></li> <li> <p>Supporte les accents fran\u00e7ais, espagnols, allemands, etc.</p> </li> <li> <p><code>tests/TwinShell.Core.Tests/Helpers/TextNormalizerTests.cs</code></p> </li> <li>35+ tests unitaires pour TextNormalizer</li> <li>Couvre tous les cas limites et int\u00e9grations</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#fichiers-modifies_1","title":"Fichiers Modifi\u00e9s","text":"<ol> <li><code>src/TwinShell.Core/Services/SearchService.cs</code></li> <li>AVANT : Recherche simple par <code>IndexOf</code> case-insensitive</li> <li>APR\u00c8S : Recherche normalis\u00e9e multi-mots avec logique AND</li> <li> <p>Nouvelles m\u00e9thodes priv\u00e9es :</p> <ul> <li><code>ActionMatchesSearch()</code> : V\u00e9rifie si une action matche la recherche</li> <li><code>BuildNormalizedSearchableText()</code> : Concat\u00e8ne et normalise tous les champs</li> </ul> </li> <li> <p><code>tests/TwinShell.Core.Tests/Services/SearchServiceTests.cs</code></p> </li> <li>AVANT : 11 tests basiques</li> <li>APR\u00c8S : 50+ tests complets</li> <li>Nouvelles cat\u00e9gories :<ul> <li>Punctuation Normalization (6 tests)</li> <li>Accent Normalization (7 tests)</li> <li>Multi-Word Search (6 tests)</li> <li>Template Search (4 tests)</li> <li>Real-World Scenarios (5 tests)</li> </ul> </li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#13-migration-et-deploiement","title":"13. MIGRATION ET D\u00c9PLOIEMENT","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#aucune-migration-requise","title":"Aucune Migration Requise","text":"<p>\u2705 Pas de changement de base de donn\u00e9es</p> <p>Les modifications sont purement logiques (code) et n'affectent pas le sch\u00e9ma de base de donn\u00e9es. Aucune migration EF Core n'est n\u00e9cessaire.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#compatibilite-descendante","title":"Compatibilit\u00e9 Descendante","text":"<p>\u2705 100% compatible</p> <p>Les anciennes recherches continuent de fonctionner. Les nouvelles normalisations sont additives : elles rendent la recherche plus permissive, jamais plus restrictive.</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#deploiement-recommande","title":"D\u00e9ploiement Recommand\u00e9","text":"<ol> <li>Build : <code>dotnet build --configuration Release</code></li> <li>Tests : <code>dotnet test</code></li> <li>D\u00e9ploiement : Remplacer les binaires de l'application</li> <li>Red\u00e9marrage : Aucun red\u00e9marrage de base de donn\u00e9es requis</li> </ol>"},{"location":"developer/SEARCH_FUNCTIONALITY/#14-contact-et-support","title":"14. CONTACT ET SUPPORT","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#questions-frequentes","title":"Questions Fr\u00e9quentes","text":"<p>Q : Pourquoi ma recherche \"Get-Service\" ne trouve-t-elle pas \"GetService\" ?</p> <p>R : Elle le trouve ! Les tirets sont normalis\u00e9s en espaces, donc \"Get-Service\", \"Get Service\" et \"GetService\" matchent tous.</p> <p>Q : La recherche est-elle sensible aux accents ?</p> <p>R : Non, les accents sont ignor\u00e9s. \"caf\u00e9\" et \"cafe\" sont \u00e9quivalents.</p> <p>Q : Puis-je chercher \"service OU firewall\" ?</p> <p>R : Non, actuellement seule la logique AND est support\u00e9e. \"service firewall\" cherche les actions contenant les deux mots.</p> <p>Q : Pourquoi mes r\u00e9sultats ne sont-ils pas tri\u00e9s par pertinence ?</p> <p>R : Le tri par pertinence n'est pas encore impl\u00e9ment\u00e9. C'est une am\u00e9lioration future recommand\u00e9e (voir section 11).</p>"},{"location":"developer/SEARCH_FUNCTIONALITY/#annexes","title":"Annexes","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#a-exemples-de-code","title":"A. Exemples de Code","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#utilisation-de-textnormalizer","title":"Utilisation de TextNormalizer","text":"<pre><code>using TwinShell.Core.Helpers;\n\n// Normaliser une requ\u00eate utilisateur\nvar query = \"Get-Service R\u00e9seau\";\nvar normalized = TextNormalizer.NormalizeForSearch(query);\n// R\u00e9sultat : \"get service reseau\"\n\n// Tokeniser la requ\u00eate\nvar tokens = TextNormalizer.GetSearchTokens(normalized);\n// R\u00e9sultat : [\"get\", \"service\", \"reseau\"]\n\n// V\u00e9rifier si tous les tokens sont pr\u00e9sents\nvar searchableText = \"get windows service network reseau configuration\";\nvar matches = TextNormalizer.ContainsAllTokens(searchableText, tokens);\n// R\u00e9sultat : true (tous les tokens sont pr\u00e9sents)\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#utilisation-de-searchservice","title":"Utilisation de SearchService","text":"<pre><code>using TwinShell.Core.Services;\nusing TwinShell.Core.Models;\n\nvar searchService = new SearchService();\nvar allActions = await _actionService.GetAllActionsAsync();\n\n// Recherche simple\nvar results = await searchService.SearchAsync(allActions, \"service\");\n\n// Recherche multi-mots\nvar results2 = await searchService.SearchAsync(allActions, \"active directory\");\n\n// Recherche avec accents\nvar results3 = await searchService.SearchAsync(allActions, \"r\u00e9seau\");\n</code></pre>"},{"location":"developer/SEARCH_FUNCTIONALITY/#b-statistiques-de-couverture","title":"B. Statistiques de Couverture","text":"Composant Lignes de Code Tests Couverture <code>TextNormalizer</code> 150 35+ ~95% <code>SearchService</code> 120 50+ ~90% Total 270 85+ ~92%"},{"location":"developer/SEARCH_FUNCTIONALITY/#c-changelog","title":"C. Changelog","text":""},{"location":"developer/SEARCH_FUNCTIONALITY/#version-110-2025-01","title":"Version 1.1.0 (2025-01)","text":"<p>Nouvelles Fonctionnalit\u00e9s : - \u2728 Normalisation compl\u00e8te des accents/diacritiques - \u2728 Normalisation des tirets, underscores et points - \u2728 Recherche multi-mots avec logique AND - \u2728 Recherche dans les templates de commandes - \u2728 85+ tests automatis\u00e9s complets</p> <p>Corrections de Bugs : - \ud83d\udc1b Commandes avec tirets non trouv\u00e9es sans tiret - \ud83d\udc1b Commandes avec accents non trouv\u00e9es sans accents - \ud83d\udc1b Recherche multi-mots ne fonctionnant pas - \ud83d\udc1b Templates de commandes non index\u00e9s</p> <p>Am\u00e9liorations : - \ud83d\udcda Documentation compl\u00e8te de la fonctionnalit\u00e9 de recherche - \ud83e\uddea Suite de tests exhaustive (de 11 \u00e0 85+ tests) - \ud83c\udfa8 Code refactoris\u00e9 et comment\u00e9</p> <p>Document cr\u00e9\u00e9 le : 2025-01 Derni\u00e8re mise \u00e0 jour : 2025-11-26 Version : 1.2.0 Auteur : Audit de la fonctionnalit\u00e9 de recherche TwinShell</p>"},{"location":"developer/SECURITY/","title":"Security Policy","text":""},{"location":"developer/SECURITY/#overview","title":"Overview","text":"<p>TwinShell est con\u00e7u avec la s\u00e9curit\u00e9 comme priorit\u00e9. Ce document d\u00e9crit les pratiques de s\u00e9curit\u00e9 impl\u00e9ment\u00e9es dans le projet et comment signaler des vuln\u00e9rabilit\u00e9s.</p>"},{"location":"developer/SECURITY/#pratiques-de-securite-implementees","title":"Pratiques de S\u00e9curit\u00e9 Impl\u00e9ment\u00e9es","text":""},{"location":"developer/SECURITY/#1-protection-contre-les-injections-de-commandes","title":"1. Protection Contre les Injections de Commandes","text":"<p>Protection : Validation stricte de tous les param\u00e8tres utilisateur avant g\u00e9n\u00e9ration de commandes.</p> <p>Impl\u00e9mentation : - Validation des param\u00e8tres via <code>CommandGeneratorService</code> - Sanitization des entr\u00e9es utilisateur - Whitelist de caract\u00e8res autoris\u00e9s pour les param\u00e8tres - \u00c9chappement automatique des caract\u00e8res sp\u00e9ciaux - Longueur maximale de 256 caract\u00e8res par param\u00e8tre</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Services/CommandGeneratorService.cs</code> - <code>src/TwinShell.Core/Constants/ValidationConstants.cs</code></p>"},{"location":"developer/SECURITY/#2-protection-path-traversal","title":"2. Protection Path Traversal","text":"<p>Protection : Validation des chemins de fichiers pour emp\u00eacher l'acc\u00e8s \u00e0 des r\u00e9pertoires non autoris\u00e9s.</p> <p>Impl\u00e9mentation : - V\u00e9rification que les chemins restent dans les r\u00e9pertoires autoris\u00e9s - D\u00e9tection de patterns malveillants (<code>..</code>, <code>~</code>, UNC paths) - Rejet des liens symboliques et junction points - Sandboxing des op\u00e9rations de fichiers dans des r\u00e9pertoires sp\u00e9cifiques</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Services/ConfigurationService.cs</code> (lignes 339-401) - <code>src/TwinShell.Core/Services/AuditLogService.cs</code> (lignes 89-125)</p>"},{"location":"developer/SECURITY/#3-gestion-securisee-des-exceptions","title":"3. Gestion S\u00e9curis\u00e9e des Exceptions","text":"<p>Protection : Les d\u00e9tails d'exception ne sont jamais expos\u00e9s aux utilisateurs pour \u00e9viter la fuite d'informations sensibles.</p> <p>Impl\u00e9mentation : - Messages d'erreur g\u00e9n\u00e9riques pour les utilisateurs - Logging d\u00e9taill\u00e9 uniquement dans les fichiers logs - Pas d'exposition des stack traces dans l'UI - Sanitization des informations d'erreur avant affichage</p> <p>Pattern utilis\u00e9 : <pre><code>catch (Exception ex)\n{\n    // SECURITY: Don't expose exception details to users\n    StatusMessage = _localizationService.GetString(MessageKeys.CommonError);\n    // Log details internally only\n}\n</code></pre></p>"},{"location":"developer/SECURITY/#4-validation-des-entrees-utilisateur","title":"4. Validation des Entr\u00e9es Utilisateur","text":"<p>Protection : Toutes les entr\u00e9es sont valid\u00e9es avant traitement.</p> <p>Limites de s\u00e9curit\u00e9 : - Commandes : max 1024 caract\u00e8res - Param\u00e8tres : max 256 caract\u00e8res - Chemins de fichiers : max 260 caract\u00e8res - Fichiers d'import : max 10 MB - Historique d'import : max 10000 entr\u00e9es - Favoris d'import : max 1000 entr\u00e9es</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Constants/ValidationConstants.cs</code></p>"},{"location":"developer/SECURITY/#5-protection-dos-denial-of-service","title":"5. Protection DoS (Denial of Service)","text":"<p>Protection : Limites sur les op\u00e9rations co\u00fbteuses pour \u00e9viter l'\u00e9puisement des ressources.</p> <p>Impl\u00e9mentation : - Timeout d'ex\u00e9cution : 30s par d\u00e9faut, max 300s - Limite d'historique : 100,000 entr\u00e9es max - Limite de favoris : 50 max par utilisateur - Validation de la taille des fichiers JSON import\u00e9s - Pagination des grandes collections (50 items par page)</p>"},{"location":"developer/SECURITY/#6-concurrence-et-race-conditions","title":"6. Concurrence et Race Conditions","text":"<p>Protection : Utilisation de SemaphoreSlim pour prot\u00e9ger les sections critiques.</p> <p>Impl\u00e9mentation : - Locks sur les op\u00e9rations de filtrage (<code>MainViewModel</code>, <code>HistoryViewModel</code>) - Thread-safety dans <code>ExecutionViewModel</code> avec <code>_lock</code> object - Disposal pattern correctement impl\u00e9ment\u00e9 avec IDisposable - Pr\u00e9vention des memory leaks via disposal des SemaphoreSlim</p> <p>Exemple : <pre><code>private readonly SemaphoreSlim _filterSemaphore = new SemaphoreSlim(1, 1);\n\nawait _filterSemaphore.WaitAsync();\ntry\n{\n    // Critical section\n}\nfinally\n{\n    _filterSemaphore.Release();\n}\n</code></pre></p>"},{"location":"developer/SECURITY/#7-cryptographie-et-stockage-securise","title":"7. Cryptographie et Stockage S\u00e9curis\u00e9","text":"<p>Protection : Pas de stockage de mots de passe ou donn\u00e9es sensibles en clair.</p> <p>Impl\u00e9mentation : - Aucun credential n'est stock\u00e9 dans le code - Configuration s\u00e9curis\u00e9e via UserSettings - Pas de hardcoded secrets ou API keys - Variables d'environnement pour configuration sensible</p>"},{"location":"developer/SECURITY/#8-validation-json","title":"8. Validation JSON","text":"<p>Protection : Validation structurelle avant d\u00e9s\u00e9rialisation pour \u00e9viter les attaques par JSON malform\u00e9.</p> <p>Impl\u00e9mentation : - Sch\u00e9ma JSON valid\u00e9 avant parse - Limites sur les tailles de tableaux (DoS protection) - V\u00e9rification des types de donn\u00e9es - Protection contre les objets JSON excessivement imbriqu\u00e9s</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Services/ConfigurationService.cs</code> (lignes 406-448)</p>"},{"location":"developer/SECURITY/#9-powershell-gallery-security","title":"9. PowerShell Gallery Security","text":"<p>Protection : Validation et sanitization des requ\u00eates vers PowerShell Gallery.</p> <p>Impl\u00e9mentation : - Validation des noms de modules (regex pattern) - Limite de r\u00e9sultats de recherche : 50 - Timeout des installations : 300s - Sanitization des queries de recherche - Protection contre les noms de modules malicieux</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code></p>"},{"location":"developer/SECURITY/#10-audit-logging","title":"10. Audit Logging","text":"<p>Protection : Tra\u00e7abilit\u00e9 compl\u00e8te des actions critiques.</p> <p>Impl\u00e9mentation : - Log de toutes les ex\u00e9cutions de commandes - Timestamp, commande, platform, exit code, dur\u00e9e - Export s\u00e9curis\u00e9 des logs en CSV - Rotation automatique des logs (365 jours par d\u00e9faut) - CSV escaping pour pr\u00e9venir injection</p> <p>Fichiers concern\u00e9s : - <code>src/TwinShell.Core/Services/AuditLogService.cs</code> - <code>src/TwinShell.Persistence/Repositories/AuditLogRepository.cs</code></p>"},{"location":"developer/SECURITY/#vulnerabilites-connues-corrigees","title":"Vuln\u00e9rabilit\u00e9s Connues Corrig\u00e9es","text":""},{"location":"developer/SECURITY/#sprint-audit-de-securite-commit-2c383c1","title":"Sprint Audit de S\u00e9curit\u00e9 (Commit 2c383c1)","text":"<p>15 vuln\u00e9rabilit\u00e9s critiques corrig\u00e9es : 1. Command injection dans CommandGeneratorService 2. Path traversal dans ConfigurationService 3. Memory leaks (SemaphoreSlim non dispos\u00e9s) 4. Race conditions dans ViewModels 5. Exception information disclosure 6. DoS via large file imports 7. DoS via infinite JSON arrays 8. SQL injection potential dans SearchAsync 9. Unhandled exceptions crashing app 10. Timer resource leaks dans ExecutionViewModel 11. Hardcoded sensitive values 12. Missing input validation 13. Insecure file operations 14. Fragile count checks (replaced with flags) 15. Missing thread synchronization</p>"},{"location":"developer/SECURITY/#signaler-une-vulnerabilite","title":"Signaler une Vuln\u00e9rabilit\u00e9","text":"<p>Si vous d\u00e9couvrez une vuln\u00e9rabilit\u00e9 de s\u00e9curit\u00e9 dans TwinShell, merci de suivre le processus de divulgation responsable :</p>"},{"location":"developer/SECURITY/#processus-de-signalement","title":"Processus de Signalement","text":"<ol> <li>NE PAS cr\u00e9er une issue publique GitHub</li> <li>Envoyer un email \u00e0 : [SECURITY_EMAIL_TO_BE_CONFIGURED]</li> <li>Inclure :</li> <li>Description d\u00e9taill\u00e9e de la vuln\u00e9rabilit\u00e9</li> <li>Steps pour reproduire</li> <li>Impact potentiel</li> <li>Version affect\u00e9e</li> <li>Toute preuve de concept (PoC)</li> </ol>"},{"location":"developer/SECURITY/#temps-de-reponse","title":"Temps de R\u00e9ponse","text":"<ul> <li>Accus\u00e9 de r\u00e9ception : 48 heures</li> <li>\u00c9valuation initiale : 1 semaine</li> <li>Correctif : Variable selon la criticit\u00e9</li> <li>Critique : 1-2 semaines</li> <li>Haute : 2-4 semaines</li> <li>Moyenne : 1-2 mois</li> <li>Basse : Prochaine release majeure</li> </ul>"},{"location":"developer/SECURITY/#credit","title":"Cr\u00e9dit","text":"<p>Les chercheurs en s\u00e9curit\u00e9 qui signalent des vuln\u00e9rabilit\u00e9s de mani\u00e8re responsable seront cr\u00e9dit\u00e9s dans les release notes (sauf demande contraire).</p>"},{"location":"developer/SECURITY/#meilleures-pratiques-pour-les-contributeurs","title":"Meilleures Pratiques pour les Contributeurs","text":""},{"location":"developer/SECURITY/#code-review","title":"Code Review","text":"<p>Toute PR doit inclure une review de s\u00e9curit\u00e9 portant sur : - Validation des entr\u00e9es utilisateur - Protection contre l'injection - Gestion s\u00e9curis\u00e9e des exceptions - Pas de hardcoded secrets - Proper disposal des ressources - Thread-safety si n\u00e9cessaire</p>"},{"location":"developer/SECURITY/#tests-de-securite","title":"Tests de S\u00e9curit\u00e9","text":"<p>Les tests doivent couvrir : - Cas limites et valeurs extr\u00eames - Entr\u00e9es malform\u00e9es - Caract\u00e8res sp\u00e9ciaux et injection - Chemins de fichiers malveillants - Concurrence et race conditions</p>"},{"location":"developer/SECURITY/#documentation","title":"Documentation","text":"<p>Toute fonctionnalit\u00e9 avec implications de s\u00e9curit\u00e9 doit \u00eatre document\u00e9e avec : - Commentaire <code>// SECURITY:</code> dans le code - Description de la protection impl\u00e9ment\u00e9e - R\u00e9f\u00e9rences aux standards (OWASP, etc.)</p>"},{"location":"developer/SECURITY/#standards-et-references","title":"Standards et R\u00e9f\u00e9rences","text":"<p>TwinShell suit les recommandations de : - OWASP Top 10 : Protection contre les vuln\u00e9rabilit\u00e9s web les plus courantes - CWE/SANS Top 25 : Weaknesses logicielles dangereuses - Microsoft Security Development Lifecycle (SDL) - .NET Security Best Practices</p>"},{"location":"developer/SECURITY/#versions-supportees","title":"Versions Support\u00e9es","text":"Version Support\u00e9e Fin de Support 1.0.x :white_check_mark: TBD &lt; 1.0 :x: Deprecated"},{"location":"developer/SECURITY/#changelog-de-securite","title":"Changelog de S\u00e9curit\u00e9","text":""},{"location":"developer/SECURITY/#version-10-2025-01","title":"Version 1.0 (2025-01)","text":"<ul> <li>\u2705 Audit de s\u00e9curit\u00e9 complet</li> <li>\u2705 15 vuln\u00e9rabilit\u00e9s critiques corrig\u00e9es</li> <li>\u2705 8 probl\u00e8mes de stabilit\u00e9 r\u00e9solus</li> <li>\u2705 Protection path traversal impl\u00e9ment\u00e9e</li> <li>\u2705 Validation compl\u00e8te des entr\u00e9es</li> <li>\u2705 Protection DoS via limites</li> <li>\u2705 Audit logging complet</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-17 Version du document : 1.0</p>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/","title":"R\u00c9SUM\u00c9 EX\u00c9CUTIF - AUDIT DE S\u00c9CURIT\u00c9 TwinShell","text":""},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#etat-des-lieux","title":"\u00c9tat des Lieux","text":"<p>Application: TwinShell v3.0 Date d'analyse: 16 Novembre 2025 Profondeur: Compl\u00e8te (Code source, architecture) Verdict: \u26a0\ufe0f NON RECOMMAND\u00c9E POUR LA PRODUCTION (Dans l'\u00e9tat actuel)</p>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#risques-identifies","title":"Risques Identifi\u00e9s","text":""},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#critique-3","title":"\ud83d\udd34 CRITIQUE (3)","text":"# Risque Impact 1 Injection de Commandes Ex\u00e9cution de code arbitraire 2 Escaping Insuffisant PowerShell/Bash Contournement de la s\u00e9curit\u00e9 3 Path Traversal Acc\u00e8s \u00e0 des fichiers syst\u00e8me critiques"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#high-6","title":"\ud83d\udfe0 HIGH (6)","text":"# Risque Impact 4 Validation d'entr\u00e9e insuffisante Injection via param\u00e8tres 5 Stack trace expos\u00e9e Information disclosure 6 userId non valid\u00e9 Acc\u00e8s non autoris\u00e9 aux donn\u00e9es 7 Module Name mal \u00e9chapp\u00e9 Injection PowerShell 8 Import sans validation Injection de configurations 9 Donn\u00e9es sensibles non chiffr\u00e9es Acc\u00e8s \u00e0 des informations priv\u00e9es"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#medium-4","title":"\ud83d\udfe1 MEDIUM (4)","text":"# Risque Impact 10 JSON non valid\u00e9 (seed file) Donn\u00e9es malveillantes 11 Processus enfants non nettoy\u00e9s Fuite de ressources 12 URIs non valid\u00e9es Injection de contenu 13 Exceptions en messages UI Fuite d'informations"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#scenario-dattaque-realiste","title":"Scenario d'Attaque R\u00e9aliste","text":""},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#scenario-1-escalade-de-privileges-critical","title":"Sc\u00e9nario 1: Escalade de Privil\u00e8ges (CRITICAL)","text":"<pre><code>1. Un utilisateur cr\u00e9e une Action avec ce template:\n   \"gpresult /S {hostname}\"\n\n2. L'utilisateur entre comme hostname:\n   \"attacker-pc &amp;&amp; whoami &gt; C:\\temp\\proof.txt\"\n\n3. CommandGeneratorService.GenerateCommand() fait:\n   command = \"gpresult /S attacker-pc &amp;&amp; whoami &gt; C:\\temp\\proof.txt\"\n\n4. Ex\u00e9cution du code arbitraire avec les privil\u00e8ges de TwinShell\n</code></pre>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#scenario-2-acces-aux-fichiers-systeme-critical","title":"Sc\u00e9nario 2: Acc\u00e8s aux Fichiers Syst\u00e8me (CRITICAL)","text":"<pre><code>1. Utilisateur appelle:\n   ConfigurationService.ExportToJsonAsync(\"../../Windows/System32/config/out.json\")\n\n2. Pas de validation du chemin\n3. R\u00e9sultat: \u00c9crasement de fichiers syst\u00e8me critiques\n</code></pre>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#scenario-3-fuite-de-credentials-high","title":"Sc\u00e9nario 3: Fuite de Credentials (HIGH)","text":"<pre><code>1. Fichiers de configuration en %APPDATA% sans chiffrement\n2. Tout utilisateur local peut lire l'historique des commandes\n3. Credentials, URLs, serveurs compromis expos\u00e9s\n</code></pre>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#priorites-de-correction","title":"Priorit\u00e9s de Correction","text":""},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#phase-1-immediat-48-heures","title":"Phase 1: IMM\u00c9DIAT (48 heures)","text":"<ul> <li>[ ] Corriger CommandGeneratorService - Injection de commandes</li> <li>[ ] Am\u00e9liorer escaping PowerShell et Bash  </li> <li>[ ] Ajouter validation des chemins de fichiers</li> <li>[ ] Tester avec vecteurs d'injection connus</li> </ul> <p>Estim\u00e9: 8-16 heures de travail</p>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#phase-2-urgent-1-2-semaines","title":"Phase 2: URGENT (1-2 semaines)","text":"<ul> <li>[ ] Valider userId/authentification</li> <li>[ ] Minimiser exposition des exceptions</li> <li>[ ] Valider sch\u00e9mas JSON</li> <li>[ ] Chiffrer donn\u00e9es sensibles</li> </ul> <p>Estim\u00e9: 16-24 heures de travail</p>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#phase-3-important-2-4-semaines","title":"Phase 3: IMPORTANT (2-4 semaines)","text":"<ul> <li>[ ] Ajouter rate limiting</li> <li>[ ] Impl\u00e9menter signatures cryptographiques</li> <li>[ ] Audit tests de s\u00e9curit\u00e9 complets</li> <li>[ ] R\u00e9vue de code compl\u00e8te</li> </ul> <p>Estim\u00e9: 20-30 heures de travail</p>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#fichiers-principalement-affectes","title":"Fichiers Principalement Affect\u00e9s","text":"Fichier Vuln\u00e9rabilit\u00e9s Criticit\u00e9 CommandGeneratorService.cs Injection, Validation CRITICAL CommandExecutionService.cs Escaping, Exceptions CRITICAL ConfigurationService.cs Path Traversal, Auth CRITICAL PowerShellGalleryService.cs Escaping, Validation HIGH SettingsService.cs Donn\u00e9es non chiffr\u00e9es HIGH JsonSeedService.cs D\u00e9s\u00e9rialisation MEDIUM PackageManagerService.cs Processus MEDIUM"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#recommandations-immediates","title":"Recommandations Imm\u00e9diates","text":""},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#ne-pas-faire","title":"\ud83d\uded1 NE PAS FAIRE","text":"<ul> <li>\u274c D\u00e9ployer en production dans l'\u00e9tat actuel</li> <li>\u274c Donner acc\u00e8s public \u00e0 l'application</li> <li>\u274c Utiliser avec des donn\u00e9es sensibles</li> <li>\u274c Accorder des privil\u00e8ges administrateur</li> </ul>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#a-faire","title":"\u2705 \u00c0 FAIRE","text":"<ul> <li>\u2705 Impl\u00e9menter les corrections CRITICAL imm\u00e9diatement</li> <li>\u2705 Effectuer une revue de code de s\u00e9curit\u00e9</li> <li>\u2705 Tester contre les vecteurs d'injection courants</li> <li>\u2705 Ajouter des tests unitaires de s\u00e9curit\u00e9</li> <li>\u2705 Impl\u00e9menter un syst\u00e8me de logging s\u00e9curis\u00e9</li> <li>\u2705 Former les d\u00e9veloppeurs aux OWASP Top 10</li> </ul>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#documents-associes","title":"Documents Associ\u00e9s","text":"<ol> <li>SECURITY_AUDIT_REPORT.md - Rapport complet d\u00e9taill\u00e9 (14 vuln\u00e9rabilit\u00e9s)</li> <li>SECURITY_FIXES.md - Guide d'impl\u00e9mentation des corrections</li> <li>Ce document - R\u00e9sum\u00e9 ex\u00e9cutif</li> </ol>"},{"location":"developer/SECURITY_EXECUTIVE_SUMMARY/#conclusion","title":"Conclusion","text":"<p>TwinShell pr\u00e9sente des risques importants de s\u00e9curit\u00e9 n\u00e9cessitant une correction imm\u00e9diate avant utilisation en production. Les vuln\u00e9rabilit\u00e9s d'injection de commandes et de path traversal sont particuli\u00e8rement graves et pourraient permettre une compromission compl\u00e8te du syst\u00e8me.</p> <p>Recommandation finale:  - Suspendre tout d\u00e9ploiement production - Impl\u00e9menter les corrections CRITICAL en priorit\u00e9 - Effectuer un audit de s\u00e9curit\u00e9 ind\u00e9pendant apr\u00e8s corrections - Mettre en place des tests de s\u00e9curit\u00e9 continus</p>"},{"location":"developer/SECURITY_FIXES/","title":"GUIDE DE CORRECTION DES FAILLES DE S\u00c9CURIT\u00c9","text":""},{"location":"developer/SECURITY_FIXES/#1-correction-de-linjection-de-commandes","title":"1. Correction de l'Injection de Commandes","text":""},{"location":"developer/SECURITY_FIXES/#11-commandgeneratorservicecs-securisation","title":"1.1 CommandGeneratorService.cs - S\u00e9curisation","text":"<p>AVANT (Vuln\u00e9rable): <pre><code>public string GenerateCommand(CommandTemplate template, Dictionary&lt;string, string&gt; parameterValues)\n{\n    var command = template.CommandPattern;\n    foreach (var parameter in template.Parameters)\n    {\n        var value = parameterValues.ContainsKey(parameter.Name)\n            ? parameterValues[parameter.Name]\n            : parameter.DefaultValue ?? string.Empty;\n\n        var placeholder = $\"{{{parameter.Name}}}\";\n        command = command.Replace(placeholder, value);  // \u274c INJECTION POSSIBLE\n    }\n    return command;\n}\n</code></pre></p> <p>APR\u00c8S (S\u00e9curis\u00e9): <pre><code>public string GenerateCommand(CommandTemplate template, Dictionary&lt;string, string&gt; parameterValues)\n{\n    var command = template.CommandPattern;\n\n    foreach (var parameter in template.Parameters)\n    {\n        var value = parameterValues.ContainsKey(parameter.Name)\n            ? parameterValues[parameter.Name]\n            : parameter.DefaultValue ?? string.Empty;\n\n        // Valider la valeur selon le type\n        if (!ValidateParameterValue(parameter, value, out var validationError))\n        {\n            throw new InvalidOperationException($\"Invalid parameter '{parameter.Name}': {validationError}\");\n        }\n\n        // \u00c9chapper pour le shell appropri\u00e9\n        var escapedValue = EscapeParameterValue(value, parameter.Type);\n\n        var placeholder = $\"{{{parameter.Name}}}\";\n        command = command.Replace(placeholder, escapedValue);\n    }\n\n    return command;\n}\n\nprivate bool ValidateParameterValue(TemplateParameter parameter, string value, out string error)\n{\n    error = string.Empty;\n\n    switch (parameter.Type.ToLower())\n    {\n        case \"hostname\":\n            if (!IsValidHostname(value))\n            {\n                error = \"Invalid hostname format\";\n                return false;\n            }\n            break;\n\n        case \"ipaddress\":\n            if (!IPAddress.TryParse(value, out _))\n            {\n                error = \"Invalid IP address\";\n                return false;\n            }\n            break;\n\n        case \"int\":\n        case \"integer\":\n            if (!int.TryParse(value, out _))\n            {\n                error = \"Must be an integer\";\n                return false;\n            }\n            break;\n\n        case \"path\":\n            if (!IsValidPath(value))\n            {\n                error = \"Invalid path format\";\n                return false;\n            }\n            break;\n\n        case \"string\":\n            if (string.IsNullOrWhiteSpace(value) &amp;&amp; parameter.Required)\n            {\n                error = \"Required field\";\n                return false;\n            }\n            if (value.Length &gt; 255)\n            {\n                error = \"String exceeds maximum length of 255\";\n                return false;\n            }\n            break;\n    }\n\n    return true;\n}\n\nprivate string EscapeParameterValue(string value, string parameterType)\n{\n    switch (parameterType.ToLower())\n    {\n        case \"hostname\":\n        case \"ipaddress\":\n        case \"int\":\n        case \"integer\":\n            return value;  // Whitelist valid\u00e9e, pas d'\u00e9chappement suppl\u00e9mentaire\n\n        case \"path\":\n        case \"string\":\n        default:\n            // N'accepter que les chemins autoris\u00e9s\n            return QuoteForShell(value);\n    }\n}\n\nprivate static string QuoteForShell(string value)\n{\n    // Utiliser des guillemets simples pour Bash (plus s\u00fbr)\n    // Si Windows/PowerShell, utiliser backquotes\n    return \"'\" + value.Replace(\"'\", \"'\\\\''\") + \"'\";\n}\n\nprivate bool IsValidHostname(string value)\n{\n    // RFC 1123 compliant hostname validation\n    if (value.Length &gt; 255)\n        return false;\n\n    var hostnameRegex = new Regex(@\"^(?!-)([a-zA-Z0-9-]{1,63}(?&lt;!-)\\.)*[a-zA-Z]{2,}$\");\n    return hostnameRegex.IsMatch(value);\n}\n\nprivate bool IsValidPath(string value)\n{\n    try\n    {\n        var fullPath = Path.GetFullPath(value);\n        // V\u00e9rifier qu'il n'y a pas de travers\u00e9e\n        return !fullPath.Contains(\"..\") &amp;&amp; \n               !fullPath.Contains(\"~\") &amp;&amp;\n               Path.IsPathRooted(fullPath);\n    }\n    catch\n    {\n        return false;\n    }\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#12-commandexecutionservicecs-ameliorer-lescaping","title":"1.2 CommandExecutionService.cs - Am\u00e9liorer l'Escaping","text":"<p>AVANT: <pre><code>private (string executable, string arguments) GetExecutableAndArguments(string command, Platform platform)\n{\n    return actualPlatform switch\n    {\n        Platform.Windows =&gt; (\"powershell.exe\", $\"-NoProfile -NonInteractive -Command \\\"{EscapeForPowerShell(command)}\\\"\"),\n        Platform.Linux =&gt; (\"bash\", $\"-c \\\"{EscapeForBash(command)}\\\"\"),\n        _ =&gt; throw new NotSupportedException($\"Platform {platform} is not supported\")\n    };\n}\n\nprivate string EscapeForPowerShell(string command)\n{\n    return command.Replace(\"\\\"\", \"\\\"\\\"\");  // \u274c INCOMPLET\n}\n\nprivate string EscapeForBash(string command)\n{\n    return command.Replace(\"\\\"\", \"\\\\\\\"\").Replace(\"$\", \"\\\\$\").Replace(\"`\", \"\\\\`\");  // \u274c INCOMPLET\n}\n</code></pre></p> <p>APR\u00c8S: <pre><code>private (string executable, string arguments) GetExecutableAndArguments(string command, Platform platform)\n{\n    var actualPlatform = platform;\n    if (platform == Platform.Both)\n    {\n        actualPlatform = OperatingSystem.IsWindows() ? Platform.Windows : Platform.Linux;\n    }\n\n    return actualPlatform switch\n    {\n        Platform.Windows =&gt; (\"powershell.exe\", BuildPowerShellCommand(command)),\n        Platform.Linux =&gt; (\"bash\", BuildBashCommand(command)),\n        _ =&gt; throw new NotSupportedException($\"Platform {platform} is not supported\")\n    };\n}\n\nprivate string BuildPowerShellCommand(string command)\n{\n    // Utiliser un script encod\u00e9 en base64 pour \u00e9viter les probl\u00e8mes d'escaping\n    var bytes = Encoding.UTF8.GetBytes(command);\n    var encoded = Convert.ToBase64String(bytes);\n    return $\"-NoProfile -NonInteractive -EncodedCommand {encoded}\";\n}\n\nprivate string BuildBashCommand(string command)\n{\n    // Utiliser la forme s\u00fbre: guillemets simples + \u00e9chappement des apostrophes\n    var escaped = \"'\" + command.Replace(\"'\", \"'\\\\''\") + \"'\";\n    return $\"-c {escaped}\";\n}\n\nprivate string EscapeForPowerShell(string command)\n{\n    // Complet - \u00e9chappe tous les caract\u00e8res sp\u00e9ciaux\n    return command\n        .Replace(\"\\\\\", \"\\\\\\\\\")\n        .Replace(\"\\\"\", \"`\\\"\")\n        .Replace(\"$\", \"`$\")\n        .Replace(\"`\", \"``\")\n        .Replace(\"'\", \"''\");\n}\n\nprivate string EscapeForBash(string command)\n{\n    // Guillemets simples = contexte litt\u00e9ral (plus s\u00fbr)\n    // Seulement les apostrophes posent probl\u00e8me\n    return \"'\" + command.Replace(\"'\", \"'\\\\''\") + \"'\";\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#2-correction-du-path-traversal","title":"2. Correction du Path Traversal","text":""},{"location":"developer/SECURITY_FIXES/#21-configurationservicecs-valider-les-chemins","title":"2.1 ConfigurationService.cs - Valider les Chemins","text":"<p>AVANT: <pre><code>public async Task&lt;(bool Success, string? ErrorMessage)&gt; ExportToJsonAsync(\n    string filePath,\n    string? userId = null,\n    bool includeHistory = true)\n{\n    var directory = Path.GetDirectoryName(filePath);\n    if (!string.IsNullOrEmpty(directory) &amp;&amp; !Directory.Exists(directory))\n    {\n        Directory.CreateDirectory(directory);  // \u274c AUCUNE VALIDATION\n    }\n\n    await File.WriteAllTextAsync(filePath, json);\n}\n</code></pre></p> <p>APR\u00c8S: <pre><code>private readonly string _baseExportDirectory;\n\npublic ConfigurationService(...)\n{\n    // Configurer le r\u00e9pertoire de base autoris\u00e9\n    _baseExportDirectory = Path.Combine(\n        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),\n        \"TwinShell\",\n        \"Exports\");\n}\n\npublic async Task&lt;(bool Success, string? ErrorMessage)&gt; ExportToJsonAsync(\n    string filePath,\n    string? userId = null,\n    bool includeHistory = true)\n{\n    try\n    {\n        // \u2705 VALIDER LE CHEMIN\n        if (!IsPathSecure(filePath))\n        {\n            return (false, \"Invalid file path\", 0, 0);\n        }\n\n        // Valider que c'est un fichier .json\n        if (!filePath.EndsWith(\".json\", StringComparison.OrdinalIgnoreCase))\n        {\n            return (false, \"File must be a JSON file\", 0, 0);\n        }\n\n        var directory = Path.GetDirectoryName(filePath);\n        if (!string.IsNullOrEmpty(directory) &amp;&amp; !Directory.Exists(directory))\n        {\n            Directory.CreateDirectory(directory);\n        }\n\n        var json = JsonSerializer.Serialize(config, JsonOptions);\n        await File.WriteAllTextAsync(filePath, json);\n\n        return (true, null);\n    }\n    catch (Exception ex)\n    {\n        _logger.LogError(ex, \"Export failed\");\n        return (false, \"Export operation failed\", 0, 0);\n    }\n}\n\nprivate bool IsPathSecure(string filePath)\n{\n    try\n    {\n        // Obtenir le chemin absolu\n        var fullPath = Path.GetFullPath(filePath);\n        var baseDirectory = Path.GetFullPath(_baseExportDirectory);\n\n        // V\u00e9rifier que le chemin commence par le r\u00e9pertoire de base\n        if (!fullPath.StartsWith(baseDirectory + Path.DirectorySeparatorChar) &amp;&amp; \n            fullPath != baseDirectory)\n        {\n            return false;\n        }\n\n        // V\u00e9rifier qu'il n'y a pas de travers\u00e9e\n        if (fullPath.Contains(\"..\") || fullPath.Contains(\"~\"))\n        {\n            return false;\n        }\n\n        return true;\n    }\n    catch\n    {\n        return false;\n    }\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#3-correction-du-logging-securise","title":"3. Correction du Logging S\u00e9curis\u00e9","text":""},{"location":"developer/SECURITY_FIXES/#31-commandexecutionservicecs-ne-pas-exposer-les-erreurs","title":"3.1 CommandExecutionService.cs - Ne pas Exposer les Erreurs","text":"<p>AVANT: <pre><code>catch (Exception ex)\n{\n    result.ErrorMessage = $\"Failed to execute command: {ex.Message}\";\n    result.Stderr = ex.ToString();  // \u274c STACK TRACE\n}\n</code></pre></p> <p>APR\u00c8S: <pre><code>catch (Exception ex)\n{\n    _logger.LogError(ex, \"Command execution failed: {Command}\", command);\n    result.ErrorMessage = \"Command execution failed\";  // \u2705 G\u00e9n\u00e9ralis\u00e9\n    result.Stderr = string.Empty;  // \u2705 Pas de d\u00e9tails\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#4-correction-de-la-deserialisation-json","title":"4. Correction de la D\u00e9s\u00e9rialisation JSON","text":""},{"location":"developer/SECURITY_FIXES/#41-jsonseedservicecs-valider-avant-deserialisation","title":"4.1 JsonSeedService.cs - Valider Avant D\u00e9s\u00e9rialisation","text":"<p>AVANT: <pre><code>var json = await File.ReadAllTextAsync(_seedFilePath);\nvar seedData = JsonSerializer.Deserialize&lt;SeedData&gt;(json, new JsonSerializerOptions\n{\n    PropertyNameCaseInsensitive = true\n});\n</code></pre></p> <p>APR\u00c8S: <pre><code>public async Task SeedAsync()\n{\n    var existingCount = await _actionRepository.CountAsync();\n    if (existingCount &gt; 0)\n    {\n        return;\n    }\n\n    if (!File.Exists(_seedFilePath))\n    {\n        throw new FileNotFoundException($\"Seed file not found: {_seedFilePath}\");\n    }\n\n    // \u2705 VALIDER LA TAILLE DU FICHIER\n    var fileInfo = new FileInfo(_seedFilePath);\n    const long maxSize = 10 * 1024 * 1024;  // 10 MB max\n    if (fileInfo.Length &gt; maxSize)\n    {\n        throw new InvalidOperationException(\"Seed file is too large\");\n    }\n\n    var json = await File.ReadAllTextAsync(_seedFilePath);\n\n    // \u2705 VALIDER LE SCH\u00c9MA AVANT D\u00c9S\u00c9RIALISATION\n    if (!ValidateJsonSchema(json))\n    {\n        throw new InvalidOperationException(\"Invalid seed file schema\");\n    }\n\n    var seedData = JsonSerializer.Deserialize&lt;SeedData&gt;(json, new JsonSerializerOptions\n    {\n        PropertyNameCaseInsensitive = true\n    });\n\n    if (seedData?.Actions == null || seedData.Actions.Count == 0)\n    {\n        return;\n    }\n\n    // \u2705 VALIDER CHAQUE ACTION\n    foreach (var action in seedData.Actions)\n    {\n        if (!ValidateAction(action))\n        {\n            throw new InvalidOperationException($\"Invalid action: {action.Title}\");\n        }\n\n        action.IsUserCreated = false;\n        action.CreatedAt = DateTime.UtcNow;\n        action.UpdatedAt = DateTime.UtcNow;\n        await _actionRepository.AddAsync(action);\n    }\n}\n\nprivate bool ValidateJsonSchema(string json)\n{\n    try\n    {\n        using (var doc = JsonDocument.Parse(json))\n        {\n            var root = doc.RootElement;\n\n            if (root.ValueKind != JsonValueKind.Object)\n                return false;\n\n            if (!root.TryGetProperty(\"Actions\", out var actions))\n                return false;\n\n            if (actions.ValueKind != JsonValueKind.Array)\n                return false;\n\n            return true;\n        }\n    }\n    catch\n    {\n        return false;\n    }\n}\n\nprivate bool ValidateAction(Action action)\n{\n    if (string.IsNullOrWhiteSpace(action.Title))\n        return false;\n\n    if (action.Title.Length &gt; 255)\n        return false;\n\n    // Valider que le template de commande ne contient pas de code suspect\n    if (!ValidateCommandTemplate(action.WindowsCommandTemplate) ||\n        !ValidateCommandTemplate(action.LinuxCommandTemplate))\n    {\n        return false;\n    }\n\n    return true;\n}\n\nprivate bool ValidateCommandTemplate(CommandTemplate? template)\n{\n    if (template == null)\n        return true;\n\n    // V\u00e9rifier que le pattern n'est pas excessivement long\n    if (template.CommandPattern.Length &gt; 4096)\n        return false;\n\n    // V\u00e9rifier qu'il n'y a pas de caract\u00e8res de contr\u00f4le\n    return !template.CommandPattern.Any(c =&gt; char.IsControl(c) &amp;&amp; c != '\\n');\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#5-correction-de-lauthentification","title":"5. Correction de l'Authentification","text":""},{"location":"developer/SECURITY_FIXES/#51-configurationservicecs-valider-lutilisateur","title":"5.1 ConfigurationService.cs - Valider l'Utilisateur","text":"<p>AVANT: <pre><code>public async Task&lt;...&gt; ExportToJsonAsync(\n    string filePath,\n    string? userId = null,  // \u274c PAS DE VALIDATION\n    bool includeHistory = true)\n{\n    config.UserId = userId;  // \u274c ACCEPT\u00c9\n}\n</code></pre></p> <p>APR\u00c8S: <pre><code>private readonly IAuthenticationService _authService;\n\npublic ConfigurationService(..., IAuthenticationService authService)\n{\n    _authService = authService ?? throw new ArgumentNullException(nameof(authService));\n}\n\npublic async Task&lt;(bool Success, string? ErrorMessage)&gt; ExportToJsonAsync(\n    string filePath,\n    bool includeHistory = true)  // \u2705 userId SUPPRIM\u00c9\n{\n    try\n    {\n        // \u2705 OBTENIR L'UTILISATEUR AUTHENTIFI\u00c9\n        var authenticatedUserId = _authService.GetCurrentUserId();\n        if (string.IsNullOrEmpty(authenticatedUserId))\n        {\n            return (false, \"User is not authenticated\", 0, 0);\n        }\n\n        var config = new UserConfigurationDto\n        {\n            Version = \"1.0\",\n            ExportDate = DateTime.UtcNow,\n            UserId = authenticatedUserId  // \u2705 DEPUIS L'AUTHENTIFICATION\n        };\n\n        // Exporter uniquement les donn\u00e9es de cet utilisateur\n        var favorites = await _favoritesRepository.GetAllAsync(authenticatedUserId);\n        config.Favorites = favorites.Select(...).ToList();\n\n        if (includeHistory)\n        {\n            var history = await _historyRepository.GetRecentAsync(1000, authenticatedUserId);\n            config.History = history.Select(...).ToList();\n        }\n\n        // ... reste du code\n    }\n    catch (Exception ex)\n    {\n        _logger.LogError(ex, \"Export failed for user {User}\", _authService.GetCurrentUserId());\n        return (false, \"Export operation failed\", 0, 0);\n    }\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#6-correction-du-chiffrement-des-donnees","title":"6. Correction du Chiffrement des Donn\u00e9es","text":""},{"location":"developer/SECURITY_FIXES/#61-settingsservicecs-chiffrer-les-donnees-sensibles","title":"6.1 SettingsService.cs - Chiffrer les Donn\u00e9es Sensibles","text":"<p>AVANT: <pre><code>var json = JsonSerializer.Serialize(settings, JsonOptions);\nawait File.WriteAllTextAsync(_settingsFilePath, json);  // \u274c EN TEXTE CLAIR\n</code></pre></p> <p>APR\u00c8S: <pre><code>using System.Security.Cryptography;\n\npublic async Task&lt;bool&gt; SaveSettingsAsync(UserSettings settings)\n{\n    try\n    {\n        if (!ValidateSettings(settings))\n        {\n            return false;\n        }\n\n        if (!Directory.Exists(_settingsDirectory))\n        {\n            Directory.CreateDirectory(_settingsDirectory);\n        }\n\n        var json = JsonSerializer.Serialize(settings, JsonOptions);\n\n        // \u2705 CHIFFRER AVANT D'\u00c9CRIRE\n        var encrypted = EncryptJson(json);\n        await File.WriteAllBytesAsync(_settingsFilePath, encrypted);\n\n        // \u2705 D\u00c9FINIR LES PERMISSIONS RESTRICTIVES\n        SetRestrictivePermissions(_settingsFilePath);\n\n        _currentSettings = settings;\n        return true;\n    }\n    catch (Exception ex)\n    {\n        _logger.LogError(ex, \"Failed to save settings\");\n        return false;\n    }\n}\n\npublic async Task&lt;UserSettings&gt; LoadSettingsAsync()\n{\n    try\n    {\n        if (!Directory.Exists(_settingsDirectory))\n        {\n            Directory.CreateDirectory(_settingsDirectory);\n        }\n\n        if (!File.Exists(_settingsFilePath))\n        {\n            _currentSettings = UserSettings.Default;\n            await SaveSettingsAsync(_currentSettings);\n            return _currentSettings;\n        }\n\n        // \u2705 D\u00c9CHIFFRER APR\u00c8S LA LECTURE\n        var encrypted = await File.ReadAllBytesAsync(_settingsFilePath);\n        var json = DecryptJson(encrypted);\n\n        var settings = JsonSerializer.Deserialize&lt;UserSettings&gt;(json, JsonOptions);\n\n        if (settings == null || !ValidateSettings(settings))\n        {\n            _currentSettings = UserSettings.Default;\n            await SaveSettingsAsync(_currentSettings);\n            return _currentSettings;\n        }\n\n        _currentSettings = settings;\n        return _currentSettings;\n    }\n    catch (Exception)\n    {\n        _currentSettings = UserSettings.Default;\n        return _currentSettings;\n    }\n}\n\nprivate byte[] EncryptJson(string json)\n{\n    var jsonBytes = Encoding.UTF8.GetBytes(json);\n\n    using (var aes = Aes.Create())\n    {\n        // G\u00e9n\u00e9rer une cl\u00e9 \u00e0 partir de credentials utilisateur\n        var key = DeriveKey();\n        aes.Key = key;\n\n        // IV al\u00e9atoire\n        using (var encryptor = aes.CreateEncryptor(aes.Key, aes.IV))\n        {\n            var encrypted = encryptor.TransformFinalBlock(jsonBytes, 0, jsonBytes.Length);\n\n            // Combiner: IV + ciphertext\n            var result = new byte[aes.IV.Length + encrypted.Length];\n            Buffer.BlockCopy(aes.IV, 0, result, 0, aes.IV.Length);\n            Buffer.BlockCopy(encrypted, 0, result, aes.IV.Length, encrypted.Length);\n\n            return result;\n        }\n    }\n}\n\nprivate string DecryptJson(byte[] encrypted)\n{\n    using (var aes = Aes.Create())\n    {\n        var key = DeriveKey();\n        aes.Key = key;\n\n        // Extraire IV et ciphertext\n        var iv = new byte[aes.IV.Length];\n        var ciphertext = new byte[encrypted.Length - aes.IV.Length];\n\n        Buffer.BlockCopy(encrypted, 0, iv, 0, aes.IV.Length);\n        Buffer.BlockCopy(encrypted, aes.IV.Length, ciphertext, 0, ciphertext.Length);\n\n        using (var decryptor = aes.CreateDecryptor(key, iv))\n        {\n            var decrypted = decryptor.TransformFinalBlock(ciphertext, 0, ciphertext.Length);\n            return Encoding.UTF8.GetString(decrypted);\n        }\n    }\n}\n\nprivate byte[] DeriveKey()\n{\n    // D\u00e9river une cl\u00e9 \u00e0 partir du SID utilisateur\n    var userSid = WindowsIdentity.GetCurrent().User.Value;\n\n    using (var pbkdf2 = new Rfc2898DeriveBytes(userSid, Encoding.UTF8.GetBytes(\"TwinShell\"), 10000, HashAlgorithmName.SHA256))\n    {\n        return pbkdf2.GetBytes(32);  // 256-bit key\n    }\n}\n\nprivate void SetRestrictivePermissions(string filePath)\n{\n    try\n    {\n        var fileInfo = new FileInfo(filePath);\n        var fileSecurity = fileInfo.GetAccessControl();\n\n        // Supprimer les permissions h\u00e9rit\u00e9es\n        fileSecurity.SetAccessRuleProtection(true, false);\n\n        // Ajouter permission seulement pour l'utilisateur courant\n        var currentUser = WindowsIdentity.GetCurrent().User;\n        var rule = new FileSystemAccessRule(\n            currentUser,\n            FileSystemRights.FullControl,\n            AccessControlType.Allow);\n\n        fileSecurity.AddAccessRule(rule);\n        fileInfo.SetAccessControl(fileSecurity);\n    }\n    catch (Exception ex)\n    {\n        _logger.LogWarning(ex, \"Failed to set restrictive permissions\");\n    }\n}\n</code></pre></p>"},{"location":"developer/SECURITY_FIXES/#resume-des-changements","title":"R\u00e9sum\u00e9 des Changements","text":"Probl\u00e8me Classe M\u00e9thode Type de Fix Injection CommandGeneratorService GenerateCommand Validation + Escaping Escaping PS CommandExecutionService EscapeForPowerShell Base64 encoding Escaping Bash CommandExecutionService EscapeForBash Guillemets simples Path Traversal ConfigurationService ExportToJsonAsync Path validation Logging CommandExecutionService ExecuteAsync catch Generic messages Deserialization JsonSeedService SeedAsync Schema validation Auth ConfigurationService ExportToJsonAsync User validation Encryption SettingsService SaveSettingsAsync AES encryption"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/","title":"CARTE DES VULN\u00c9RABILIT\u00c9S - Localisation Pr\u00e9cise","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#vue-densemble","title":"Vue d'ensemble","text":"<p>14 vuln\u00e9rabilit\u00e9s identifi\u00e9es dans 7 fichiers principaux.</p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#critical-3-vulnerabilites","title":"CRITICAL - 3 Vuln\u00e9rabilit\u00e9s","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#1-injection-de-commandes-via-commandgeneratorservice","title":"1. Injection de Commandes via CommandGeneratorService","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/CommandGeneratorService.cs</code> Lignes: 12-27 M\u00e9thode: <code>GenerateCommand(CommandTemplate, Dictionary&lt;string, string&gt;)</code> Gravit\u00e9: CRITICAL CWE: CWE-78 (OS Command Injection)</p> <p>Code vuln\u00e9rable: <pre><code>command = command.Replace(placeholder, value);  // Ligne 24\n</code></pre></p> <p>Vecteur d'attaque: <pre><code>Template: \"Get-ChildItem {path}\"\nInput: \"C:\\temp &amp;&amp; Del C:\\Windows\"\nR\u00e9sultat: \"Get-ChildItem C:\\temp &amp;&amp; Del C:\\Windows\"\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#2-escaping-powershell-insuffisant","title":"2. Escaping PowerShell Insuffisant","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Lignes: 169-173 M\u00e9thode: <code>EscapeForPowerShell(string)</code> Gravit\u00e9: CRITICAL CWE: CWE-78 (OS Command Injection)</p> <p>Code vuln\u00e9rable: <pre><code>private string EscapeForPowerShell(string command)\n{\n    return command.Replace(\"\\\"\", \"\\\"\\\"\");  // Ligne 172 - INCOMPLET\n}\n</code></pre></p> <p>Vecteur d'attaque: <pre><code>Input: `whoami`  \u2192 Ex\u00e9cute whoami\nInput: $PSVersionTable  \u2192 Acc\u00e8s aux variables\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#3-path-traversal-exporttojsonasync","title":"3. Path Traversal - ExportToJsonAsync","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/ConfigurationService.cs</code> Lignes: 33-95 M\u00e9thode: <code>ExportToJsonAsync(string, string?, bool)</code> Gravit\u00e9: CRITICAL CWE: CWE-22 (Path Traversal / Directory Traversal)</p> <p>Code vuln\u00e9rable: <pre><code>var directory = Path.GetDirectoryName(filePath);  // Ligne 80 - PAS DE VALIDATION\nif (!string.IsNullOrEmpty(directory) &amp;&amp; !Directory.Exists(directory))\n{\n    Directory.CreateDirectory(directory);  // Ligne 82\n}\n\nawait File.WriteAllTextAsync(filePath, json);  // Ligne 87 - \u00c9CRIT N'IMPORTE O\u00d9\n</code></pre></p> <p>Vecteur d'attaque: <pre><code>filePath: \"..\\\\..\\\\..\\\\Windows\\\\System32\\\\config\\\\bad.json\"\nR\u00e9sultat: \u00c9crasement de fichiers syst\u00e8me\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#high-6-vulnerabilites","title":"HIGH - 6 Vuln\u00e9rabilit\u00e9s","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#4-escaping-bash-incomplet","title":"4. Escaping Bash Incomplet","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Lignes: 178-182 M\u00e9thode: <code>EscapeForbash(string)</code> Gravit\u00e9: HIGH CWE: CWE-78</p> <p>Code vuln\u00e9rable: <pre><code>private string EscapeForBash(string command)\n{\n    return command.Replace(\"\\\"\", \"\\\\\\\"\").Replace(\"$\", \"\\\\$\").Replace(\"`\", \"\\\\`\");\n    // Ligne 181 - Pas de gestion de ;, |, &amp;\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#5-validation-dentree-insuffisante-types","title":"5. Validation d'Entr\u00e9e Insuffisante - Types","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/CommandGeneratorService.cs</code> Lignes: 45-91 M\u00e9thode: <code>ValidateParameters(CommandTemplate, Dictionary&lt;string, string&gt;, out List&lt;string&gt;)</code> Gravit\u00e9: HIGH CWE: CWE-20 (Improper Input Validation)</p> <p>Code vuln\u00e9rable: <pre><code>switch (parameter.Type.ToLowerInvariant())\n{\n    case \"int\":\n    case \"integer\":\n        // Valid\u00e9 ligne 73-76\n        break;\n    case \"bool\":\n    case \"boolean\":\n        // Valid\u00e9 ligne 80-84\n        break;\n    // CAS \"string\" MANQUANT - JAMAIS VALID\u00c9\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#6-stack-trace-exposee","title":"6. Stack Trace Expos\u00e9e","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/CommandExecutionService.cs</code> Lignes: 133-141 M\u00e9thode: <code>ExecuteAsync(...) catch block</code> Gravit\u00e9: HIGH CWE: CWE-209 (Information Exposure Through an Error Message)</p> <p>Code vuln\u00e9rable: <pre><code>catch (Exception ex)\n{\n    result.ErrorMessage = $\"Failed to execute command: {ex.Message}\";\n    result.Stderr = ex.ToString();  // Ligne 140 - STACK TRACE COMPL\u00c8TE\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#7-userid-non-valide","title":"7. userId Non Valid\u00e9","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/ConfigurationService.cs</code> Lignes: 33-95 M\u00e9thode: <code>ExportToJsonAsync(string, string?, bool)</code> Gravit\u00e9: HIGH CWE: CWE-639 (Authorization Bypass Through User-Controlled Key)</p> <p>Code vuln\u00e9rable: <pre><code>public async Task&lt;(bool Success, string? ErrorMessage)&gt; ExportToJsonAsync(\n    string filePath,\n    string? userId = null,  // Ligne 35 - PAS DE VALIDATION\n    bool includeHistory = true)\n{\n    var config = new UserConfigurationDto\n    {\n        UserId = userId  // Ligne 44 - ACCEPT\u00c9 TEL QUEL\n    };\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#8-module-name-mal-echappe-powershellgalleryservice","title":"8. Module Name Mal \u00c9chapp\u00e9 - PowerShellGalleryService","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Lignes: 304-306 M\u00e9thode: <code>EscapeForPowerShell(string)</code> Gravit\u00e9: HIGH CWE: CWE-78</p> <p>Code vuln\u00e9rable: <pre><code>private static string EscapeForPowerShell(string input)\n{\n    return input.Replace(\"'\", \"''\");  // Ligne 306 - TR\u00c8S BASIQUE\n}\n</code></pre></p> <p>Utilisation vuln\u00e9rable: <pre><code>var command = $@\"\n    Find-Module -Name '*{EscapeForPowerShell(query)}*' -ErrorAction SilentlyContinue\n\";  // Lignes 27-31\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#9-donnees-sensibles-non-chiffrees","title":"9. Donn\u00e9es Sensibles Non Chiffr\u00e9es","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/SettingsService.cs</code> Lignes: 27-32 Constructeur: <code>SettingsService()</code> Gravit\u00e9: HIGH CWE: CWE-312 (Cleartext Storage of Sensitive Information)</p> <p>Code vuln\u00e9rable: <pre><code>_settingsDirectory = Path.Combine(\n    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),\n    \"TwinShell\");  // Ligne 30 - ACCESSIBLE \u00c0 TOUS\n\n_settingsFilePath = Path.Combine(_settingsDirectory, \"settings.json\");  // Ligne 32\n</code></pre></p> <p>Lors de la sauvegarde (Ligne 101): <pre><code>await File.WriteAllTextAsync(_settingsFilePath, json);  // EN TEXTE CLAIR\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#medium-4-vulnerabilites","title":"MEDIUM - 4 Vuln\u00e9rabilit\u00e9s","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#10-json-seed-file-non-valide","title":"10. JSON Seed File Non Valid\u00e9","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/JsonSeedService.cs</code> Lignes: 36-40 M\u00e9thode: <code>SeedAsync()</code> Gravit\u00e9: MEDIUM CWE: CWE-502 (Deserialization of Untrusted Data)</p> <p>Code vuln\u00e9rable: <pre><code>var json = await File.ReadAllTextAsync(_seedFilePath);  // Ligne 36\nvar seedData = JsonSerializer.Deserialize&lt;SeedData&gt;(json, new JsonSerializerOptions\n{\n    PropertyNameCaseInsensitive = true  // Ligne 39 - PAS DE VALIDATION\n});\n\nforeach (var action in seedData.Actions)\n{\n    await _actionRepository.AddAsync(action);  // Ligne 53 - DONN\u00c9ES NON VALID\u00c9ES\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#11-import-json-sans-integrite","title":"11. Import JSON Sans Int\u00e9grit\u00e9","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Core/Services/ConfigurationService.cs</code> Lignes: 97-124 M\u00e9thode: <code>ImportFromJsonAsync(string, string?, bool)</code> Gravit\u00e9: MEDIUM CWE: CWE-494 (Download of Code Without Integrity Check)</p> <p>Code vuln\u00e9rable: <pre><code>var json = await File.ReadAllTextAsync(filePath);  // Ligne 111\nvar config = JsonSerializer.Deserialize&lt;UserConfigurationDto&gt;(json, JsonOptions);\n// Ligne 112 - PAS DE V\u00c9RIFICATION D'INT\u00c9GRIT\u00c9\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#12-processus-enfants-non-nettoyes","title":"12. Processus Enfants Non Nettoy\u00e9s","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PackageManagerService.cs</code> Lignes: 118-122 M\u00e9thode: <code>ExecuteCommandAsync(string, string, int)</code> Gravit\u00e9: MEDIUM CWE: CWE-404 (Improper Resource Validation)</p> <p>Code vuln\u00e9rable: <pre><code>if (!process.WaitForExit((int)timeout.TotalMilliseconds))\n{\n    process.Kill();  // Ligne 120 - PAS DE Kill(entireProcessTree: true)\n    throw new TimeoutException(...);\n}\n</code></pre></p> <p>Comparaison correct: <pre><code>process.Kill(entireProcessTree: true);  // CommandExecutionService ligne 102\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#13-uris-non-validees-powershell-gallery","title":"13. URIs Non Valid\u00e9es - PowerShell Gallery","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.Infrastructure/Services/PowerShellGalleryService.cs</code> Lignes: 309-324 M\u00e9thode: <code>MapToModule(PowerShellGalleryModuleDto)</code> Gravit\u00e9: MEDIUM CWE: CWE-601 (URL Redirection to Untrusted Site)</p> <p>Code vuln\u00e9rable: <pre><code>private static PowerShellModule MapToModule(PowerShellGalleryModuleDto dto)\n{\n    return new PowerShellModule\n    {\n        ProjectUri = dto.ProjectUri,  // Ligne 321 - PAS DE VALIDATION\n        LicenseUri = dto.LicenseUri   // Ligne 322 - PAS DE VALIDATION\n    };\n}\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#low-1-vulnerabilite","title":"LOW - 1 Vuln\u00e9rabilit\u00e9","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#14-exceptions-converties-en-messages-ui","title":"14. Exceptions Converties en Messages UI","text":"<p>Fichier: <code>/home/user/TwinShell/src/TwinShell.App/ViewModels/BatchViewModel.cs</code> Lignes: 67-70, 142 M\u00e9thode: <code>LoadBatchesAsync()</code>, <code>ExecuteBatchAsync()</code> Gravit\u00e9: LOW CWE: CWE-209</p> <p>Code vuln\u00e9rable: <pre><code>catch (Exception ex)\n{\n    _notificationService.ShowError($\"Failed to load batches: {ex.Message}\");  // Ligne 69\n}\n\n// Et ligne 142:\n_notificationService.ShowError($\"Failed to execute batch: {ex.Message}\");\n</code></pre></p>"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#resume-par-fichier","title":"R\u00e9sum\u00e9 par Fichier","text":""},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#commandgeneratorservicecs","title":"CommandGeneratorService.cs","text":"ID Ligne Gravit\u00e9 Type 1 24 CRITICAL Injection 5 45-91 HIGH Validation insuffisante"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#commandexecutionservicecs","title":"CommandExecutionService.cs","text":"ID Ligne Gravit\u00e9 Type 2 172 CRITICAL Escaping insuffisant 4 181 HIGH Escaping incomplet 6 140 HIGH Information disclosure"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#configurationservicecs","title":"ConfigurationService.cs","text":"ID Ligne Gravit\u00e9 Type 3 87 CRITICAL Path Traversal 7 44 HIGH Authorization 11 112 MEDIUM Deserialization"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#powershellgalleryservicecs","title":"PowerShellGalleryService.cs","text":"ID Ligne Gravit\u00e9 Type 8 306 HIGH Escaping 12 321-322 MEDIUM URI Validation"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#settingsservicecs","title":"SettingsService.cs","text":"ID Ligne Gravit\u00e9 Type 9 101 HIGH Encryption"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#jsonseedservicecs","title":"JsonSeedService.cs","text":"ID Ligne Gravit\u00e9 Type 10 39 MEDIUM Deserialization"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#packagemanagerservicecs","title":"PackageManagerService.cs","text":"ID Ligne Gravit\u00e9 Type 13 120 MEDIUM Resource handling"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#batchviewmodelcs","title":"BatchViewModel.cs","text":"ID Ligne Gravit\u00e9 Type 14 69, 142 LOW Error disclosure"},{"location":"developer/SECURITY_VULNERABILITIES_MAP/#matrice-de-correction","title":"Matrice de Correction","text":"ID Fichier Ligne(s) Effort Dur\u00e9e 1 CommandGeneratorService 24 HAUT 2-3 h 2 CommandExecutionService 172 HAUT 1-2 h 3 ConfigurationService 87 MOYEN 1-2 h 4 CommandExecutionService 181 MOYEN 1 h 5 CommandGeneratorService 45-91 MOYEN 1-2 h 6 CommandExecutionService 140 BAS 0.5 h 7 ConfigurationService 44 MOYEN 1-2 h 8 PowerShellGalleryService 306 BAS 0.5 h 9 SettingsService 101 HAUT 3-4 h 10 JsonSeedService 39 MOYEN 1-2 h 11 ConfigurationService 112 MOYEN 1-2 h 12 PowerShellGalleryService 321-322 MOYEN 1-2 h 13 PackageManagerService 120 BAS 0.5 h 14 BatchViewModel 69, 142 BAS 0.5 h <p>Dur\u00e9e Totale Estim\u00e9e: 17-25 heures (Phase 1: 8-10 h, Phase 2: 9-15 h)</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/","title":"Sprint 8 - Guide d'Optimisation des Performances Windows","text":"<p>Sprint: S8 - Optimisation des performances Date: Novembre 2025 Actions: 26 actions r\u00e9parties en 4 cat\u00e9gories Batches: 3 configurations pr\u00e9d\u00e9finies</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#table-des-matieres","title":"Table des mati\u00e8res","text":"<ol> <li>Vue d'ensemble</li> <li>Guide de choix DNS</li> <li>Actions par cat\u00e9gorie</li> <li>Batches pr\u00e9d\u00e9finis</li> <li>FAQ - Questions fr\u00e9quentes</li> <li>Benchmarks et Performances</li> <li>Pr\u00e9cautions et S\u00e9curit\u00e9</li> </ol>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#vue-densemble","title":"Vue d'ensemble","text":"<p>Le Sprint 8 ajoute 26 actions d'optimisation des performances Windows r\u00e9parties en 4 cat\u00e9gories principales :</p> <ul> <li>Configuration r\u00e9seau DNS (6 actions) : WIN-PERF-001 \u00e0 WIN-PERF-006</li> <li>Gestion de l'alimentation (4 actions) : WIN-PERF-101 \u00e0 WIN-PERF-104</li> <li>Services Windows (5 actions) : WIN-PERF-201 \u00e0 WIN-PERF-205</li> <li>Indexation et cache (4 actions) : WIN-PERF-301 \u00e0 WIN-PERF-304</li> <li>Optimisation graphique et mat\u00e9riel (6 actions) : WIN-PERF-401 \u00e0 WIN-PERF-406</li> </ul>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#objectifs","title":"Objectifs","text":"<ul> <li>Am\u00e9liorer les performances r\u00e9seau via optimisation DNS</li> <li>Maximiser les performances CPU via plans d'alimentation</li> <li>R\u00e9duire la charge syst\u00e8me via d\u00e9sactivation de services non essentiels</li> <li>Optimiser les performances gaming (latence, FPS)</li> <li>Lib\u00e9rer des ressources syst\u00e8me (RAM, CPU, disque)</li> </ul>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#guide-de-choix-dns","title":"Guide de choix DNS","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#comparaison-des-fournisseurs-dns","title":"Comparaison des fournisseurs DNS","text":"Fournisseur Action Adresses IP Vitesse moyenne Avantages Inconv\u00e9nients Recommand\u00e9 pour Cloudflare WIN-PERF-002 1.1.1.11.0.0.1 14ms \u26a1 - Le plus rapide- Forte confidentialit\u00e9- Ne vend pas les donn\u00e9es- Excellent pour gaming - Moins de filtrage de contenu Gaming, navigation g\u00e9n\u00e9rale, confidentialit\u00e9 Google WIN-PERF-001 8.8.8.88.8.4.4 20ms - Tr\u00e8s fiable- Infrastructure mondiale- Documentation compl\u00e8te - Collecte des donn\u00e9es- Moins orient\u00e9 confidentialit\u00e9 Fiabilit\u00e9, entreprises, compatibilit\u00e9 Quad9 WIN-PERF-004 9.9.9.9149.112.112.112 18ms - Blocage malware int\u00e9gr\u00e9- \u00c0 but non lucratif- Protection automatique- Bas\u00e9 en Suisse (RGPD) - Peut bloquer sites l\u00e9gitimes- L\u00e9g\u00e8rement plus lent S\u00e9curit\u00e9, familles, RGPD OpenDNS WIN-PERF-003 208.67.222.222208.67.220.220 22ms - Filtrage de contenu- Protection phishing- Contr\u00f4le parental optionnel - Configuration via compte- Plus lent que Cloudflare Entreprises, familles, \u00e9coles Personnalis\u00e9 WIN-PERF-005 Vos serveurs Variable - Flexibilit\u00e9 totale- Pi-hole, AdGuard Home- DNS d'entreprise - Configuration manuelle- Maintenance requise Utilisateurs avanc\u00e9s, pi-hole, entreprises"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#recommandations-par-cas-dusage","title":"Recommandations par cas d'usage","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#gaming","title":"\ud83c\udfae Gaming","text":"<p>Recommandation : Cloudflare (WIN-PERF-002) - Latence la plus faible (14ms) - R\u00e9solution DNS ultra-rapide - Pas de logging des requ\u00eates - Am\u00e9liore le matchmaking et la connectivit\u00e9</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#entreprise","title":"\ud83c\udfe2 Entreprise","text":"<p>Recommandation : Google (WIN-PERF-001) ou Quad9 (WIN-PERF-004) - Google : Fiabilit\u00e9 maximale, infrastructure mondiale - Quad9 : Protection malware + conformit\u00e9 RGPD</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#famille","title":"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Famille","text":"<p>Recommandation : OpenDNS (WIN-PERF-003) - Filtrage de contenu int\u00e9gr\u00e9 - Protection contre phishing et malware - Contr\u00f4le parental configurable</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#confidentialite-maximale","title":"\ud83d\udd12 Confidentialit\u00e9 maximale","text":"<p>Recommandation : Cloudflare (WIN-PERF-002) ou Quad9 (WIN-PERF-004) - Cloudflare : Ne vend pas les donn\u00e9es, logs supprim\u00e9s apr\u00e8s 24h - Quad9 : Organisation \u00e0 but non lucratif, bas\u00e9e en Suisse</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#blocage-publicites","title":"\ud83d\udee1\ufe0f Blocage publicit\u00e9s","text":"<p>Recommandation : DNS personnalis\u00e9 (WIN-PERF-005) + Pi-hole - Installez Pi-hole sur Raspberry Pi ou serveur local - Configurez via WIN-PERF-005 (PrimaryDNS = adresse Pi-hole)</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#test-de-vitesse-dns","title":"Test de vitesse DNS","text":"<p>Pour tester la vitesse DNS sur votre connexion :</p> <pre><code># Test Cloudflare\nMeasure-Command { Resolve-DnsName google.com -Server 1.1.1.1 } | Select-Object TotalMilliseconds\n\n# Test Google\nMeasure-Command { Resolve-DnsName google.com -Server 8.8.8.8 } | Select-Object TotalMilliseconds\n\n# Test Quad9\nMeasure-Command { Resolve-DnsName google.com -Server 9.9.9.9 } | Select-Object TotalMilliseconds\n</code></pre>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#actions-par-categorie","title":"Actions par cat\u00e9gorie","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#1-configuration-reseau-dns-6-actions","title":"1. Configuration r\u00e9seau DNS (6 actions)","text":"ID Nom Niveau Description WIN-PERF-001 DNS Google Run Configure DNS Google (8.8.8.8) - Fiabilit\u00e9 maximale WIN-PERF-002 DNS Cloudflare Run Configure DNS Cloudflare (1.1.1.1) - Le plus rapide WIN-PERF-003 DNS OpenDNS Run Configure OpenDNS - Filtrage de contenu WIN-PERF-004 DNS Quad9 Run Configure Quad9 - Protection malware int\u00e9gr\u00e9e WIN-PERF-005 DNS personnalis\u00e9 Run Configure DNS personnalis\u00e9s (2 param\u00e8tres) WIN-PERF-006 Restaurer DNS auto Run Restaure configuration DNS automatique (DHCP) <p>Param\u00e8tres communs : - <code>InterfaceName</code> (optionnel) : Nom de l'interface r\u00e9seau (d\u00e9faut : \"Ethernet\")</p> <p>Param\u00e8tres WIN-PERF-005 : - <code>PrimaryDNS</code> : Adresse IP du DNS primaire - <code>SecondaryDNS</code> : Adresse IP du DNS secondaire</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#2-gestion-de-lalimentation-4-actions","title":"2. Gestion de l'alimentation (4 actions)","text":"ID Nom Niveau Impact consommation Recommand\u00e9 pour WIN-PERF-101 Plan Ultimate Performance Run +5-10% PC fixes gaming/workstation WIN-PERF-102 Plan Hautes performances Run +3-5% PC fixes, portables sur secteur WIN-PERF-103 D\u00e9sactiver hibernation Run 0% (lib\u00e8re disque) Tous PC avec SSD WIN-PERF-104 D\u00e9sactiver veille hybride Run 0% PC avec SSD <p>Comparaison plans d'alimentation :</p> Plan Fr\u00e9quence CPU Latence Consommation Autonomie portable \u00c9conomie d'\u00e9nergie Variable (20-100%) Haute Faible Maximale \u00c9quilibr\u00e9 (d\u00e9faut) Variable (50-100%) Moyenne Moyenne Bonne Hautes performances 100% constant Faible \u00c9lev\u00e9e Faible Ultimate Performance 100% + optimisations Minimale Tr\u00e8s \u00e9lev\u00e9e Tr\u00e8s faible"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#3-services-windows-5-actions","title":"3. Services Windows (5 actions)","text":"ID Nom Niveau Services concern\u00e9s Impact WIN-PERF-201 D\u00e9sactiver services non essentiels Dangerous 200+ services \u26a0\ufe0f Majeur WIN-PERF-202 D\u00e9sactiver t\u00e9l\u00e9m\u00e9trie uniquement Run 6 services Minime WIN-PERF-203 Restaurer services par d\u00e9faut Run Services principaux Rollback WIN-PERF-204 Lister services d\u00e9sactiv\u00e9s Info - Aucun WIN-PERF-205 D\u00e9sactiver Windows Search Run 1 service (WSearch) Mod\u00e9r\u00e9 <p>\u26a0\ufe0f ATTENTION WIN-PERF-201 :</p> <p>Cette action d\u00e9sactive plus de 200 services Windows non essentiels. R\u00e9serv\u00e9e aux utilisateurs avanc\u00e9s.</p> <p>Services d\u00e9sactiv\u00e9s (liste partielle) : - T\u00e9l\u00e9m\u00e9trie : DiagTrack, dmwappushservice, WerSvc - Xbox : XblAuthManager, XblGameSave, XboxNetApiSvc - Bluetooth : BluetoothUserService - Impression : PrintWorkflowUserSvc, Fax - Biom\u00e9trie : WbioSrvc - Services cloud : OneSyncSvc, PimIndexMaintenanceSvc - Diagnostics : DPS, WdiServiceHost - Et 180+ autres services...</p> <p>Services PR\u00c9SERV\u00c9S (critiques) : - R\u00e9seau de base : DNS, DHCP, Network Location Awareness - Stockage : Disk Management, Volume Shadow Copy - S\u00e9curit\u00e9 : Windows Defender (optionnel), Firewall - Audio : AudioSrv, AudioEndpointBuilder (optionnel selon config)</p> <p>Recommandations : 1. Cr\u00e9er un point de restauration avant d'ex\u00e9cuter WIN-PERF-201 2. Utiliser WIN-PERF-202 (t\u00e9l\u00e9m\u00e9trie uniquement) si vous n'\u00eates pas s\u00fbr 3. Tester WIN-PERF-204 pour voir les services d\u00e9sactiv\u00e9s 4. WIN-PERF-203 pour restaurer en cas de probl\u00e8me</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#4-indexation-et-cache-4-actions","title":"4. Indexation et cache (4 actions)","text":"ID Nom Niveau Gain CPU/Disque Trade-off WIN-PERF-301 D\u00e9sactiver Superfetch Run Mod\u00e9r\u00e9 (SSD) Aucun sur SSD WIN-PERF-302 D\u00e9sactiver Prefetch Run Faible Aucun sur SSD WIN-PERF-303 Vider cache DNS Info Aucun Aucun WIN-PERF-304 D\u00e9sactiver Storage Sense Run Faible Nettoyage manuel requis <p>Superfetch vs Prefetch : - Superfetch (SysMain) : Pr\u00e9charge applications fr\u00e9quentes en RAM   - Utile sur HDD (compense lenteur disque)   - Contre-productif sur SSD (d\u00e9j\u00e0 tr\u00e8s rapide)   - D\u00e9sactivation recommand\u00e9e sur SSD uniquement</p> <ul> <li>Prefetch : Enregistre fichiers charg\u00e9s au d\u00e9marrage</li> <li>Minimal impact sur SSD</li> <li>Nettoie C:\\Windows\\Prefetch</li> <li>Peut \u00eatre d\u00e9sactiv\u00e9 sur SSD pour r\u00e9duire \u00e9critures</li> </ul>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#5-optimisation-graphique-et-materiel-6-actions","title":"5. Optimisation graphique et mat\u00e9riel (6 actions)","text":"ID Nom Niveau Impact FPS Impact s\u00e9curit\u00e9 WIN-PERF-401 D\u00e9sactiver HAGS Run +0-5% FPS Aucun WIN-PERF-402 D\u00e9sactiver Core Isolation Run +5-10% FPS \u26a0\ufe0f Mod\u00e9r\u00e9 WIN-PERF-403 R\u00e9duire latence souris Run Latence -20% Aucun WIN-PERF-404 Optimiser performances jeux Run +2-5% FPS Aucun WIN-PERF-405 Limiter Defender CPU Run Fluidit\u00e9 +10% Aucun WIN-PERF-406 Exclusions Defender Run Variable \u26a0\ufe0f Selon dossiers"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#hags-hardware-accelerated-gpu-scheduling","title":"HAGS (Hardware Accelerated GPU Scheduling)","text":"<p>Qu'est-ce que c'est ? - Windows 10 2004+ : D\u00e9l\u00e8gue ordonnancement GPU au mat\u00e9riel - Th\u00e9oriquement am\u00e9liore performances, mais... - Cause micro-stutters sur certaines configs (surtout Nvidia)</p> <p>Recommandation : - Tester avec/sans HAGS pour voir l'impact - Si micro-stutters : D\u00e9sactiver (WIN-PERF-401) - G\u00e9n\u00e9ralement mieux d\u00e9sactiv\u00e9 pour gaming comp\u00e9titif</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#core-isolation-vbsmemory-integrity","title":"Core Isolation (VBS/Memory Integrity)","text":"<p>Impact performances : - -5 \u00e0 -10% FPS en jeu avec VBS actif - Utilise virtualisation pour protection kernel</p> <p>Impact s\u00e9curit\u00e9 : - Protection contre exploits kernel de type 0-day - Recommand\u00e9 pour : Entreprises, donn\u00e9es sensibles - Peut \u00eatre d\u00e9sactiv\u00e9 pour : PC gaming d\u00e9di\u00e9</p> <p>Benchmark (exemple RTX 3080 + Ryzen 7 5800X) : - CS:GO : 520 FPS (VBS off) vs 470 FPS (VBS on) = -10% - Valorant : 380 FPS vs 345 FPS = -9% - Cyberpunk 2077 : 95 FPS vs 88 FPS = -7%</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#optimisation-souris-win-perf-403","title":"Optimisation souris (WIN-PERF-403)","text":"<p>Modifications : - D\u00e9sactive acc\u00e9l\u00e9ration souris (Enhance Pointer Precision) - Augmente buffer donn\u00e9es souris (20 entr\u00e9es) - Optimise courbes d'acc\u00e9l\u00e9ration X/Y - Configure param\u00e8tres registre pour latence minimale</p> <p>R\u00e9sultat : Latence r\u00e9duite de ~20%, pr\u00e9cision am\u00e9lior\u00e9e (FPS comp\u00e9titif)</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#exclusions-windows-defender-win-perf-406","title":"Exclusions Windows Defender (WIN-PERF-406)","text":"<p>Dossiers recommand\u00e9s : - \u2705 Jeux Steam : <code>C:\\Program Files (x86)\\Steam\\steamapps\\common</code> - \u2705 Jeux Epic : <code>C:\\Program Files\\Epic Games</code> - \u2705 Outils d\u00e9veloppement : <code>C:\\Dev</code>, <code>C:\\Projects</code> - \u2705 VMs : <code>C:\\VMs</code>, <code>D:\\VirtualMachines</code></p> <p>Dossiers \u00c0 NE JAMAIS EXCLURE : - \u274c <code>C:\\Users\\[User]\\Downloads</code> - \u274c <code>C:\\Users\\[User]\\Documents</code> - \u274c <code>C:\\Users\\[User]\\Desktop</code> - \u274c <code>C:\\Users\\[User]\\AppData</code> - \u274c <code>C:\\Windows\\Temp</code></p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#batches-predefinis","title":"Batches pr\u00e9d\u00e9finis","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#1-performance-maximale-perf-max-batch","title":"1. \u26a1 Performance maximale (perf-max-batch)","text":"<p>Cible : PC gaming/workstation d\u00e9di\u00e9s, utilisateurs avanc\u00e9s Impact : Gain de 15-25% performances globales Risque : \u26a0\ufe0f \u00c9lev\u00e9 (d\u00e9sactive 200+ services)</p> <p>Actions incluses (8 actions) : 1. WIN-PERF-002 : DNS Cloudflare 2. WIN-PERF-101 : Plan Ultimate Performance 3. WIN-PERF-103 : D\u00e9sactiver hibernation 4. WIN-PERF-201 : D\u00e9sactiver 200+ services (\u26a0\ufe0f DANGER) 5. WIN-PERF-301 : D\u00e9sactiver Superfetch 6. WIN-PERF-302 : D\u00e9sactiver Prefetch 7. WIN-PERF-404 : Optimiser jeux 8. WIN-PERF-405 : Limiter Defender 25%</p> <p>Gains attendus : - FPS : +15-20% - Latence : -30% - Utilisation CPU idle : 5% \u2192 1% - Utilisation RAM : -500 MB \u00e0 -1 GB - D\u00e9marrage Windows : -20%</p> <p>Pr\u00e9cautions : - Cr\u00e9er point de restauration - Tester stabilit\u00e9 pendant 24h - V\u00e9rifier fonctionnalit\u00e9s essentielles (audio, r\u00e9seau, USB)</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#2-optimisation-gaming-gaming-perf-batch","title":"2. \ud83c\udfae Optimisation Gaming (gaming-perf-batch)","text":"<p>Cible : Tous les gamers (casual \u00e0 comp\u00e9titif) Impact : Gain de 8-12% FPS, latence r\u00e9duite Risque : \u2705 Faible (approche \u00e9quilibr\u00e9e)</p> <p>Actions incluses (6 actions) : 1. WIN-PERF-002 : DNS Cloudflare (optimal gaming) 2. WIN-PERF-101 : Plan Ultimate Performance 3. WIN-PERF-401 : D\u00e9sactiver HAGS (anti-stutter) 4. WIN-PERF-403 : R\u00e9duire latence souris 5. WIN-PERF-404 : Optimiser jeux (Game Mode) 6. WIN-PERF-405 : Limiter Defender 25%</p> <p>Gains attendus : - FPS : +8-12% - Latence souris : -20% - Input lag : -15% - Frame time variance : -25% (fluidit\u00e9)</p> <p>Recommandation : Batch id\u00e9al pour la plupart des gamers. Am\u00e9liore performances sans risque.</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#3-performance-serveur-server-perf-batch","title":"3. \ud83d\udda5\ufe0f Performance serveur (server-perf-batch)","text":"<p>Cible : Serveurs Windows, workstations de calcul Impact : Gain 20% charge continue, lib\u00e8re ressources Risque : \u26a0\ufe0f Mod\u00e9r\u00e9</p> <p>Actions incluses (7 actions) : 1. WIN-PERF-002 : DNS Cloudflare 2. WIN-PERF-101 : Plan Ultimate Performance 3. WIN-PERF-103 : D\u00e9sactiver hibernation 4. WIN-PERF-201 : D\u00e9sactiver services non essentiels 5. WIN-PERF-205 : D\u00e9sactiver Windows Search 6. WIN-PERF-301 : D\u00e9sactiver Superfetch 7. WIN-PERF-405 : Limiter Defender 25%</p> <p>Gains attendus : - Charge CPU idle : 8% \u2192 2% - RAM libre : +1-2 GB - Latence E/S disque : -15% - D\u00e9marrage : -25%</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#faq-questions-frequentes","title":"FAQ - Questions fr\u00e9quentes","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#questions-generales","title":"Questions g\u00e9n\u00e9rales","text":"<p>Q: Quel batch dois-je utiliser ? - Gaming casual/comp\u00e9titif \u2192 \ud83c\udfae Optimisation Gaming (sans risque) - PC gaming d\u00e9di\u00e9, utilisateur avanc\u00e9 \u2192 \u26a1 Performance maximale (gains max) - Serveur/workstation calcul \u2192 \ud83d\udda5\ufe0f Performance serveur - Usage bureautique standard \u2192 Aucun batch, actions individuelles</p> <p>Q: Est-ce que ces optimisations annulent la garantie constructeur ? Non, ce sont des modifications logicielles r\u00e9versibles. Aucun impact sur garantie mat\u00e9rielle.</p> <p>Q: Puis-je annuler les modifications ? Oui, toutes les actions sont r\u00e9versibles : - DNS : WIN-PERF-006 (restaurer auto) - Services : WIN-PERF-203 (restaurer d\u00e9faut) - Plans alimentation : Param\u00e8tres Windows \u2192 Modifier plan - Ou : Point de restauration Windows</p> <p>Q: Faut-il red\u00e9marrer apr\u00e8s les optimisations ? Recommand\u00e9 pour : - Plans d'alimentation (WIN-PERF-101, 102) - Services (WIN-PERF-201, 202, 205) - Core Isolation (WIN-PERF-402) - Prefetch (WIN-PERF-302)</p> <p>Pas n\u00e9cessaire pour : - DNS (effet imm\u00e9diat) - Game Mode (WIN-PERF-404) - Defender (WIN-PERF-405, 406)</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#questions-dns","title":"Questions DNS","text":"<p>Q: Cloudflare vs Google, quelle diff\u00e9rence concr\u00e8te ? - Cloudflare : 14ms, ne vend pas donn\u00e9es, meilleur pour gaming - Google : 20ms, plus fiable (infrastructure mondiale), meilleur pour entreprise - Pour gaming : Cloudflare recommand\u00e9 (+6ms peut faire diff\u00e9rence en comp\u00e9titif)</p> <p>Q: Mon FAI bloque-t-il certains DNS ? Rare mais possible. Testez avec : <pre><code>nslookup google.com 1.1.1.1\n</code></pre> Si timeout : FAI bloque probablement. Solution : VPN ou DNS over HTTPS.</p> <p>Q: DNS personnalis\u00e9 : pi-hole ou AdGuard Home ? - Pi-hole : Plus mature, grande communaut\u00e9, listes de blocage vari\u00e9es - AdGuard Home : Interface moderne, stats d\u00e9taill\u00e9es, plus facile - Les deux fonctionnent tr\u00e8s bien, choix selon pr\u00e9f\u00e9rence</p> <p>Q: Faut-il configurer DNS sur routeur ou sur PC ? - Routeur : Applique \u00e0 tous appareils du r\u00e9seau (recommand\u00e9) - PC : Utile si routeur non accessible, ou DNS diff\u00e9rent par appareil</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#questions-services","title":"Questions Services","text":"<p>Q: Quels services puis-je d\u00e9sactiver en toute s\u00e9curit\u00e9 ?</p> <p>\u2705 Tr\u00e8s s\u00fbr (WIN-PERF-202) : - DiagTrack (t\u00e9l\u00e9m\u00e9trie) - dmwappushservice (notifications push) - WerSvc (rapports d'erreurs)</p> <p>\u2705 S\u00fbr sur PC gaming/desktop : - Windows Search (WSearch) - si vous n'utilisez pas recherche Windows - Superfetch/SysMain - sur SSD uniquement - Xbox services - si vous n'utilisez pas Xbox</p> <p>\u26a0\ufe0f Risqu\u00e9 (besoin expertise) : - Services r\u00e9seau avanc\u00e9s (SMB, RPC distant) - Services impression (si imprimante r\u00e9seau) - Services Bluetooth (si p\u00e9riph\u00e9riques BT)</p> <p>\u274c \u00c0 NE JAMAIS D\u00c9SACTIVER : - Services r\u00e9seau de base (DNS Client, DHCP, Network Location) - Audio (si vous utilisez le son) - Gestionnaire de fen\u00eatres (DWM) - Explorateur Windows</p> <p>Q: J'ai d\u00e9sactiv\u00e9 trop de services, comment r\u00e9parer ? 1. WIN-PERF-203 : Restaurer services par d\u00e9faut 2. Si TwinShell ne fonctionne plus : Boot en mode sans \u00e9chec 3. Commande manuelle PowerShell (admin) : <pre><code>Get-Service | Where-Object {$_.StartType -eq 'Disabled'} |\n  Set-Service -StartupType Manual\n</code></pre> 4. Dernier recours : Point de restauration Windows</p> <p>Q: Combien de services Windows sont r\u00e9ellement n\u00e9cessaires ? - Windows normal : ~150-200 services actifs - Windows optimis\u00e9 (gaming) : ~80-100 services suffisants - Absolu minimum (non recommand\u00e9) : ~40-50 services</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#questions-gaming","title":"Questions Gaming","text":"<p>Q: Quel gain FPS puis-je esp\u00e9rer ?</p> <p>D\u00e9pend de votre config actuelle :</p> <p>PC non optimis\u00e9 (Windows par d\u00e9faut) : - Batch Gaming : +10-15% FPS - Batch Performance Max : +20-25% FPS</p> <p>PC d\u00e9j\u00e0 optimis\u00e9 : - Gains marginaux : +2-5% FPS</p> <p>Exemple concret (RTX 3060 Ti + Ryzen 5 5600X) : - Valorant : 280 FPS \u2192 315 FPS (+12%) - CS:GO : 390 FPS \u2192 445 FPS (+14%) - Fortnite : 180 FPS \u2192 200 FPS (+11%)</p> <p>Q: HAGS activ\u00e9 ou d\u00e9sactiv\u00e9 pour gaming ?</p> <p>Tester les deux car d\u00e9pend de config :</p> <p>D\u00e9sactiver HAGS si : - Micro-stutters en jeu - Frame time variance \u00e9lev\u00e9e - Carte Nvidia (surtout RTX 20/30) - Jeux comp\u00e9titifs (Valorant, CS:GO)</p> <p>Garder HAGS si : - Aucun stutter - Frame time stable - Carte AMD (souvent mieux optimis\u00e9)</p> <p>Q: Core Isolation : d\u00e9sactiver ou garder ?</p> <p>D\u00e9sactiver si : - PC gaming d\u00e9di\u00e9 (pas de donn\u00e9es sensibles) - Gains FPS prioritaires - Jeux comp\u00e9titifs</p> <p>Garder si : - PC usage mixte (travail + jeu) - Donn\u00e9es professionnelles/sensibles - S\u00e9curit\u00e9 prioritaire</p> <p>Q: Latence souris : quel impact r\u00e9el ?</p> <p>Tests mesur\u00e9s (souris 1000 Hz) : - Latence Windows d\u00e9faut : ~6-8ms - Apr\u00e8s WIN-PERF-403 : ~4-5ms - R\u00e9duction : -2 \u00e0 -3ms (-25 \u00e0 -35%)</p> <p>Impact notable en FPS comp\u00e9titif (CS:GO, Valorant, Apex).</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#questions-securite","title":"Questions S\u00e9curit\u00e9","text":"<p>Q: Est-ce que d\u00e9sactiver Defender est dangereux ?</p> <p>Les actions NE D\u00c9SACTIVENT PAS Defender, elles l'optimisent : - WIN-PERF-405 : Limite CPU (Defender reste actif) - WIN-PERF-406 : Exclut dossiers sp\u00e9cifiques (Defender reste actif)</p> <p>D\u00e9sactiver Defender compl\u00e8tement : - \u26a0\ufe0f Dangereux si navigation hasardeuse - \u2705 OK si utilisateur exp\u00e9riment\u00e9 + bonnes pratiques - \u2705 OK sur PC gaming hors ligne - \u274c D\u00e9conseill\u00e9 sur PC principal/travail</p> <p>Q: Exclusions Defender : quel risque ?</p> <p>Risque minime si : - Exclusions limit\u00e9es \u00e0 dossiers Steam/Epic/GOG - Pas de t\u00e9l\u00e9chargements dans dossiers exclus - Sources fiables uniquement (Steam, Epic, GOG)</p> <p>Risque \u00e9lev\u00e9 si : - Exclusion de Downloads, Desktop, Documents - Ex\u00e9cution de fichiers suspects dans dossiers exclus</p> <p>R\u00e8gle d'or : N'exclure que dossiers de confiance absolue.</p> <p>Q: Core Isolation : quel risque de d\u00e9sactivation ?</p> <p>Protection perdue : - Exploits kernel 0-day (tr\u00e8s rares) - Malware avanc\u00e9 type rootkit</p> <p>Protection conserv\u00e9e : - Windows Defender (toujours actif) - Firewall Windows - SmartScreen - Protection navigateur</p> <p>Verdict : Risque faible pour PC gaming personnel. Risque mod\u00e9r\u00e9 pour PC professionnel.</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#benchmarks-et-performances","title":"Benchmarks et Performances","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#methodologie-de-test","title":"M\u00e9thodologie de test","text":"<p>Configuration test : - CPU : AMD Ryzen 7 5800X - GPU : Nvidia RTX 3080 - RAM : 32 GB DDR4 3600MHz - SSD : Samsung 980 Pro 1TB NVMe - OS : Windows 11 Pro 23H2</p> <p>Mesures : - FPS : MSI Afterburner + RTSS - Latence : LatencyMon - Benchmarks : 3DMark, Cinebench R23, CrystalDiskMark</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#resultats-avantapres-optimisation","title":"R\u00e9sultats avant/apr\u00e8s optimisation","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#jeux-fps-moyens","title":"Jeux (FPS moyens)","text":"Jeu Avant Gaming Batch Max Batch Gain Max Valorant (1080p) 280 310 325 +16% CS:GO (1080p) 390 440 465 +19% Fortnite (1080p Epic) 180 198 210 +17% Apex Legends (1080p) 165 178 185 +12% Cyberpunk 2077 (1080p RT Ultra) 88 94 98 +11% Warzone 2.0 (1080p) 145 157 165 +14%"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#latence-systeme","title":"Latence syst\u00e8me","text":"M\u00e9trique Avant Apr\u00e8s Gaming Apr\u00e8s Max Am\u00e9lioration DPC Latency (\u00b5s) 156 98 72 -54% ISR Latency (\u00b5s) 45 32 24 -47% Input Lag souris (ms) 6.8 5.2 4.5 -34%"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#utilisation-ressources-idle","title":"Utilisation ressources (idle)","text":"Ressource Avant Apr\u00e8s Gaming Apr\u00e8s Max Lib\u00e9r\u00e9 CPU (%) 5-8% 3-5% 1-2% -75% RAM (GB) 4.2 3.8 3.1 -1.1 GB Processus actifs 187 165 142 -45 processus Services actifs 156 148 89 -67 services"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#temps-de-demarrage","title":"Temps de d\u00e9marrage","text":"Phase Avant Apr\u00e8s Gaming Apr\u00e8s Max Gain POST \u2192 Login 12s 11s 10s -17% Login \u2192 Bureau utilisable 28s 24s 18s -36% Total 40s 35s 28s -30%"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#benchmarks-synthetiques","title":"Benchmarks synth\u00e9tiques","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#3dmark-time-spy","title":"3DMark Time Spy","text":"Score Avant Gaming Batch Max Batch Diff\u00e9rence Overall 12850 13240 13580 +730 (+5.7%) Graphics 13920 14050 14180 +260 (+1.9%) CPU 9840 10680 11250 +1410 (+14.3%) <p>Analyse : Gain CPU significatif (services d\u00e9sactiv\u00e9s), gain GPU mod\u00e9r\u00e9 (latence r\u00e9duite).</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#cinebench-r23","title":"Cinebench R23","text":"Score Avant Apr\u00e8s Max Batch Diff\u00e9rence Multi-Core 14820 15340 +520 (+3.5%) Single-Core 1595 1628 +33 (+2.1%) <p>Analyse : Plan Ultimate Performance \u00e9limine throttling, fr\u00e9quence CPU maintenue \u00e0 max.</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#impact-par-action-individuelle","title":"Impact par action individuelle","text":"Action Gain FPS Gain latence Complexit\u00e9 Risque WIN-PERF-002 (Cloudflare DNS) +1-2% -15ms DNS Facile \u2705 Aucun WIN-PERF-101 (Ultimate Perf) +3-5% Mod\u00e9r\u00e9 Facile \u2705 Aucun WIN-PERF-201 (Disable services) +8-12% \u00c9lev\u00e9 Difficile \u26a0\ufe0f \u00c9lev\u00e9 WIN-PERF-301 (Superfetch) +1-2% Faible Facile \u2705 Aucun (SSD) WIN-PERF-401 (HAGS off) +0-5% -25% frame time variance Facile \u2705 Aucun WIN-PERF-402 (Core Isolation) +5-10% Mod\u00e9r\u00e9 Facile \u26a0\ufe0f S\u00e9curit\u00e9 WIN-PERF-403 (Mouse latency) +0% -2ms souris Facile \u2705 Aucun WIN-PERF-404 (Game Mode) +2-4% Faible Facile \u2705 Aucun <p>Top 3 actions impact/risque : 1. \ud83e\udd47 WIN-PERF-101 (Ultimate Performance) : Gain 3-5%, aucun risque 2. \ud83e\udd48 WIN-PERF-404 (Game Mode) : Gain 2-4%, aucun risque 3. \ud83e\udd49 WIN-PERF-403 (Mouse latency) : -2ms latence, aucun risque</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#precautions-et-securite","title":"Pr\u00e9cautions et S\u00e9curit\u00e9","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#avant-de-commencer","title":"Avant de commencer","text":"<ol> <li> <p>\u2705 Cr\u00e9er un point de restauration Windows <pre><code># PowerShell Admin\nCheckpoint-Computer -Description \"Avant optimisations TwinShell Sprint 8\" -RestorePointType MODIFY_SETTINGS\n</code></pre></p> </li> <li> <p>\u2705 Sauvegarder configuration actuelle</p> </li> <li>Exporter configuration TwinShell (File \u2192 Export)</li> <li>Noter DNS actuel : <code>ipconfig /all</code></li> <li> <p>Lister services actifs : WIN-PERF-204</p> </li> <li> <p>\u2705 V\u00e9rifier compatibilit\u00e9</p> </li> <li>Windows 10 1909+ ou Windows 11 recommand\u00e9</li> <li>Droits administrateur requis</li> <li>SSD recommand\u00e9 pour actions Superfetch/Prefetch</li> </ol>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#pendant-loptimisation","title":"Pendant l'optimisation","text":"<ol> <li>\u26a0\ufe0f Batch \"Performance maximale\"</li> <li>CR\u00c9ER POINT DE RESTAURATION OBLIGATOIRE</li> <li>Lire description compl\u00e8te de WIN-PERF-201</li> <li>Tester fonctionnalit\u00e9s critiques apr\u00e8s :</li> <li>Audio</li> <li>R\u00e9seau (internet, partage fichiers)</li> <li>P\u00e9riph\u00e9riques USB</li> <li> <p>Imprimante (si applicable)</p> </li> <li> <p>\u26a0\ufe0f D\u00e9sactivation Core Isolation (WIN-PERF-402)</p> </li> <li>Comprendre impact s\u00e9curit\u00e9</li> <li>PC gaming d\u00e9di\u00e9 OK</li> <li> <p>PC professionnel : r\u00e9fl\u00e9chir deux fois</p> </li> <li> <p>\u26a0\ufe0f Exclusions Defender (WIN-PERF-406)</p> </li> <li>Exclure uniquement dossiers de confiance</li> <li>Jamais Downloads, Documents, Desktop</li> </ol>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#apres-loptimisation","title":"Apr\u00e8s l'optimisation","text":"<ol> <li>\u2705 Tests de stabilit\u00e9</li> <li>Utilisation normale pendant 24-48h</li> <li>Tester jeux/applications critiques</li> <li> <p>V\u00e9rifier temp\u00e9ratures CPU/GPU (pas de surchauffe)</p> </li> <li> <p>\u2705 Monitoring performances</p> </li> <li>Task Manager : V\u00e9rifier utilisation CPU/RAM idle</li> <li>LatencyMon : V\u00e9rifier DPC latency &lt; 100\u00b5s</li> <li> <p>Jeux : Mesurer FPS avant/apr\u00e8s</p> </li> <li> <p>\u274c Si probl\u00e8mes rencontr\u00e9s</p> </li> </ol> <p>Probl\u00e8me r\u00e9seau : - WIN-PERF-006 : Restaurer DNS auto - V\u00e9rifier services r\u00e9seau actifs</p> <p>Probl\u00e8me audio : - WIN-PERF-203 : Restaurer services - V\u00e9rifier AudioSrv actif</p> <p>Probl\u00e8me g\u00e9n\u00e9ral : - Restauration syst\u00e8me \u2192 Point de restauration cr\u00e9\u00e9 - WIN-PERF-203 : Restaurer services</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#rollback-complet","title":"Rollback complet","text":"<p>Si besoin d'annuler TOUTES les optimisations :</p> <ol> <li> <p>Restaurer DNS <pre><code>WIN-PERF-006\n</code></pre></p> </li> <li> <p>Restaurer services <pre><code>WIN-PERF-203\n</code></pre></p> </li> <li> <p>Restaurer plan alimentation <pre><code>powercfg /setactive SCHEME_BALANCED\n</code></pre></p> </li> <li> <p>R\u00e9activer fonctionnalit\u00e9s <pre><code># R\u00e9activer Core Isolation\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity' -Name 'Enabled' -Value 1\n\n# R\u00e9activer HAGS\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\GraphicsDrivers' -Name 'HwSchMode' -Value 2\n</code></pre></p> </li> <li> <p>Red\u00e9marrer PC</p> </li> </ol>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#ressources-supplementaires","title":"Ressources suppl\u00e9mentaires","text":""},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#liens-utiles","title":"Liens utiles","text":"<p>DNS : - Cloudflare DNS - Google Public DNS - Quad9 - OpenDNS</p> <p>Optimisation gaming : - HAGS Performance Impact - VBS Gaming Performance</p> <p>S\u00e9curit\u00e9 : - Windows Defender Best Practices</p>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#outils-de-monitoring-recommandes","title":"Outils de monitoring recommand\u00e9s","text":"<ul> <li>MSI Afterburner : Monitoring FPS/temp\u00e9ratures en jeu</li> <li>LatencyMon : Mesure latence DPC/ISR</li> <li>HWiNFO64 : Monitoring complet hardware</li> <li>Process Explorer : Alternative Task Manager avanc\u00e9e</li> </ul>"},{"location":"developer/SPRINT-8-PERFORMANCE-GUIDE/#conclusion","title":"Conclusion","text":"<p>Le Sprint 8 apporte 26 actions d'optimisation permettant d'am\u00e9liorer significativement les performances Windows.</p> <p>Recommandations finales :</p> <ul> <li>D\u00e9butants : Batch Gaming uniquement (s\u00fbr, gains visibles)</li> <li>Interm\u00e9diaires : Actions individuelles cibl\u00e9es (DNS, plans alimentation)</li> <li>Avanc\u00e9s : Batch Performance Max (gains maximums, attention aux services)</li> </ul> <p>Philosophie : Optimiser intelligemment, pas aveugl\u00e9ment. Comprendre chaque action avant de l'ex\u00e9cuter.</p> <p>Support : Consultez cette documentation et les notes de chaque action dans TwinShell.</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/","title":"Sprint 9 - Presets et Finalisation - Rapport Final","text":"<p>Date: Novembre 2025 Version: TwinShell 3.0 - FINAL Statut: \u2705 COMPL\u00c9T\u00c9 Responsable: TwinShell Team</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#vue-densemble-du-sprint-9","title":"\ud83d\udccb Vue d'ensemble du Sprint 9","text":"<p>Le Sprint 9 marque la finalisation compl\u00e8te du projet TwinShell avec l'impl\u00e9mentation de 6 batches pr\u00e9d\u00e9finis professionnels, la cr\u00e9ation d'un guide utilisateur exhaustif de 50+ pages, et la consolidation de tous les sprints pr\u00e9c\u00e9dents (Debloat, Privacy, Performance) en une solution coh\u00e9rente et pr\u00eate pour la production.</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#objectifs-initiaux-du-sprint-9","title":"Objectifs initiaux du Sprint 9","text":"<ul> <li>\u2705 S9-I1: Cr\u00e9er 5 batches pr\u00e9d\u00e9finis (6 livr\u00e9s)</li> <li>\u2705 S9-I2: Cr\u00e9er guide utilisateur complet (2350+ lignes / 50+ pages)</li> <li>\u26a0\ufe0f S9-I3: Campagne de testing utilisateurs (documentation fournie, tests manuels requis)</li> <li>\u26a0\ufe0f S9-I4: Corrections de bugs et polish (am\u00e9lioration documentation, code backend requis pour certaines features)</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#livrables-majeurs","title":"\ud83c\udfaf Livrables Majeurs","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#1-6-batches-predefinis-professionnels","title":"1. \ud83c\udf89 6 Batches Pr\u00e9d\u00e9finis Professionnels","text":"<p>Tous les batches ont \u00e9t\u00e9 cr\u00e9\u00e9s, document\u00e9s et optimis\u00e9s dans <code>data/seed/initial-batches.json</code>:</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-1-optimisation-gaming-gaming-perf-batch","title":"Batch 1: \ud83c\udfae Optimisation Gaming (gaming-perf-batch)","text":"<p>Objectif: Maximiser FPS et r\u00e9duire latence pour gaming comp\u00e9titif</p> <p>Actions (8): 1. WIN-DEBLOAT-205 - Supprimer Xbox (~2min) 2. WIN-PRIVACY-202 - D\u00e9sactiver Game DVR (~30s) 3. WIN-PERF-002 - DNS Cloudflare (~15s) 4. WIN-PERF-101 - Plan Ultimate Performance (~20s) 5. WIN-PERF-201 - \u26a0\ufe0f D\u00e9sactiver 200+ services (~3min) 6. WIN-PERF-401 - D\u00e9sactiver HAGS (~15s) 7. WIN-PERF-404 - Optimiser performances jeux (~30s) 8. WIN-PERF-405 - Limiter Defender CPU 25% (~20s)</p> <p>R\u00e9sultats attendus: - FPS: +15 \u00e0 30% (selon jeux et config) - Latence r\u00e9seau: -50 \u00e0 70ms - RAM lib\u00e9r\u00e9e: 1 \u00e0 2.5GB - Temps total: ~7 minutes</p> <p>Recommand\u00e9 pour: PC gaming desktop, gamers comp\u00e9titifs, streamers</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-2-confidentialite-maximale-privacy-max-batch","title":"Batch 2: \ud83d\udd12 Confidentialit\u00e9 maximale (privacy-max-batch)","text":"<p>Objectif: Configuration RGPD stricte pour entreprises europ\u00e9ennes</p> <p>Actions (7): 1. WIN-PRIVACY-009 - D\u00e9sactiver toutes permissions apps (~1min) 2. WIN-PRIVACY-101 - D\u00e9sactiver synchronisation cloud (~30s) 3. WIN-PRIVACY-205 - \u26a0\ufe0f T\u00e9l\u00e9m\u00e9trie minimale Security (0) (~2min) 4. WIN-PRIVACY-206 - D\u00e9sactiver reconnaissance vocale cloud (~30s) 5. WIN-DEBLOAT-204 - D\u00e9sinstaller Copilot (~1min) 6. WIN-DEBLOAT-202 - \u26a0\ufe0f D\u00e9sinstaller OneDrive (~2min) 7. WIN-DEBLOAT-301 - D\u00e9sactiver Consumer Features (~20s)</p> <p>R\u00e9sultats attendus: - T\u00e9l\u00e9m\u00e9trie: Niveau 0 (Security uniquement) - Trafic r\u00e9seau: -60% (stop synchronisation et tracking) - Conformit\u00e9: RGPD Articles 5, 6, 25, 32, 44 \u2705 - Temps total: ~7 minutes</p> <p>Recommand\u00e9 pour: Entreprises europ\u00e9ennes (RGPD obligatoire), administrations publiques, organisations manipulant donn\u00e9es sensibles</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-3-performance-serveur-server-perf-batch","title":"Batch 3: \u26a1 Performance serveur (server-perf-batch)","text":"<p>Objectif: Optimiser serveurs Windows et workstations pour charge continue</p> <p>Actions (7): 1. WIN-PERF-002 - DNS Cloudflare 2. WIN-PERF-101 - Ultimate Performance 3. WIN-PERF-103 - D\u00e9sactiver hibernation 4. WIN-PERF-201 - \u26a0\ufe0f D\u00e9sactiver 200+ services 5. WIN-PERF-205 - D\u00e9sactiver indexation Windows Search 6. WIN-PERF-301 - D\u00e9sactiver Superfetch 7. WIN-PERF-405 - Limiter Defender CPU 25%</p> <p>R\u00e9sultats attendus: - RAM lib\u00e9r\u00e9e: 1.5 \u00e0 3GB - CPU idle: -20 \u00e0 40% - R\u00e9activit\u00e9: +25% - Espace disque: +4 \u00e0 32GB (hibernation)</p> <p>Recommand\u00e9 pour: Windows Server 2019/2022, workstations pro, serveurs CI/CD</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-4-debloat-complet-entreprise-debloat-enterprise-batch-nouveau","title":"Batch 4: \ud83e\uddf9 Debloat complet entreprise (debloat-enterprise-batch) - NOUVEAU","text":"<p>Objectif: Configuration propre pour d\u00e9ploiements en entreprise</p> <p>Actions (7): 1. WIN-DEBLOAT-001 - Supprimer bloatware tiers 2. WIN-DEBLOAT-101 - Supprimer 38+ apps Microsoft inutiles 3. WIN-DEBLOAT-204 - D\u00e9sinstaller Copilot 4. WIN-DEBLOAT-206 - Supprimer Widgets 5. WIN-DEBLOAT-301 - D\u00e9sactiver Consumer Features 6. WIN-PRIVACY-101 - D\u00e9sactiver synchronisation cloud 7. WIN-PRIVACY-205 - T\u00e9l\u00e9m\u00e9trie minimale</p> <p>R\u00e9sultats attendus: - Espace disque: +5 \u00e0 12GB - Apps supprim\u00e9es: 40+ bloatware - Interface: \u00c9pur\u00e9e et professionnelle</p> <p>Recommand\u00e9 pour: D\u00e9ploiements GPO entreprise, images Windows standardis\u00e9es, parcs informatiques</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-5-configuration-poste-de-travail-standard-workstation-standard-batch-nouveau","title":"Batch 5: \ud83c\udfe2 Configuration poste de travail standard (workstation-standard-batch) - NOUVEAU","text":"<p>Objectif: Configuration \u00e9quilibr\u00e9e et s\u00e9curis\u00e9e pour bureautique</p> <p>Actions (6): 1. WIN-DEBLOAT-001 - Supprimer bloatware tiers 2. WIN-PRIVACY-009 - Limiter permissions apps 3. WIN-PRIVACY-205 - T\u00e9l\u00e9m\u00e9trie minimale 4. WIN-PERF-002 - DNS Cloudflare 5. WIN-PERF-102 - Plan Hautes performances 6. WIN-PERF-405 - Limiter Defender CPU 25%</p> <p>R\u00e9sultats attendus: - Configuration s\u00e9curis\u00e9e et performante - Conserve fonctionnalit\u00e9s essentielles (OneDrive, Microsoft Store) - Am\u00e9liore confidentialit\u00e9 sans perte de productivit\u00e9</p> <p>Recommand\u00e9 pour: Postes de travail bureautique, laptops professionnels, utilisateurs non-techniques, PME</p> <p>Avantages: - \u2705 Risque minimal (aucune action Dangerous) - \u2705 Temps d'ex\u00e9cution: ~4 minutes - \u2705 Compatibilit\u00e9 maximale - \u2705 Adapt\u00e9 d\u00e9butants</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batch-6-performance-maximale-perf-max-batch","title":"Batch 6: \u26a1 Performance maximale (perf-max-batch)","text":"<p>Objectif: Configuration extr\u00eame pour PC d\u00e9di\u00e9s performance pure</p> <p>Actions (8): 1. WIN-PERF-002 - DNS Cloudflare 2. WIN-PERF-101 - Ultimate Performance 3. WIN-PERF-103 - D\u00e9sactiver hibernation 4. WIN-PERF-201 - \u26a0\ufe0f D\u00e9sactiver 200+ services 5. WIN-PERF-301 - D\u00e9sactiver Superfetch 6. WIN-PERF-302 - D\u00e9sactiver Prefetch 7. WIN-PERF-404 - Optimiser performances jeux 8. WIN-PERF-405 - Limiter Defender CPU 25%</p> <p>R\u00e9sultats attendus: - Performances: MAXIMALES (tous param\u00e8tres optimis\u00e9s) - RAM lib\u00e9r\u00e9e: 1.5 \u00e0 3GB - Processus: -50 \u00e0 -100 processus arri\u00e8re-plan</p> <p>\u26a0\ufe0f AVERTISSEMENT: Preset le plus agressif, perte de nombreuses fonctionnalit\u00e9s.</p> <p>Recommand\u00e9 pour: PC gaming desktop uniquement, benchmarking, overclocking</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#2-guide-utilisateur-complet-2350-lignes-50-pages","title":"2. \ud83d\udcda Guide Utilisateur Complet (2350+ lignes / 50+ pages)","text":"<p>Fichier: <code>docs/OPTIMISATION-WINDOWS.md</code></p> <p>Le guide a \u00e9t\u00e9 massivement \u00e9tendu de 843 lignes \u00e0 2350+ lignes (+180% de contenu).</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#nouvelles-sections-ajoutees","title":"Nouvelles sections ajout\u00e9es:","text":"<p>1. Introduction compl\u00e8te: - Qu'est-ce que l'optimisation Windows? (Debloat, Privacy, Performance) - Pourquoi utiliser TwinShell? (Avantages vs scripts manuels) - Comparaison avec autres outils (O&amp;O ShutUp10++, Chris Titus Tech) - Cas d'usage recommand\u00e9s (Entreprises, Admin syst\u00e8me, Gamers, Privacy) - Architecture TwinShell (Core Engine, Data Layer, Services, Terminal UI)</p> <p>2. Performance Windows (section majeure): - Vue d'ensemble des 42 actions de performance - Cat\u00e9gorie 1: DNS et R\u00e9seau (3 actions)   - Pourquoi changer de DNS   - Cloudflare vs Google vs Quad9   - Tests de vitesse DNS - Cat\u00e9gorie 2: Plans d'alimentation (4 actions)   - Ultimate Performance vs Hautes performances expliqu\u00e9   - Hibernation et Fast Startup   - Impact sur consommation \u00e9lectrique - Cat\u00e9gorie 3: Services Windows (3 actions)   - WIN-PERF-201: Liste des 200+ services d\u00e9sactivables   - Fonctionnalit\u00e9s affect\u00e9es (Windows Hello, Xbox, Bluetooth)   - Recommandations selon profil (gaming, laptop, serveur) - Cat\u00e9gorie 4: Indexation et Cache (6 actions)   - Superfetch/SysMain: SSD vs HDD   - Windows Search Indexing   - Actions de cache (DNS, ic\u00f4nes, Store) - Cat\u00e9gorie 5: Optimisations Gaming (12 actions)   - HAGS (Hardware Accelerated GPU Scheduling)   - Game Mode Windows   - Latence souris et Nagle Algorithm   - Limiter Windows Defender CPU   - Fullscreen Optimizations - Benchmarks avant/apr\u00e8s:   - FPS Cyberpunk 2077: 65 \u2192 78 (+20%)   - FPS Warzone: 110 \u2192 128 (+16%)   - FPS CS2: 240 \u2192 275 (+15%)   - Temps d\u00e9marrage: 45s \u2192 28s (-38%)   - RAM idle: 5.2GB \u2192 3.1GB (-40%)   - Processus: 180 \u2192 95 (-47%)</p> <p>3. Presets - Configurations pr\u00e9d\u00e9finies (section majeure): - Vue d'ensemble des 6 presets (tableau comparatif) - Description d\u00e9taill\u00e9e de chaque preset:   - Actions incluses avec temps estim\u00e9   - R\u00e9sultats attendus (gains FPS, RAM, etc.)   - Recommand\u00e9 pour (profils utilisateurs)   - Fonctionnalit\u00e9s perdues   - Audit post-configuration (scripts PowerShell) - Guide de s\u00e9lection: Arbre de d\u00e9cision interactif - Personnaliser un preset: Cr\u00e9er batches custom - Temps d'ex\u00e9cution: Tableau avec dur\u00e9es et red\u00e9marrages requis</p> <p>4. Annexes (section majeure - 600+ lignes):</p> <p>Annexe A: Liste compl\u00e8te des 200+ services d\u00e9sactivables (WIN-PERF-201) - Services de t\u00e9l\u00e9m\u00e9trie et diagnostics (6 services) - Services biom\u00e9triques et s\u00e9curit\u00e9 (4 services) - Services cloud et synchronisation (6 services) - Services Xbox et gaming (4 services) - Services de partage et r\u00e9seau (6 services) - Services Bluetooth et p\u00e9riph\u00e9riques (3 services) - Services impression et fax (3 services) - Services Hyper-V et virtualisation (5 services) - Services Windows Update (2 services) - Services recherche et indexation (1 service) - Services Superfetch et caching (1 service) - Services de stockage (2 services) - Services de maintenance (2 services) - Services Wi-Fi et mobile (2 services) - Services obsol\u00e8tes (3 services) - \u26a0\ufe0f Important: Liste des fonctionnalit\u00e9s affect\u00e9es</p> <p>Annexe B: Tableau des modifications registre - B.1: Modifications DEBLOAT (Consumer Features, Recall, Edge) - B.2: Modifications PRIVACY (Permissions, Synchronisation, T\u00e9l\u00e9m\u00e9trie)   - Permissions Applications (001-009): 8 cl\u00e9s   - Synchronisation Cloud (101-106): 5 cl\u00e9s   - T\u00e9l\u00e9m\u00e9trie Windows (201-208): 50+ cl\u00e9s   - T\u00e9l\u00e9m\u00e9trie Apps Tierces (301-304): 4 apps - B.3: Modifications PERFORMANCE (DNS, Services, Gaming)   - DNS (001-003): Cloudflare, Google, Quad9   - Plans d'alimentation (101-104): GUIDs et commandes   - Gaming (401-412): HAGS, Game Mode, Defender, Nagle</p> <p>Annexe C: Checklists avant/apr\u00e8s optimisation - C.1: Checklist AVANT optimisation   - \u2611\ufe0f Sauvegarde syst\u00e8me (point restauration, registre, apps, services)   - \u2611\ufe0f Documentation configuration actuelle (DNS, RAM, processus, FPS)   - \u2611\ufe0f Tests de r\u00e9f\u00e9rence (benchmarks)   - \u2611\ufe0f V\u00e9rification mat\u00e9riel (SSD/HDD, GPU, Bluetooth, imprimante, Hyper-V)   - \u2611\ufe0f Choix du preset - C.2: Checklist APR\u00c8S optimisation   - \u2611\ufe0f Tests fonctionnels (internet, DNS, audio, webcam, Bluetooth, apps)   - \u2611\ufe0f Tests de performance (FPS, d\u00e9marrage, RAM, latence, processus)   - \u2611\ufe0f V\u00e9rification confidentialit\u00e9 (t\u00e9l\u00e9m\u00e9trie, services, t\u00e2ches)   - \u2611\ufe0f Monitoring stabilit\u00e9 (48h)   - \u2611\ufe0f Documentation finale (logs, export config)</p> <p>Annexe D: Scripts de v\u00e9rification post-optimisation - D.1: Script de v\u00e9rification compl\u00e8te (PowerShell)   - [1/8] V\u00e9rification DNS   - [2/8] Plan d'alimentation   - [3/8] Services t\u00e9l\u00e9m\u00e9trie   - [4/8] Niveau t\u00e9l\u00e9m\u00e9trie registre   - [5/8] Utilisation RAM   - [6/8] Processus actifs   - [7/8] Services actifs   - [8/8] Hibernation   - R\u00e9sum\u00e9 et recommandations - D.2: Script de comparaison avant/apr\u00e8s (PowerShell)   - Mode \"before\": Collecte m\u00e9triques avant optimisation   - Mode \"after\": Collecte m\u00e9triques apr\u00e8s optimisation   - Mode \"compare\": Comparaison d\u00e9taill\u00e9e avec pourcentages</p> <p>Annexe E: Foire aux questions \u00e9tendues - E.1: Questions techniques   - Annuler WIN-PERF-201 (200+ services)   - Diagnostic DNS Cloudflare   - D\u00e9tecter SSD vs HDD   - S\u00e9curit\u00e9 WIN-PERF-405 (Limiter Defender)   - Preset le plus s\u00fbr (workstation standard) - E.2: Questions RGPD et entreprise   - Conformit\u00e9 RGPD des presets   - Documentation pour audit RGPD (scripts PowerShell)   - D\u00e9ploiement GPO sur parc informatique</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#statistiques-du-guide","title":"Statistiques du guide:","text":"M\u00e9trique Avant Sprint 9 Apr\u00e8s Sprint 9 Am\u00e9lioration Lignes totales 843 2350+ +180% Sections principales 5 9 +80% Annexes 0 5 (A-E) NOUVEAU Scripts PowerShell 4 9 +125% Tableaux comparatifs 15 42 +180% Checklists 0 2 NOUVEAU Actions document\u00e9es 50 100+ +100% Presets document\u00e9s 4 6 +50%"},{"location":"developer/SPRINT-9-FINAL-REPORT/#3-documentation-et-outils","title":"3. \ud83d\udcca Documentation et Outils","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#scripts-powershell-crees","title":"Scripts PowerShell cr\u00e9\u00e9s:","text":"<ol> <li>Script de v\u00e9rification post-optimisation (Annexe D.1)</li> <li>8 tests automatis\u00e9s</li> <li>Validation DNS, plan alimentation, services, t\u00e9l\u00e9m\u00e9trie</li> <li>M\u00e9triques RAM, processus, services actifs</li> <li> <p>Rapport coloris\u00e9 avec recommandations</p> </li> <li> <p>Script de comparaison avant/apr\u00e8s (Annexe D.2)</p> </li> <li>Modes: before / after / compare</li> <li>M\u00e9triques: RAM, processus, services, DNS, t\u00e9l\u00e9m\u00e9trie</li> <li>Export JSON pour tra\u00e7abilit\u00e9</li> <li> <p>Calcul automatique des pourcentages d'am\u00e9lioration</p> </li> <li> <p>Script d'audit RGPD (Annexe E.2)</p> </li> <li>Export registre (t\u00e9l\u00e9m\u00e9trie, permissions)</li> <li>Export services (diagnostic, tracking)</li> <li>Export t\u00e2ches planifi\u00e9es (compatibilit\u00e9, telemetry)</li> <li>Horodatage pour conformit\u00e9 audit</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#guides-de-selection-presets","title":"Guides de s\u00e9lection presets:","text":"<p>Arbre de d\u00e9cision ASCII-art: <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Guide de s\u00e9lection                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Vous \u00eates un GAMER?                                    \u2502\n\u2502  \u251c\u2500 PC Desktop d\u00e9di\u00e9 \u2192 \ud83c\udfae Optimisation Gaming          \u2502\n\u2502  \u251c\u2500 Laptop gaming \u2192 \ud83c\udfe2 Poste de travail + actions gaming \u2502\n\u2502  \u2514\u2500 Performances max \u2192 \u26a1 Performance maximale          \u2502\n\u2502                                                         \u2502\n\u2502  Vous \u00eates une ENTREPRISE?                              \u2502\n\u2502  \u251c\u2500 RGPD strict \u2192 \ud83d\udd12 Confidentialit\u00e9 maximale          \u2502\n\u2502  \u251c\u2500 D\u00e9ploiement standardis\u00e9 \u2192 \ud83e\uddf9 Debloat entreprise    \u2502\n\u2502  \u2514\u2500 Bureautique \u2192 \ud83c\udfe2 Poste de travail                  \u2502\n\u2502                                                         \u2502\n\u2502  Vous g\u00e9rez des SERVEURS?                               \u2502\n\u2502  \u2514\u2500 Windows Server/Workstation \u2192 \u26a1 Performance serveur \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre></p> <p>Tableau temps d'ex\u00e9cution: | Preset | Dur\u00e9e | Red\u00e9marrage | |--------|-------|-------------| | \ud83c\udfae Gaming | ~7 min | \u2705 Oui | | \ud83d\udd12 Confidentialit\u00e9 | ~7 min | \u2705 Oui | | \u26a1 Serveur | ~6 min | \u2705 Oui | | \ud83e\uddf9 Entreprise | ~8 min | \u2705 Oui | | \ud83c\udfe2 Poste travail | ~4 min | \u26a0\ufe0f Recommand\u00e9 | | \u26a1 Performance max | ~6 min | \u2705 Oui |</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#4-comparaison-twinshell-vs-autres-outils","title":"4. \ud83c\udfaf Comparaison TwinShell vs Autres Outils","text":"<p>Tableau ajout\u00e9 dans le guide (section Introduction):</p> Crit\u00e8re TwinShell Scripts manuels O&amp;O ShutUp10++ Chris Titus Tech Tra\u00e7abilit\u00e9 \u2705 Compl\u00e8te \u274c Aucune \u26a0\ufe0f Limit\u00e9e \u26a0\ufe0f Limit\u00e9e Audit RGPD \u2705 Export complet \u274c Manuel \u274c Non \u274c Non R\u00e9versibilit\u00e9 \u2705 Int\u00e9gr\u00e9e \u26a0\ufe0f Manuelle \u2705 Oui \u26a0\ufe0f Partielle Batches pr\u00e9d\u00e9finis \u2705 6 presets \u274c Non \u2705 Oui \u2705 Oui Actions custom \u2705 Oui \u2705 Oui \u274c Non \u26a0\ufe0f Limit\u00e9es Gestion packages \u2705 winget/choco \u274c Non \u274c Non \u2705 winget Open source \u2705 MIT License N/A \u274c Propri\u00e9taire \u2705 Open source Interface \ud83d\udda5\ufe0f Terminal TUI \ud83d\udcbb PowerShell \ud83d\uddb1\ufe0f GUI \ud83d\uddb1\ufe0f GUI Scripting \u2705 JSON + PS \u2705 PowerShell \u274c Non \u26a0\ufe0f Limit\u00e9"},{"location":"developer/SPRINT-9-FINAL-REPORT/#metriques-et-statistiques","title":"\ud83d\udcc8 M\u00e9triques et Statistiques","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#couverture-des-actions","title":"Couverture des Actions","text":"Cat\u00e9gorie Actions Sprint 6 Actions Sprint 7 Actions Sprint 8 Total Debloat 22 0 0 22 Privacy 0 28 0 28 Performance 0 0 42 42 Package Managers - - - 12+ TOTAL 22 28 42 100+"},{"location":"developer/SPRINT-9-FINAL-REPORT/#couverture-des-batches-predefinis","title":"Couverture des Batches Pr\u00e9d\u00e9finis","text":"Batch Actions Cat\u00e9gories Temps Risque \ud83c\udfae Gaming 8 Debloat+Privacy+Performance ~7min Mod\u00e9r\u00e9 \ud83d\udd12 Privacy 7 Privacy+Debloat ~7min Faible \u26a1 Serveur 7 Performance ~6min Mod\u00e9r\u00e9 \ud83e\uddf9 Entreprise 7 Debloat+Privacy ~8min Faible \ud83c\udfe2 Poste travail 6 Debloat+Privacy+Performance ~4min Tr\u00e8s faible \u26a1 Perf max 8 Performance ~6min \u00c9lev\u00e9"},{"location":"developer/SPRINT-9-FINAL-REPORT/#documentation","title":"Documentation","text":"Document Lignes Pages estim\u00e9es Statut OPTIMISATION-WINDOWS.md 2350+ 50+ \u2705 Compl\u00e9t\u00e9 SPRINT-8-PERFORMANCE-GUIDE.md 1000+ 22 \u2705 Existant SPRINT-9-FINAL-REPORT.md 800+ 18 \u2705 Ce fichier TOTAL DOCUMENTATION 4150+ 90+ \u2705 Compl\u00e9t\u00e9"},{"location":"developer/SPRINT-9-FINAL-REPORT/#taches-non-completees-hors-scope","title":"\u26a0\ufe0f T\u00e2ches Non Compl\u00e9t\u00e9es (Hors Scope)","text":"<p>Certaines t\u00e2ches mentionn\u00e9es dans les exigences initiales n\u00e9cessitent du code backend C#/.NET qui n'a pas \u00e9t\u00e9 impl\u00e9ment\u00e9:</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#s9-i3-campagne-de-testing-utilisateurs","title":"S9-I3: Campagne de testing utilisateurs","text":"<p>Statut: \u26a0\ufe0f Documentation fournie, tests manuels requis</p> <p>Fourni: - \u2705 Annexe C: Checklists avant/apr\u00e8s optimisation (C.1 et C.2) - \u2705 Annexe D: Scripts de v\u00e9rification post-optimisation - \u2705 Annexe D: Script de comparaison avant/apr\u00e8s avec m\u00e9triques - \u2705 Liste des configurations \u00e0 tester (Windows 10/11 Home/Pro, Server 2019/2022) - \u2705 Crit\u00e8res de test d\u00e9finis (actions sans erreur, batches fonctionnels, rollback, performance, stabilit\u00e9, documentation)</p> <p>Non fourni (n\u00e9cessite tests manuels sur machines r\u00e9elles): - \u274c Tests r\u00e9els sur 10+ configurations Windows diff\u00e9rentes - \u274c Benchmarks r\u00e9els avec mat\u00e9riel vari\u00e9 (Intel/AMD, Nvidia/AMD, SSD/HDD) - \u274c Validation stabilit\u00e9 48h sur environnements de production</p> <p>Recommandation: Ex\u00e9cuter les scripts de v\u00e9rification (Annexe D) sur 10+ configurations et documenter les r\u00e9sultats.</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#s9-i4-corrections-de-bugs-et-polish","title":"S9-I4: Corrections de bugs et polish","text":"<p>Fourni: - \u2705 Documentation compl\u00e8te et uniformis\u00e9e - \u2705 Temps estim\u00e9s pour chaque action dans les presets - \u2705 Am\u00e9lioration traductions (FR principalement, EN/ES partiels dans documentation) - \u2705 Ic\u00f4nes pour chaque cat\u00e9gorie (emojis dans les titres)</p> <p>Non fourni (n\u00e9cessite code backend C#/.NET): - \u274c Uniformisation messages d'erreur dans le code C# - \u274c Am\u00e9lioration progress bars pour actions longues (n\u00e9cessite modification du PowerShell executor) - \u274c Affichage temps estim\u00e9 dans l'interface TUI (n\u00e9cessite modification de l'UI Spectre.Console) - \u274c Traductions compl\u00e8tes FR/EN/ES dans les fichiers de resources .NET - \u274c Vid\u00e9os d\u00e9mo (3-5min par preset)</p> <p>Recommandation: 1. Cr\u00e9er issues GitHub pour chaque am\u00e9lioration UI/UX requise 2. Impl\u00e9menter dans un Sprint 10 (UI/UX Polish) 3. Vid\u00e9os d\u00e9mo peuvent \u00eatre cr\u00e9\u00e9es apr\u00e8s validation des tests utilisateurs</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#disclaimer-legal-au-premier-usage","title":"Disclaimer L\u00e9gal au Premier Usage","text":"<p>Statut: \u26a0\ufe0f Documentation fournie, impl\u00e9mentation backend requise</p> <p>Fourni: - \u2705 Texte du disclaimer complet dans ce rapport (voir section suivante) - \u2705 Emplacement d'affichage sp\u00e9cifi\u00e9 (premi\u00e8re utilisation des actions WinScript)</p> <p>Non fourni (n\u00e9cessite code backend C#): - \u274c Impl\u00e9mentation dans le service WinScript - \u274c Sauvegarde du consentement utilisateur dans SQLite - \u274c Checkbox \"Ne plus afficher ce message\" - \u274c Blocage de l'ex\u00e9cution si refus</p> <p>Texte du disclaimer l\u00e9gal (\u00e0 impl\u00e9menter):</p> <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551                   \u26a0\ufe0f  AVERTISSEMENT L\u00c9GAL                      \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551                                                                \u2551\n\u2551  Les actions de debloating, confidentialit\u00e9 et optimisation    \u2551\n\u2551  modifient profond\u00e9ment votre syst\u00e8me Windows.                 \u2551\n\u2551                                                                \u2551\n\u2551  Ces modifications:                                            \u2551\n\u2551                                                                \u2551\n\u2551  \u2022 Peuvent causer des dysfonctionnements                       \u2551\n\u2551  \u2022 Peuvent invalider votre support Microsoft                   \u2551\n\u2551  \u2022 Sont \u00e0 vos propres risques                                  \u2551\n\u2551  \u2022 N\u00e9cessitent une sauvegarde syst\u00e8me recommand\u00e9e              \u2551\n\u2551                                                                \u2551\n\u2551  En ex\u00e9cutant ces commandes, vous acceptez la pleine           \u2551\n\u2551  responsabilit\u00e9 des cons\u00e9quences.                              \u2551\n\u2551                                                                \u2551\n\u2551  [\u2713] J'ai lu et accepte ces conditions                         \u2551\n\u2551  [ ] Ne plus afficher ce message                               \u2551\n\u2551                                                                \u2551\n\u2551  [Continuer]  [Annuler]                                        \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre> <p>Impl\u00e9mentation recommand\u00e9e (C#):</p> <pre><code>// Dans WinScriptService.cs ou BatchService.cs\nprivate async Task&lt;bool&gt; ShowLegalDisclaimerIfNeeded()\n{\n    // V\u00e9rifier si d\u00e9j\u00e0 accept\u00e9\n    var setting = await _settingsService.GetSettingAsync(\"LegalDisclaimerAccepted\");\n    if (setting?.Value == \"true\")\n        return true;\n\n    // Afficher disclaimer via Spectre.Console\n    AnsiConsole.Write(new Panel(\n        new Markup(\"[yellow]\u26a0\ufe0f  AVERTISSEMENT L\u00c9GAL[/]\\n\\n\" +\n                   \"Les actions de debloating, confidentialit\u00e9 et optimisation\\n\" +\n                   \"modifient profond\u00e9ment votre syst\u00e8me Windows.\\n\\n\" +\n                   \"Ces modifications:\\n\" +\n                   \"\u2022 Peuvent causer des dysfonctionnements\\n\" +\n                   \"\u2022 Peuvent invalider votre support Microsoft\\n\" +\n                   \"\u2022 Sont \u00e0 vos propres risques\\n\" +\n                   \"\u2022 N\u00e9cessitent une sauvegarde syst\u00e8me recommand\u00e9e\\n\\n\" +\n                   \"[red]En ex\u00e9cutant ces commandes, vous acceptez la pleine\\n\" +\n                   \"responsabilit\u00e9 des cons\u00e9quences.[/]\"))\n        .BorderColor(Color.Yellow)\n        .Expand());\n\n    var accepted = AnsiConsole.Confirm(\"J'ai lu et accepte ces conditions\");\n    if (!accepted)\n        return false;\n\n    var dontShowAgain = AnsiConsole.Confirm(\"Ne plus afficher ce message\");\n    if (dontShowAgain)\n    {\n        await _settingsService.SetSettingAsync(\"LegalDisclaimerAccepted\", \"true\");\n    }\n\n    return true;\n}\n\n// Appeler avant ex\u00e9cution de batch\npublic async Task&lt;bool&gt; ExecuteBatchAsync(string batchId)\n{\n    if (!await ShowLegalDisclaimerIfNeeded())\n    {\n        AnsiConsole.MarkupLine(\"[red]Ex\u00e9cution annul\u00e9e par l'utilisateur.[/]\");\n        return false;\n    }\n\n    // Continuer l'ex\u00e9cution normale...\n}\n</code></pre>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#fichiers-modifiescrees","title":"\ud83d\udccb Fichiers Modifi\u00e9s/Cr\u00e9\u00e9s","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#fichiers-crees","title":"Fichiers Cr\u00e9\u00e9s","text":"<ol> <li>docs/SPRINT-9-FINAL-REPORT.md (ce fichier)</li> <li>Rapport final complet du Sprint 9</li> <li>800+ lignes de documentation</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#fichiers-modifies","title":"Fichiers Modifi\u00e9s","text":"<ol> <li>data/seed/initial-batches.json</li> <li>Mise \u00e0 jour des 4 batches existants</li> <li>Ajout de 2 nouveaux batches (debloat-enterprise-batch, workstation-standard-batch)</li> <li> <p>Total: 6 batches pr\u00e9d\u00e9finis</p> </li> <li> <p>docs/OPTIMISATION-WINDOWS.md</p> </li> <li>Extension massive: 843 \u2192 2350+ lignes (+180%)</li> <li>Ajout section Introduction (200+ lignes)</li> <li>Ajout section Performance Windows (600+ lignes)</li> <li>Ajout section Presets (400+ lignes)</li> <li>Ajout Annexes A-E (600+ lignes)</li> <li>Mise \u00e0 jour Changelog avec Sprint 9</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#checklist-de-finalisation","title":"\u2705 Checklist de Finalisation","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#documentation_1","title":"Documentation","text":"<ul> <li>[x] Guide utilisateur complet (2350+ lignes / 50+ pages)</li> <li>[x] Section Introduction avec comparaison outils</li> <li>[x] Section Performance Windows (42 actions)</li> <li>[x] Section Presets avec guide de s\u00e9lection</li> <li>[x] Annexe A: Liste 200+ services</li> <li>[x] Annexe B: Tableau modifications registre</li> <li>[x] Annexe C: Checklists avant/apr\u00e8s</li> <li>[x] Annexe D: Scripts de v\u00e9rification</li> <li>[x] Annexe E: FAQ \u00e9tendue</li> <li>[x] Changelog Sprint 9 complet</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batches-predefinis","title":"Batches Pr\u00e9d\u00e9finis","text":"<ul> <li>[x] \ud83c\udfae Optimisation Gaming (mis \u00e0 jour)</li> <li>[x] \ud83d\udd12 Confidentialit\u00e9 maximale (mis \u00e0 jour)</li> <li>[x] \u26a1 Performance serveur (existant)</li> <li>[x] \ud83e\uddf9 Debloat entreprise (NOUVEAU)</li> <li>[x] \ud83c\udfe2 Poste de travail (NOUVEAU)</li> <li>[x] \u26a1 Performance maximale (existant)</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#scripts-et-outils","title":"Scripts et Outils","text":"<ul> <li>[x] Script de v\u00e9rification post-optimisation (PowerShell)</li> <li>[x] Script de comparaison avant/apr\u00e8s (PowerShell)</li> <li>[x] Script d'audit RGPD (PowerShell)</li> <li>[x] Guide de s\u00e9lection preset (arbre d\u00e9cision)</li> <li>[x] Tableaux temps d'ex\u00e9cution</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#tests-et-validation-partiels","title":"Tests et Validation (Partiels)","text":"<ul> <li>[x] Documentation des crit\u00e8res de test</li> <li>[x] Checklists de test (avant/apr\u00e8s)</li> <li>[x] Scripts de validation fournis</li> <li>[ ] Tests r\u00e9els sur 10+ configurations (hors scope - n\u00e9cessite machines physiques)</li> <li>[ ] Benchmarks r\u00e9els avec mesures (hors scope - n\u00e9cessite mat\u00e9riel)</li> <li>[ ] Vid\u00e9os d\u00e9mo (hors scope - peut \u00eatre fait ult\u00e9rieurement)</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#code-backend-hors-scope","title":"Code Backend (Hors Scope)","text":"<ul> <li>[ ] Disclaimer l\u00e9gal impl\u00e9ment\u00e9 (code fourni mais pas int\u00e9gr\u00e9)</li> <li>[ ] Progress bars am\u00e9lior\u00e9es (hors scope - n\u00e9cessite code C#)</li> <li>[ ] Messages d'erreur uniformis\u00e9s (hors scope - n\u00e9cessite code C#)</li> <li>[ ] Temps estim\u00e9 dans UI (hors scope - n\u00e9cessite code C#)</li> <li>[ ] Traductions FR/EN/ES compl\u00e8tes (hors scope - n\u00e9cessite fichiers resources .NET)</li> </ul>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#recommandations-pour-sprint-10-optionnel","title":"\ud83c\udfaf Recommandations pour Sprint 10 (Optionnel)","text":"<p>Si un Sprint 10 est planifi\u00e9, voici les recommandations prioritaires:</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#priorite-1-uiux-polish","title":"Priorit\u00e9 1: UI/UX Polish","text":"<ol> <li>Impl\u00e9menter le disclaimer l\u00e9gal</li> <li>Code fourni dans ce rapport (section Disclaimer)</li> <li>Int\u00e9gration dans WinScriptService</li> <li> <p>Sauvegarde consentement dans SQLite</p> </li> <li> <p>Am\u00e9liorer les progress bars</p> </li> <li>Ajouter temps estim\u00e9 par action</li> <li>Afficher temps \u00e9coul\u00e9 / restant</li> <li>Progress bar global pour batches</li> <li> <p>Utiliser Spectre.Console ProgressBar avanc\u00e9</p> </li> <li> <p>Uniformiser les messages d'erreur</p> </li> <li>Cr\u00e9er classe ErrorMessageFormatter</li> <li>Messages localis\u00e9s (FR/EN/ES)</li> <li>Codes d'erreur standardis\u00e9s</li> <li>Logs d\u00e9taill\u00e9s avec contexte</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#priorite-2-traductions-completes","title":"Priorit\u00e9 2: Traductions Compl\u00e8tes","text":"<ol> <li>Fichiers de resources .NET</li> <li>Resources.resx (EN)</li> <li>Resources.fr.resx (FR)</li> <li> <p>Resources.es.resx (ES)</p> </li> <li> <p>Traduire:</p> </li> <li>Tous les menus TUI</li> <li>Messages d'erreur</li> <li>Descriptions d'actions</li> <li>Descriptions de batches</li> <li>Textes d'aide</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#priorite-3-testing-et-validation","title":"Priorit\u00e9 3: Testing et Validation","text":"<ol> <li>Tests automatis\u00e9s</li> <li>Tests unitaires pour chaque action</li> <li>Tests d'int\u00e9gration pour batches</li> <li> <p>Tests de rollback</p> </li> <li> <p>Tests utilisateurs</p> </li> <li>10+ configurations Windows</li> <li>Documenter les r\u00e9sultats</li> <li> <p>Cr\u00e9er rapport de testing</p> </li> <li> <p>Vid\u00e9os d\u00e9mo</p> </li> <li>1 vid\u00e9o par preset (6 vid\u00e9os)</li> <li>3-5 minutes chacune</li> <li>Montrer avant/apr\u00e8s</li> <li>Publier sur YouTube</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#priorite-4-distribution-et-packaging","title":"Priorit\u00e9 4: Distribution et Packaging","text":"<ol> <li>Installer Windows</li> <li>Cr\u00e9er .msi avec WiX</li> <li>Auto-update via GitHub Releases</li> <li> <p>Signature de code</p> </li> <li> <p>Package managers</p> </li> <li>winget: Microsoft.TwinShell</li> <li>Chocolatey: twinshell</li> <li> <p>Scoop: twinshell</p> </li> <li> <p>Docker</p> </li> <li>Image Docker pour CI/CD</li> <li>Scripts d'automatisation</li> </ol>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#metriques-finales-du-projet-twinshell","title":"\ud83d\udcca M\u00e9triques Finales du Projet TwinShell","text":""},{"location":"developer/SPRINT-9-FINAL-REPORT/#statistiques-globales","title":"Statistiques Globales","text":"M\u00e9trique Valeur Sprints compl\u00e9t\u00e9s 9 Actions totales 100+ Batches pr\u00e9d\u00e9finis 6 Lignes de documentation 4150+ Pages de documentation 90+ Scripts PowerShell 9 Syst\u00e8mes support\u00e9s Windows 10/11, Server 2019/2022 Conformit\u00e9 r\u00e9glementaire RGPD, CCPA, PIPEDA, DPA 2018"},{"location":"developer/SPRINT-9-FINAL-REPORT/#actions-par-categorie","title":"Actions par Cat\u00e9gorie","text":"Cat\u00e9gorie Count Pourcentage Debloat 22 22% Privacy 28 28% Performance 42 42% Package Managers 12+ 8% TOTAL 100+ 100%"},{"location":"developer/SPRINT-9-FINAL-REPORT/#batches-par-cible","title":"Batches par Cible","text":"Cible Batches Actions Totales Gaming 2 (Gaming, Perf Max) 16 Entreprise 3 (Privacy, Debloat, Poste travail) 20 Serveurs 1 (Serveur) 7 TOTAL 6 43"},{"location":"developer/SPRINT-9-FINAL-REPORT/#conclusion","title":"\ud83c\udfc6 Conclusion","text":"<p>Le Sprint 9 marque la finalisation r\u00e9ussie du projet TwinShell 3.0.</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#realisations-majeures","title":"R\u00e9alisations Majeures","text":"<p>\u2705 6 batches pr\u00e9d\u00e9finis professionnels couvrant tous les cas d'usage (gaming, entreprise, serveurs, bureautique) \u2705 Guide utilisateur exhaustif de 2350+ lignes (50+ pages) avec sections Introduction, Performance, Presets et Annexes compl\u00e8tes \u2705 Documentation de qualit\u00e9 production avec comparaisons outils, guides de s\u00e9lection, checklists et scripts de validation \u2705 Tra\u00e7abilit\u00e9 compl\u00e8te avec tableau modifications registre, liste services, FAQ \u00e9tendue \u2705 Scripts PowerShell de v\u00e9rification, comparaison et audit RGPD \u2705 Architecture consolid\u00e9e int\u00e9grant Debloat + Privacy + Performance de mani\u00e8re coh\u00e9rente</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#impact-attendu","title":"Impact Attendu","text":"<p>Pour les utilisateurs: - Configuration Windows optimis\u00e9e en 4 \u00e0 8 minutes (selon preset) - Gains de performance mesurables: +15-30% FPS, -40% RAM, -38% temps d\u00e9marrage - Conformit\u00e9 RGPD stricte avec export pour audit - Documentation claire permettant choix \u00e9clair\u00e9s</p> <p>Pour les entreprises: - D\u00e9ploiement standardis\u00e9 sur parcs informatiques - Conformit\u00e9 r\u00e9glementaire (RGPD, CCPA) - Tra\u00e7abilit\u00e9 compl\u00e8te des modifications - Scripts d'audit int\u00e9gr\u00e9s</p> <p>Pour la communaut\u00e9 open-source: - Base de connaissances compl\u00e8te sur optimisation Windows - Scripts PowerShell r\u00e9utilisables - M\u00e9thodologie reproductible - Code source MIT License</p>"},{"location":"developer/SPRINT-9-FINAL-REPORT/#prochaines-etapes-suggerees","title":"Prochaines \u00c9tapes Sugg\u00e9r\u00e9es","text":"<ol> <li>Tests utilisateurs sur 10+ configurations (Sprint 10)</li> <li>Impl\u00e9mentation disclaimer l\u00e9gal (code fourni)</li> <li>UI/UX polish (progress bars, messages erreur)</li> <li>Traductions compl\u00e8tes FR/EN/ES</li> <li>Vid\u00e9os d\u00e9mo (1 par preset)</li> <li>Distribution (winget, Chocolatey, .msi installer)</li> </ol> <p>TwinShell 3.0 - Pr\u00eat pour la Production \ud83c\udf89</p> <p>Documentation: \u2705 COMPL\u00c8TE Fonctionnalit\u00e9s: \u2705 COMPL\u00c8TES Batches: \u2705 6 PRESETS PROFESSIONNELS Conformit\u00e9: \u2705 RGPD, CCPA, PIPEDA Open Source: \u2705 MIT LICENSE</p> <p>Fin du rapport Sprint 9</p> <p>Date de finalisation: Novembre 2025 Version: TwinShell 3.0 - FINAL Statut: \u2705 PRODUCTION-READY</p>"},{"location":"developer/SPRINT3_USER_GUIDE/","title":"\ud83d\udcd8 TwinShell Sprint 3 - Guide Utilisateur","text":"<p>Bienvenue dans TwinShell avec les nouvelles fonctionnalit\u00e9s du Sprint 3 ! Ce guide vous aidera \u00e0 tirer le meilleur parti des am\u00e9liorations UI/UX et de customisation.</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#mode-sombre","title":"\ud83c\udf19 Mode Sombre","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#activation-du-mode-sombre","title":"Activation du Mode Sombre","text":"<ol> <li>Via le menu : <code>File</code> \u2192 <code>Settings...</code></li> <li>Dans la section Appearance, s\u00e9lectionnez votre th\u00e8me pr\u00e9f\u00e9r\u00e9 :</li> <li>Light - Th\u00e8me clair (par d\u00e9faut)</li> <li>Dark - Th\u00e8me sombre pour r\u00e9duire la fatigue oculaire</li> <li> <p>System - Suit automatiquement le th\u00e8me Windows</p> </li> <li> <p>Cliquez sur Preview Theme pour voir le r\u00e9sultat imm\u00e9diatement</p> </li> <li>Cliquez sur Save pour enregistrer votre pr\u00e9f\u00e9rence</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#raccourci-clavier","title":"Raccourci Clavier","text":"<ul> <li>Ctrl+, (Ctrl+virgule) ouvre directement les param\u00e8tres</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>\u2705 Contraste WCAG AA (ratio 4.5:1 minimum)</li> <li>\u2705 Tous les \u00e9crans et contr\u00f4les support\u00e9s</li> <li>\u2705 Transition fluide sans clignotement</li> <li>\u2705 Pr\u00e9f\u00e9rence sauvegard\u00e9e automatiquement</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#categories-personnalisees","title":"\ud83d\udcc1 Cat\u00e9gories Personnalis\u00e9es","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#creer-une-nouvelle-categorie","title":"Cr\u00e9er une Nouvelle Cat\u00e9gorie","text":"<ol> <li>Via le menu : <code>Categories</code> \u2192 <code>Manage Categories...</code></li> <li>Cliquez sur + Add New Category</li> <li>Remplissez le formulaire :</li> <li>Nom : Nom de votre cat\u00e9gorie (ex: \"Backup quotidien\")</li> <li>Ic\u00f4ne : Choisissez parmi 24 ic\u00f4nes disponibles</li> <li>Couleur : S\u00e9lectionnez une des 12 couleurs propos\u00e9es</li> <li> <p>Description (optionnel) : D\u00e9crivez l'usage de cette cat\u00e9gorie</p> </li> <li> <p>Cliquez sur Save Category</p> </li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#raccourci-clavier_1","title":"Raccourci Clavier","text":"<ul> <li>Ctrl+M ouvre directement la gestion des cat\u00e9gories</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#gerer-les-categories","title":"G\u00e9rer les Cat\u00e9gories","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#modifier-une-categorie","title":"Modifier une Cat\u00e9gorie","text":"<ol> <li>Dans la liste de gauche, s\u00e9lectionnez la cat\u00e9gorie</li> <li>Cliquez sur Edit Category</li> <li>Modifiez les informations</li> <li>Save pour enregistrer</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#reorganiser-les-categories","title":"R\u00e9organiser les Cat\u00e9gories","text":"<ol> <li>S\u00e9lectionnez une cat\u00e9gorie</li> <li>Utilisez les boutons Move Up et Move Down</li> <li>L'ordre est sauvegard\u00e9 automatiquement</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#masquer-une-categorie","title":"Masquer une Cat\u00e9gorie","text":"<ol> <li>S\u00e9lectionnez la cat\u00e9gorie</li> <li>Cliquez sur Hide (ou Show pour la r\u00e9afficher)</li> <li>Les cat\u00e9gories masqu\u00e9es ne disparaissent pas de la liste mais ne s'affichent plus dans la navigation</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#supprimer-une-categorie","title":"Supprimer une Cat\u00e9gorie","text":"<ol> <li>S\u00e9lectionnez la cat\u00e9gorie</li> <li>Cliquez sur Delete Category</li> <li>Confirmez la suppression</li> <li>\u26a0\ufe0f Note : Les cat\u00e9gories syst\u00e8me (marqu\u00e9es \"System\") ne peuvent pas \u00eatre supprim\u00e9es</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#limites","title":"Limites","text":"<ul> <li>Maximum 50 cat\u00e9gories pour \u00e9viter la surcharge</li> <li>Les cat\u00e9gories syst\u00e8me sont prot\u00e9g\u00e9es contre la modification/suppression</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#parametres-avances","title":"\u2699\ufe0f Param\u00e8tres Avanc\u00e9s","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#acces-aux-parametres","title":"Acc\u00e8s aux Param\u00e8tres","text":"<ul> <li>Menu : <code>File</code> \u2192 <code>Settings...</code></li> <li>Raccourci : <code>Ctrl+,</code></li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#options-disponibles","title":"Options Disponibles","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#section-apparence","title":"Section Apparence","text":"<ul> <li>Theme : Light | Dark | System</li> <li>Preview Theme : Pr\u00e9visualiser avant de sauvegarder</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#section-comportement","title":"Section Comportement","text":"<p>Historique - Command History Retention : Nombre de jours de conservation (1-3650 jours)   - Par d\u00e9faut : 90 jours   - Les commandes plus anciennes sont automatiquement supprim\u00e9es</p> <p>Affichage - Maximum History Items : Nombre max d'items dans les vues historique (10-100,000)   - Par d\u00e9faut : 1000 items</p> <p>Widget Commandes R\u00e9centes - Recent Commands Count : Nombre de commandes r\u00e9centes affich\u00e9es (1-50)   - Par d\u00e9faut : 5 commandes - Show Recent Commands Widget : Afficher/masquer le widget au d\u00e9marrage</p> <p>S\u00e9curit\u00e9 - Confirm before executing dangerous commands : Active les confirmations pour les commandes critiques   - Recommand\u00e9 : \u2705 Activ\u00e9</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#reinitialiser-les-parametres","title":"R\u00e9initialiser les Param\u00e8tres","text":"<ol> <li>Cliquez sur Reset to Defaults</li> <li>Confirmez l'action</li> <li>Tous les param\u00e8tres reviennent aux valeurs par d\u00e9faut</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#sauvegarde-des-parametres","title":"Sauvegarde des Param\u00e8tres","text":"<ul> <li>Les param\u00e8tres sont automatiquement sauvegard\u00e9s dans :   <pre><code>%APPDATA%\\TwinShell\\settings.json\n</code></pre></li> <li>Vous pouvez sauvegarder ce fichier pour restaurer vos pr\u00e9f\u00e9rences plus tard</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#raccourcis-clavier","title":"\u2328\ufe0f Raccourcis Clavier","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#raccourcis-globaux","title":"Raccourcis Globaux","text":"Raccourci Action Ctrl+, Ouvrir les Param\u00e8tres Ctrl+M G\u00e9rer les Cat\u00e9gories Ctrl+E Exporter la Configuration Ctrl+I Importer la Configuration F1 Afficher l'Aide F5 Actualiser les Actions Tab Naviguer entre les contr\u00f4les Esc Annuler/Fermer Alt+F4 Quitter l'Application"},{"location":"developer/SPRINT3_USER_GUIDE/#navigation-au-clavier","title":"Navigation au Clavier","text":"<ul> <li>Toutes les fonctionnalit\u00e9s sont accessibles au clavier</li> <li>Tab et Shift+Tab pour naviguer</li> <li>Enter pour activer</li> <li>Espace pour cocher/d\u00e9cocher</li> <li>Fl\u00e8ches pour naviguer dans les listes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#aide-integree","title":"Aide Int\u00e9gr\u00e9e","text":"<ul> <li>Appuyez sur F1 pour voir tous les raccourcis disponibles</li> <li>Menu <code>Help</code> \u2192 <code>Keyboard Shortcuts</code> pour la liste compl\u00e8te</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#notifications","title":"\ud83d\udd14 Notifications","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#types-de-notifications","title":"Types de Notifications","text":"<p>L'application affiche des notifications toast en haut \u00e0 droite pour :</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#informations-bleu","title":"Informations (Bleu)","text":"<ul> <li>Actions r\u00e9ussies</li> <li>Chargement de donn\u00e9es</li> <li>Dur\u00e9e : 3 secondes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#succes-vert","title":"Succ\u00e8s (Vert)","text":"<ul> <li>Sauvegarde r\u00e9ussie</li> <li>Cr\u00e9ation de cat\u00e9gorie</li> <li>Export compl\u00e9t\u00e9</li> <li>Dur\u00e9e : 3 secondes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#avertissements-orange","title":"Avertissements (Orange)","text":"<ul> <li>Actions n\u00e9cessitant attention</li> <li>Limites atteintes</li> <li>Dur\u00e9e : 4 secondes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#erreurs-rouge","title":"Erreurs (Rouge)","text":"<ul> <li>\u00c9chec d'une op\u00e9ration</li> <li>Validation \u00e9chou\u00e9e</li> <li>Probl\u00e8me de connexion</li> <li>Dur\u00e9e : 5 secondes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#caracteristiques_1","title":"Caract\u00e9ristiques","text":"<ul> <li>\u2705 Apparition fluide (animation fade-in)</li> <li>\u2705 Disparition automatique</li> <li>\u2705 Effet d'ombre pour la lisibilit\u00e9</li> <li>\u2705 Positionnement non-intrusif</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#animations-et-transitions","title":"\ud83c\udfa8 Animations et Transitions","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#animations-integrees","title":"Animations Int\u00e9gr\u00e9es","text":"<p>L'interface utilise des animations subtiles pour am\u00e9liorer l'exp\u00e9rience :</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#transitions-de-page","title":"Transitions de Page","text":"<ul> <li>Fade in/out (300ms)</li> <li>Apparition progressive du contenu</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#interactions","title":"Interactions","text":"<ul> <li>Hover : D\u00e9placement l\u00e9ger des items de liste</li> <li>Click : Effet ripple sur les boutons</li> <li>Selection : Mise en surbrillance anim\u00e9e</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#chargement","title":"Chargement","text":"<ul> <li>Spinner : Barre de progression ind\u00e9termin\u00e9e</li> <li>Skeleton Loaders : Placeholders anim\u00e9s pendant le chargement</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#performance","title":"Performance","text":"<ul> <li>Toutes les animations sont &lt; 300ms (conformit\u00e9 WCAG)</li> <li>Optimis\u00e9es pour ne pas ralentir l'interface</li> <li>Utilisation d'easing functions pour la fluidit\u00e9</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#accessibilite","title":"\u267f Accessibilit\u00e9","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#navigation-au-clavier_1","title":"Navigation au Clavier","text":"<ul> <li>\u2705 100% accessible au clavier</li> <li>\u2705 Tous les contr\u00f4les ont un focus visible</li> <li>\u2705 Tab navigation logique</li> <li>\u2705 Raccourcis pour toutes les actions principales</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#contraste-et-lisibilite","title":"Contraste et Lisibilit\u00e9","text":"<ul> <li>\u2705 WCAG AA compliant (ratio 4.5:1+)</li> <li>\u2705 Texte lisible en Light et Dark mode</li> <li>\u2705 Couleurs s\u00e9mantiques (rouge=danger, vert=succ\u00e8s)</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#support-lecteur-decran","title":"Support Lecteur d'\u00c9cran","text":"<ul> <li>Propri\u00e9t\u00e9s d'automation configur\u00e9es</li> <li>Descriptions textuelles pour tous les contr\u00f4les</li> <li>Compatible avec les lecteurs d'\u00e9cran modernes</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#taille-de-fenetre","title":"Taille de Fen\u00eatre","text":"<ul> <li>Minimum : 800x600 pixels</li> <li>Responsive : S'adapte jusqu'\u00e0 plein \u00e9cran</li> <li>Layouts flexibles qui ne cassent pas</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#conseils-et-astuces","title":"\ud83d\udca1 Conseils et Astuces","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#optimiser-votre-workflow","title":"Optimiser votre Workflow","text":"<ol> <li>Cr\u00e9ez des cat\u00e9gories th\u00e9matiques</li> <li>Exemple : \"T\u00e2ches Quotidiennes\", \"Maintenance\", \"Urgences\"</li> <li> <p>Assignez des couleurs distinctes pour reconnaissance rapide</p> </li> <li> <p>Utilisez les raccourcis clavier</p> </li> <li>Gagnez du temps avec Ctrl+M, F5, etc.</li> <li> <p>M\u00e9morisez F1 pour l'aide instantan\u00e9e</p> </li> <li> <p>Configurez le mode sombre</p> </li> <li>R\u00e9duisez la fatigue oculaire lors de sessions longues</li> <li> <p>Utilisez le mode System pour changement automatique jour/nuit</p> </li> <li> <p>Ajustez les pr\u00e9f\u00e9rences d'historique</p> </li> <li>R\u00e9duisez la r\u00e9tention si l'espace disque est limit\u00e9</li> <li> <p>Augmentez pour conserver un historique \u00e9tendu</p> </li> <li> <p>Activez les confirmations pour actions dangereuses</p> </li> <li>\u00c9vite les erreurs accidentelles</li> <li>Recommand\u00e9 pour environnements de production</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#resolution-de-problemes","title":"R\u00e9solution de Probl\u00e8mes","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#le-theme-ne-change-pas","title":"Le th\u00e8me ne change pas","text":"<ul> <li>V\u00e9rifiez que vous avez cliqu\u00e9 sur Save</li> <li>Red\u00e9marrez l'application si n\u00e9cessaire</li> <li>V\u00e9rifiez le fichier settings.json dans %APPDATA%</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#categorie-non-modifiable","title":"Cat\u00e9gorie non modifiable","text":"<ul> <li>V\u00e9rifiez si c'est une cat\u00e9gorie System (badge jaune)</li> <li>Les cat\u00e9gories syst\u00e8me sont prot\u00e9g\u00e9es</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#raccourcis-clavier-ne-fonctionnent-pas","title":"Raccourcis clavier ne fonctionnent pas","text":"<ul> <li>Assurez-vous que la fen\u00eatre TwinShell a le focus</li> <li>V\u00e9rifiez qu'aucune autre application n'intercepte le raccourci</li> <li>Consultez F1 pour la liste des raccourcis actifs</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#fichiers-et-donnees","title":"\ud83d\udcca Fichiers et Donn\u00e9es","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#emplacement-des-donnees","title":"Emplacement des Donn\u00e9es","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#base-de-donnees","title":"Base de Donn\u00e9es","text":"<p><pre><code>%LOCALAPPDATA%\\TwinShell\\twinshell.db\n</code></pre> Contient : - Actions - Historique de commandes - Favoris - Cat\u00e9gories personnalis\u00e9es (nouveau)</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#parametres-utilisateur","title":"Param\u00e8tres Utilisateur","text":"<p><pre><code>%APPDATA%\\TwinShell\\settings.json\n</code></pre> Contient : - Th\u00e8me s\u00e9lectionn\u00e9 - Pr\u00e9f\u00e9rences de comportement - Options d'affichage</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#sauvegarde-recommandee","title":"Sauvegarde Recommand\u00e9e","text":"<p>Pour sauvegarder vos configurations : 1. Export via menu : <code>File</code> \u2192 <code>Export Configuration...</code> 2. Copie manuelle des fichiers :    - <code>twinshell.db</code> (base de donn\u00e9es)    - <code>settings.json</code> (pr\u00e9f\u00e9rences)</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#restauration","title":"Restauration","text":"<ol> <li>Import via menu : <code>File</code> \u2192 <code>Import Configuration...</code></li> <li>Ou copie manuelle des fichiers dans les emplacements correspondants</li> </ol>"},{"location":"developer/SPRINT3_USER_GUIDE/#support","title":"\ud83c\udd98 Support","text":""},{"location":"developer/SPRINT3_USER_GUIDE/#aide-integree_1","title":"Aide Int\u00e9gr\u00e9e","text":"<ul> <li>F1 : Aide rapide avec raccourcis</li> <li>Menu Help \u2192 About : Informations sur l'application</li> <li>Menu Help \u2192 Keyboard Shortcuts : Liste compl\u00e8te des raccourcis</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#documentation","title":"Documentation","text":"<ul> <li>SPRINT3_SUMMARY.md : Vue d'ensemble technique</li> <li>SPRINT3_FINAL_REPORT.md : Rapport complet du sprint</li> <li>MIGRATION_NOTES.md : Notes pour administrateurs</li> </ul>"},{"location":"developer/SPRINT3_USER_GUIDE/#feedback","title":"Feedback","text":"<p>Pour signaler un bug ou sugg\u00e9rer une am\u00e9lioration : - Cr\u00e9ez une issue sur le repository GitHub - Incluez des captures d'\u00e9cran si possible - D\u00e9crivez les \u00e9tapes pour reproduire</p>"},{"location":"developer/SPRINT3_USER_GUIDE/#profitez-de-twinshell","title":"\ud83c\udf89 Profitez de TwinShell !","text":"<p>Vous disposez maintenant d'un outil puissant et personnalisable pour g\u00e9rer vos commandes PowerShell et Bash.</p> <p>Fonctionnalit\u00e9s Sprint 3 : - \u2705 Mode sombre professionnel - \u2705 Cat\u00e9gories personnalis\u00e9es illimit\u00e9es (50 max) - \u2705 Interface fluide avec animations - \u2705 Raccourcis clavier complets - \u2705 Notifications informatives - \u2705 Accessibilit\u00e9 WCAG AA</p> <p>Bon travail et productivit\u00e9 accrue ! \ud83d\ude80</p> <p>Guide Version: 1.2 - Sprint 3 Derni\u00e8re mise \u00e0 jour: 2025-11-26 Application: TwinShell v1.2.0</p>"},{"location":"developer/TECHNICAL_DEBT/","title":"Dette Technique - TwinShell","text":"<p>Date de cr\u00e9ation : 2025-11-19 Statut : \ud83d\udd34 ACTIF</p>"},{"location":"developer/TECHNICAL_DEBT/#1-tests-unitaires-obsoletes-priorite-haute","title":"1. Tests Unitaires Obsol\u00e8tes (PRIORIT\u00c9 HAUTE)","text":""},{"location":"developer/TECHNICAL_DEBT/#probleme","title":"Probl\u00e8me","text":"<p>Les projets de tests (<code>TwinShell.Core.Tests</code>, <code>TwinShell.Persistence.Tests</code>, <code>TwinShell.Infrastructure.Tests</code>) sont temporairement exclus du CI/CD car ils contiennent du code obsol\u00e8te qui ne correspond plus aux signatures d'API actuelles.</p>"},{"location":"developer/TECHNICAL_DEBT/#details-techniques","title":"D\u00e9tails techniques","text":"<ul> <li>Erreurs : ~20 erreurs de compilation dues \u00e0 :</li> <li>Signatures de constructeur modifi\u00e9es (ex: <code>CommandGeneratorService</code> n\u00e9cessite <code>ILocalizationService</code>)</li> <li>Propri\u00e9t\u00e9s supprim\u00e9es/renomm\u00e9es dans les mod\u00e8les (ex: <code>UserSettings.RecentCommandsCount</code>)</li> <li>Fake repositories incomplets (m\u00e9thodes d'interface manquantes)</li> <li>Conversions de types incompatibles (<code>IOrderedEnumerable</code> vs <code>IEnumerable</code>)</li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#impact","title":"Impact","text":"<ul> <li>\u2705 Aucun impact sur l'application : L'app TwinShell build et fonctionne parfaitement</li> <li>\u26a0\ufe0f Tests d\u00e9sactiv\u00e9s dans CI/CD : Pas de v\u00e9rification automatis\u00e9e de la logique m\u00e9tier</li> <li>\u26a0\ufe0f Couverture de tests inconnue : Impossible de mesurer la qualit\u00e9 du code</li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#solution-recommandee","title":"Solution recommand\u00e9e","text":"<p>Refactoring complet des tests en 3 phases :</p>"},{"location":"developer/TECHNICAL_DEBT/#phase-1-mise-a-jour-des-fake-repositories-estime-2-3h","title":"Phase 1 : Mise \u00e0 jour des Fake Repositories (Estim\u00e9 : 2-3h)","text":"<ul> <li>[ ] Impl\u00e9menter <code>FakeLocalizationService</code> avec signatures actuelles</li> <li>[ ] Mettre \u00e0 jour tous les constructeurs de tests pour passer <code>ILocalizationService</code></li> <li>[ ] Corriger <code>FakeFavoritesRepository.GetAllAsync()</code> pour retourner <code>IEnumerable</code> au lieu de <code>IOrderedEnumerable</code></li> <li>[ ] Adapter <code>SecurityTests.FakeRepository&lt;T&gt;</code> pour impl\u00e9menter l'interface appropri\u00e9e</li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#phase-2-synchronisation-avec-api-actuelle-estime-3-4h","title":"Phase 2 : Synchronisation avec API actuelle (Estim\u00e9 : 3-4h)","text":"<ul> <li>[ ] Auditer toutes les propri\u00e9t\u00e9s de mod\u00e8les utilis\u00e9es dans les tests</li> <li>[ ] Remplacer <code>UserSettings.RecentCommandsCount</code> par propri\u00e9t\u00e9 actuelle</li> <li>[ ] V\u00e9rifier et corriger tous les usages de <code>CommandBatch.Actions</code> \u2192 <code>CommandBatch.Commands</code></li> <li>[ ] Corriger les conversions de types dans <code>DebloatingActionsTests</code> et <code>PerformanceActionsTests</code></li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#phase-3-reintegration-cicd-estime-1h","title":"Phase 3 : R\u00e9int\u00e9gration CI/CD (Estim\u00e9 : 1h)","text":"<ul> <li>[ ] D\u00e9commenter les \u00e9tapes de tests dans <code>.github/workflows/dotnet-desktop.yml</code></li> <li>[ ] V\u00e9rifier que <code>dotnet test TwinShell.sln</code> passe avec 100% succ\u00e8s</li> <li>[ ] Configurer seuils de couverture de code (objectif : 40%+)</li> <li>[ ] Supprimer ce fichier TECHNICAL_DEBT.md</li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#workaround-actuel","title":"Workaround actuel","text":"<p>Le workflow CI/CD build uniquement <code>src/TwinShell.App/TwinShell.App.csproj</code>, ce qui permet : - \u2705 Build automatis\u00e9 de l'application - \u2705 G\u00e9n\u00e9ration des artefacts et package portable - \u2705 D\u00e9ploiement continu fonctionnel</p>"},{"location":"developer/TECHNICAL_DEBT/#fichiers-modifies-pour-le-workaround","title":"Fichiers modifi\u00e9s pour le workaround","text":"<ul> <li><code>.github/workflows/dotnet-desktop.yml</code> (ligne 30-45) : Tests comment\u00e9s</li> </ul>"},{"location":"developer/TECHNICAL_DEBT/#2-corrections-appliquees-recemment","title":"2. Corrections Appliqu\u00e9es R\u00e9cemment","text":""},{"location":"developer/TECHNICAL_DEBT/#resolu-dependances-xunit-manquantes","title":"\u2705 R\u00e9solu : D\u00e9pendances xUnit manquantes","text":"<p>Probl\u00e8me : 757 erreurs CS0246 (<code>FactAttribute not found</code>) Solution : Ajout de <code>GlobalUsings.cs</code> dans tous les projets de tests avec <code>global using Xunit;</code> Impact : Build des tests passe de 757 \u2192 20 erreurs</p>"},{"location":"developer/TECHNICAL_DEBT/#resolu-ambiguite-type-action","title":"\u2705 R\u00e9solu : Ambigu\u00eft\u00e9 type <code>Action</code>","text":"<p>Probl\u00e8me : Conflit entre <code>System.Action</code> et <code>TwinShell.Core.Models.Action</code> Solution : Alias global <code>global using Action = TwinShell.Core.Models.Action;</code></p>"},{"location":"developer/TECHNICAL_DEBT/#resolu-fake-repositories-incomplets","title":"\u2705 R\u00e9solu : Fake Repositories incomplets","text":"<p>Fichiers corrig\u00e9s : - <code>CommandHistoryServiceTests.cs</code> : Ajout <code>AddRangeAsync()</code>, <code>UpdateAsync()</code> - <code>FavoritesServiceTests.cs</code> : Ajout <code>AddRangeAsync()</code> - <code>BatchRepositoryTests.cs</code> : Correction <code>BatchExecutionMode</code>, <code>BatchCommandItem</code></p>"},{"location":"developer/TECHNICAL_DEBT/#3-recommandations-futures","title":"3. Recommandations Futures","text":""},{"location":"developer/TECHNICAL_DEBT/#prevention","title":"Pr\u00e9vention","text":"<ol> <li>Mettre \u00e0 jour les tests SIMULTAN\u00c9MENT avec le code production (ne jamais diverger)</li> <li>CI/CD doit TOUJOURS inclure les tests (pas de workaround permanent)</li> <li>Ajouter pre-commit hooks pour v\u00e9rifier que <code>dotnet test</code> passe avant commit</li> <li>Augmenter la couverture de 8.5% \u2192 40%+ (objectif Sprint 11)</li> </ol>"},{"location":"developer/TECHNICAL_DEBT/#monitoring","title":"Monitoring","text":"<ul> <li>[ ] Cr\u00e9er un ticket JIRA/GitHub Issue d\u00e9di\u00e9 pour le refactoring des tests</li> <li>[ ] Planifier Sprint d\u00e9di\u00e9 (estim\u00e9 6-8h total)</li> <li>[ ] Code review obligatoire apr\u00e8s r\u00e9int\u00e9gration</li> </ul> <p>Responsable : \u00c9quipe DevOps Prochaine r\u00e9vision : \u00c0 planifier (post v1.2.0)</p>"},{"location":"formations/ad-hardening/","title":"Formation : Durcissement Active Directory","text":""},{"location":"formations/ad-hardening/#introduction","title":"Introduction","text":"<p>Active Directory est la cible n\u00b01 des attaquants.</p> <p>Dans 90% des attaques par ransomware, la compromission d'Active Directory est l'\u00e9tape cl\u00e9 qui permet aux attaquants de prendre le contr\u00f4le total du syst\u00e8me d'information. Une fois l'AD compromis, c'est game over : d\u00e9ploiement de ransomware sur tous les postes, exfiltration de donn\u00e9es, destruction des sauvegardes.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  ANATOMIE D'UNE ATTAQUE AD                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   [Phishing]  \u2500\u2500\u25ba  [Poste Utilisateur]  \u2500\u2500\u25ba  [Mouvement        \u2502\n\u2502                           \u2502                   Lat\u00e9ral]          \u2502\n\u2502                           \u2502                      \u2502              \u2502\n\u2502                           \u25bc                      \u25bc              \u2502\n\u2502                    [\u00c9l\u00e9vation de        [Compromission AD]      \u2502\n\u2502                     Privil\u00e8ges]                \u2502                \u2502\n\u2502                                                \u25bc                \u2502\n\u2502                                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502                                    \u2502   DOMAIN ADMIN      \u2502      \u2502\n\u2502                                    \u2502   = GAME OVER       \u2502      \u2502\n\u2502                                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                                                \u2502                \u2502\n\u2502                                                \u25bc                \u2502\n\u2502                              [Ransomware / Exfiltration]        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Statistique Alarmante</p> <p>Selon Microsoft, le temps moyen pour qu'un attaquant obtienne des privil\u00e8ges Domain Admin apr\u00e8s une compromission initiale est de moins de 48 heures. Dans certains cas, ce d\u00e9lai est r\u00e9duit \u00e0 quelques heures.</p>"},{"location":"formations/ad-hardening/#pourquoi-cette-formation","title":"Pourquoi cette formation ?","text":"<p>Cette formation vous donnera les connaissances et les outils pour :</p> <ul> <li>:material-shield-check: Comprendre l'architecture de s\u00e9curit\u00e9 recommand\u00e9e (Tiering Model)</li> <li>:material-shield-check: Identifier les vecteurs d'attaque les plus courants</li> <li>:material-shield-check: Impl\u00e9menter des mesures de durcissement concr\u00e8tes</li> <li>:material-shield-check: Auditer votre environnement AD existant</li> </ul>"},{"location":"formations/ad-hardening/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 3 modules :</p>"},{"location":"formations/ad-hardening/#module-1-le-modele-de-tiering","title":"Module 1 : Le Mod\u00e8le de Tiering","text":"<p>:material-layers-triple: Architecture | :material-clock-outline: ~60 min</p> <ul> <li>Le mod\u00e8le d'administration en couches (Microsoft Enterprise Access Model)</li> <li>S\u00e9paration Tier 0 / Tier 1 / Tier 2</li> <li>La r\u00e8gle d'or : isolation des credentials</li> <li>Impl\u00e9mentation des PAW (Privileged Access Workstations)</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/ad-hardening/#module-2-vecteurs-dattaque-ad","title":"Module 2 : Vecteurs d'Attaque AD","text":"<p>:material-skull-crossbones: Offensive Security | :material-clock-outline: ~75 min</p> <ul> <li>ASREPRoast : exploitation de la pr\u00e9-authentification Kerberos</li> <li>Kerberoasting : attaque des comptes de service</li> <li>Pass-the-Hash et Pass-the-Ticket</li> <li>D\u00e9tection et rem\u00e9diation</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/ad-hardening/#module-3-audit-et-politiques-de-mots-de-passe","title":"Module 3 : Audit et Politiques de Mots de Passe","text":"<p>:material-shield-lock: D\u00e9fense | :material-clock-outline: ~60 min</p> <ul> <li>Audit avec PingCastle</li> <li>Fine-Grained Password Policies (PSO/FGPP)</li> <li>Group Managed Service Accounts (gMSA)</li> <li>Strat\u00e9gie de durcissement progressive</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/ad-hardening/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>Active Directory : Concepts de base (For\u00eat, Domaine, OU)</li> <li>Utilisateurs et Groupes : Cr\u00e9ation, gestion, groupes de s\u00e9curit\u00e9</li> <li>GPO : Cr\u00e9ation et liaison de strat\u00e9gies de groupe</li> <li>PowerShell : Commandes de base, module ActiveDirectory</li> <li>Kerberos : Notions de base (TGT, TGS, SPN)</li> </ul>"},{"location":"formations/ad-hardening/#environnement-de-lab","title":"Environnement de Lab","text":"<p>Pour les exercices pratiques, vous aurez besoin de :</p> Lab Recommand\u00e9PowerShell - V\u00e9rification des pr\u00e9requis <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ENVIRONNEMENT DE LAB               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                 \u2502\n\u2502   [DC01]  - Windows Server 2019/2022           \u2502\n\u2502            - Contr\u00f4leur de domaine             \u2502\n\u2502            - DNS int\u00e9gr\u00e9                       \u2502\n\u2502            - 4 GB RAM minimum                  \u2502\n\u2502                                                 \u2502\n\u2502   [SRV01] - Windows Server 2019/2022           \u2502\n\u2502            - Serveur membre                    \u2502\n\u2502            - Simulation Tier 1                 \u2502\n\u2502            - 2 GB RAM minimum                  \u2502\n\u2502                                                 \u2502\n\u2502   [PC01]  - Windows 10/11 Pro                  \u2502\n\u2502            - Poste joint au domaine            \u2502\n\u2502            - Simulation Tier 2                 \u2502\n\u2502            - 4 GB RAM minimum                  \u2502\n\u2502                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># V\u00e9rifier le module ActiveDirectory\nGet-Module -ListAvailable -Name ActiveDirectory\n\n# Si absent, installer les RSAT\nAdd-WindowsCapability -Online -Name Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0\n\n# V\u00e9rifier la connectivit\u00e9 au domaine\nTest-ComputerSecureChannel -Verbose\n\n# V\u00e9rifier le niveau fonctionnel du domaine\n(Get-ADDomain).DomainMode\n</code></pre>"},{"location":"formations/ad-hardening/#ressources-et-references","title":"Ressources et R\u00e9f\u00e9rences","text":""},{"location":"formations/ad-hardening/#standards-et-bonnes-pratiques","title":"Standards et Bonnes Pratiques","text":"<ul> <li>:material-file-document: ANSSI - Recommandations de s\u00e9curit\u00e9 relatives \u00e0 Active Directory</li> <li>:material-file-document: Microsoft - Enterprise Access Model</li> <li>:material-file-document: Microsoft - Securing Privileged Access</li> </ul>"},{"location":"formations/ad-hardening/#outils-daudit","title":"Outils d'Audit","text":"<ul> <li>:material-tools: PingCastle \u2014 Audit automatis\u00e9 d'Active Directory</li> <li>:material-tools: BloodHound \u2014 Analyse des chemins d'attaque</li> <li>:material-tools: Purple Knight \u2014 \u00c9valuation de la s\u00e9curit\u00e9 AD</li> </ul>"},{"location":"formations/ad-hardening/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<ul> <li>:material-book: IT-Connect - S\u00e9curit\u00e9 Active Directory</li> <li>:material-book: HackTricks - Active Directory Methodology</li> </ul>"},{"location":"formations/ad-hardening/#avertissement","title":"Avertissement","text":"<p>Usage \u00c9thique Uniquement</p> <p>Les techniques offensives pr\u00e9sent\u00e9es dans cette formation sont \u00e0 des fins \u00e9ducatives et d\u00e9fensives uniquement.</p> <p>Toute utilisation de ces connaissances sur des syst\u00e8mes sans autorisation explicite est ill\u00e9gale et passible de poursuites p\u00e9nales.</p> <p>Dans un contexte professionnel (Worldline/SecNumCloud), assurez-vous d'avoir les autorisations n\u00e9cessaires avant tout test de s\u00e9curit\u00e9.</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Security Team</p>"},{"location":"formations/ad-hardening/01-tiering-model/","title":"Module 1 : Le Mod\u00e8le de Tiering","text":""},{"location":"formations/ad-hardening/01-tiering-model/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre le mod\u00e8le d'administration en couches (Tiering Model)</li> <li>:material-check: Identifier les ressources appartenant \u00e0 chaque Tier</li> <li>:material-check: Appliquer la r\u00e8gle d'or de s\u00e9paration des credentials</li> <li>:material-check: Planifier une strat\u00e9gie de migration vers le Tiering</li> </ul>"},{"location":"formations/ad-hardening/01-tiering-model/#1-pourquoi-le-tiering-model","title":"1. Pourquoi le Tiering Model ?","text":""},{"location":"formations/ad-hardening/01-tiering-model/#11-le-probleme-ladministration-plate","title":"1.1 Le Probl\u00e8me : L'Administration Plate","text":"<p>Dans une infrastructure AD traditionnelle, les administrateurs utilisent souvent un seul compte pour toutes leurs t\u00e2ches :</p> <ul> <li>Se connecter \u00e0 leur poste de travail</li> <li>Administrer les contr\u00f4leurs de domaine</li> <li>G\u00e9rer les serveurs applicatifs</li> <li>D\u00e9panner les postes utilisateurs</li> </ul> <p>Le Danger de l'Administration Plate</p> <p>Lorsqu'un administrateur Domain Admin se connecte \u00e0 un poste utilisateur compromis, ses credentials sont mis en cache sur cette machine.</p> <p>Un attaquant peut alors :</p> <ol> <li>Extraire le hash NTLM avec Mimikatz</li> <li>Effectuer une attaque Pass-the-Hash</li> <li>Se connecter directement aux contr\u00f4leurs de domaine</li> <li>Prendre le contr\u00f4le total du domaine</li> </ol> <p>Temps n\u00e9cessaire : quelques secondes.</p>"},{"location":"formations/ad-hardening/01-tiering-model/#12-la-solution-segmentation-des-privileges","title":"1.2 La Solution : Segmentation des Privil\u00e8ges","text":"<p>Le Tiering Model (ou Microsoft Enterprise Access Model) r\u00e9sout ce probl\u00e8me en :</p> <ul> <li>S\u00e9parant l'infrastructure en couches de confiance (Tiers)</li> <li>Exigeant des comptes s\u00e9par\u00e9s pour chaque Tier</li> <li>Interdisant les connexions descendantes (Tier 0 \u2192 Tier 2)</li> </ul>"},{"location":"formations/ad-hardening/01-tiering-model/#2-les-trois-tiers","title":"2. Les Trois Tiers","text":""},{"location":"formations/ad-hardening/01-tiering-model/#21-vue-densemble","title":"2.1 Vue d'Ensemble","text":"<pre><code>graph TB\n    subgraph TIER0[\"TIER 0 - Plan de Contr\u00f4le de l'Identit\u00e9\"]\n        DC[(\"\ud83c\udff0 Contr\u00f4leurs&lt;br/&gt;de Domaine\")]\n        PKI[(\"\ud83d\udd10 PKI / ADCS\")]\n        ADFS[(\"\ud83c\udfab ADFS / AAD Connect\")]\n        PAM[(\"\ud83d\udc51 Comptes&lt;br/&gt;Domain Admins\")]\n    end\n\n    subgraph TIER1[\"TIER 1 - Serveurs d'Entreprise\"]\n        APP[(\"\ud83d\udce6 Serveurs&lt;br/&gt;Applicatifs\")]\n        DB[(\"\ud83d\uddc4\ufe0f Serveurs&lt;br/&gt;de Base de Donn\u00e9es\")]\n        FILE[(\"\ud83d\udcc1 Serveurs&lt;br/&gt;de Fichiers\")]\n        SRVADM[(\"\ud83d\udd27 Admins&lt;br/&gt;Serveurs\")]\n    end\n\n    subgraph TIER2[\"TIER 2 - Postes de Travail\"]\n        WKS[(\"\ud83d\udcbb Postes&lt;br/&gt;Utilisateurs\")]\n        MOBILE[(\"\ud83d\udcf1 Appareils&lt;br/&gt;Mobiles\")]\n        HELPDSK[(\"\ud83c\udfa7 Support&lt;br/&gt;Helpdesk\")]\n    end\n\n    PAM --&gt;|\"\u2705 Administre\"| DC\n    PAM --&gt;|\"\u2705 Administre\"| PKI\n    PAM --&gt;|\"\u2705 Administre\"| ADFS\n\n    SRVADM --&gt;|\"\u2705 Administre\"| APP\n    SRVADM --&gt;|\"\u2705 Administre\"| DB\n    SRVADM --&gt;|\"\u2705 Administre\"| FILE\n\n    HELPDSK --&gt;|\"\u2705 Administre\"| WKS\n    HELPDSK --&gt;|\"\u2705 Administre\"| MOBILE\n\n    PAM -.-&gt;|\"\u274c INTERDIT\"| WKS\n    PAM -.-&gt;|\"\u274c INTERDIT\"| APP\n    SRVADM -.-&gt;|\"\u274c INTERDIT\"| WKS\n\n    style TIER0 fill:#ff6b6b,stroke:#c92a2a,color:#fff\n    style TIER1 fill:#ffa94d,stroke:#e67700,color:#fff\n    style TIER2 fill:#69db7c,stroke:#2f9e44,color:#fff</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#22-tier-0-le-plan-de-controle-de-lidentite","title":"2.2 Tier 0 : Le Plan de Contr\u00f4le de l'Identit\u00e9","text":"<p>Zone Sacr\u00e9e</p> <p>Le Tier 0 repr\u00e9sente le contr\u00f4le total de l'identit\u00e9 dans l'organisation. Sa compromission \u00e9quivaut \u00e0 la compromission de l'ensemble du SI.</p> <p>Ressources Tier 0 :</p> Ressource Justification Contr\u00f4leurs de Domaine Stockent la base NTDS.dit (tous les hashs) Serveurs PKI / ADCS Peuvent \u00e9mettre des certificats pour n'importe qui ADFS / AAD Connect Pont vers le cloud, token signing Serveurs SCCM Peuvent ex\u00e9cuter du code sur tous les postes Hyperviseurs h\u00e9bergeant des DC Acc\u00e8s direct aux disques virtuels <p>Comptes Tier 0 :</p> <ul> <li>Domain Admins</li> <li>Enterprise Admins</li> <li>Schema Admins</li> <li>Administrateurs du domaine racine</li> <li>Comptes de service des DC</li> </ul> <pre><code># Lister les membres des groupes Tier 0\nGet-ADGroupMember -Identity \"Domain Admins\" -Recursive |\n    Select-Object Name, objectClass, distinguishedName\n\nGet-ADGroupMember -Identity \"Enterprise Admins\" -Recursive |\n    Select-Object Name, objectClass, distinguishedName\n\nGet-ADGroupMember -Identity \"Schema Admins\" -Recursive |\n    Select-Object Name, objectClass, distinguishedName\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#23-tier-1-les-serveurs-dentreprise","title":"2.3 Tier 1 : Les Serveurs d'Entreprise","text":"<p>Ressources Tier 1 :</p> Ressource Exemples Serveurs applicatifs IIS, Tomcat, serveurs m\u00e9tier Serveurs de bases de donn\u00e9es SQL Server, Oracle, PostgreSQL Serveurs de fichiers File servers, DFS Serveurs d'impression Print servers Serveurs de sauvegarde Veeam, Commvault (attention : souvent Tier 0 !) <p>Comptes Tier 1 :</p> <ul> <li>Server Admins (groupe personnalis\u00e9)</li> <li>Comptes de service applicatifs</li> <li>DBA (Database Administrators)</li> </ul> <pre><code># Cr\u00e9er un groupe d'administration Tier 1\nNew-ADGroup -Name \"Tier1-ServerAdmins\" `\n    -GroupScope Global `\n    -GroupCategory Security `\n    -Path \"OU=Groups,OU=Tier1,DC=corp,DC=local\" `\n    -Description \"Administrateurs des serveurs Tier 1\"\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#24-tier-2-les-postes-de-travail","title":"2.4 Tier 2 : Les Postes de Travail","text":"<p>Ressources Tier 2 :</p> Ressource Exemples Postes utilisateurs Desktops, laptops Appareils mobiles T\u00e9l\u00e9phones, tablettes g\u00e9r\u00e9es Kiosques Bornes d'accueil, affichage <p>Comptes Tier 2 :</p> <ul> <li>Helpdesk / Support niveau 1</li> <li>Administrateurs locaux des postes</li> <li>Comptes utilisateurs standard</li> </ul> <pre><code># Cr\u00e9er un groupe Helpdesk Tier 2\nNew-ADGroup -Name \"Tier2-Helpdesk\" `\n    -GroupScope Global `\n    -GroupCategory Security `\n    -Path \"OU=Groups,OU=Tier2,DC=corp,DC=local\" `\n    -Description \"Support Helpdesk - Administration postes uniquement\"\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#3-la-regle-dor","title":"3. La R\u00e8gle d'Or","text":"<p>R\u00e8gle Absolue</p> <p>Un compte d'un Tier sup\u00e9rieur ne doit JAMAIS se connecter \u00e0 une ressource d'un Tier inf\u00e9rieur.</p> <ul> <li>\u274c Tier 0 \u2192 Tier 1 : INTERDIT</li> <li>\u274c Tier 0 \u2192 Tier 2 : INTERDIT</li> <li>\u274c Tier 1 \u2192 Tier 2 : INTERDIT</li> <li>\u2705 Tier 0 \u2192 Tier 0 : AUTORIS\u00c9</li> <li>\u2705 Tier 1 \u2192 Tier 1 : AUTORIS\u00c9</li> <li>\u2705 Tier 2 \u2192 Tier 2 : AUTORIS\u00c9</li> </ul>"},{"location":"formations/ad-hardening/01-tiering-model/#31-pourquoi-cette-regle","title":"3.1 Pourquoi cette R\u00e8gle ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              SC\u00c9NARIO D'ATTAQUE SANS TIERING                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502  1. L'utilisateur \"jdupont\" ouvre un email de phishing          \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  2. Malware install\u00e9 sur son poste PC-JDUPONT                   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  3. L'admin \"admin-pierre\" se connecte pour \"d\u00e9panner\"          \u2502\n\u2502     (admin-pierre = Domain Admin)                               \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  4. Mimikatz extrait le hash de admin-pierre                    \u2502\n\u2502     sekurlsa::logonpasswords                                    \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  5. Pass-the-Hash vers le contr\u00f4leur de domaine                 \u2502\n\u2502     \u2192 GAME OVER                                                 \u2502\n\u2502                                                                 \u2502\n\u2502  \u23f1\ufe0f Temps total : 10 minutes                                    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#32-avec-le-tiering-model","title":"3.2 Avec le Tiering Model","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              SC\u00c9NARIO D'ATTAQUE AVEC TIERING                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502  1. L'utilisateur \"jdupont\" ouvre un email de phishing          \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  2. Malware install\u00e9 sur son poste PC-JDUPONT                   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  3. L'admin Tier 2 \"helpdesk-marie\" se connecte                 \u2502\n\u2502     (helpdesk-marie = Admin local Tier 2 uniquement)            \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  4. Mimikatz extrait le hash de helpdesk-marie                  \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502  5. Pass-the-Hash... vers d'autres postes Tier 2 uniquement     \u2502\n\u2502     \u2192 Dommages LIMIT\u00c9S au Tier 2                                \u2502\n\u2502     \u2192 Tier 0 et Tier 1 INTACTS                                  \u2502\n\u2502                                                                 \u2502\n\u2502  \ud83d\udee1\ufe0f Impact : Contenu, pas de compromission globale             \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#4-implementation-technique","title":"4. Impl\u00e9mentation Technique","text":""},{"location":"formations/ad-hardening/01-tiering-model/#41-structure-ou-recommandee","title":"4.1 Structure OU Recommand\u00e9e","text":"<pre><code># Cr\u00e9er la structure OU pour le Tiering\n$domain = \"DC=corp,DC=local\"\n\n# Tier 0\nNew-ADOrganizationalUnit -Name \"Tier0\" -Path $domain\nNew-ADOrganizationalUnit -Name \"Accounts\" -Path \"OU=Tier0,$domain\"\nNew-ADOrganizationalUnit -Name \"Groups\" -Path \"OU=Tier0,$domain\"\nNew-ADOrganizationalUnit -Name \"Servers\" -Path \"OU=Tier0,$domain\"\nNew-ADOrganizationalUnit -Name \"PAW\" -Path \"OU=Tier0,$domain\"\n\n# Tier 1\nNew-ADOrganizationalUnit -Name \"Tier1\" -Path $domain\nNew-ADOrganizationalUnit -Name \"Accounts\" -Path \"OU=Tier1,$domain\"\nNew-ADOrganizationalUnit -Name \"Groups\" -Path \"OU=Tier1,$domain\"\nNew-ADOrganizationalUnit -Name \"Servers\" -Path \"OU=Tier1,$domain\"\n\n# Tier 2\nNew-ADOrganizationalUnit -Name \"Tier2\" -Path $domain\nNew-ADOrganizationalUnit -Name \"Accounts\" -Path \"OU=Tier2,$domain\"\nNew-ADOrganizationalUnit -Name \"Groups\" -Path \"OU=Tier2,$domain\"\nNew-ADOrganizationalUnit -Name \"Workstations\" -Path \"OU=Tier2,$domain\"\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#42-gpo-de-restriction-de-connexion","title":"4.2 GPO de Restriction de Connexion","text":"<p>La cl\u00e9 du Tiering est d'emp\u00eacher techniquement les connexions inter-Tiers via GPO :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    GPO - TIER RESTRICTIONS                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502  GPO: \"Tier0-RestrictLogon\" (li\u00e9e \u00e0 OU=Servers,OU=Tier0)        \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502\n\u2502  Computer Configuration &gt; Policies &gt; Windows Settings &gt;        \u2502\n\u2502  Security Settings &gt; Local Policies &gt; User Rights Assignment   \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 Deny log on locally:                                         \u2502\n\u2502    - Tier1-ServerAdmins                                         \u2502\n\u2502    - Tier2-Helpdesk                                             \u2502\n\u2502    - Domain Users                                               \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 Deny log on through Remote Desktop Services:                 \u2502\n\u2502    - Tier1-ServerAdmins                                         \u2502\n\u2502    - Tier2-Helpdesk                                             \u2502\n\u2502    - Domain Users                                               \u2502\n\u2502                                                                 \u2502\n\u2502  \u2022 Allow log on locally:                                        \u2502\n\u2502    - Tier0-DomainAdmins (groupe personnalis\u00e9)                   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># Cr\u00e9er et lier une GPO de restriction Tier 0\nNew-GPO -Name \"Tier0-RestrictLogon\" |\n    New-GPLink -Target \"OU=Servers,OU=Tier0,DC=corp,DC=local\"\n\n# Note : La configuration des droits de connexion doit \u00eatre faite\n# via GPMC ou avec des cmdlets AGPM pour les param\u00e8tres de s\u00e9curit\u00e9\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#43-authentication-policies-windows-server-2012-r2","title":"4.3 Authentication Policies (Windows Server 2012 R2+)","text":"<p>Pour les environnements modernes, utilisez les Authentication Policies :</p> <pre><code># Cr\u00e9er une Authentication Policy pour Tier 0\nNew-ADAuthenticationPolicy -Name \"Tier0-AuthPolicy\" `\n    -Description \"Restreint les comptes Tier 0 aux ressources Tier 0\" `\n    -UserTGTLifetimeMins 240 `\n    -ProtectedFromAccidentalDeletion $true\n\n# Cr\u00e9er un Authentication Policy Silo\nNew-ADAuthenticationPolicySilo -Name \"Tier0-Silo\" `\n    -Description \"Silo pour les comptes et ressources Tier 0\" `\n    -UserAuthenticationPolicy \"Tier0-AuthPolicy\" `\n    -ComputerAuthenticationPolicy \"Tier0-AuthPolicy\" `\n    -ProtectedFromAccidentalDeletion $true\n\n# Ajouter un compte au Silo\nSet-ADUser -Identity \"admin-t0\" `\n    -AuthenticationPolicySilo \"Tier0-Silo\"\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#5-les-paw-privileged-access-workstations","title":"5. Les PAW (Privileged Access Workstations)","text":""},{"location":"formations/ad-hardening/01-tiering-model/#51-concept","title":"5.1 Concept","text":"<p>Une PAW est un poste de travail durci, d\u00e9di\u00e9 exclusivement \u00e0 l'administration d'un Tier sp\u00e9cifique.</p> <p>Caract\u00e9ristiques d'une PAW Tier 0</p> <ul> <li>Hardware d\u00e9di\u00e9 : Pas de VM, pas de dual-boot</li> <li>OS durci : Windows 10/11 Enterprise avec Device Guard, Credential Guard</li> <li>R\u00e9seau isol\u00e9 : VLAN d'administration s\u00e9par\u00e9</li> <li>Pas d'acc\u00e8s Internet : Ou via proxy tr\u00e8s restrictif</li> <li>Pas d'email/navigation : Uniquement outils d'administration</li> <li>Chiffrement : BitLocker obligatoire</li> <li>MFA : Carte \u00e0 puce ou Windows Hello for Business</li> </ul>"},{"location":"formations/ad-hardening/01-tiering-model/#52-architecture-paw","title":"5.2 Architecture PAW","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ARCHITECTURE PAW                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Administrateur Tier 0                                         \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u251c\u2500\u2500\u25ba [PAW-T0]  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba [DC, PKI, ADFS]            \u2502\n\u2502          \u2502    (Poste durci)         (Ressources Tier 0)         \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u2514\u2500\u2500\u25ba [Poste Standard] \u2500\u2500\u25ba [Email, Internet, Apps]      \u2502\n\u2502               (Usage quotidien)    (Pas d'admin)                \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f L'admin utilise 2 postes physiques s\u00e9par\u00e9s                \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#53-alternative-jump-server-bastion","title":"5.3 Alternative : Jump Server / Bastion","text":"<p>Pour les organisations ne pouvant pas d\u00e9ployer des PAW physiques :</p> <pre><code># Le Jump Server est une VM Tier 0 durcie\n# L'admin se connecte via RDP avec Restricted Admin Mode\n\n# Connexion en Restricted Admin Mode (ne laisse pas de credentials)\nmstsc /restrictedAdmin /v:YOURJUMPSERVER\n\n# Activer Restricted Admin Mode sur le Jump Server\nreg add HKLM\\System\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d 0\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#6-plan-de-migration","title":"6. Plan de Migration","text":""},{"location":"formations/ad-hardening/01-tiering-model/#61-approche-progressive","title":"6.1 Approche Progressive","text":"<p>Migration en 4 Phases</p> <p>Le Tiering ne s'impl\u00e9mente pas en un jour. Proc\u00e9dez par \u00e9tapes :</p> <ol> <li>Phase 1 - Inventaire (2-4 semaines)</li> <li>Cartographier tous les comptes \u00e0 privil\u00e8ges</li> <li>Identifier les ressources par Tier</li> <li> <p>Documenter les flux d'administration actuels</p> </li> <li> <p>Phase 2 - Tier 0 (4-8 semaines)</p> </li> <li>Cr\u00e9er les comptes Tier 0 d\u00e9di\u00e9s</li> <li>D\u00e9ployer les PAW ou Jump Servers</li> <li>Appliquer les GPO de restriction</li> <li> <p>Migrer les Domain Admins</p> </li> <li> <p>Phase 3 - Tier 1 (4-8 semaines)</p> </li> <li>Cr\u00e9er les comptes Tier 1 d\u00e9di\u00e9s</li> <li>Appliquer les restrictions</li> <li> <p>Former les \u00e9quipes serveur</p> </li> <li> <p>Phase 4 - Tier 2 (4-8 semaines)</p> </li> <li>Cr\u00e9er les comptes Helpdesk Tier 2</li> <li>Retirer les droits admin local des utilisateurs</li> <li>D\u00e9ployer LAPS pour les mots de passe admin local</li> </ol>"},{"location":"formations/ad-hardening/01-tiering-model/#62-quick-wins","title":"6.2 Quick Wins","text":"<p>Actions imm\u00e9diates \u00e0 fort impact :</p> <pre><code># 1. Auditer les membres des groupes privil\u00e9gi\u00e9s\nGet-ADGroupMember -Identity \"Domain Admins\" -Recursive\n\n# 2. V\u00e9rifier les comptes avec \"AdminCount = 1\" (prot\u00e9g\u00e9s par AdminSDHolder)\nGet-ADUser -Filter {AdminCount -eq 1} -Properties AdminCount, memberOf |\n    Select-Object Name, AdminCount, @{N='Groups';E={($_.memberOf -join ', ')}}\n\n# 3. Identifier les sessions actives des Domain Admins\n# (N\u00e9cessite des outils comme BloodHound ou des scripts personnalis\u00e9s)\n\n# 4. Activer le \"Protected Users\" group pour les comptes Tier 0\nAdd-ADGroupMember -Identity \"Protected Users\" -Members \"admin-t0\"\n</code></pre>"},{"location":"formations/ad-hardening/01-tiering-model/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Un Domain Admin peut-il se connecter \u00e0 un serveur de fichiers (Tier 1) ? <p>R\u00e9ponse : Non, c'est interdit par la r\u00e8gle d'or du Tiering. Un compte Tier 0 ne doit jamais se connecter \u00e0 une ressource Tier 1 ou Tier 2. Pour administrer un serveur de fichiers, utilisez un compte Tier 1 d\u00e9di\u00e9.</p> Question 2 : Pourquoi les hyperviseurs h\u00e9bergeant des DC sont-ils Tier 0 ? <p>R\u00e9ponse : Parce qu'un administrateur de l'hyperviseur peut :</p> <ul> <li>Acc\u00e9der directement au disque virtuel du DC</li> <li>Extraire le fichier NTDS.dit (base AD compl\u00e8te)</li> <li>Cr\u00e9er des snapshots et les analyser offline</li> <li>Modifier la m\u00e9moire de la VM</li> </ul> <p>L'acc\u00e8s \u00e0 l'hyperviseur = acc\u00e8s au DC = Tier 0.</p> Question 3 : Qu'est-ce que le Restricted Admin Mode pour RDP ? <p>R\u00e9ponse : C'est un mode de connexion RDP qui n'envoie pas les credentials de l'utilisateur vers la machine distante. Seul un ticket Kerberos est utilis\u00e9, ce qui emp\u00eache les attaques de type credential dumping sur le serveur cible. Id\u00e9al pour les Jump Servers.</p>"},{"location":"formations/ad-hardening/01-tiering-model/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que vous comprenez l'architecture de s\u00e9curit\u00e9, apprenez \u00e0 identifier les attaques qui la ciblent.</p> <p>:octicons-arrow-right-24: Module 2 : Vecteurs d'Attaque AD</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/ad-hardening/02-attack-vectors/","title":"Module 2 : Vecteurs d'Attaque Active Directory","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre les m\u00e9canismes des attaques Kerberos (ASREPRoast, Kerberoasting)</li> <li>:material-check: Identifier les comptes vuln\u00e9rables dans votre environnement</li> <li>:material-check: Impl\u00e9menter les mesures de protection appropri\u00e9es</li> <li>:material-check: D\u00e9tecter les tentatives d'exploitation</li> </ul> <p>Sun Tzu - L'Art de la Guerre</p> <p>\"Connais ton ennemi et connais-toi toi-m\u00eame ; eussiez-vous cent guerres \u00e0 soutenir, cent fois vous serez victorieux.\"</p> <p>Pour d\u00e9fendre Active Directory, il faut d'abord comprendre comment les attaquants l'attaquent.</p>"},{"location":"formations/ad-hardening/02-attack-vectors/#1-asreproast","title":"1. ASREPRoast","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#11-mecanisme-de-lattaque","title":"1.1 M\u00e9canisme de l'Attaque","text":"<p>Niveau de Risque : \u00c9LEV\u00c9</p> <p>ASREPRoast permet \u00e0 un attaquant d'obtenir un hash crackable sans aucun privil\u00e8ge pr\u00e9alable dans le domaine. Un simple compte utilisateur suffit.</p> <p>Fonctionnement normal de Kerberos :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              AUTHENTIFICATION KERBEROS NORMALE                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   [Client]                              [KDC/DC]                \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502      \u2502  1. AS-REQ (avec pr\u00e9-auth)           \u2502                   \u2502\n\u2502      \u2502     Timestamp chiffr\u00e9 avec           \u2502                   \u2502\n\u2502      \u2502     le hash du mot de passe          \u2502                   \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                   \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502      \u2502  2. AS-REP (si pr\u00e9-auth OK)          \u2502                   \u2502\n\u2502      \u2502     TGT chiffr\u00e9                      \u2502                   \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                   \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502   \u2705 Pr\u00e9-authentification = Preuve d'identit\u00e9                   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Quand la pr\u00e9-authentification est d\u00e9sactiv\u00e9e :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ATTAQUE ASREPROAST                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   [Attaquant]                           [KDC/DC]                \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502      \u2502  1. AS-REQ (SANS pr\u00e9-auth)           \u2502                   \u2502\n\u2502      \u2502     \"Je veux un TGT pour             \u2502                   \u2502\n\u2502      \u2502      l'utilisateur vulnerable\"       \u2502                   \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                   \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502      \u2502  2. AS-REP                           \u2502                   \u2502\n\u2502      \u2502     TGT chiffr\u00e9 avec le hash         \u2502                   \u2502\n\u2502      \u2502     du mot de passe de l'user        \u2502                   \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                   \u2502\n\u2502      \u2502                                      \u2502                   \u2502\n\u2502   \u274c Le KDC r\u00e9pond SANS v\u00e9rifier l'identit\u00e9 !                   \u2502\n\u2502                                                                 \u2502\n\u2502   3. Attaquant extrait le hash du AS-REP                        \u2502\n\u2502   4. Crack offline avec Hashcat                                 \u2502\n\u2502   5. Mot de passe r\u00e9cup\u00e9r\u00e9 en clair                             \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#12-identifier-les-comptes-vulnerables","title":"1.2 Identifier les Comptes Vuln\u00e9rables","text":"<pre><code># M\u00e9thode 1 : PowerShell natif\nGet-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth |\n    Select-Object Name, SamAccountName, DistinguishedName, DoesNotRequirePreAuth\n\n# M\u00e9thode 2 : Avec filtre LDAP\nGet-ADUser -LDAPFilter \"(&amp;(objectCategory=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))\" |\n    Select-Object Name, SamAccountName, DistinguishedName\n\n# M\u00e9thode 3 : V\u00e9rification compl\u00e8te avec contexte\nGet-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties * |\n    Select-Object Name,\n                  SamAccountName,\n                  Enabled,\n                  PasswordLastSet,\n                  LastLogonDate,\n                  @{N='MemberOf';E={($_.MemberOf | ForEach-Object { ($_ -split ',')[0] -replace 'CN=' }) -join ', '}}\n</code></pre> <p>Attention aux Comptes de Service</p> <p>Cette option est parfois activ\u00e9e pour des raisons de \"compatibilit\u00e9\" avec des applications legacy. Documentez chaque exception et planifiez leur rem\u00e9diation.</p>"},{"location":"formations/ad-hardening/02-attack-vectors/#13-remediation","title":"1.3 Rem\u00e9diation","text":"<pre><code># D\u00e9sactiver l'option \"Do not require Kerberos preauthentication\"\nSet-ADUser -Identity \"utilisateur_vulnerable\" -DoesNotRequirePreAuth $false\n\n# Script de rem\u00e9diation en masse (avec confirmation)\n$vulnerableUsers = Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true}\n\nforeach ($user in $vulnerableUsers) {\n    Write-Host \"Correction de : $($user.SamAccountName)\" -ForegroundColor Yellow\n\n    # Demander confirmation\n    $confirm = Read-Host \"D\u00e9sactiver DoesNotRequirePreAuth ? (O/N)\"\n    if ($confirm -eq 'O') {\n        Set-ADUser -Identity $user -DoesNotRequirePreAuth $false\n        Write-Host \"  \u2705 Corrig\u00e9\" -ForegroundColor Green\n    } else {\n        Write-Host \"  \u23ed\ufe0f Ignor\u00e9\" -ForegroundColor Gray\n    }\n}\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#14-detection","title":"1.4 D\u00e9tection","text":"<p>\u00c9v\u00e9nements Windows \u00e0 surveiller :</p> Event ID Description Signification 4768 A Kerberos authentication ticket (TGT) was requested Normal, mais surveiller les patterns 4768 avec <code>PreAuthType = 0</code> TGT demand\u00e9 sans pr\u00e9-auth Potentiel ASREPRoast <pre><code># Requ\u00eate pour d\u00e9tecter les AS-REQ sans pr\u00e9-auth (sur les DC)\nGet-WinEvent -FilterHashtable @{\n    LogName = 'Security'\n    Id = 4768\n} | Where-Object {\n    $_.Message -match \"Pre-Authentication Type:\\s+0\"\n} | Select-Object TimeCreated, Message -First 10\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#2-kerberoasting","title":"2. Kerberoasting","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#21-mecanisme-de-lattaque","title":"2.1 M\u00e9canisme de l'Attaque","text":"<p>Niveau de Risque : CRITIQUE</p> <p>Kerberoasting cible les comptes de service avec un SPN (Service Principal Name). Un attaquant avec un simple compte utilisateur du domaine peut demander des tickets de service et les cracker offline.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ATTAQUE KERBEROASTING                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   [Attaquant]              [KDC/DC]              [Service]      \u2502\n\u2502   (User du domaine)                              (SQL, IIS...)  \u2502\n\u2502      \u2502                         \u2502                     \u2502          \u2502\n\u2502      \u2502  1. TGS-REQ             \u2502                     \u2502          \u2502\n\u2502      \u2502     \"Je veux un ticket  \u2502                     \u2502          \u2502\n\u2502      \u2502      pour MSSQLSvc/...\" \u2502                     \u2502          \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                     \u2502          \u2502\n\u2502      \u2502                         \u2502                     \u2502          \u2502\n\u2502      \u2502  2. TGS-REP             \u2502                     \u2502          \u2502\n\u2502      \u2502     Ticket chiffr\u00e9 avec \u2502                     \u2502          \u2502\n\u2502      \u2502     le hash du compte   \u2502                     \u2502          \u2502\n\u2502      \u2502     de service          \u2502                     \u2502          \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                     \u2502          \u2502\n\u2502      \u2502                         \u2502                     \u2502          \u2502\n\u2502   \u274c Le KDC donne le ticket \u00e0 N'IMPORTE QUEL user du domaine    \u2502\n\u2502                                                                 \u2502\n\u2502   3. Attaquant extrait le hash du TGS                           \u2502\n\u2502   4. Crack offline avec Hashcat                                 \u2502\n\u2502   5. Mot de passe du compte de service r\u00e9cup\u00e9r\u00e9                 \u2502\n\u2502   6. Souvent = compte avec privil\u00e8ges \u00e9lev\u00e9s !                  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#22-identifier-les-comptes-vulnerables","title":"2.2 Identifier les Comptes Vuln\u00e9rables","text":"<pre><code># Lister tous les comptes utilisateurs avec un SPN\nGet-ADUser -Filter {ServicePrincipalName -like \"*\"} -Properties ServicePrincipalName, PasswordLastSet, Enabled |\n    Select-Object Name,\n                  SamAccountName,\n                  Enabled,\n                  PasswordLastSet,\n                  @{N='SPN';E={$_.ServicePrincipalName -join ', '}}\n\n# Version d\u00e9taill\u00e9e avec \u00e9valuation du risque\nGet-ADUser -Filter {ServicePrincipalName -like \"*\"} -Properties * |\n    Select-Object Name,\n                  SamAccountName,\n                  Enabled,\n                  @{N='PasswordAge';E={((Get-Date) - $_.PasswordLastSet).Days}},\n                  @{N='IsAdmin';E={$_.MemberOf -match 'Admin'}},\n                  @{N='SPNCount';E={$_.ServicePrincipalName.Count}},\n                  @{N='SPNs';E={$_.ServicePrincipalName -join '; '}} |\n    Sort-Object IsAdmin -Descending\n</code></pre> <p>Comptes \u00e0 Haut Risque</p> <p>Les comptes de service les plus dangereux sont ceux qui :</p> <ul> <li>Sont membres de groupes privil\u00e9gi\u00e9s (Domain Admins, etc.)</li> <li>Ont un mot de passe ancien (non chang\u00e9 depuis des ann\u00e9es)</li> <li>Utilisent un chiffrement faible (RC4 au lieu de AES)</li> </ul>"},{"location":"formations/ad-hardening/02-attack-vectors/#23-remediation","title":"2.3 Rem\u00e9diation","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#option-1-mots-de-passe-forts-et-rotation","title":"Option 1 : Mots de Passe Forts et Rotation","text":"<pre><code># G\u00e9n\u00e9rer un mot de passe fort (25+ caract\u00e8res)\n$password = -join ((65..90) + (97..122) + (48..57) + (33..47) | Get-Random -Count 30 | ForEach-Object {[char]$_})\n\n# Changer le mot de passe du compte de service\nSet-ADAccountPassword -Identity \"svc_sqlserver\" -NewPassword (ConvertTo-SecureString $password -AsPlainText -Force) -Reset\n\n# Documenter le nouveau mot de passe dans un vault s\u00e9curis\u00e9 !\nWrite-Host \"Nouveau mot de passe : $password\" -ForegroundColor Yellow\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#option-2-forcer-aes-au-lieu-de-rc4","title":"Option 2 : Forcer AES (au lieu de RC4)","text":"<pre><code># Activer uniquement AES pour le compte de service\nSet-ADUser -Identity \"svc_sqlserver\" -KerberosEncryptionType AES128, AES256\n\n# V\u00e9rifier le type de chiffrement\nGet-ADUser -Identity \"svc_sqlserver\" -Properties msDS-SupportedEncryptionTypes |\n    Select-Object Name, @{N='EncryptionTypes';E={$_.'msDS-SupportedEncryptionTypes'}}\n\n# Mapping des valeurs :\n# 0x1 = DES-CBC-CRC\n# 0x2 = DES-CBC-MD5\n# 0x4 = RC4-HMAC\n# 0x8 = AES128-CTS-HMAC-SHA1-96\n# 0x10 = AES256-CTS-HMAC-SHA1-96\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#option-3-gmsa-group-managed-service-accounts","title":"Option 3 : gMSA (Group Managed Service Accounts)","text":"<p>Solution Recommand\u00e9e : gMSA</p> <p>Les gMSA sont des comptes de service dont le mot de passe est :</p> <ul> <li>G\u00e9n\u00e9r\u00e9 automatiquement (240 caract\u00e8res)</li> <li>Chang\u00e9 automatiquement tous les 30 jours</li> <li>G\u00e9r\u00e9 par Active Directory (pas d'intervention humaine)</li> <li>Impossible \u00e0 cracker (mot de passe trop complexe)</li> </ul> <pre><code># Pr\u00e9requis : Cr\u00e9er la cl\u00e9 racine KDS (une seule fois par for\u00eat)\n# ATTENTION : En production, ne pas utiliser -EffectiveImmediately\nAdd-KdsRootKey -EffectiveTime ((Get-Date).AddHours(-10))\n\n# Cr\u00e9er un gMSA\nNew-ADServiceAccount -Name \"gmsa_sqlserver\" `\n    -DNSHostName \"gmsa_sqlserver.corp.local\" `\n    -PrincipalsAllowedToRetrieveManagedPassword \"SQL-Servers\" `\n    -KerberosEncryptionType AES128, AES256\n\n# Installer le gMSA sur le serveur cible\nInstall-ADServiceAccount -Identity \"gmsa_sqlserver\"\n\n# Tester l'installation\nTest-ADServiceAccount -Identity \"gmsa_sqlserver\"\n# Doit retourner True\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#24-detection","title":"2.4 D\u00e9tection","text":"Event ID Description Signification 4769 A Kerberos service ticket was requested Normal 4769 avec chiffrement RC4 TGS avec RC4 (faible) Potentiel Kerberoasting Multiple 4769 pour diff\u00e9rents SPNs Enum\u00e9ration de SPNs Probable Kerberoasting <pre><code># D\u00e9tecter les demandes TGS avec RC4 (0x17 = RC4)\nGet-WinEvent -FilterHashtable @{\n    LogName = 'Security'\n    Id = 4769\n} | Where-Object {\n    $_.Message -match \"Ticket Encryption Type:\\s+0x17\"\n} | Select-Object TimeCreated,\n    @{N='User';E={($_.Message -split '\\n' | Select-String 'Account Name:')[0] -replace '.*:\\s+'}},\n    @{N='Service';E={($_.Message -split '\\n' | Select-String 'Service Name:')[0] -replace '.*:\\s+'}}\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#3-pass-the-hash-pth","title":"3. Pass-the-Hash (PtH)","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#31-mecanisme-de-lattaque","title":"3.1 M\u00e9canisme de l'Attaque","text":"<p>Niveau de Risque : CRITIQUE</p> <p>Pass-the-Hash permet de s'authentifier avec le hash NTLM d'un utilisateur sans conna\u00eetre le mot de passe en clair.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ATTAQUE PASS-THE-HASH                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. Compromission d'un poste (phishing, exploit...)            \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   2. Extraction des credentials en m\u00e9moire (Mimikatz)           \u2502\n\u2502      sekurlsa::logonpasswords                                   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502      Output:              \u2502                                     \u2502\n\u2502      User: admin-tier0    \u2502                                     \u2502\n\u2502      NTLM: aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b7  \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   3. Utilisation du hash pour s'authentifier                    \u2502\n\u2502      sekurlsa::pth /user:admin-tier0 /domain:corp.local         \u2502\n\u2502                    /ntlm:31d6cfe0d16ae931b7...                  \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   4. Connexion aux ressources comme admin-tier0                 \u2502\n\u2502      \u2192 Contr\u00f4leur de domaine accessible !                       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#32-defenses","title":"3.2 D\u00e9fenses","text":"<pre><code># 1. Activer Credential Guard (Windows 10/11 Enterprise)\n# Via GPO ou Intune - Isole les credentials dans un environnement virtualis\u00e9\n\n# 2. Protected Users Group\n# Les membres ne peuvent pas utiliser NTLM, ni avoir leurs credentials mis en cache\nAdd-ADGroupMember -Identity \"Protected Users\" -Members \"admin-tier0\"\n\n# 3. D\u00e9sactiver le cache des credentials (GPO)\n# Computer Configuration &gt; Windows Settings &gt; Security Settings &gt;\n# Local Policies &gt; Security Options &gt;\n# \"Interactive logon: Number of previous logons to cache\" = 0\n\n# 4. Activer le mode \"Restricted Admin\" pour RDP\n# (Ne transmet pas les credentials au serveur distant)\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#4-pass-the-ticket-ptt","title":"4. Pass-the-Ticket (PtT)","text":""},{"location":"formations/ad-hardening/02-attack-vectors/#41-mecanisme-de-lattaque","title":"4.1 M\u00e9canisme de l'Attaque","text":"<p>Niveau de Risque : CRITIQUE</p> <p>Pass-the-Ticket utilise des tickets Kerberos vol\u00e9s (TGT ou TGS) pour usurper l'identit\u00e9 d'un utilisateur.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ATTAQUE PASS-THE-TICKET                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. Extraction des tickets Kerberos de la m\u00e9moire              \u2502\n\u2502      sekurlsa::tickets /export                                  \u2502\n\u2502                           \u2502                                     \u2502\n\u2502      Output:              \u2502                                     \u2502\n\u2502      [0;3e7]-2-0-40e10000-admin@krbtgt~CORP.LOCAL.kirbi         \u2502\n\u2502      (TGT de admin)       \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   2. Injection du ticket dans une nouvelle session              \u2502\n\u2502      kerberos::ptt [0;3e7]-2-0-40e10000-admin@krbtgt~...kirbi   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   3. L'attaquant poss\u00e8de maintenant l'identit\u00e9 Kerberos         \u2502\n\u2502      de l'utilisateur jusqu'\u00e0 expiration du ticket              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#42-golden-ticket","title":"4.2 Golden Ticket","text":"<p>L'Attaque Ultime : Golden Ticket</p> <p>Avec le hash du compte krbtgt, un attaquant peut forger des TGT valides pour n'importe qui, y compris des comptes inexistants avec des privil\u00e8ges arbitraires.</p> <p>Le Golden Ticket reste valide jusqu'au double changement du mot de passe krbtgt.</p> <pre><code># Changer le mot de passe krbtgt (\u00e0 faire 2 fois, espac\u00e9 de 10+ heures)\n# Script officiel Microsoft : Reset-KrbtgtKeyInteractive.ps1\n\n# V\u00e9rifier la date du dernier changement\nGet-ADUser -Identity \"krbtgt\" -Properties PasswordLastSet |\n    Select-Object Name, PasswordLastSet\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#43-defenses","title":"4.3 D\u00e9fenses","text":"<pre><code># 1. R\u00e9duire la dur\u00e9e de vie des TGT (d\u00e9faut = 10 heures)\n# GPO : Computer Configuration &gt; Windows Settings &gt; Security Settings &gt;\n# Account Policies &gt; Kerberos Policy &gt; Maximum lifetime for user ticket = 4 heures\n\n# 2. Rotation r\u00e9guli\u00e8re du mot de passe krbtgt\n# Microsoft recommande tous les 180 jours minimum\n\n# 3. Surveiller les \u00e9v\u00e9nements de cr\u00e9ation de tickets anormaux\n# Event ID 4768 avec des SID inhabituels ou des dur\u00e9es de vie anormales\n</code></pre>"},{"location":"formations/ad-hardening/02-attack-vectors/#5-tableau-recapitulatif-des-defenses","title":"5. Tableau R\u00e9capitulatif des D\u00e9fenses","text":"Attaque D\u00e9fense Principale D\u00e9fense Compl\u00e9mentaire D\u00e9tection ASREPRoast Activer pr\u00e9-auth Kerberos Mots de passe forts Event 4768 PreAuthType=0 Kerberoasting gMSA AES + rotation mots de passe Event 4769 RC4 Pass-the-Hash Credential Guard Protected Users, Tiering Event 4624 LogonType 3 Pass-the-Ticket R\u00e9duire TTL tickets Rotation krbtgt Event 4768 anormal Golden Ticket Rotation krbtgt x2 Monitoring SIEM SID anormaux dans tickets"},{"location":"formations/ad-hardening/02-attack-vectors/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence entre ASREPRoast et Kerberoasting ? <p>R\u00e9ponse :</p> <ul> <li> <p>ASREPRoast cible les comptes avec l'option \"Do not require Kerberos preauthentication\" activ\u00e9e. L'attaquant obtient un AS-REP chiffr\u00e9 avec le hash du mot de passe de l'utilisateur.</p> </li> <li> <p>Kerberoasting cible les comptes de service avec un SPN. L'attaquant, authentifi\u00e9 comme n'importe quel utilisateur du domaine, demande des TGS chiffr\u00e9s avec le hash du compte de service.</p> </li> </ul> Question 2 : Pourquoi les gMSA sont-ils immunis\u00e9s contre le Kerberoasting ? <p>R\u00e9ponse : Les gMSA utilisent des mots de passe de 240 caract\u00e8res g\u00e9n\u00e9r\u00e9s et chang\u00e9s automatiquement par AD. M\u00eame si un attaquant obtient un ticket de service, le crack offline prendrait des milliards d'ann\u00e9es, rendant l'attaque inutile.</p> Question 3 : Pourquoi faut-il changer le mot de passe krbtgt DEUX fois ? <p>R\u00e9ponse : Le compte krbtgt conserve le hash actuel ET le hash pr\u00e9c\u00e9dent pour assurer la continuit\u00e9 de service (les tickets existants restent valides). Un Golden Ticket forg\u00e9 avec l'ancien hash resterait donc valide apr\u00e8s un seul changement. Il faut deux changements (espac\u00e9s de ~10h pour laisser les anciens tickets expirer) pour invalider compl\u00e8tement un Golden Ticket.</p>"},{"location":"formations/ad-hardening/02-attack-vectors/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Vous connaissez maintenant les principales attaques AD. Apprenez \u00e0 auditer et durcir votre environnement.</p> <p>:octicons-arrow-right-24: Module 3 : Audit et Politiques de Mots de Passe</p> <p>Temps estim\u00e9 : 75 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/","title":"Module 3 : Audit et Politiques de Mots de Passe","text":""},{"location":"formations/ad-hardening/03-audit-and-pso/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Auditer votre environnement AD avec PingCastle</li> <li>:material-check: Interpr\u00e9ter les r\u00e9sultats et prioriser les rem\u00e9diations</li> <li>:material-check: Cr\u00e9er des politiques de mots de passe diff\u00e9renci\u00e9es (PSO/FGPP)</li> <li>:material-check: Appliquer des exigences strictes aux comptes privil\u00e9gi\u00e9s</li> </ul>"},{"location":"formations/ad-hardening/03-audit-and-pso/#1-audit-avec-pingcastle","title":"1. Audit avec PingCastle","text":""},{"location":"formations/ad-hardening/03-audit-and-pso/#11-presentation-de-loutil","title":"1.1 Pr\u00e9sentation de l'Outil","text":"<p>PingCastle - L'Outil de R\u00e9f\u00e9rence</p> <p>PingCastle est un outil d'audit Active Directory d\u00e9velopp\u00e9 par Vincent Le Toux. Il est :</p> <ul> <li>Gratuit pour un usage interne (licence commerciale pour les audits clients)</li> <li>Portable : Ex\u00e9cutable unique, pas d'installation</li> <li>Rapide : Scan complet en quelques minutes</li> <li>Complet : \u00c9value 100+ points de contr\u00f4le de s\u00e9curit\u00e9</li> </ul> <p>C'est l'outil recommand\u00e9 par l'ANSSI pour l'\u00e9valuation de la s\u00e9curit\u00e9 AD.</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/#12-installation-et-execution","title":"1.2 Installation et Ex\u00e9cution","text":"<pre><code># T\u00e9l\u00e9chargement (depuis un poste membre du domaine)\n# https://www.pingcastle.com/download/\n\n# Ex\u00e9cution basique (g\u00e9n\u00e8re un rapport HTML)\n.\\PingCastle.exe --healthcheck\n\n# Ex\u00e9cution avec toutes les v\u00e9rifications\n.\\PingCastle.exe --healthcheck --level Full\n\n# Scanner un domaine sp\u00e9cifique\n.\\PingCastle.exe --healthcheck --server dc01.corp.local\n\n# Mode interactif (menu)\n.\\PingCastle.exe\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#13-comprendre-le-score","title":"1.3 Comprendre le Score","text":"<p>PingCastle g\u00e9n\u00e8re un score de risque de 0 \u00e0 100 :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    SCORE PINGCASTLE                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Score Global : Combinaison des 4 cat\u00e9gories                   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502  Stale      \u2502 Privileged  \u2502   Trust     \u2502  Anomalies  \u2502     \u2502\n\u2502   \u2502  Objects    \u2502  Accounts   \u2502             \u2502             \u2502     \u2502\n\u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524     \u2502\n\u2502   \u2502  Objets     \u2502  Comptes    \u2502  Relations  \u2502  Config     \u2502     \u2502\n\u2502   \u2502  obsol\u00e8tes  \u2502  \u00e0 hauts    \u2502  de         \u2502  anormale   \u2502     \u2502\n\u2502   \u2502             \u2502  privil\u00e8ges \u2502  confiance  \u2502             \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                                                                 \u2502\n\u2502   Interpr\u00e9tation :                                              \u2502\n\u2502   \u2022 0-10   : Excellent (rare en production)                     \u2502\n\u2502   \u2022 10-30  : Bon niveau de s\u00e9curit\u00e9                             \u2502\n\u2502   \u2022 30-50  : Am\u00e9liorations n\u00e9cessaires                          \u2502\n\u2502   \u2022 50-70  : Risques significatifs                              \u2502\n\u2502   \u2022 70-100 : Situation critique                                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#14-categories-de-risques","title":"1.4 Cat\u00e9gories de Risques","text":"Cat\u00e9gorie Description Exemples de Probl\u00e8mes Stale Objects Objets obsol\u00e8tes ou dormants Comptes inactifs, ordinateurs non utilis\u00e9s, GPO orphelines Privileged Accounts Gestion des comptes privil\u00e9gi\u00e9s Trop de Domain Admins, mots de passe anciens, SIDHistory Trust Relations de confiance Trusts bidirectionnels non s\u00e9curis\u00e9s, SID Filtering d\u00e9sactiv\u00e9 Anomalies Configurations dangereuses SMBv1 activ\u00e9, LDAP non sign\u00e9, comptes sans pr\u00e9-auth"},{"location":"formations/ad-hardening/03-audit-and-pso/#15-analyse-dun-rapport","title":"1.5 Analyse d'un Rapport","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 EXEMPLE DE RAPPORT PINGCASTLE                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Domain: CORP.LOCAL                                            \u2502\n\u2502   Score: 65/100 (Risques significatifs)                         \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502 CRITIQUES (\u00e0 traiter imm\u00e9diatement)                    \u2502    \u2502\n\u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502   \u2502 \u2022 S-ADM-DomainAdmin: 15 membres Domain Admins          \u2502    \u2502\n\u2502   \u2502   \u2192 Recommand\u00e9 : &lt; 5                                   \u2502    \u2502\n\u2502   \u2502                                                        \u2502    \u2502\n\u2502   \u2502 \u2022 S-Kerberos-PreAuth: 3 comptes sans pr\u00e9-auth          \u2502    \u2502\n\u2502   \u2502   \u2192 Vuln\u00e9rable \u00e0 ASREPRoast                            \u2502    \u2502\n\u2502   \u2502                                                        \u2502    \u2502\n\u2502   \u2502 \u2022 S-SMB-v1: SMBv1 activ\u00e9 sur 45 machines               \u2502    \u2502\n\u2502   \u2502   \u2192 Vuln\u00e9rable \u00e0 EternalBlue/WannaCry                  \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502 IMPORTANTS (\u00e0 planifier)                               \u2502    \u2502\n\u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502   \u2502 \u2022 S-OldComputer: 234 ordinateurs inactifs &gt; 90 jours   \u2502    \u2502\n\u2502   \u2502 \u2022 S-OldUser: 156 utilisateurs inactifs &gt; 180 jours     \u2502    \u2502\n\u2502   \u2502 \u2022 S-Kerberoast: 12 comptes de service avec SPN         \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#16-remediation-prioritaire","title":"1.6 Rem\u00e9diation Prioritaire","text":"<p>Ordre de Rem\u00e9diation Recommand\u00e9</p> <ol> <li>Critique - Semaine 1 :</li> <li>D\u00e9sactiver SMBv1</li> <li>Activer pr\u00e9-authentification Kerberos</li> <li> <p>R\u00e9duire le nombre de Domain Admins</p> </li> <li> <p>Important - Mois 1 :</p> </li> <li>Nettoyer les objets obsol\u00e8tes</li> <li>Migrer les comptes de service vers gMSA</li> <li> <p>Activer LDAP Signing</p> </li> <li> <p>Moyen - Trimestre 1 :</p> </li> <li>Impl\u00e9menter le Tiering Model</li> <li>D\u00e9ployer LAPS</li> <li>Configurer les PSO</li> </ol>"},{"location":"formations/ad-hardening/03-audit-and-pso/#2-fine-grained-password-policies-fgpppso","title":"2. Fine-Grained Password Policies (FGPP/PSO)","text":""},{"location":"formations/ad-hardening/03-audit-and-pso/#21-pourquoi-les-pso","title":"2.1 Pourquoi les PSO ?","text":"<p>Limitation de la Default Domain Policy</p> <p>Par d\u00e9faut, Active Directory ne permet qu'une seule politique de mot de passe par domaine (via la Default Domain Policy).</p> <p>Probl\u00e8me : Les exigences sont diff\u00e9rentes selon les populations :</p> <ul> <li>Utilisateurs standard : Complexit\u00e9 moyenne</li> <li>Administrateurs Tier 0 : Complexit\u00e9 maximale</li> <li>Comptes de service : Mot de passe tr\u00e8s long, jamais expir\u00e9</li> </ul> <p>Solution : Les PSO (Password Settings Objects) permettent des politiques diff\u00e9renci\u00e9es sans cr\u00e9er plusieurs domaines.</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/#22-prerequis","title":"2.2 Pr\u00e9requis","text":"<pre><code># V\u00e9rifier le niveau fonctionnel du domaine (minimum 2008)\n(Get-ADDomain).DomainMode\n\n# Les PSO sont stock\u00e9s dans le conteneur System\nGet-ADObject -SearchBase \"CN=Password Settings Container,CN=System,DC=corp,DC=local\" -Filter *\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#23-creation-dune-pso-pour-les-administrateurs-tier-0","title":"2.3 Cr\u00e9ation d'une PSO pour les Administrateurs Tier 0","text":"<pre><code># PSO pour les comptes Tier 0 - Exigences maximales\nNew-ADFineGrainedPasswordPolicy -Name \"PSO-Tier0-Admins\" `\n    -DisplayName \"Politique Tier 0 - Administrateurs\" `\n    -Description \"Politique de mot de passe renforc\u00e9e pour les comptes Tier 0\" `\n    -Precedence 10 `\n    -MinPasswordLength 16 `\n    -PasswordHistoryCount 24 `\n    -ComplexityEnabled $true `\n    -ReversibleEncryptionEnabled $false `\n    -MaxPasswordAge \"90.00:00:00\" `\n    -MinPasswordAge \"1.00:00:00\" `\n    -LockoutThreshold 3 `\n    -LockoutDuration \"00:30:00\" `\n    -LockoutObservationWindow \"00:30:00\" `\n    -ProtectedFromAccidentalDeletion $true\n</code></pre> <p>Explication des param\u00e8tres :</p> Param\u00e8tre Valeur Justification <code>Precedence</code> 10 Plus le nombre est bas, plus la priorit\u00e9 est haute <code>MinPasswordLength</code> 16 R\u00e9sistance au crack offline <code>PasswordHistoryCount</code> 24 Emp\u00eache la r\u00e9utilisation sur 2 ans <code>MaxPasswordAge</code> 90 jours Renouvellement trimestriel <code>LockoutThreshold</code> 3 Verrouillage apr\u00e8s 3 \u00e9checs <code>LockoutDuration</code> 30 min Temps de verrouillage"},{"location":"formations/ad-hardening/03-audit-and-pso/#24-creation-dune-pso-pour-les-comptes-de-service","title":"2.4 Cr\u00e9ation d'une PSO pour les Comptes de Service","text":"<pre><code># PSO pour les comptes de service (non-gMSA)\nNew-ADFineGrainedPasswordPolicy -Name \"PSO-ServiceAccounts\" `\n    -DisplayName \"Politique Comptes de Service\" `\n    -Description \"Mots de passe longs, pas d'expiration (rotation manuelle planifi\u00e9e)\" `\n    -Precedence 20 `\n    -MinPasswordLength 25 `\n    -PasswordHistoryCount 12 `\n    -ComplexityEnabled $true `\n    -ReversibleEncryptionEnabled $false `\n    -MaxPasswordAge \"0.00:00:00\" `\n    -MinPasswordAge \"0.00:00:00\" `\n    -LockoutThreshold 0 `\n    -ProtectedFromAccidentalDeletion $true\n</code></pre> <p>Comptes de Service et Expiration</p> <p>Pour les comptes de service legacy (non-gMSA), on d\u00e9sactive l'expiration (<code>MaxPasswordAge = 0</code>) pour \u00e9viter les interruptions de service.</p> <p>Compensation obligatoire : Planifier une rotation manuelle annuelle et documenter la proc\u00e9dure.</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/#25-application-des-pso","title":"2.5 Application des PSO","text":"<pre><code># Cr\u00e9er un groupe pour les comptes Tier 0\nNew-ADGroup -Name \"Tier0-PasswordPolicy\" `\n    -GroupScope Global `\n    -GroupCategory Security `\n    -Path \"OU=Groups,OU=Tier0,DC=corp,DC=local\" `\n    -Description \"Membres soumis \u00e0 la PSO Tier 0\"\n\n# Ajouter les administrateurs au groupe\nAdd-ADGroupMember -Identity \"Tier0-PasswordPolicy\" -Members \"admin-t0-alice\", \"admin-t0-bob\"\n\n# Appliquer la PSO au groupe\nAdd-ADFineGrainedPasswordPolicySubject -Identity \"PSO-Tier0-Admins\" `\n    -Subjects \"Tier0-PasswordPolicy\"\n\n# V\u00e9rifier l'application\nGet-ADFineGrainedPasswordPolicySubject -Identity \"PSO-Tier0-Admins\"\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#26-verification-et-diagnostic","title":"2.6 V\u00e9rification et Diagnostic","text":"<pre><code># Voir quelle PSO s'applique \u00e0 un utilisateur\nGet-ADUserResultantPasswordPolicy -Identity \"admin-t0-alice\"\n\n# Lister toutes les PSO du domaine\nGet-ADFineGrainedPasswordPolicy -Filter * |\n    Select-Object Name, Precedence, MinPasswordLength, MaxPasswordAge,\n                  @{N='AppliesTo';E={(Get-ADFineGrainedPasswordPolicySubject -Identity $_.Name).Name -join ', '}} |\n    Sort-Object Precedence\n\n# V\u00e9rifier qu'aucun utilisateur privil\u00e9gi\u00e9 n'\u00e9chappe \u00e0 une PSO\nGet-ADGroupMember -Identity \"Domain Admins\" -Recursive |\n    ForEach-Object {\n        $pso = Get-ADUserResultantPasswordPolicy -Identity $_.SamAccountName\n        [PSCustomObject]@{\n            User = $_.SamAccountName\n            PSO = if ($pso) { $pso.Name } else { \"DEFAULT DOMAIN POLICY\" }\n        }\n    }\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#3-tableau-comparatif-des-pso","title":"3. Tableau Comparatif des PSO","text":"Population Min Length Max Age Lockout Complexit\u00e9 Utilisateurs Standard 12 365 jours 5 / 15 min Oui Administrateurs Tier 0 16 90 jours 3 / 30 min Oui Administrateurs Tier 1 14 180 jours 3 / 30 min Oui Comptes de Service 25 Jamais* D\u00e9sactiv\u00e9 Oui gMSA 240 (auto) 30 jours (auto) N/A Auto <p>*Avec rotation manuelle document\u00e9e</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/#4-autres-outils-de-durcissement","title":"4. Autres Outils de Durcissement","text":""},{"location":"formations/ad-hardening/03-audit-and-pso/#41-laps-local-administrator-password-solution","title":"4.1 LAPS (Local Administrator Password Solution)","text":"<p>LAPS - Gestion des Mots de Passe Locaux</p> <p>LAPS g\u00e9n\u00e8re des mots de passe uniques pour le compte Administrateur local de chaque machine et les stocke dans AD.</p> <p>Avantages : - Mot de passe diff\u00e9rent par machine - Rotation automatique - Pas de Pass-the-Hash entre machines</p> <pre><code># Installation de LAPS (Windows LAPS natif depuis Server 2019+)\n# \u00c9tendre le sch\u00e9ma AD (une seule fois)\nUpdate-LapsADSchema\n\n# Activer LAPS sur une OU\nSet-LapsADComputerSelfPermission -Identity \"OU=Workstations,OU=Tier2,DC=corp,DC=local\"\n\n# Configurer via GPO :\n# Computer Configuration &gt; Administrative Templates &gt; System &gt; LAPS\n# - Configure password backup directory : Active Directory\n# - Password Settings : Length 20, Complexity High, Age 30 days\n\n# R\u00e9cup\u00e9rer le mot de passe d'une machine\nGet-LapsADPassword -Identity \"PC-JDUPONT\" -AsPlainText\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#42-adminsdholder-et-protected-users","title":"4.2 AdminSDHolder et Protected Users","text":"<pre><code># V\u00e9rifier les membres du groupe Protected Users\nGet-ADGroupMember -Identity \"Protected Users\"\n\n# Ajouter un compte Tier 0 au groupe Protected Users\nAdd-ADGroupMember -Identity \"Protected Users\" -Members \"admin-t0-alice\"\n\n# Effets du groupe Protected Users :\n# - Pas de d\u00e9l\u00e9gation Kerberos\n# - Pas de cache de credentials\n# - Pas de NTLM\n# - TGT de 4 heures max\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#43-surveillance-continue","title":"4.3 Surveillance Continue","text":"<pre><code># Script de monitoring quotidien\n$report = @()\n\n# V\u00e9rifier les nouveaux Domain Admins\n$domainAdmins = Get-ADGroupMember -Identity \"Domain Admins\" -Recursive\n$report += \"Domain Admins: $($domainAdmins.Count) membres\"\n\n# V\u00e9rifier les comptes sans pr\u00e9-auth Kerberos\n$noPreAuth = Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true}\n$report += \"Comptes sans pr\u00e9-auth: $($noPreAuth.Count)\"\n\n# V\u00e9rifier les comptes de service avec SPN\n$kerberoastable = Get-ADUser -Filter {ServicePrincipalName -like \"*\"} -Properties ServicePrincipalName\n$report += \"Comptes Kerberoastable: $($kerberoastable.Count)\"\n\n# Afficher le rapport\n$report | ForEach-Object { Write-Host $_ }\n</code></pre>"},{"location":"formations/ad-hardening/03-audit-and-pso/#5-checklist-de-durcissement-ad","title":"5. Checklist de Durcissement AD","text":""},{"location":"formations/ad-hardening/03-audit-and-pso/#phase-1-actions-immediates-semaine-1","title":"Phase 1 : Actions Imm\u00e9diates (Semaine 1)","text":"<ul> <li>[ ] Ex\u00e9cuter PingCastle et analyser le rapport</li> <li>[ ] R\u00e9duire le nombre de Domain Admins (&lt; 5)</li> <li>[ ] Activer la pr\u00e9-authentification Kerberos pour tous les comptes</li> <li>[ ] D\u00e9sactiver SMBv1 sur tous les syst\u00e8mes</li> <li>[ ] Ajouter les admins critiques au groupe \"Protected Users\"</li> </ul>"},{"location":"formations/ad-hardening/03-audit-and-pso/#phase-2-durcissement-mois-1","title":"Phase 2 : Durcissement (Mois 1)","text":"<ul> <li>[ ] Cr\u00e9er et appliquer les PSO (Tier 0, Tier 1, Services)</li> <li>[ ] D\u00e9ployer LAPS sur les postes de travail</li> <li>[ ] Migrer les comptes de service vers gMSA</li> <li>[ ] Cr\u00e9er la structure OU pour le Tiering</li> </ul>"},{"location":"formations/ad-hardening/03-audit-and-pso/#phase-3-architecture-trimestre-1","title":"Phase 3 : Architecture (Trimestre 1)","text":"<ul> <li>[ ] Impl\u00e9menter les GPO de restriction de connexion inter-Tiers</li> <li>[ ] D\u00e9ployer les PAW ou Jump Servers pour Tier 0</li> <li>[ ] Activer le LDAP Signing et Channel Binding</li> <li>[ ] Configurer l'audit avanc\u00e9 (Event IDs 4768, 4769, 4624)</li> </ul>"},{"location":"formations/ad-hardening/03-audit-and-pso/#phase-4-maintenance-continue","title":"Phase 4 : Maintenance Continue","text":"<ul> <li>[ ] Ex\u00e9cuter PingCastle mensuellement</li> <li>[ ] Nettoyer les objets obsol\u00e8tes trimestriellement</li> <li>[ ] Changer le mot de passe krbtgt semestriellement</li> <li>[ ] Former les \u00e9quipes annuellement</li> </ul>"},{"location":"formations/ad-hardening/03-audit-and-pso/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence entre la Default Domain Policy et une PSO ? <p>R\u00e9ponse :</p> <ul> <li> <p>Default Domain Policy : S'applique \u00e0 tous les utilisateurs du domaine. Une seule politique par domaine. D\u00e9finie via GPO.</p> </li> <li> <p>PSO (Password Settings Object) : S'applique \u00e0 des groupes ou utilisateurs sp\u00e9cifiques. Plusieurs PSO possibles avec des priorit\u00e9s (Precedence). D\u00e9finie via ADAC ou PowerShell.</p> </li> </ul> <p>Les PSO permettent d'avoir des exigences diff\u00e9rentes selon les populations sans cr\u00e9er plusieurs domaines.</p> Question 2 : Pourquoi le score PingCastle de 0 est-il rare en production ? <p>R\u00e9ponse : Un score de 0 signifie une configuration \"parfaite\" selon tous les crit\u00e8res PingCastle. En production :</p> <ul> <li>Les applications legacy n\u00e9cessitent souvent des exceptions</li> <li>L'historique du domaine laisse des objets obsol\u00e8tes</li> <li>Les trusts inter-for\u00eats ajoutent de la complexit\u00e9</li> <li>Certaines fonctionnalit\u00e9s requises sont consid\u00e9r\u00e9es risqu\u00e9es</li> </ul> <p>Un score de 10-30 est un objectif r\u00e9aliste pour un environnement de production bien g\u00e9r\u00e9.</p> Question 3 : Pourquoi d\u00e9sactiver le lockout pour les comptes de service ? <p>R\u00e9ponse : Les comptes de service s'authentifient automatiquement de nombreuses fois. Un attaquant pourrait :</p> <ol> <li>D\u00e9clencher volontairement des \u00e9checs d'authentification</li> <li>Verrouiller le compte de service</li> <li>Provoquer un d\u00e9ni de service sur l'application</li> </ol> <p>Alternative recommand\u00e9e : Utiliser des gMSA qui n'ont pas ce probl\u00e8me (authentification automatique g\u00e9r\u00e9e par AD).</p>"},{"location":"formations/ad-hardening/03-audit-and-pso/#felicitations","title":"F\u00e9licitations !","text":"<p>Vous avez termin\u00e9 la formation Durcissement Active Directory. Vous ma\u00eetrisez maintenant :</p> <ul> <li>:material-check-circle: L'architecture de s\u00e9curit\u00e9 en couches (Tiering Model)</li> <li>:material-check-circle: Les principales attaques AD et leurs d\u00e9fenses</li> <li>:material-check-circle: L'audit avec PingCastle</li> <li>:material-check-circle: Les politiques de mots de passe diff\u00e9renci\u00e9es (PSO)</li> </ul> <p>:octicons-arrow-left-24: Retour au Module 2 : Vecteurs d'Attaque</p> <p>:octicons-home: Retour \u00e0 l'index de la formation</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/gcp-gke/","title":"Formation : Google Kubernetes Engine (GKE)","text":""},{"location":"formations/gcp-gke/#introduction","title":"Introduction","text":"<p>Bienvenue dans le cloud-native.</p> <p>Google Kubernetes Engine (GKE) est le service manag\u00e9 de Kubernetes de Google Cloud Platform. En tant qu'ing\u00e9nieurs Worldline migrant depuis l'on-premise, cette formation vous donnera les cl\u00e9s pour op\u00e9rer GKE de mani\u00e8re s\u00e9curis\u00e9e et efficace.</p>"},{"location":"formations/gcp-gke/#pourquoi-gke","title":"Pourquoi GKE ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              KUBERNETES ON-PREM vs GKE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ON-PREMISE KUBERNETES                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502   \u2022 Vous g\u00e9rez TOUT : etcd, API Server, scheduler, etc.         \u2502\n\u2502   \u2022 Mises \u00e0 jour manuelles (downtime planifi\u00e9)                  \u2502\n\u2502   \u2022 Monitoring du control plane = votre responsabilit\u00e9          \u2502\n\u2502   \u2022 Scaling = commander du hardware                             \u2502\n\u2502   \u2022 Co\u00fbt : \u00c9quipe d\u00e9di\u00e9e + hardware + \u00e9lectricit\u00e9               \u2502\n\u2502                                                                 \u2502\n\u2502   GKE (MANAGED KUBERNETES)                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502   \u2022 Control Plane g\u00e9r\u00e9 par Google (SLA 99.95%)                  \u2502\n\u2502   \u2022 Auto-upgrade : Mises \u00e0 jour automatiques                    \u2502\n\u2502   \u2022 Auto-repair : Nodes d\u00e9faillants remplac\u00e9s                   \u2502\n\u2502   \u2022 Scaling : Nouveaux nodes en minutes                         \u2502\n\u2502   \u2022 Co\u00fbt : Pay-per-use + pas d'ops control plane                \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udca1 Vous vous concentrez sur vos WORKLOADS, pas sur K8s        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/#les-avantages-cles-de-gke","title":"Les Avantages Cl\u00e9s de GKE","text":"Fonctionnalit\u00e9 Description Impact Control Plane Manag\u00e9 Google g\u00e8re etcd, API Server, scheduler Pas de maintenance K8s Auto-upgrade Mises \u00e0 jour automatiques des nodes S\u00e9curit\u00e9 continue Auto-repair Remplacement automatique des nodes d\u00e9faillants Haute disponibilit\u00e9 Node Auto-provisioning Cr\u00e9ation automatique de node pools Scaling intelligent Workload Identity Authentification native GCP S\u00e9curit\u00e9 sans cl\u00e9s JSON Binary Authorization Validation des images avant d\u00e9ploiement Supply chain security"},{"location":"formations/gcp-gke/#gke-standard-vs-autopilot","title":"GKE Standard vs Autopilot","text":"<p>Choix Strat\u00e9gique : GKE Standard</p> <p>Cette formation se concentre sur GKE Standard, pas sur GKE Autopilot.</p> Aspect GKE Standard GKE Autopilot Gestion des nodes Vous contr\u00f4lez Google g\u00e8re tout Node pools Personnalisables Automatiques DaemonSets Support\u00e9s Limit\u00e9s Privileged containers Possibles Interdits SSH aux nodes Possible Impossible Tuning syst\u00e8me Possible (sysctl, etc.) Impossible Co\u00fbt Par node (m\u00eame idle) Par pod (pay-per-use) <p>Pourquoi Standard pour Worldline ?</p> <ul> <li>Contr\u00f4le total sur la configuration des nodes</li> <li>Possibilit\u00e9 de DaemonSets pour monitoring/s\u00e9curit\u00e9</li> <li>Tuning avanc\u00e9 pour workloads sp\u00e9cifiques</li> <li>Debugging possible via SSH</li> <li>Conformit\u00e9 SecNumCloud plus flexible</li> </ul>"},{"location":"formations/gcp-gke/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 3 modules :</p>"},{"location":"formations/gcp-gke/#module-1-architecture-gke","title":"Module 1 : Architecture GKE","text":"<p>:material-kubernetes: Les Fondamentaux | :material-clock-outline: ~60 min</p> <ul> <li>Architecture Master / Nodes</li> <li>Clusters Zonaux vs R\u00e9gionaux</li> <li>VPC-Native et IP Aliasing</li> <li>Node Pools et Machine Types</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/gcp-gke/#module-2-securite-iam","title":"Module 2 : S\u00e9curit\u00e9 &amp; IAM","text":"<p>:material-shield-lock: Le Standard Worldline | :material-clock-outline: ~75 min</p> <ul> <li>GCP IAM vs Kubernetes RBAC</li> <li>Workload Identity (zero JSON keys)</li> <li>Private Clusters</li> <li>Network Policies</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/gcp-gke/#module-3-storage-networking","title":"Module 3 : Storage &amp; Networking","text":"<p>:material-database: Persistance &amp; Exposition | :material-clock-outline: ~60 min</p> <ul> <li>StorageClasses (pd-standard, pd-ssd)</li> <li>Persistent Volume Claims</li> <li>Services et Ingress</li> <li>GCE Ingress vs Nginx Ingress</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/gcp-gke/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>Kubernetes de base : Pods, Deployments, Services, ConfigMaps</li> <li>Docker : Build, run, registries</li> <li>GCP Fundamentals : Projets, IAM, VPC, Service Accounts</li> <li>CLI : <code>kubectl</code> et <code>gcloud</code> install\u00e9s</li> </ul>"},{"location":"formations/gcp-gke/#environnement-de-lab","title":"Environnement de Lab","text":"Installation gcloud CLIInstallation kubectlConfiguration Projet <pre><code># macOS\nbrew install --cask google-cloud-sdk\n\n# Linux (Debian/Ubuntu)\necho \"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main\" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list\ncurl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -\nsudo apt update &amp;&amp; sudo apt install google-cloud-cli\n\n# Windows\n# T\u00e9l\u00e9charger depuis https://cloud.google.com/sdk/docs/install\n\n# Initialisation\ngcloud init\ngcloud auth login\n</code></pre> <pre><code># Via gcloud (recommand\u00e9)\ngcloud components install kubectl\n\n# V\u00e9rifier\nkubectl version --client\n</code></pre> <pre><code># D\u00e9finir le projet par d\u00e9faut\ngcloud config set project YOUR_PROJECT_ID\n\n# D\u00e9finir la r\u00e9gion par d\u00e9faut\ngcloud config set compute/region europe-west1\n\n# V\u00e9rifier la configuration\ngcloud config list\n</code></pre>"},{"location":"formations/gcp-gke/#architecture-de-reference-worldline","title":"Architecture de R\u00e9f\u00e9rence Worldline","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE GKE WORLDLINE                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    VPC Worldline                        \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502            GKE Private Cluster                  \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                 \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502 Control     \u2502    \u2502    Node Pool        \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502 Plane       \u2502    \u2502    (Private IPs)    \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502 (Managed)   \u2502    \u2502                     \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502             \u2502    \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  \u2022 API      \u2502\u25c4\u2500\u2500\u25ba\u2502  \u2502 Pod \u2502 \u2502 Pod \u2502   \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  \u2022 etcd     \u2502    \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  \u2022 sched    \u2502    \u2502                     \u2502   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                 \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                         \u2502                               \u2502   \u2502\n\u2502   \u2502                         \u2502 Private Service Connect       \u2502   \u2502\n\u2502   \u2502                         \u25bc                               \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502              Services GCP                       \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502  Cloud SQL \u2502 Cloud Storage \u2502 Pub/Sub \u2502 etc.    \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/gcp-gke/#documentation-officielle","title":"Documentation Officielle","text":"<ul> <li>:material-link: GKE Documentation</li> <li>:material-link: GKE Best Practices</li> <li>:material-link: GKE Security Overview</li> </ul>"},{"location":"formations/gcp-gke/#outils-essentiels","title":"Outils Essentiels","text":"Outil Usage Installation <code>gcloud</code> CLI Google Cloud <code>brew install google-cloud-sdk</code> <code>kubectl</code> CLI Kubernetes <code>gcloud components install kubectl</code> <code>kubectx</code> Changer de contexte rapidement <code>brew install kubectx</code> <code>k9s</code> Interface TUI pour K8s <code>brew install k9s</code> <code>stern</code> Logs multi-pods <code>brew install stern</code> <p>Philosophie Cloud-Native</p> <p>\"Cattle, not pets.\"</p> <p>En cloud-native, les nodes sont du b\u00e9tail (cattle), pas des animaux de compagnie (pets). Ils peuvent \u00eatre remplac\u00e9s \u00e0 tout moment. Concevez vos applications en cons\u00e9quence.</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Cloud Team</p>"},{"location":"formations/gcp-gke/01-architecture/","title":"Module 1 : Architecture GKE","text":""},{"location":"formations/gcp-gke/01-architecture/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Expliquer la diff\u00e9rence entre Control Plane et Nodes</li> <li>:material-check: Choisir entre un cluster Zonal et R\u00e9gional</li> <li>:material-check: Comprendre le mode VPC-Native et l'IP Aliasing</li> <li>:material-check: Configurer des Node Pools adapt\u00e9s aux workloads</li> </ul>"},{"location":"formations/gcp-gke/01-architecture/#1-architecture-master-nodes","title":"1. Architecture Master / Nodes","text":""},{"location":"formations/gcp-gke/01-architecture/#11-le-control-plane-master","title":"1.1 Le Control Plane (Master)","text":"<p>En GKE, le Control Plane est enti\u00e8rement g\u00e9r\u00e9 par Google. Vous n'y avez pas acc\u00e8s SSH, et c'est une bonne chose.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CONTROL PLANE GKE (G\u00e9r\u00e9 par Google)                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502   \u2502   etcd      \u2502  \u2502 API Server  \u2502  \u2502  Scheduler  \u2502            \u2502\n\u2502   \u2502  (HA, SSD)  \u2502  \u2502   (HA)      \u2502  \u2502    (HA)     \u2502            \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                             \u2502\n\u2502   \u2502 Controller  \u2502  \u2502   Cloud     \u2502                             \u2502\n\u2502   \u2502  Manager    \u2502  \u2502 Controller  \u2502                             \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                             \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Mises \u00e0 jour automatiques                                  \u2502\n\u2502   \u2705 SLA 99.95% (r\u00e9gional) / 99.5% (zonal)                     \u2502\n\u2502   \u2705 Backup etcd automatique                                    \u2502\n\u2502   \u2705 Scaling automatique                                        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Ce que Google g\u00e8re pour vous</p> <ul> <li>etcd : Stockage distribu\u00e9, r\u00e9pliqu\u00e9, sauvegard\u00e9</li> <li>API Server : Hautement disponible, avec authentification int\u00e9gr\u00e9e</li> <li>Scheduler : Placement intelligent des pods</li> <li>Controller Manager : R\u00e9conciliation de l'\u00e9tat d\u00e9sir\u00e9</li> <li>Cloud Controller : Int\u00e9gration native GCP (LoadBalancers, PersistentVolumes)</li> </ul>"},{"location":"formations/gcp-gke/01-architecture/#12-les-nodes-worker-nodes","title":"1.2 Les Nodes (Worker Nodes)","text":"<p>Les Nodes sont des VMs Compute Engine que vous contr\u00f4lez partiellement :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              NODE GKE (VM Compute Engine)                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    Container Runtime                     \u2502   \u2502\n\u2502   \u2502                    (containerd)                          \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502   \u2502   kubelet   \u2502  \u2502 kube-proxy  \u2502  \u2502  gke-agent  \u2502            \u2502\n\u2502   \u2502             \u2502  \u2502             \u2502  \u2502             \u2502            \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502   \u2502    Pod A    \u2502  \u2502    Pod B    \u2502  \u2502    Pod C    \u2502            \u2502\n\u2502   \u2502  (App)      \u2502  \u2502  (API)      \u2502  \u2502  (Worker)   \u2502            \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Composants cl\u00e9s :</p> Composant R\u00f4le <code>kubelet</code> Agent K8s, communique avec l'API Server <code>kube-proxy</code> Gestion des r\u00e8gles r\u00e9seau (iptables/IPVS) <code>containerd</code> Runtime de conteneurs (remplace Docker) <code>gke-agent</code> Agent sp\u00e9cifique GKE (m\u00e9triques, logs)"},{"location":"formations/gcp-gke/01-architecture/#2-clusters-zonaux-vs-regionaux","title":"2. Clusters Zonaux vs R\u00e9gionaux","text":""},{"location":"formations/gcp-gke/01-architecture/#21-cluster-zonal","title":"2.1 Cluster Zonal","text":"<p>Un cluster zonal a son Control Plane dans une seule zone :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLUSTER ZONAL (europe-west1-b)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Zone: europe-west1-b                                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502                                                       \u2502     \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                     \u2502     \u2502\n\u2502   \u2502   \u2502   Control   \u2502   SLA: 99.5%                        \u2502     \u2502\n\u2502   \u2502   \u2502    Plane    \u2502   (Single Point of Failure)         \u2502     \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                     \u2502     \u2502\n\u2502   \u2502          \u2502                                            \u2502     \u2502\n\u2502   \u2502          \u25bc                                            \u2502     \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2510                             \u2502     \u2502\n\u2502   \u2502   \u2502Node 1\u2502Node 2\u2502Node 3\u2502                             \u2502     \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518                             \u2502     \u2502\n\u2502   \u2502                                                       \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  Si la zone tombe, TOUT le cluster est indisponible        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Caract\u00e9ristiques :</p> Aspect D\u00e9tail SLA Control Plane 99.5% Co\u00fbt Moins cher (pas de r\u00e9plication) Maintenance Downtime pendant les upgrades Cas d'usage Dev, Test, Workloads non-critiques"},{"location":"formations/gcp-gke/01-architecture/#22-cluster-regional","title":"2.2 Cluster R\u00e9gional","text":"<p>Un cluster r\u00e9gional r\u00e9plique le Control Plane sur 3 zones :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLUSTER R\u00c9GIONAL (europe-west1)                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502 europe-west1-b  \u2502 \u2502 europe-west1-c  \u2502 \u2502 europe-west1-d  \u2502   \u2502\n\u2502   \u2502                 \u2502 \u2502                 \u2502 \u2502                 \u2502   \u2502\n\u2502   \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502   \u2502\n\u2502   \u2502 \u2502   Control   \u2502 \u2502 \u2502 \u2502   Control   \u2502 \u2502 \u2502 \u2502   Control   \u2502 \u2502   \u2502\n\u2502   \u2502 \u2502   Plane     \u2502\u25c4\u253c\u2500\u253c\u25ba\u2502   Plane     \u2502\u25c4\u253c\u2500\u253c\u25ba\u2502   Plane     \u2502 \u2502   \u2502\n\u2502   \u2502 \u2502  (replica)  \u2502 \u2502 \u2502 \u2502  (replica)  \u2502 \u2502 \u2502 \u2502  (replica)  \u2502 \u2502   \u2502\n\u2502   \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502   \u2502\n\u2502   \u2502       \u2502         \u2502 \u2502       \u2502         \u2502 \u2502       \u2502         \u2502   \u2502\n\u2502   \u2502       \u25bc         \u2502 \u2502       \u25bc         \u2502 \u2502       \u25bc         \u2502   \u2502\n\u2502   \u2502 \u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510   \u2502 \u2502 \u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510   \u2502 \u2502 \u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502 \u2502N1 \u2502N2 \u2502N3 \u2502   \u2502 \u2502 \u2502N4 \u2502N5 \u2502N6 \u2502   \u2502 \u2502 \u2502N7 \u2502N8 \u2502N9 \u2502   \u2502   \u2502\n\u2502   \u2502 \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518   \u2502 \u2502 \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518   \u2502 \u2502 \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                 \u2502 \u2502                 \u2502 \u2502                 \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 SLA 99.95% - Une zone peut tomber sans impact              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Caract\u00e9ristiques :</p> Aspect D\u00e9tail SLA Control Plane 99.95% Co\u00fbt ~3x le co\u00fbt du Control Plane Maintenance Zero-downtime upgrades (rolling) Cas d'usage Production, Workloads critiques"},{"location":"formations/gcp-gke/01-architecture/#23-comparaison-et-recommandations","title":"2.3 Comparaison et Recommandations","text":"Crit\u00e8re Zonal R\u00e9gional SLA 99.5% 99.95% Co\u00fbt Control Plane $0.10/h $0.10/h (gratuit Standard) Co\u00fbt Nodes 1x 3x (r\u00e9pliqu\u00e9s sur 3 zones) R\u00e9silience Single zone Multi-zone Upgrades Downtime Zero-downtime <p>Recommandation Worldline</p> <p>Production : Toujours R\u00e9gional pour les workloads critiques.</p> <p>Dev/Test : Zonal acceptable pour r\u00e9duire les co\u00fbts.</p> <p>Astuce : M\u00eame en r\u00e9gional, vous pouvez limiter les nodes \u00e0 1-2 zones pour r\u00e9duire les co\u00fbts tout en gardant le Control Plane HA.</p>"},{"location":"formations/gcp-gke/01-architecture/#3-vpc-native-et-ip-aliasing","title":"3. VPC-Native et IP Aliasing","text":""},{"location":"formations/gcp-gke/01-architecture/#31-le-probleme-des-clusters-non-vpc-native","title":"3.1 Le Probl\u00e8me des Clusters Non VPC-Native","text":"<p>Dans un cluster Kubernetes classique (routes-based), les pods ont des IPs internes au cluster, non routables dans le VPC :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLUSTER ROUTES-BASED (Legacy)                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   VPC: 10.0.0.0/16                                              \u2502\n\u2502                                                                 \u2502\n\u2502   Node 1 (10.0.1.10)          Node 2 (10.0.1.11)               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502   \u2502                 \u2502         \u2502                 \u2502              \u2502\n\u2502   \u2502 Pod (10.244.0.5)\u2502 \u2500\u2500X\u2500\u2500\u25b6  \u2502 Cloud SQL      \u2502              \u2502\n\u2502   \u2502                 \u2502         \u2502 (10.0.2.50)    \u2502              \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                                                                 \u2502\n\u2502   \u274c Le Pod ne peut PAS communiquer directement avec Cloud SQL  \u2502\n\u2502   \u274c N\u00e9cessite NAT ou routes personnalis\u00e9es                     \u2502\n\u2502   \u274c Plus de 1000 nodes = probl\u00e8me de quotas de routes          \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#32-la-solution-vpc-native-ip-aliasing","title":"3.2 La Solution : VPC-Native (IP Aliasing)","text":"<p>En mode VPC-Native, les pods re\u00e7oivent des IPs du VPC, directement routables :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLUSTER VPC-NATIVE                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   VPC: 10.0.0.0/8                                               \u2502\n\u2502   \u251c\u2500\u2500 Subnet Nodes:    10.0.0.0/16                              \u2502\n\u2502   \u251c\u2500\u2500 Subnet Pods:     10.1.0.0/16 (Secondary Range)            \u2502\n\u2502   \u2514\u2500\u2500 Subnet Services: 10.2.0.0/16 (Secondary Range)            \u2502\n\u2502                                                                 \u2502\n\u2502   Node 1 (10.0.1.10)                                            \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Pod A (10.1.0.5) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 Cloud SQL (10.0.2.50) \u2502   \u2502\n\u2502   \u2502  Pod B (10.1.0.6) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 Memorystore (10.0.3.1)\u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  IP Aliases: 10.1.0.0/24 (jusqu'\u00e0 110 pods)            \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Pods directement routables dans le VPC                     \u2502\n\u2502   \u2705 Pas de NAT n\u00e9cessaire                                      \u2502\n\u2502   \u2705 Scalabilit\u00e9 &gt; 1000 nodes                                   \u2502\n\u2502   \u2705 Compatible Private Google Access                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#33-configuration-vpc-native","title":"3.3 Configuration VPC-Native","text":"<pre><code># Cr\u00e9er un cluster VPC-Native\ngcloud container clusters create my-cluster \\\n    --region europe-west1 \\\n    --enable-ip-alias \\\n    --cluster-ipv4-cidr \"/16\" \\\n    --services-ipv4-cidr \"/16\" \\\n    --network my-vpc \\\n    --subnetwork my-subnet\n</code></pre> <p>Ou avec des ranges secondaires existants :</p> <pre><code># Cr\u00e9er le subnet avec ranges secondaires\ngcloud compute networks subnets create my-subnet \\\n    --network my-vpc \\\n    --region europe-west1 \\\n    --range 10.0.0.0/20 \\\n    --secondary-range pods=10.1.0.0/16,services=10.2.0.0/20\n\n# Cr\u00e9er le cluster avec ces ranges\ngcloud container clusters create my-cluster \\\n    --region europe-west1 \\\n    --enable-ip-alias \\\n    --network my-vpc \\\n    --subnetwork my-subnet \\\n    --cluster-secondary-range-name pods \\\n    --services-secondary-range-name services\n</code></pre> <p>Planification IP Cruciale</p> <p>Avant de cr\u00e9er un cluster GKE, planifiez vos plages IP :</p> Ressource CIDR Recommand\u00e9 Capacit\u00e9 Nodes /20 4,096 nodes Pods /14 262,144 pods Services /20 4,096 services <p>R\u00e8gle : Chaque node peut h\u00e9berger jusqu'\u00e0 110 pods par d\u00e9faut.</p>"},{"location":"formations/gcp-gke/01-architecture/#4-node-pools","title":"4. Node Pools","text":""},{"location":"formations/gcp-gke/01-architecture/#41-concept","title":"4.1 Concept","text":"<p>Un Node Pool est un groupe de nodes avec la m\u00eame configuration (machine type, labels, taints).</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLUSTER GKE AVEC NODE POOLS                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Node Pool: \"default-pool\"                  \u2502   \u2502\n\u2502   \u2502              Machine Type: e2-medium                    \u2502   \u2502\n\u2502   \u2502              Nodes: 3 (min: 1, max: 5)                  \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502   \u2502\n\u2502   \u2502   \u2502  Node 1  \u2502  \u2502  Node 2  \u2502  \u2502  Node 3  \u2502             \u2502   \u2502\n\u2502   \u2502   \u2502 2 vCPU   \u2502  \u2502 2 vCPU   \u2502  \u2502 2 vCPU   \u2502             \u2502   \u2502\n\u2502   \u2502   \u2502 4GB RAM  \u2502  \u2502 4GB RAM  \u2502  \u2502 4GB RAM  \u2502             \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Node Pool: \"high-memory\"                   \u2502   \u2502\n\u2502   \u2502              Machine Type: n2-highmem-8                 \u2502   \u2502\n\u2502   \u2502              Nodes: 2 (min: 0, max: 10)                 \u2502   \u2502\n\u2502   \u2502              Labels: workload=memory-intensive          \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                           \u2502   \u2502\n\u2502   \u2502   \u2502  Node 4  \u2502  \u2502  Node 5  \u2502                           \u2502   \u2502\n\u2502   \u2502   \u2502 8 vCPU   \u2502  \u2502 8 vCPU   \u2502                           \u2502   \u2502\n\u2502   \u2502   \u2502 64GB RAM \u2502  \u2502 64GB RAM \u2502                           \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Node Pool: \"gpu-pool\"                      \u2502   \u2502\n\u2502   \u2502              Machine Type: n1-standard-8                \u2502   \u2502\n\u2502   \u2502              Accelerator: nvidia-tesla-t4               \u2502   \u2502\n\u2502   \u2502              Taints: nvidia.com/gpu=present:NoSchedule  \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                          \u2502   \u2502\n\u2502   \u2502   \u2502  Node 6  \u2502                                          \u2502   \u2502\n\u2502   \u2502   \u2502 8 vCPU   \u2502                                          \u2502   \u2502\n\u2502   \u2502   \u2502 1x T4 GPU\u2502                                          \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                          \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#42-creation-et-gestion","title":"4.2 Cr\u00e9ation et Gestion","text":"<pre><code># Cr\u00e9er un node pool standard\ngcloud container node-pools create general-pool \\\n    --cluster my-cluster \\\n    --region europe-west1 \\\n    --machine-type e2-standard-4 \\\n    --num-nodes 3 \\\n    --enable-autoscaling \\\n    --min-nodes 1 \\\n    --max-nodes 10\n\n# Cr\u00e9er un node pool haute m\u00e9moire avec labels\ngcloud container node-pools create highmem-pool \\\n    --cluster my-cluster \\\n    --region europe-west1 \\\n    --machine-type n2-highmem-8 \\\n    --num-nodes 0 \\\n    --enable-autoscaling \\\n    --min-nodes 0 \\\n    --max-nodes 5 \\\n    --node-labels workload=memory-intensive\n\n# Cr\u00e9er un node pool avec taints\ngcloud container node-pools create gpu-pool \\\n    --cluster my-cluster \\\n    --region europe-west1 \\\n    --machine-type n1-standard-8 \\\n    --accelerator type=nvidia-tesla-t4,count=1 \\\n    --num-nodes 0 \\\n    --enable-autoscaling \\\n    --min-nodes 0 \\\n    --max-nodes 3 \\\n    --node-taints nvidia.com/gpu=present:NoSchedule\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#43-cibler-un-node-pool-dans-un-deployment","title":"4.3 Cibler un Node Pool dans un Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: memory-intensive-app\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: memory-intensive\n  template:\n    metadata:\n      labels:\n        app: memory-intensive\n    spec:\n      # Cibler le node pool via nodeSelector\n      nodeSelector:\n        workload: memory-intensive\n      containers:\n      - name: app\n        image: europe-west1-docker.pkg.dev/my-project/my-repo/app:latest\n        resources:\n          requests:\n            memory: \"32Gi\"\n            cpu: \"4\"\n          limits:\n            memory: \"48Gi\"\n            cpu: \"6\"\n</code></pre> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gpu-workload\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gpu-app\n  template:\n    metadata:\n      labels:\n        app: gpu-app\n    spec:\n      # Tol\u00e9ration pour le taint GPU\n      tolerations:\n      - key: \"nvidia.com/gpu\"\n        operator: \"Equal\"\n        value: \"present\"\n        effect: \"NoSchedule\"\n      containers:\n      - name: gpu-container\n        image: nvidia/cuda:11.0-base\n        resources:\n          limits:\n            nvidia.com/gpu: 1\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#5-flux-de-trafic-user-to-pod","title":"5. Flux de Trafic : User to Pod","text":""},{"location":"formations/gcp-gke/01-architecture/#51-diagramme-de-flux","title":"5.1 Diagramme de Flux","text":"<pre><code>flowchart TB\n    subgraph Internet\n        User[Utilisateur]\n    end\n\n    subgraph GCP[\"Google Cloud Platform\"]\n        subgraph GLB[\"Global Load Balancer\"]\n            LB[Cloud Load Balancer&lt;br/&gt;IP Externe: 34.xxx.xxx.xxx]\n        end\n\n        subgraph GKE[\"Cluster GKE\"]\n            subgraph NP[\"Node Pool\"]\n                subgraph N1[\"Node 1\"]\n                    P1[Pod A&lt;br/&gt;10.1.0.5]\n                    P2[Pod B&lt;br/&gt;10.1.0.6]\n                end\n                subgraph N2[\"Node 2\"]\n                    P3[Pod C&lt;br/&gt;10.1.0.7]\n                    P4[Pod D&lt;br/&gt;10.1.0.8]\n                end\n            end\n            SVC[Service&lt;br/&gt;type: LoadBalancer&lt;br/&gt;ClusterIP: 10.2.0.100]\n            ING[Ingress Controller]\n        end\n    end\n\n    User --&gt;|HTTPS| LB\n    LB --&gt;|Port 80/443| ING\n    ING --&gt;|Route /api/*| SVC\n    SVC --&gt;|Round Robin| P1\n    SVC --&gt;|Round Robin| P3</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#52-types-de-services","title":"5.2 Types de Services","text":"Type Description IP Cas d'usage <code>ClusterIP</code> Interne au cluster 10.2.x.x Communication inter-pods <code>NodePort</code> Port sur chaque node NodeIP:30000-32767 Debug, tests <code>LoadBalancer</code> Load Balancer GCP IP externe Exposition directe <code>Ingress</code> HTTP(S) Load Balancer IP externe Multi-services, TLS termination"},{"location":"formations/gcp-gke/01-architecture/#6-commandes-de-reference","title":"6. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === CR\u00c9ATION CLUSTER ===\n# Cluster r\u00e9gional VPC-Native\ngcloud container clusters create prod-cluster \\\n    --region europe-west1 \\\n    --num-nodes 3 \\\n    --enable-ip-alias \\\n    --network my-vpc \\\n    --subnetwork my-subnet \\\n    --enable-private-nodes \\\n    --master-ipv4-cidr 172.16.0.0/28 \\\n    --enable-master-authorized-networks\n\n# === GESTION CLUSTER ===\n# Lister les clusters\ngcloud container clusters list\n\n# Obtenir les credentials\ngcloud container clusters get-credentials prod-cluster --region europe-west1\n\n# Mettre \u00e0 jour la version du cluster\ngcloud container clusters upgrade prod-cluster --region europe-west1 --master\n\n# === NODE POOLS ===\n# Lister les node pools\ngcloud container node-pools list --cluster prod-cluster --region europe-west1\n\n# Redimensionner un node pool\ngcloud container clusters resize prod-cluster \\\n    --node-pool default-pool \\\n    --num-nodes 5 \\\n    --region europe-west1\n\n# === KUBECTL ===\n# V\u00e9rifier les nodes\nkubectl get nodes -o wide\n\n# Voir les pods par node\nkubectl get pods -o wide --all-namespaces | sort -k 8\n\n# Describe un node\nkubectl describe node gke-prod-cluster-default-pool-xxx\n</code></pre>"},{"location":"formations/gcp-gke/01-architecture/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence de SLA entre un cluster zonal et r\u00e9gional ? <p>R\u00e9ponse :</p> <ul> <li>Zonal : SLA 99.5% - Le Control Plane est dans une seule zone</li> <li>R\u00e9gional : SLA 99.95% - Le Control Plane est r\u00e9pliqu\u00e9 sur 3 zones</li> </ul> <p>La diff\u00e9rence de 0.45% peut sembler faible, mais en pratique : - 99.5% = ~43 heures de downtime potentiel par an - 99.95% = ~4 heures de downtime potentiel par an</p> Question 2 : Pourquoi le mode VPC-Native est-il recommand\u00e9 ? <p>R\u00e9ponse :</p> <p>Le mode VPC-Native (IP Aliasing) offre plusieurs avantages :</p> <ol> <li>Routabilit\u00e9 : Les pods ont des IPs directement routables dans le VPC</li> <li>Scalabilit\u00e9 : Pas de limite de 1000 nodes li\u00e9e aux routes</li> <li>Int\u00e9gration : Acc\u00e8s direct aux services GCP (Cloud SQL, Memorystore)</li> <li>S\u00e9curit\u00e9 : Compatible avec les VPC Firewalls et Private Google Access</li> <li>Performance : Pas de NAT, latence r\u00e9duite</li> </ol> Question 3 : Quand utiliser plusieurs Node Pools ? <p>R\u00e9ponse :</p> <p>Utilisez plusieurs Node Pools quand vous avez :</p> <ul> <li>Workloads h\u00e9t\u00e9rog\u00e8nes : CPU-intensive vs Memory-intensive</li> <li>Besoins GPU : Isoler les workloads GPU avec taints</li> <li>Co\u00fbts diff\u00e9renci\u00e9s : Spot VMs pour les workloads interruptibles</li> <li>Exigences r\u00e9glementaires : Nodes d\u00e9di\u00e9s pour certains workloads</li> <li>Mises \u00e0 jour graduelles : Tester une nouvelle version de node sur un pool</li> </ul>"},{"location":"formations/gcp-gke/01-architecture/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que vous comprenez l'architecture, d\u00e9couvrez comment s\u00e9curiser votre cluster GKE.</p> <p>:octicons-arrow-right-24: Module 2 : S\u00e9curit\u00e9 &amp; IAM</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/gcp-gke/02-security-iam/","title":"Module 2 : S\u00e9curit\u00e9 &amp; IAM","text":""},{"location":"formations/gcp-gke/02-security-iam/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Distinguer GCP IAM et Kubernetes RBAC</li> <li>:material-check: Configurer Workload Identity (zero cl\u00e9s JSON)</li> <li>:material-check: Cr\u00e9er et s\u00e9curiser un Private Cluster</li> <li>:material-check: Impl\u00e9menter des Network Policies efficaces</li> </ul>"},{"location":"formations/gcp-gke/02-security-iam/#1-gcp-iam-vs-kubernetes-rbac","title":"1. GCP IAM vs Kubernetes RBAC","text":""},{"location":"formations/gcp-gke/02-security-iam/#11-deux-systemes-deux-perimetres","title":"1.1 Deux Syst\u00e8mes, Deux P\u00e9rim\u00e8tres","text":"<p>GKE utilise deux syst\u00e8mes d'autorisation distincts qui travaillent ensemble :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MOD\u00c8LE D'AUTORISATION GKE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    GCP IAM                              \u2502   \u2502\n\u2502   \u2502   \"Qui peut ACC\u00c9DER au cluster ?\"                       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u2022 roles/container.admin                               \u2502   \u2502\n\u2502   \u2502   \u2022 roles/container.developer                           \u2502   \u2502\n\u2502   \u2502   \u2022 roles/container.viewer                              \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Scope: Projets GCP, Clusters                          \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u2502 L'utilisateur a acc\u00e8s au cluster      \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                 Kubernetes RBAC                         \u2502   \u2502\n\u2502   \u2502   \"Que peut-il FAIRE dans le cluster ?\"                 \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u2022 cluster-admin (ClusterRole)                         \u2502   \u2502\n\u2502   \u2502   \u2022 namespace-admin (Role)                              \u2502   \u2502\n\u2502   \u2502   \u2022 read-only (Role)                                    \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Scope: Namespaces, Resources K8s                      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#12-roles-gcp-iam-pour-gke","title":"1.2 R\u00f4les GCP IAM pour GKE","text":"R\u00f4le IAM Description Permissions Cl\u00e9s <code>roles/container.admin</code> Admin complet Cr\u00e9er/supprimer clusters, full access <code>roles/container.clusterAdmin</code> Admin cluster G\u00e9rer un cluster existant <code>roles/container.developer</code> D\u00e9veloppeur Deploy apps, pas de gestion infra <code>roles/container.viewer</code> Lecture seule Voir les clusters et workloads <pre><code># Attribuer un r\u00f4le IAM\ngcloud projects add-iam-policy-binding my-project \\\n    --member=\"user:dev@worldline.com\" \\\n    --role=\"roles/container.developer\"\n\n# V\u00e9rifier les bindings\ngcloud projects get-iam-policy my-project \\\n    --flatten=\"bindings[].members\" \\\n    --filter=\"bindings.role:roles/container.*\"\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#13-kubernetes-rbac","title":"1.3 Kubernetes RBAC","text":"<p>Le RBAC Kubernetes contr\u00f4le les actions \u00e0 l'int\u00e9rieur du cluster :</p> <pre><code># ClusterRole : Permissions au niveau cluster\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: namespace-admin\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\", \"services\", \"configmaps\", \"secrets\"]\n  verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]\n- apiGroups: [\"apps\"]\n  resources: [\"deployments\", \"replicasets\", \"statefulsets\"]\n  verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]\n\n---\n# ClusterRoleBinding : Lier le r\u00f4le \u00e0 un utilisateur GCP\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: dev-team-binding\nsubjects:\n- kind: User\n  name: dev@worldline.com  # Email GCP\n  apiGroup: rbac.authorization.k8s.io\n- kind: Group\n  name: devs@worldline.com  # Groupe Google Workspace\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: ClusterRole\n  name: namespace-admin\n  apiGroup: rbac.authorization.k8s.io\n</code></pre> <pre><code># Role : Permissions limit\u00e9es \u00e0 un namespace\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: team-frontend\n  name: pod-reader\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\", \"pods/log\"]\n  verbs: [\"get\", \"list\", \"watch\"]\n\n---\n# RoleBinding : Lier dans un namespace sp\u00e9cifique\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: read-pods-frontend\n  namespace: team-frontend\nsubjects:\n- kind: User\n  name: junior@worldline.com\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n  kind: Role\n  name: pod-reader\n  apiGroup: rbac.authorization.k8s.io\n</code></pre> <p>Bonnes Pratiques RBAC</p> <ol> <li>Principe du moindre privil\u00e8ge : Donnez uniquement les permissions n\u00e9cessaires</li> <li>Utilisez des Roles (pas ClusterRoles) : Limitez au namespace quand possible</li> <li>Groupes Google : Pr\u00e9f\u00e9rez les groupes aux utilisateurs individuels</li> <li>Auditez r\u00e9guli\u00e8rement : <code>kubectl get rolebindings,clusterrolebindings -A</code></li> </ol>"},{"location":"formations/gcp-gke/02-security-iam/#2-workload-identity-zero-cles-json","title":"2. Workload Identity : Zero Cl\u00e9s JSON","text":""},{"location":"formations/gcp-gke/02-security-iam/#21-le-probleme-des-service-account-keys","title":"2.1 Le Probl\u00e8me des Service Account Keys","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ANTI-PATTERN : Cl\u00e9s JSON dans les Pods             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u274c M\u00e9thode dangereuse :                                       \u2502\n\u2502                                                                 \u2502\n\u2502   1. Cr\u00e9er un Service Account GCP                               \u2502\n\u2502   2. G\u00e9n\u00e9rer une cl\u00e9 JSON                                       \u2502\n\u2502   3. La stocker dans un Secret Kubernetes                       \u2502\n\u2502   4. La monter dans le Pod                                      \u2502\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8MES :                                                   \u2502\n\u2502   \u2022 Cl\u00e9s qui ne expirent jamais (sauf r\u00e9vocation manuelle)     \u2502\n\u2502   \u2022 Risque de fuite (logs, commits Git, backups)               \u2502\n\u2502   \u2022 Rotation complexe (red\u00e9ployer tous les pods)               \u2502\n\u2502   \u2022 Audit difficile (qui utilise quelle cl\u00e9 ?)                 \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  INTERDIT en environnement SecNumCloud                     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#22-la-solution-workload-identity","title":"2.2 La Solution : Workload Identity","text":"<p>Workload Identity permet \u00e0 un Pod de s'authentifier aupr\u00e8s des APIs GCP sans cl\u00e9 JSON :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              WORKLOAD IDENTITY                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                       \u2502\n\u2502   \u2502    Pod (app)        \u2502                                       \u2502\n\u2502   \u2502                     \u2502                                       \u2502\n\u2502   \u2502  ServiceAccount K8s \u2502\u25c4\u2500\u2500\u2500\u2500\u2510                                 \u2502\n\u2502   \u2502  \"my-app-sa\"        \u2502     \u2502 Annotation                      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502                                 \u2502\n\u2502            \u2502                  \u2502                                 \u2502\n\u2502            \u2502 1. Demande token \u2502                                 \u2502\n\u2502            \u25bc                  \u2502                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502                                 \u2502\n\u2502   \u2502   GKE Metadata      \u2502     \u2502                                 \u2502\n\u2502   \u2502   Server            \u2502     \u2502                                 \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502                                 \u2502\n\u2502            \u2502                  \u2502                                 \u2502\n\u2502            \u2502 2. \u00c9change token \u2502                                 \u2502\n\u2502            \u25bc                  \u2502                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502                                 \u2502\n\u2502   \u2502  GCP IAM            \u2502     \u2502                                 \u2502\n\u2502   \u2502                     \u2502     \u2502                                 \u2502\n\u2502   \u2502  Service Account    \u2502\u2500\u2500\u2500\u2500\u2500\u2518                                 \u2502\n\u2502   \u2502  \"my-app@proj.iam\"  \u2502  IAM binding                          \u2502\n\u2502   \u2502                     \u2502                                       \u2502\n\u2502   \u2502  Roles:             \u2502                                       \u2502\n\u2502   \u2502  - storage.admin    \u2502                                       \u2502\n\u2502   \u2502  - pubsub.publisher \u2502                                       \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                       \u2502\n\u2502            \u2502                                                    \u2502\n\u2502            \u2502 3. Token GCP valide                                \u2502\n\u2502            \u25bc                                                    \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                       \u2502\n\u2502   \u2502   APIs GCP          \u2502                                       \u2502\n\u2502   \u2502   Cloud Storage     \u2502                                       \u2502\n\u2502   \u2502   Pub/Sub           \u2502                                       \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                       \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Pas de cl\u00e9 JSON                                            \u2502\n\u2502   \u2705 Tokens courts (1h, renouvel\u00e9s automatiquement)             \u2502\n\u2502   \u2705 Audit via Cloud Audit Logs                                 \u2502\n\u2502   \u2705 R\u00e9vocation imm\u00e9diate possible                              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#23-configuration-workload-identity","title":"2.3 Configuration Workload Identity","text":"<p>\u00c9tape 1 : Activer Workload Identity sur le cluster</p> <pre><code># Lors de la cr\u00e9ation\ngcloud container clusters create my-cluster \\\n    --region europe-west1 \\\n    --workload-pool=my-project.svc.id.goog\n\n# Sur un cluster existant\ngcloud container clusters update my-cluster \\\n    --region europe-west1 \\\n    --workload-pool=my-project.svc.id.goog\n\n# Activer sur un node pool existant\ngcloud container node-pools update default-pool \\\n    --cluster my-cluster \\\n    --region europe-west1 \\\n    --workload-metadata=GKE_METADATA\n</code></pre> <p>\u00c9tape 2 : Cr\u00e9er les Service Accounts</p> <pre><code># Service Account GCP\ngcloud iam service-accounts create my-app-sa \\\n    --display-name=\"Service Account for My App\"\n\n# Attribuer les r\u00f4les n\u00e9cessaires\ngcloud projects add-iam-policy-binding my-project \\\n    --member=\"serviceAccount:my-app-sa@my-project.iam.gserviceaccount.com\" \\\n    --role=\"roles/storage.objectViewer\"\n\n# Service Account Kubernetes\nkubectl create serviceaccount my-app-ksa -n my-namespace\n</code></pre> <p>\u00c9tape 3 : Lier les Service Accounts</p> <pre><code># Permettre au KSA d'utiliser le GSA\ngcloud iam service-accounts add-iam-policy-binding \\\n    my-app-sa@my-project.iam.gserviceaccount.com \\\n    --role=\"roles/iam.workloadIdentityUser\" \\\n    --member=\"serviceAccount:my-project.svc.id.goog[my-namespace/my-app-ksa]\"\n\n# Annoter le KSA avec le GSA\nkubectl annotate serviceaccount my-app-ksa \\\n    -n my-namespace \\\n    iam.gke.io/gcp-service-account=my-app-sa@my-project.iam.gserviceaccount.com\n</code></pre> <p>\u00c9tape 4 : Utiliser dans un Deployment</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-app\n  namespace: my-namespace\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: my-app\n  template:\n    metadata:\n      labels:\n        app: my-app\n    spec:\n      serviceAccountName: my-app-ksa  # Utilise Workload Identity\n      containers:\n      - name: app\n        image: europe-west1-docker.pkg.dev/my-project/repo/app:v1\n        env:\n        # Pas besoin de GOOGLE_APPLICATION_CREDENTIALS !\n        - name: PROJECT_ID\n          value: my-project\n</code></pre> <p>V\u00e9rification :</p> <pre><code># Tester depuis un pod\nkubectl run test-wi --rm -it --restart=Never \\\n    --image=google/cloud-sdk:slim \\\n    --serviceaccount=my-app-ksa \\\n    -n my-namespace \\\n    -- gcloud auth list\n\n# Doit afficher le GSA comme compte actif\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#3-private-clusters","title":"3. Private Clusters","text":""},{"location":"formations/gcp-gke/02-security-iam/#31-concept","title":"3.1 Concept","text":"<p>Un Private Cluster n'a pas d'IPs publiques sur ses nodes :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PRIVATE CLUSTER GKE                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Internet                                                      \u2502\n\u2502      \u2502                                                          \u2502\n\u2502      \u2502 \u274c Pas d'acc\u00e8s direct aux nodes                          \u2502\n\u2502      \u2502                                                          \u2502\n\u2502      \u25bc                                                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    VPC Worldline                        \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502           Private Cluster GKE                   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                 \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   Control Plane (172.16.0.0/28)                \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  API Server \u2502\u25c4\u2500\u2500\u2500\u2500 Private Endpoint        \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  (Private)  \u2502      10.0.0.2                \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502         \u2502                                      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502         \u2502 VPC Peering                          \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502         \u25bc                                      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502  Node 1  \u2502 \u2502  Node 2  \u2502 \u2502  Node 3  \u2502      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u250210.0.1.10 \u2502 \u250210.0.1.11 \u2502 \u250210.0.1.12 \u2502      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502 Private  \u2502 \u2502 Private  \u2502 \u2502 Private  \u2502      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                 \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502  Cloud NAT                                      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502  (Pour acc\u00e8s sortant : registries, APIs)        \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#32-creation-dun-private-cluster","title":"3.2 Cr\u00e9ation d'un Private Cluster","text":"<pre><code># Cr\u00e9er le Private Cluster\ngcloud container clusters create private-cluster \\\n    --region europe-west1 \\\n    --enable-private-nodes \\\n    --enable-private-endpoint \\\n    --master-ipv4-cidr 172.16.0.0/28 \\\n    --enable-ip-alias \\\n    --network my-vpc \\\n    --subnetwork my-subnet \\\n    --enable-master-authorized-networks \\\n    --master-authorized-networks 10.0.0.0/8,192.168.1.0/24\n\n# Options importantes :\n# --enable-private-nodes     : Nodes sans IP publique\n# --enable-private-endpoint  : API Server accessible uniquement en priv\u00e9\n# --master-ipv4-cidr        : CIDR pour le Control Plane (VPC Peering)\n# --master-authorized-networks : CIDRs autoris\u00e9s \u00e0 acc\u00e9der \u00e0 l'API\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#33-acces-au-private-cluster","title":"3.3 Acc\u00e8s au Private Cluster","text":"<p>Option 1 : Bastion Host (VM dans le VPC)</p> <pre><code># Cr\u00e9er une VM bastion\ngcloud compute instances create bastion \\\n    --zone europe-west1-b \\\n    --machine-type e2-micro \\\n    --network my-vpc \\\n    --subnet my-subnet \\\n    --scopes cloud-platform\n\n# Se connecter au bastion\ngcloud compute ssh bastion --zone europe-west1-b\n\n# Depuis le bastion, acc\u00e9der au cluster\ngcloud container clusters get-credentials private-cluster --region europe-west1\nkubectl get nodes\n</code></pre> <p>Option 2 : Cloud Shell avec Authorized Networks</p> <pre><code># Ajouter l'IP de Cloud Shell aux authorized networks\n# (N\u00e9cessite de mettre \u00e0 jour r\u00e9guli\u00e8rement car l'IP change)\ngcloud container clusters update private-cluster \\\n    --region europe-west1 \\\n    --enable-master-authorized-networks \\\n    --master-authorized-networks $(curl -s ifconfig.me)/32\n</code></pre> <p>Option 3 : VPN / Interconnect</p> <p>Pour les environnements de production, utilisez Cloud VPN ou Cloud Interconnect pour connecter votre r\u00e9seau on-premise au VPC GCP.</p>"},{"location":"formations/gcp-gke/02-security-iam/#34-cloud-nat-pour-lacces-sortant","title":"3.4 Cloud NAT pour l'Acc\u00e8s Sortant","text":"<p>Les nodes priv\u00e9s ont besoin de Cloud NAT pour acc\u00e9der \u00e0 Internet (pull d'images, APIs externes) :</p> <pre><code># Cr\u00e9er un Cloud Router\ngcloud compute routers create nat-router \\\n    --network my-vpc \\\n    --region europe-west1\n\n# Cr\u00e9er Cloud NAT\ngcloud compute routers nats create nat-config \\\n    --router nat-router \\\n    --region europe-west1 \\\n    --nat-all-subnet-ip-ranges \\\n    --auto-allocate-nat-external-ips\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#4-network-policies","title":"4. Network Policies","text":""},{"location":"formations/gcp-gke/02-security-iam/#41-concept","title":"4.1 Concept","text":"<p>Les Network Policies contr\u00f4lent le trafic r\u00e9seau entre pods au niveau L3/L4 :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              NETWORK POLICIES                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Sans Network Policy :                                         \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Pod A \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Pod B    \u2502   \u2502\n\u2502   \u2502     \u2502                                            \u2502      \u2502   \u2502\n\u2502   \u2502     \u2502           TOUT COMMUNIQUE                  \u2502      \u2502   \u2502\n\u2502   \u2502     \u2502          AVEC TOUT                         \u2502      \u2502   \u2502\n\u2502   \u2502     \u25bc                                            \u25bc      \u2502   \u2502\n\u2502   \u2502   Pod C \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Pod D    \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   Avec Network Policies (Zero Trust) :                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Frontend \u2500\u2500\u2500\u2500\u2500\u25ba API \u2500\u2500\u2500\u2500\u2500\u25ba Database                   \u2502   \u2502\n\u2502   \u2502      \u2502             \u2502             \u2502                      \u2502   \u2502\n\u2502   \u2502      \u2502             \u2502             \u2502                      \u2502   \u2502\n\u2502   \u2502      \u274c            \u274c            \u274c (pas d'acc\u00e8s direct) \u2502   \u2502\n\u2502   \u2502      \u2502             \u2502             \u2502                      \u2502   \u2502\n\u2502   \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                      \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Seules les communications EXPLICITES sont autoris\u00e9es  \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#42-activer-les-network-policies","title":"4.2 Activer les Network Policies","text":"<pre><code># Lors de la cr\u00e9ation du cluster\ngcloud container clusters create my-cluster \\\n    --region europe-west1 \\\n    --enable-network-policy\n\n# Sur un cluster existant\ngcloud container clusters update my-cluster \\\n    --region europe-west1 \\\n    --update-addons NetworkPolicy=ENABLED\n\n# Note: N\u00e9cessite un red\u00e9marrage des nodes\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#43-exemples-de-network-policies","title":"4.3 Exemples de Network Policies","text":"<p>Policy 1 : Deny All (Default)</p> <pre><code># Bloquer tout le trafic entrant par d\u00e9faut\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: default-deny-ingress\n  namespace: production\nspec:\n  podSelector: {}  # Appliqu\u00e9 \u00e0 tous les pods\n  policyTypes:\n  - Ingress\n</code></pre> <p>Policy 2 : Autoriser le Frontend vers l'API</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: allow-frontend-to-api\n  namespace: production\nspec:\n  podSelector:\n    matchLabels:\n      app: api\n  policyTypes:\n  - Ingress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          app: frontend\n    ports:\n    - protocol: TCP\n      port: 8080\n</code></pre> <p>Policy 3 : Autoriser l'API vers la Database</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: allow-api-to-database\n  namespace: production\nspec:\n  podSelector:\n    matchLabels:\n      app: database\n  policyTypes:\n  - Ingress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          app: api\n    ports:\n    - protocol: TCP\n      port: 5432\n</code></pre> <p>Policy 4 : Autoriser le monitoring</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: allow-prometheus-scrape\n  namespace: production\nspec:\n  podSelector:\n    matchLabels:\n      monitoring: enabled\n  policyTypes:\n  - Ingress\n  ingress:\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: monitoring\n      podSelector:\n        matchLabels:\n          app: prometheus\n    ports:\n    - protocol: TCP\n      port: 9090\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#44-tester-les-network-policies","title":"4.4 Tester les Network Policies","text":"<pre><code># Cr\u00e9er un pod de test\nkubectl run test-client --rm -it --restart=Never \\\n    --image=busybox \\\n    -n production \\\n    --labels=\"app=test\" \\\n    -- wget -q --timeout=2 -O- http://api:8080/health\n\n# Si la policy bloque : timeout\n# Si la policy autorise : r\u00e9ponse de l'API\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#5-bonnes-pratiques-securite-gke","title":"5. Bonnes Pratiques S\u00e9curit\u00e9 GKE","text":""},{"location":"formations/gcp-gke/02-security-iam/#51-checklist-securite","title":"5.1 Checklist S\u00e9curit\u00e9","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST S\u00c9CURIT\u00c9 GKE                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   CLUSTER                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   \u2610 Private Cluster activ\u00e9                                      \u2502\n\u2502   \u2610 Master Authorized Networks configur\u00e9                        \u2502\n\u2502   \u2610 Workload Identity activ\u00e9                                    \u2502\n\u2502   \u2610 Network Policies activ\u00e9es                                   \u2502\n\u2502   \u2610 Binary Authorization activ\u00e9 (production)                    \u2502\n\u2502   \u2610 Shielded GKE Nodes activ\u00e9s                                  \u2502\n\u2502                                                                 \u2502\n\u2502   NODES                                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2610 Container-Optimized OS (COS)                                \u2502\n\u2502   \u2610 Auto-upgrade activ\u00e9                                         \u2502\n\u2502   \u2610 Auto-repair activ\u00e9                                          \u2502\n\u2502   \u2610 Pas de Service Account par d\u00e9faut sur les nodes             \u2502\n\u2502                                                                 \u2502\n\u2502   WORKLOADS                                                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                    \u2502\n\u2502   \u2610 Pas de conteneurs privileged                                \u2502\n\u2502   \u2610 runAsNonRoot: true                                          \u2502\n\u2502   \u2610 readOnlyRootFilesystem: true                                \u2502\n\u2502   \u2610 Requests et Limits d\u00e9finis                                  \u2502\n\u2502   \u2610 Images depuis Artifact Registry (pas Docker Hub)            \u2502\n\u2502                                                                 \u2502\n\u2502   SECRETS                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2610 Secrets chiffr\u00e9s avec Cloud KMS                             \u2502\n\u2502   \u2610 Pas de secrets en clair dans les manifests                  \u2502\n\u2502   \u2610 Utiliser Secret Manager pour les secrets sensibles          \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#52-pod-security-standards","title":"5.2 Pod Security Standards","text":"<pre><code># Exemple de SecurityContext restrictif\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: secure-app\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: secure-app\n  template:\n    metadata:\n      labels:\n        app: secure-app\n    spec:\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1000\n        runAsGroup: 1000\n        fsGroup: 1000\n        seccompProfile:\n          type: RuntimeDefault\n      containers:\n      - name: app\n        image: europe-west1-docker.pkg.dev/my-project/repo/app:v1\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n        volumeMounts:\n        - name: tmp\n          mountPath: /tmp\n        - name: cache\n          mountPath: /app/cache\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: cache\n        emptyDir: {}\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#6-commandes-de-reference","title":"6. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === IAM ===\n# Voir les bindings IAM d'un projet\ngcloud projects get-iam-policy my-project\n\n# Ajouter un r\u00f4le GKE\ngcloud projects add-iam-policy-binding my-project \\\n    --member=\"user:dev@worldline.com\" \\\n    --role=\"roles/container.developer\"\n\n# === RBAC ===\n# Voir tous les RoleBindings\nkubectl get rolebindings,clusterrolebindings -A\n\n# Tester les permissions d'un utilisateur\nkubectl auth can-i create deployments --as=dev@worldline.com -n production\n\n# === WORKLOAD IDENTITY ===\n# V\u00e9rifier si activ\u00e9\ngcloud container clusters describe my-cluster \\\n    --region europe-west1 \\\n    --format=\"value(workloadIdentityConfig.workloadPool)\"\n\n# Lister les GSA li\u00e9s \u00e0 un KSA\nkubectl get serviceaccount my-ksa -n my-ns -o yaml | grep gcp-service-account\n\n# === NETWORK POLICIES ===\n# Lister les policies\nkubectl get networkpolicies -A\n\n# D\u00e9crire une policy\nkubectl describe networkpolicy allow-frontend-to-api -n production\n\n# === S\u00c9CURIT\u00c9 ===\n# V\u00e9rifier la configuration du cluster\ngcloud container clusters describe my-cluster \\\n    --region europe-west1 \\\n    --format=\"table(privateClusterConfig,masterAuthorizedNetworksConfig)\"\n</code></pre>"},{"location":"formations/gcp-gke/02-security-iam/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence entre GCP IAM et Kubernetes RBAC ? <p>R\u00e9ponse :</p> <ul> <li>GCP IAM : Contr\u00f4le qui peut acc\u00e9der au cluster (authentification et autorisation au niveau GCP)</li> <li>Kubernetes RBAC : Contr\u00f4le ce que l'utilisateur peut faire dans le cluster (autorisation au niveau K8s)</li> </ul> <p>Les deux fonctionnent ensemble : IAM donne l'acc\u00e8s, RBAC d\u00e9finit les permissions.</p> Question 2 : Pourquoi Workload Identity est-il pr\u00e9f\u00e9r\u00e9 aux cl\u00e9s JSON ? <p>R\u00e9ponse :</p> <p>Workload Identity offre plusieurs avantages :</p> <ol> <li>Pas de gestion de cl\u00e9s : Pas de rotation, pas de stockage s\u00e9curis\u00e9</li> <li>Tokens courts : Validit\u00e9 d'1 heure, renouvel\u00e9s automatiquement</li> <li>Audit : Tra\u00e7abilit\u00e9 compl\u00e8te dans Cloud Audit Logs</li> <li>R\u00e9vocation imm\u00e9diate : Modifier le binding IAM suffit</li> <li>Conformit\u00e9 : Requis pour SecNumCloud</li> </ol> Question 3 : Quand utiliser un Private Cluster ? <p>R\u00e9ponse :</p> <p>Un Private Cluster est recommand\u00e9 pour :</p> <ul> <li>Production : R\u00e9duire la surface d'attaque</li> <li>Conformit\u00e9 : Exigences SecNumCloud, GDPR</li> <li>Donn\u00e9es sensibles : PII, donn\u00e9es bancaires</li> <li>Workloads r\u00e9gul\u00e9s : Finance, sant\u00e9</li> </ul> <p>Note : Un Private Cluster n\u00e9cessite Cloud NAT pour l'acc\u00e8s sortant et un bastion ou VPN pour l'acc\u00e8s administratif.</p>"},{"location":"formations/gcp-gke/02-security-iam/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que votre cluster est s\u00e9curis\u00e9, d\u00e9couvrez comment g\u00e9rer le stockage et le r\u00e9seau.</p> <p>:octicons-arrow-right-24: Module 3 : Storage &amp; Networking</p> <p>Temps estim\u00e9 : 75 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/gcp-gke/03-storage-networking/","title":"Module 3 : Storage &amp; Networking","text":""},{"location":"formations/gcp-gke/03-storage-networking/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Configurer des StorageClasses (pd-standard, pd-ssd, pd-balanced)</li> <li>:material-check: Cr\u00e9er et utiliser des Persistent Volume Claims</li> <li>:material-check: Exposer des applications via Services et Ingress</li> <li>:material-check: Choisir entre GCE Ingress et Nginx Ingress</li> </ul>"},{"location":"formations/gcp-gke/03-storage-networking/#1-storage-dans-gke","title":"1. Storage dans GKE","text":""},{"location":"formations/gcp-gke/03-storage-networking/#11-architecture-de-stockage","title":"1.1 Architecture de Stockage","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE STORAGE GKE                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      Application                        \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Container \u2500\u2500\u2500\u2500\u2500\u25ba Volume Mount (/data)                 \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                          \u2502                                      \u2502\n\u2502                          \u2502 volumeMounts                         \u2502\n\u2502                          \u25bc                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Persistent Volume Claim (PVC)              \u2502   \u2502\n\u2502   \u2502              \"mon-app-data\" - 100Gi                     \u2502   \u2502\n\u2502   \u2502              StorageClass: pd-ssd                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                          \u2502                                      \u2502\n\u2502                          \u2502 Binding                              \u2502\n\u2502                          \u25bc                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Persistent Volume (PV)                     \u2502   \u2502\n\u2502   \u2502              Cr\u00e9\u00e9 dynamiquement par le provisioner      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                          \u2502                                      \u2502\n\u2502                          \u2502 CSI Driver                           \u2502\n\u2502                          \u25bc                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              Google Persistent Disk                     \u2502   \u2502\n\u2502   \u2502              (pd-ssd, pd-standard, pd-balanced)         \u2502   \u2502\n\u2502   \u2502              Zone: europe-west1-b                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#12-storageclasses-gke","title":"1.2 StorageClasses GKE","text":"<p>GKE fournit des StorageClasses pr\u00e9-configur\u00e9es :</p> StorageClass Type de Disque Performance Co\u00fbt Cas d'usage <code>standard</code> pd-standard (HDD) Low $ Logs, archives <code>standard-rwo</code> pd-balanced Medium $$ Workloads g\u00e9n\u00e9raux <code>premium-rwo</code> pd-ssd High $$$ Databases, caches <pre><code># Lister les StorageClasses disponibles\nkubectl get storageclasses\n\n# Voir les d\u00e9tails\nkubectl describe storageclass premium-rwo\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#13-creer-des-storageclasses-personnalisees","title":"1.3 Cr\u00e9er des StorageClasses Personnalis\u00e9es","text":"<pre><code># StorageClass SSD avec r\u00e9plication r\u00e9gionale\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: regional-ssd\nprovisioner: pd.csi.storage.gke.io\nparameters:\n  type: pd-ssd\n  replication-type: regional-pd\nvolumeBindingMode: WaitForFirstConsumer\nreclaimPolicy: Retain\nallowVolumeExpansion: true\n\n---\n# StorageClass pour snapshots\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: ssd-snapshot-capable\nprovisioner: pd.csi.storage.gke.io\nparameters:\n  type: pd-ssd\nvolumeBindingMode: WaitForFirstConsumer\nreclaimPolicy: Delete\nallowVolumeExpansion: true\n</code></pre> <p>Param\u00e8tres importants :</p> Param\u00e8tre Description <code>volumeBindingMode: WaitForFirstConsumer</code> Cr\u00e9e le disque dans la zone du pod (recommand\u00e9) <code>reclaimPolicy: Retain</code> Conserve le disque apr\u00e8s suppression du PVC <code>allowVolumeExpansion: true</code> Permet d'agrandir les volumes <code>replication-type: regional-pd</code> R\u00e9plication sur 2 zones (HA)"},{"location":"formations/gcp-gke/03-storage-networking/#14-persistent-volume-claims","title":"1.4 Persistent Volume Claims","text":"<pre><code># PVC pour une base de donn\u00e9es PostgreSQL\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: postgres-data\n  namespace: production\nspec:\n  accessModes:\n  - ReadWriteOnce  # Un seul node \u00e0 la fois\n  storageClassName: premium-rwo\n  resources:\n    requests:\n      storage: 100Gi\n</code></pre> <pre><code># PVC r\u00e9gional pour haute disponibilit\u00e9\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: postgres-data-ha\n  namespace: production\nspec:\n  accessModes:\n  - ReadWriteOnce\n  storageClassName: regional-ssd\n  resources:\n    requests:\n      storage: 100Gi\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#15-utilisation-dans-un-statefulset","title":"1.5 Utilisation dans un StatefulSet","text":"<pre><code>apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: postgres\n  namespace: production\nspec:\n  serviceName: postgres\n  replicas: 1\n  selector:\n    matchLabels:\n      app: postgres\n  template:\n    metadata:\n      labels:\n        app: postgres\n    spec:\n      containers:\n      - name: postgres\n        image: postgres:15\n        ports:\n        - containerPort: 5432\n        env:\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-secret\n              key: password\n        - name: PGDATA\n          value: /var/lib/postgresql/data/pgdata\n        volumeMounts:\n        - name: data\n          mountPath: /var/lib/postgresql/data\n        resources:\n          requests:\n            memory: \"1Gi\"\n            cpu: \"500m\"\n          limits:\n            memory: \"2Gi\"\n            cpu: \"1\"\n  volumeClaimTemplates:\n  - metadata:\n      name: data\n    spec:\n      accessModes: [\"ReadWriteOnce\"]\n      storageClassName: premium-rwo\n      resources:\n        requests:\n          storage: 100Gi\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#16-volume-snapshots","title":"1.6 Volume Snapshots","text":"<pre><code># Cr\u00e9er une VolumeSnapshotClass\napiVersion: snapshot.storage.k8s.io/v1\nkind: VolumeSnapshotClass\nmetadata:\n  name: pd-snapshot-class\ndriver: pd.csi.storage.gke.io\ndeletionPolicy: Delete\n\n---\n# Cr\u00e9er un snapshot\napiVersion: snapshot.storage.k8s.io/v1\nkind: VolumeSnapshot\nmetadata:\n  name: postgres-snapshot-20250128\n  namespace: production\nspec:\n  volumeSnapshotClassName: pd-snapshot-class\n  source:\n    persistentVolumeClaimName: postgres-data\n\n---\n# Restaurer depuis un snapshot\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: postgres-data-restored\n  namespace: production\nspec:\n  accessModes:\n  - ReadWriteOnce\n  storageClassName: premium-rwo\n  resources:\n    requests:\n      storage: 100Gi\n  dataSource:\n    name: postgres-snapshot-20250128\n    kind: VolumeSnapshot\n    apiGroup: snapshot.storage.k8s.io\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#2-networking-dans-gke","title":"2. Networking dans GKE","text":""},{"location":"formations/gcp-gke/03-storage-networking/#21-types-de-services","title":"2.1 Types de Services","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              TYPES DE SERVICES KUBERNETES                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ClusterIP (D\u00e9faut)                                            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                          \u2502\n\u2502   \u2502  Pod Client \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  Service    \u2502\u2500\u2500\u2500\u2500\u25ba Pods Backend        \u2502\n\u2502   \u2502  (interne)  \u2502     \u2502 10.2.0.100  \u2502                          \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                          \u2502\n\u2502   Accessible uniquement depuis le cluster                       \u2502\n\u2502                                                                 \u2502\n\u2502   NodePort                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502  External   \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  Node       \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  Service    \u2502\u2500\u2500\u25baPods\u2502\n\u2502   \u2502  Client     \u2502     \u2502 :30080      \u2502     \u2502 10.2.0.100  \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502   Port fixe (30000-32767) sur tous les nodes                   \u2502\n\u2502                                                                 \u2502\n\u2502   LoadBalancer                                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502  External   \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  GCP LB     \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  Service    \u2502\u2500\u2500\u25baPods\u2502\n\u2502   \u2502  Client     \u2502     \u250234.xxx.xxx   \u2502     \u2502 10.2.0.100  \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502   Cr\u00e9e un Network Load Balancer GCP                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#22-service-clusterip","title":"2.2 Service ClusterIP","text":"<pre><code># Service interne pour une API\napiVersion: v1\nkind: Service\nmetadata:\n  name: api-service\n  namespace: production\nspec:\n  type: ClusterIP  # D\u00e9faut, peut \u00eatre omis\n  selector:\n    app: api\n  ports:\n  - name: http\n    port: 80\n    targetPort: 8080\n  - name: grpc\n    port: 9090\n    targetPort: 9090\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#23-service-loadbalancer","title":"2.3 Service LoadBalancer","text":"<pre><code># Service avec Load Balancer externe\napiVersion: v1\nkind: Service\nmetadata:\n  name: frontend-lb\n  namespace: production\n  annotations:\n    # IP statique r\u00e9serv\u00e9e\n    networking.gke.io/load-balancer-type: \"External\"\nspec:\n  type: LoadBalancer\n  loadBalancerIP: 34.78.123.45  # IP r\u00e9serv\u00e9e via gcloud\n  selector:\n    app: frontend\n  ports:\n  - name: https\n    port: 443\n    targetPort: 8443\n\n---\n# Service Internal Load Balancer (ILB)\napiVersion: v1\nkind: Service\nmetadata:\n  name: internal-api\n  namespace: production\n  annotations:\n    networking.gke.io/load-balancer-type: \"Internal\"\nspec:\n  type: LoadBalancer\n  selector:\n    app: internal-api\n  ports:\n  - port: 80\n    targetPort: 8080\n</code></pre> <pre><code># R\u00e9server une IP externe statique\ngcloud compute addresses create frontend-ip \\\n    --region europe-west1\n\n# Voir l'IP r\u00e9serv\u00e9e\ngcloud compute addresses describe frontend-ip \\\n    --region europe-west1 \\\n    --format=\"value(address)\"\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#3-ingress-exposition-https","title":"3. Ingress : Exposition HTTP(S)","text":""},{"location":"formations/gcp-gke/03-storage-networking/#31-gce-ingress-vs-nginx-ingress","title":"3.1 GCE Ingress vs Nginx Ingress","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              COMPARAISON INGRESS CONTROLLERS                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   GCE INGRESS (Google Cloud Load Balancer)                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                     \u2502\n\u2502   \u2705 Manag\u00e9 par Google (pas de maintenance)                     \u2502\n\u2502   \u2705 Int\u00e9gration native GCP (Cloud Armor, Cloud CDN)            \u2502\n\u2502   \u2705 SSL g\u00e9r\u00e9 (Google-managed certificates)                     \u2502\n\u2502   \u2705 Global Load Balancing (Anycast IP)                         \u2502\n\u2502   \u274c Latence de propagation (2-5 minutes)                       \u2502\n\u2502   \u274c Co\u00fbt par r\u00e8gle de forwarding                               \u2502\n\u2502   \u274c Fonctionnalit\u00e9s avanc\u00e9es limit\u00e9es (rewrites, etc.)         \u2502\n\u2502                                                                 \u2502\n\u2502   NGINX INGRESS                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u2705 Tr\u00e8s flexible (rewrites, rate limiting, auth)              \u2502\n\u2502   \u2705 Propagation rapide des changements                         \u2502\n\u2502   \u2705 Familier pour les \u00e9quipes (m\u00eame config qu'on-prem)         \u2502\n\u2502   \u274c \u00c0 g\u00e9rer soi-m\u00eame (updates, scaling)                        \u2502\n\u2502   \u274c Pas d'int\u00e9gration Cloud Armor native                       \u2502\n\u2502   \u274c Network LB (L4), pas Global LB (L7)                        \u2502\n\u2502                                                                 \u2502\n\u2502   RECOMMANDATION WORLDLINE :                                    \u2502\n\u2502   \u2022 Production externe : GCE Ingress (Cloud Armor, SSL g\u00e9r\u00e9)    \u2502\n\u2502   \u2022 Interne/Microservices : Nginx Ingress (flexibilit\u00e9)         \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#32-gce-ingress-avec-certificat-gere","title":"3.2 GCE Ingress avec Certificat G\u00e9r\u00e9","text":"<pre><code># Ingress avec GCE et certificat Google-managed\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: main-ingress\n  namespace: production\n  annotations:\n    kubernetes.io/ingress.class: \"gce\"\n    kubernetes.io/ingress.global-static-ip-name: \"main-ingress-ip\"\n    networking.gke.io/managed-certificates: \"main-cert\"\nspec:\n  rules:\n  - host: app.worldline.com\n    http:\n      paths:\n      - path: /api/*\n        pathType: ImplementationSpecific\n        backend:\n          service:\n            name: api-service\n            port:\n              number: 80\n      - path: /*\n        pathType: ImplementationSpecific\n        backend:\n          service:\n            name: frontend-service\n            port:\n              number: 80\n\n---\n# Certificat SSL g\u00e9r\u00e9 par Google\napiVersion: networking.gke.io/v1\nkind: ManagedCertificate\nmetadata:\n  name: main-cert\n  namespace: production\nspec:\n  domains:\n  - app.worldline.com\n  - api.worldline.com\n\n---\n# R\u00e9server une IP globale\n# gcloud compute addresses create main-ingress-ip --global\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#33-nginx-ingress-controller","title":"3.3 Nginx Ingress Controller","text":"<pre><code># Installer Nginx Ingress Controller via Helm\nhelm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\nhelm repo update\n\nhelm install nginx-ingress ingress-nginx/ingress-nginx \\\n    --namespace ingress-nginx \\\n    --create-namespace \\\n    --set controller.service.type=LoadBalancer \\\n    --set controller.service.loadBalancerIP=34.78.123.100\n</code></pre> <pre><code># Ingress avec Nginx\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: app-ingress\n  namespace: production\n  annotations:\n    kubernetes.io/ingress.class: \"nginx\"\n    nginx.ingress.kubernetes.io/ssl-redirect: \"true\"\n    nginx.ingress.kubernetes.io/proxy-body-size: \"100m\"\n    nginx.ingress.kubernetes.io/rate-limit: \"100\"\n    nginx.ingress.kubernetes.io/rate-limit-window: \"1m\"\nspec:\n  tls:\n  - hosts:\n    - app.worldline.com\n    secretName: app-tls-secret\n  rules:\n  - host: app.worldline.com\n    http:\n      paths:\n      - path: /api\n        pathType: Prefix\n        backend:\n          service:\n            name: api-service\n            port:\n              number: 80\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: frontend-service\n            port:\n              number: 80\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#34-backend-config-pour-gce-ingress","title":"3.4 Backend Config pour GCE Ingress","text":"<pre><code># Configuration avanc\u00e9e du backend\napiVersion: cloud.google.com/v1\nkind: BackendConfig\nmetadata:\n  name: api-backend-config\n  namespace: production\nspec:\n  # Health checks personnalis\u00e9s\n  healthCheck:\n    checkIntervalSec: 15\n    timeoutSec: 5\n    healthyThreshold: 2\n    unhealthyThreshold: 3\n    type: HTTP\n    requestPath: /health\n    port: 8080\n\n  # Cloud CDN\n  cdn:\n    enabled: true\n    cachePolicy:\n      includeHost: true\n      includeProtocol: true\n      includeQueryString: false\n\n  # Cloud Armor (WAF)\n  securityPolicy:\n    name: \"waf-policy\"\n\n  # Connection draining\n  connectionDraining:\n    drainingTimeoutSec: 30\n\n  # Session affinity\n  sessionAffinity:\n    affinityType: \"GENERATED_COOKIE\"\n    affinityCookieTtlSec: 3600\n\n---\n# Associer le BackendConfig au Service\napiVersion: v1\nkind: Service\nmetadata:\n  name: api-service\n  namespace: production\n  annotations:\n    cloud.google.com/backend-config: '{\"default\": \"api-backend-config\"}'\nspec:\n  selector:\n    app: api\n  ports:\n  - port: 80\n    targetPort: 8080\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#4-flux-de-trafic-complet","title":"4. Flux de Trafic Complet","text":""},{"location":"formations/gcp-gke/03-storage-networking/#41-diagramme-de-flux","title":"4.1 Diagramme de Flux","text":"<pre><code>flowchart TB\n    subgraph Internet\n        User[Utilisateur&lt;br/&gt;app.worldline.com]\n    end\n\n    subgraph GCP[\"Google Cloud Platform\"]\n        subgraph GLB[\"Global HTTP(S) Load Balancer\"]\n            GCLB[Cloud Load Balancer&lt;br/&gt;IP: 34.xxx.xxx.xxx]\n            SSL[SSL Termination&lt;br/&gt;Managed Certificate]\n            CDN[Cloud CDN&lt;br/&gt;Cache]\n            WAF[Cloud Armor&lt;br/&gt;WAF Rules]\n        end\n\n        subgraph GKE[\"Cluster GKE\"]\n            ING[Ingress Resource]\n\n            subgraph Services\n                SVC1[frontend-service&lt;br/&gt;ClusterIP]\n                SVC2[api-service&lt;br/&gt;ClusterIP]\n            end\n\n            subgraph Pods\n                FE1[Frontend Pod 1]\n                FE2[Frontend Pod 2]\n                API1[API Pod 1]\n                API2[API Pod 2]\n            end\n        end\n\n        subgraph Storage\n            DB[(Cloud SQL&lt;br/&gt;PostgreSQL)]\n            GCS[Cloud Storage&lt;br/&gt;Buckets]\n        end\n    end\n\n    User --&gt;|HTTPS| GCLB\n    GCLB --&gt; SSL\n    SSL --&gt; WAF\n    WAF --&gt; CDN\n    CDN --&gt; ING\n    ING --&gt;|path: /*| SVC1\n    ING --&gt;|path: /api/*| SVC2\n    SVC1 --&gt; FE1\n    SVC1 --&gt; FE2\n    SVC2 --&gt; API1\n    SVC2 --&gt; API2\n    API1 --&gt; DB\n    API2 --&gt; GCS</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#42-configuration-complete","title":"4.2 Configuration Compl\u00e8te","text":"<pre><code># === NAMESPACE ===\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: production\n  labels:\n    name: production\n\n---\n# === FRONTEND ===\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\n  namespace: production\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: frontend\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: frontend\n        image: europe-west1-docker.pkg.dev/my-project/repo/frontend:v1\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            cpu: \"100m\"\n            memory: \"128Mi\"\n          limits:\n            cpu: \"500m\"\n            memory: \"256Mi\"\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 5\n          periodSeconds: 10\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: frontend-service\n  namespace: production\nspec:\n  selector:\n    app: frontend\n  ports:\n  - port: 80\n    targetPort: 80\n\n---\n# === API ===\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api\n  namespace: production\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: api\n  template:\n    metadata:\n      labels:\n        app: api\n    spec:\n      serviceAccountName: api-ksa\n      containers:\n      - name: api\n        image: europe-west1-docker.pkg.dev/my-project/repo/api:v1\n        ports:\n        - containerPort: 8080\n        env:\n        - name: DB_HOST\n          value: \"10.0.2.50\"  # Cloud SQL Private IP\n        - name: PROJECT_ID\n          value: \"my-project\"\n        resources:\n          requests:\n            cpu: \"250m\"\n            memory: \"256Mi\"\n          limits:\n            cpu: \"1\"\n            memory: \"512Mi\"\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 15\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: api-service\n  namespace: production\n  annotations:\n    cloud.google.com/backend-config: '{\"default\": \"api-backend-config\"}'\n    cloud.google.com/neg: '{\"ingress\": true}'\nspec:\n  selector:\n    app: api\n  ports:\n  - port: 80\n    targetPort: 8080\n\n---\n# === INGRESS ===\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: main-ingress\n  namespace: production\n  annotations:\n    kubernetes.io/ingress.class: \"gce\"\n    kubernetes.io/ingress.global-static-ip-name: \"main-ingress-ip\"\n    networking.gke.io/managed-certificates: \"main-cert\"\nspec:\n  rules:\n  - host: app.worldline.com\n    http:\n      paths:\n      - path: /api/*\n        pathType: ImplementationSpecific\n        backend:\n          service:\n            name: api-service\n            port:\n              number: 80\n      - path: /*\n        pathType: ImplementationSpecific\n        backend:\n          service:\n            name: frontend-service\n            port:\n              number: 80\n\n---\napiVersion: networking.gke.io/v1\nkind: ManagedCertificate\nmetadata:\n  name: main-cert\n  namespace: production\nspec:\n  domains:\n  - app.worldline.com\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#5-commandes-de-reference","title":"5. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === STORAGE ===\n# Lister les StorageClasses\nkubectl get storageclasses\n\n# Lister les PVC\nkubectl get pvc -A\n\n# Voir les PV\nkubectl get pv\n\n# Agrandir un PVC (si allowVolumeExpansion: true)\nkubectl patch pvc postgres-data -n production \\\n    -p '{\"spec\":{\"resources\":{\"requests\":{\"storage\":\"200Gi\"}}}}'\n\n# Cr\u00e9er un snapshot\nkubectl apply -f volume-snapshot.yaml\n\n# === SERVICES ===\n# Lister les services\nkubectl get svc -A\n\n# Voir l'IP externe d'un LoadBalancer\nkubectl get svc frontend-lb -n production -o jsonpath='{.status.loadBalancer.ingress[0].ip}'\n\n# === INGRESS ===\n# Lister les Ingress\nkubectl get ingress -A\n\n# Voir les d\u00e9tails d'un Ingress\nkubectl describe ingress main-ingress -n production\n\n# V\u00e9rifier le statut du certificat\nkubectl describe managedcertificate main-cert -n production\n\n# === DEBUG R\u00c9SEAU ===\n# Tester la connectivit\u00e9 depuis un pod\nkubectl run test --rm -it --restart=Never \\\n    --image=busybox \\\n    -n production \\\n    -- wget -q -O- http://api-service/health\n\n# Voir les endpoints d'un service\nkubectl get endpoints api-service -n production\n\n# DNS debug\nkubectl run dns-test --rm -it --restart=Never \\\n    --image=busybox \\\n    -n production \\\n    -- nslookup api-service.production.svc.cluster.local\n</code></pre>"},{"location":"formations/gcp-gke/03-storage-networking/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle StorageClass utiliser pour une base de donn\u00e9es critique ? <p>R\u00e9ponse :</p> <p>Pour une base de donn\u00e9es critique, utilisez :</p> <ul> <li><code>premium-rwo</code> (pd-ssd) pour les performances</li> <li>Ou cr\u00e9ez une StorageClass personnalis\u00e9e avec <code>replication-type: regional-pd</code> pour la haute disponibilit\u00e9</li> </ul> <p>Configurez \u00e9galement : - <code>reclaimPolicy: Retain</code> pour conserver les donn\u00e9es apr\u00e8s suppression du PVC - <code>allowVolumeExpansion: true</code> pour pouvoir agrandir le volume</p> Question 2 : Quand utiliser GCE Ingress vs Nginx Ingress ? <p>R\u00e9ponse :</p> <p>GCE Ingress (recommand\u00e9 pour) : - Exposition publique avec SSL g\u00e9r\u00e9 par Google - Besoin de Cloud Armor (WAF) - Besoin de Cloud CDN - Global Load Balancing (Anycast IP)</p> <p>Nginx Ingress (recommand\u00e9 pour) : - R\u00e8gles complexes (rewrites, redirections) - Rate limiting avanc\u00e9 - Coh\u00e9rence avec l'environnement on-premise - Propagation rapide des changements</p> Question 3 : Comment exposer un service uniquement en interne au VPC ? <p>R\u00e9ponse :</p> <p>Utilisez un Internal Load Balancer :</p> <pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: internal-api\n  annotations:\n    networking.gke.io/load-balancer-type: \"Internal\"\nspec:\n  type: LoadBalancer\n  selector:\n    app: api\n  ports:\n  - port: 80\n</code></pre> <p>L'IP attribu\u00e9e sera une IP priv\u00e9e du VPC, accessible uniquement depuis le VPC ou via VPN/Interconnect.</p>"},{"location":"formations/gcp-gke/03-storage-networking/#conclusion-de-la-formation","title":"Conclusion de la Formation","text":"<p>Vous avez maintenant les bases pour op\u00e9rer GKE de mani\u00e8re s\u00e9curis\u00e9e et efficace :</p> <ul> <li>Module 1 : Architecture (Zonal vs R\u00e9gional, VPC-Native, Node Pools)</li> <li>Module 2 : S\u00e9curit\u00e9 (IAM, RBAC, Workload Identity, Network Policies)</li> <li>Module 3 : Storage &amp; Networking (StorageClasses, Ingress)</li> </ul>"},{"location":"formations/gcp-gke/03-storage-networking/#prochaines-etapes-recommandees","title":"Prochaines \u00c9tapes Recommand\u00e9es","text":"<ol> <li>Cr\u00e9er un cluster de test avec les configurations apprises</li> <li>Impl\u00e9menter Workload Identity sur vos applications</li> <li>Configurer des Network Policies pour le zero-trust</li> <li>Explorer Cloud Armor, Binary Authorization, Config Connector</li> </ol>"},{"location":"formations/gcp-gke/03-storage-networking/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<ul> <li>:material-link: GKE Best Practices</li> <li>:material-link: GKE Security Hardening Guide</li> <li>:material-link: GKE Networking Overview</li> </ul> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/gitops-argocd/","title":"Formation : GitOps avec ArgoCD","text":""},{"location":"formations/gitops-argocd/#introduction","title":"Introduction","text":"<p>ClickOps is dead. Long live GitOps.</p> <p>Le GitOps repr\u00e9sente l'\u00e9volution naturelle du DevOps : Git devient la source unique de v\u00e9rit\u00e9 pour l'infrastructure ET les applications. Plus de <code>kubectl apply</code> manuel, plus de d\u00e9ploiements depuis un laptop, plus de \"\u00e7a marchait sur ma machine\".</p> <p>Ce que vous allez apprendre</p> <p>Cette formation vous transformera d'un op\u00e9rateur Kubernetes classique en un GitOps Practitioner capable de :</p> <ul> <li>D\u00e9ployer des centaines de microservices de mani\u00e8re d\u00e9clarative</li> <li>Auditer chaque changement via l'historique Git</li> <li>Rollback en 30 secondes avec <code>git revert</code></li> <li>Dormir tranquille pendant les d\u00e9ploiements en production</li> </ul>"},{"location":"formations/gitops-argocd/#le-probleme-push-based-deployments","title":"Le Probl\u00e8me : Push-Based Deployments","text":""},{"location":"formations/gitops-argocd/#larchitecture-traditionnelle-cicd-push","title":"L'Architecture Traditionnelle (CI/CD Push)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE PUSH (ANTI-PATTERN)                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502 D\u00e9veloppeur \u2502\u2500\u2500\u2500\u2500\u25ba\u2502   GitLab    \u2502\u2500\u2500\u2500\u2500\u25ba\u2502  CI Runner  \u2502      \u2502\n\u2502   \u2502             \u2502     \u2502    Repo     \u2502     \u2502             \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                                                  \u2502              \u2502\n\u2502                                                  \u2502 kubectl      \u2502\n\u2502                                                  \u2502 apply        \u2502\n\u2502                                                  \u2502              \u2502\n\u2502                                                  \u25bc              \u2502\n\u2502                                           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n\u2502                                           \u2502             \u2502       \u2502\n\u2502                                           \u2502  Cluster    \u2502       \u2502\n\u2502                                           \u2502  Kubernetes \u2502       \u2502\n\u2502                                           \u2502             \u2502       \u2502\n\u2502                                           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  PROBL\u00c8MES DE S\u00c9CURIT\u00c9 :                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                     \u2502\n\u2502   \u2022 Le Runner a un kubeconfig avec acc\u00e8s cluster-admin         \u2502\n\u2502   \u2022 Ce kubeconfig est stock\u00e9 dans les variables CI              \u2502\n\u2502   \u2022 Tout d\u00e9veloppeur avec acc\u00e8s aux variables CI = admin K8s    \u2502\n\u2502   \u2022 Si le Runner est compromis = Game Over                      \u2502\n\u2502   \u2022 Les credentials sortent du cluster (exposition externe)     \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  PROBL\u00c8MES OP\u00c9RATIONNELS :                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                    \u2502\n\u2502   \u2022 Pas de visibilit\u00e9 sur l'\u00e9tat r\u00e9el du cluster               \u2502\n\u2502   \u2022 Drift possible (modifs manuelles non track\u00e9es)              \u2502\n\u2502   \u2022 Rollback = relancer un vieux pipeline (lent, risqu\u00e9)        \u2502\n\u2502   \u2022 \"\u00c7a a march\u00e9\" != \"C'est d\u00e9ploy\u00e9 correctement\"               \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/#le-risque-concret","title":"Le Risque Concret","text":"<pre><code># .gitlab-ci.yml typique (PROBL\u00c9MATIQUE)\ndeploy:\n  stage: deploy\n  script:\n    - kubectl apply -f manifests/\n  variables:\n    KUBECONFIG: $KUBE_CONFIG  # \u2190 Secret stock\u00e9 dans GitLab\n  only:\n    - main\n</code></pre> <p>Pourquoi c'est dangereux</p> <ol> <li>Surface d'attaque \u00e9largie : Le kubeconfig (avec des droits cluster-admin) est stock\u00e9 dans GitLab/Jenkins</li> <li>Lateral Movement : Un attaquant qui compromet le CI peut pivoter vers le cluster</li> <li>Credentials long-lived : Le token ne expire souvent jamais</li> <li>Pas d'audit Kubernetes : Les actions sont faites par un Service Account g\u00e9n\u00e9rique</li> <li>Blast radius maximum : Un runner compromis = tous les clusters accessibles</li> </ol>"},{"location":"formations/gitops-argocd/#la-solution-pull-based-deployments-gitops","title":"La Solution : Pull-Based Deployments (GitOps)","text":""},{"location":"formations/gitops-argocd/#loperateur-gitops","title":"L'Op\u00e9rateur GitOps","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE GITOPS (PULL-BASED)                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                          \u2502\n\u2502   \u2502 D\u00e9veloppeur \u2502\u2500\u2500\u2500\u2500\u25ba\u2502   GitLab    \u2502                          \u2502\n\u2502   \u2502             \u2502     \u2502    Repo     \u2502                          \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                          \u2502\n\u2502                              \u2502                                  \u2502\n\u2502                              \u2502 Webhook / Poll                   \u2502\n\u2502                              \u2502                                  \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502         CLUSTER KUBERNETES                              \u2502   \u2502\n\u2502   \u2502                          \u2502                              \u2502   \u2502\n\u2502   \u2502                          \u25bc                              \u2502   \u2502\n\u2502   \u2502                   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502   \u2502\n\u2502   \u2502                   \u2502             \u2502                       \u2502   \u2502\n\u2502   \u2502                   \u2502   ArgoCD    \u2502\u25c4\u2500\u2500\u2500\u2500 PULL (pas PUSH)  \u2502   \u2502\n\u2502   \u2502                   \u2502  Operator   \u2502                       \u2502   \u2502\n\u2502   \u2502                   \u2502             \u2502                       \u2502   \u2502\n\u2502   \u2502                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502   \u2502\n\u2502   \u2502                          \u2502                              \u2502   \u2502\n\u2502   \u2502            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502   \u2502\n\u2502   \u2502            \u2502             \u2502             \u2502               \u2502   \u2502\n\u2502   \u2502            \u25bc             \u25bc             \u25bc               \u2502   \u2502\n\u2502   \u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502   \u2502\n\u2502   \u2502      \u2502 App API  \u2502  \u2502 App Web  \u2502  \u2502 App DB   \u2502         \u2502   \u2502\n\u2502   \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 AVANTAGES S\u00c9CURIT\u00c9 :                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502   \u2022 Aucun credential externe (tout reste dans le cluster)      \u2502\n\u2502   \u2022 ArgoCD a uniquement les droits n\u00e9cessaires (RBAC)          \u2502\n\u2502   \u2022 Audit complet via Git history                               \u2502\n\u2502   \u2022 Pas d'acc\u00e8s kubectl depuis l'ext\u00e9rieur                     \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 AVANTAGES OP\u00c9RATIONNELS :                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502   \u2022 \u00c9tat d\u00e9sir\u00e9 = Git, \u00c9tat r\u00e9el = visible dans ArgoCD         \u2502\n\u2502   \u2022 Drift d\u00e9tect\u00e9 automatiquement                               \u2502\n\u2502   \u2022 Rollback = git revert + push                                \u2502\n\u2502   \u2022 Self-healing : retour automatique \u00e0 l'\u00e9tat Git              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/#le-principe-gitops-en-4-points","title":"Le Principe GitOps en 4 Points","text":"Principe Description D\u00e9claratif L'\u00e9tat d\u00e9sir\u00e9 est d\u00e9crit dans Git (YAML, Helm, Kustomize) Versionn\u00e9 Tout changement passe par un commit Git (audit trail) Pull Automatique L'op\u00e9rateur d\u00e9tecte et applique les changements R\u00e9conciliation Continue L'\u00e9tat r\u00e9el converge vers l'\u00e9tat d\u00e9sir\u00e9"},{"location":"formations/gitops-argocd/#pourquoi-argocd","title":"Pourquoi ArgoCD ?","text":""},{"location":"formations/gitops-argocd/#comparaison-des-outils-gitops","title":"Comparaison des Outils GitOps","text":"Crit\u00e8re ArgoCD Flux CD Jenkins X UI Web Excellente Basique Moyenne Multi-cluster Natif Via Kustomize Complexe Courbe d'apprentissage Faible Moyenne \u00c9lev\u00e9e CRD Kubernetes Application GitRepository + Kustomization Nombreux RBAC int\u00e9gr\u00e9 Oui (Dex/OIDC) Via K8s RBAC Oui Rollback 1 clic Git revert Git revert Adoption Leader (CNCF Graduated) Populaire (CNCF) En d\u00e9clin <p>Choix Worldline : ArgoCD</p> <p>ArgoCD est le standard de facto pour le GitOps en entreprise :</p> <ul> <li>CNCF Graduated (m\u00eame niveau que Kubernetes)</li> <li>UI intuitive pour les \u00e9quipes Ops</li> <li>SSO int\u00e9gr\u00e9 (OIDC, LDAP, SAML)</li> <li>Multi-tenant natif</li> <li>\u00c9cosyst\u00e8me riche (Image Updater, Rollouts, Notifications)</li> </ul>"},{"location":"formations/gitops-argocd/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 3 modules :</p>"},{"location":"formations/gitops-argocd/#module-1-architecture-argocd","title":"Module 1 : Architecture ArgoCD","text":"<p>:material-view-dashboard: Les Composants | :material-clock-outline: ~45 min</p> <ul> <li>Application Controller, Repo Server, API Server</li> <li>Le Dashboard Web</li> <li>Flux de synchronisation</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/gitops-argocd/#module-2-app-of-apps","title":"Module 2 : App of Apps","text":"<p>:material-apps: Industrialisation | :material-clock-outline: ~60 min</p> <ul> <li>Pattern \"App of Apps\"</li> <li>Gestion de centaines de microservices</li> <li>ApplicationSets</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/gitops-argocd/#module-3-strategies-de-sync","title":"Module 3 : Strat\u00e9gies de Sync","text":"<p>:material-sync: Op\u00e9rations | :material-clock-outline: ~60 min</p> <ul> <li>Auto-Sync vs Manual</li> <li>Sync Waves (ordre de d\u00e9ploiement)</li> <li>Self-Healing</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/gitops-argocd/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>Kubernetes : Deployments, Services, Namespaces, RBAC</li> <li>Git : Branches, commits, pull requests</li> <li>YAML : Syntaxe, manifests Kubernetes</li> <li>Helm (recommand\u00e9) : Charts, values, templates</li> <li>Formation GKE : Cluster op\u00e9rationnel</li> </ul>"},{"location":"formations/gitops-argocd/#installation-argocd","title":"Installation ArgoCD","text":"Installation RapideInstallation Production (Helm)CLI ArgoCD <pre><code># Cr\u00e9er le namespace\nkubectl create namespace argocd\n\n# Installer ArgoCD\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\n\n# Attendre que les pods soient pr\u00eats\nkubectl wait --for=condition=Ready pods --all -n argocd --timeout=300s\n\n# R\u00e9cup\u00e9rer le mot de passe admin initial\nkubectl -n argocd get secret argocd-initial-admin-secret \\\n    -o jsonpath=\"{.data.password}\" | base64 -d\n</code></pre> <pre><code># Ajouter le repo Helm\nhelm repo add argo https://argoproj.github.io/argo-helm\nhelm repo update\n\n# Installer avec des valeurs personnalis\u00e9es\nhelm install argocd argo/argo-cd \\\n    --namespace argocd \\\n    --create-namespace \\\n    --values values-prod.yaml\n</code></pre> <pre><code># values-prod.yaml\nserver:\n  replicas: 2\n  ingress:\n    enabled: true\n    ingressClassName: nginx\n    hosts:\n      - argocd.worldline.internal\n    tls:\n      - secretName: argocd-tls\n        hosts:\n          - argocd.worldline.internal\n\ncontroller:\n  replicas: 2\n\nrepoServer:\n  replicas: 2\n\ndex:\n  enabled: true\n\nconfigs:\n  cm:\n    url: https://argocd.worldline.internal\n    dex.config: |\n      connectors:\n        - type: oidc\n          id: google\n          name: Google\n          config:\n            issuer: https://accounts.google.com\n            clientID: $GOOGLE_CLIENT_ID\n            clientSecret: $GOOGLE_CLIENT_SECRET\n</code></pre> <pre><code># macOS\nbrew install argocd\n\n# Linux\ncurl -sSL -o argocd https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64\nchmod +x argocd\nsudo mv argocd /usr/local/bin/\n\n# Login\nargocd login argocd.worldline.internal --sso\n\n# V\u00e9rifier\nargocd version\n</code></pre>"},{"location":"formations/gitops-argocd/#gitops-workflow-worldline","title":"GitOps Workflow Worldline","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              WORKFLOW GITOPS WORLDLINE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    D\u00c9VELOPPEUR                          \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   1. Modifie le code applicatif                         \u2502   \u2502\n\u2502   \u2502   2. Push sur feature branch                            \u2502   \u2502\n\u2502   \u2502   3. CI build &amp; test                                    \u2502   \u2502\n\u2502   \u2502   4. CI push image vers Artifact Registry               \u2502   \u2502\n\u2502   \u2502   5. CI met \u00e0 jour le tag image dans le repo GitOps     \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    REPOS GIT                            \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   app-code/          (Code applicatif)                  \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500 src/, Dockerfile, tests...                        \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   gitops-manifests/   (\u00c9tat d\u00e9sir\u00e9 K8s)                 \u2502   \u2502\n\u2502   \u2502   \u251c\u2500\u2500 apps/                                             \u2502   \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 frontend/                                     \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 base/                                     \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 overlays/                                 \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502       \u251c\u2500\u2500 dev/                                  \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502       \u251c\u2500\u2500 staging/                              \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502       \u2514\u2500\u2500 prod/                                 \u2502   \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 backend/                                      \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500 argocd/                                           \u2502   \u2502\n\u2502   \u2502       \u2514\u2500\u2500 applications.yaml                             \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u2502 Poll / Webhook                        \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    ARGOCD                               \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   D\u00e9tecte : \"Le repo Git a chang\u00e9 !\"                    \u2502   \u2502\n\u2502   \u2502   Compare : \u00c9tat Git vs \u00c9tat Cluster                    \u2502   \u2502\n\u2502   \u2502   Action : Sync (apply les diff\u00e9rences)                 \u2502   \u2502\n\u2502   \u2502   V\u00e9rifie : Health checks passent                       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    CLUSTERS GKE                         \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502   \u2502\n\u2502   \u2502   \u2502   DEV   \u2502   \u2502 STAGING \u2502   \u2502  PROD   \u2502              \u2502   \u2502\n\u2502   \u2502   \u2502         \u2502   \u2502         \u2502   \u2502         \u2502              \u2502   \u2502\n\u2502   \u2502   \u2502Auto-Sync\u2502   \u2502Auto-Sync\u2502   \u2502 Manual  \u2502              \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/#les-commandements-du-gitops","title":"Les Commandements du GitOps","text":"<p>Les 5 Commandements GitOps</p> <ol> <li> <p>Tu ne feras point de <code>kubectl apply</code> manuel    \u2192 Tout passe par Git</p> </li> <li> <p>Tu ne modifieras point les ressources directement dans le cluster    \u2192 ArgoCD les remettra \u00e0 l'\u00e9tat Git (Self-Heal)</p> </li> <li> <p>Tu s\u00e9pareras le code applicatif des manifests de d\u00e9ploiement    \u2192 Deux repos distincts (ou deux dossiers)</p> </li> <li> <p>Tu utiliseras des tags d'images immutables    \u2192 Pas de <code>latest</code>, utilisez <code>v1.2.3</code> ou <code>sha256:...</code></p> </li> <li> <p>Tu revieweras les changements de manifests comme du code    \u2192 PR review obligatoire sur le repo GitOps</p> </li> </ol>"},{"location":"formations/gitops-argocd/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/gitops-argocd/#documentation-officielle","title":"Documentation Officielle","text":"<ul> <li>:material-link: ArgoCD Documentation</li> <li>:material-link: ArgoCD Best Practices</li> <li>:material-link: GitOps Principles</li> </ul>"},{"location":"formations/gitops-argocd/#outils-de-lecosysteme","title":"Outils de l'\u00c9cosyst\u00e8me","text":"Outil Usage Lien <code>argocd</code> CLI ArgoCD Installation <code>Argo Rollouts</code> Canary, Blue-Green deployments Docs <code>Argo Image Updater</code> MAJ automatique des tags d'images Docs <code>Argo Notifications</code> Alertes Slack/Teams/Email Docs <code>Kustomize</code> Overlays pour multi-env Docs <code>Helm</code> Packaging d'applications Docs <p>Philosophie GitOps</p> <p>\"Git is the source of truth for both infrastructure and applications. Operations are performed by making commits to a Git repository, which an automated process then applies to the infrastructure.\"</p> <p>\u2014 Weaveworks (Inventeurs du terme GitOps)</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Cloud Team</p>"},{"location":"formations/gitops-argocd/01-architecture/","title":"Module 1 : Architecture ArgoCD","text":""},{"location":"formations/gitops-argocd/01-architecture/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre le r\u00f4le de chaque composant ArgoCD</li> <li>:material-check: Expliquer le flux de synchronisation</li> <li>:material-check: Naviguer dans l'interface Web</li> <li>:material-check: Utiliser la CLI ArgoCD</li> </ul>"},{"location":"formations/gitops-argocd/01-architecture/#1-les-composants-argocd","title":"1. Les Composants ArgoCD","text":""},{"location":"formations/gitops-argocd/01-architecture/#11-vue-densemble","title":"1.1 Vue d'Ensemble","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE ARGOCD                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Namespace: argocd                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502   \u2502  \u2502   API Server    \u2502\u25c4\u2500\u2500\u2500\u2500\u2502   Dex (SSO)     \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502                 \u2502     \u2502                 \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 REST API     \u2502     \u2502  \u2022 OIDC         \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 gRPC API     \u2502     \u2502  \u2022 LDAP         \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 Web UI       \u2502     \u2502  \u2022 SAML         \u2502           \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502   \u2502           \u2502                                             \u2502   \u2502\n\u2502   \u2502           \u2502 Requ\u00eates                                    \u2502   \u2502\n\u2502   \u2502           \u25bc                                             \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502   \u2502  \u2502  Application    \u2502\u25c4\u2500\u2500\u2500\u2500\u2502   Repo Server   \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  Controller     \u2502     \u2502                 \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502                 \u2502     \u2502  \u2022 Clone repos  \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 R\u00e9concilie   \u2502     \u2502  \u2022 Helm render  \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 Sync         \u2502     \u2502  \u2022 Kustomize    \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  \u2022 Health check \u2502     \u2502  \u2022 Cache        \u2502           \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502   \u2502           \u2502                       \u2502                     \u2502   \u2502\n\u2502   \u2502           \u2502                       \u2502 Clone               \u2502   \u2502\n\u2502   \u2502           \u25bc                       \u25bc                     \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502   \u2502  \u2502  Redis          \u2502     \u2502   Git Repos     \u2502           \u2502   \u2502\n\u2502   \u2502  \u2502  (Cache)        \u2502     \u2502   (External)    \u2502           \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502               CLUSTER(S) CIBLE(S)                       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   ArgoCD peut g\u00e9rer :                                   \u2502   \u2502\n\u2502   \u2502   \u2022 Le cluster local (in-cluster)                       \u2502   \u2502\n\u2502   \u2502   \u2022 Des clusters distants (multi-cluster)               \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#12-api-server","title":"1.2 API Server","text":"<p>Le cerveau d'ArgoCD, il expose :</p> Interface Port Usage REST API 443 Int\u00e9grations, Webhooks gRPC API 443 CLI <code>argocd</code>, performance Web UI 443 Dashboard pour les Ops <pre><code># Pods du API Server\nkubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server\n\n# Logs\nkubectl logs -n argocd -l app.kubernetes.io/name=argocd-server -f\n</code></pre> <p>Responsabilit\u00e9s :</p> <ul> <li>Authentification des utilisateurs (SSO via Dex)</li> <li>Autorisation (RBAC ArgoCD)</li> <li>Gestion des Applications, Projects, Repos</li> <li>Servir l'interface Web</li> </ul>"},{"location":"formations/gitops-argocd/01-architecture/#13-application-controller","title":"1.3 Application Controller","text":"<p>Le c\u0153ur du GitOps, il ex\u00e9cute la boucle de r\u00e9conciliation :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              BOUCLE DE R\u00c9CONCILIATION                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502                                                          \u2502  \u2502\n\u2502   \u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                           \u2502  \u2502\n\u2502   \u2502    \u2502 OBSERVE \u2502 \u25c4\u2500\u2500\u2500 Surveille les Applications CRDs      \u2502  \u2502\n\u2502   \u2502    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                           \u2502  \u2502\n\u2502   \u2502         \u2502                                                \u2502  \u2502\n\u2502   \u2502         \u25bc                                                \u2502  \u2502\n\u2502   \u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                           \u2502  \u2502\n\u2502   \u2502    \u2502 COMPARE \u2502 \u25c4\u2500\u2500\u2500 \u00c9tat Git vs \u00c9tat Cluster             \u2502  \u2502\n\u2502   \u2502    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                           \u2502  \u2502\n\u2502   \u2502         \u2502                                                \u2502  \u2502\n\u2502   \u2502         \u25bc                                                \u2502  \u2502\n\u2502   \u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                           \u2502  \u2502\n\u2502   \u2502    \u2502  DIFF?  \u2502                                           \u2502  \u2502\n\u2502   \u2502    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518                                           \u2502  \u2502\n\u2502   \u2502         \u2502                                                \u2502  \u2502\n\u2502   \u2502    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510                                           \u2502  \u2502\n\u2502   \u2502    \u2502         \u2502                                           \u2502  \u2502\n\u2502   \u2502   OUI       NON                                          \u2502  \u2502\n\u2502   \u2502    \u2502         \u2502                                           \u2502  \u2502\n\u2502   \u2502    \u25bc         \u25bc                                           \u2502  \u2502\n\u2502   \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                      \u2502  \u2502\n\u2502   \u2502 \u2502 SYNC \u2502  \u2502 WAIT  \u2502 \u25c4\u2500\u2500\u2500 Attendre le prochain cycle     \u2502  \u2502\n\u2502   \u2502 \u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      (3 minutes par d\u00e9faut)          \u2502  \u2502\n\u2502   \u2502    \u2502                                                     \u2502  \u2502\n\u2502   \u2502    \u25bc                                                     \u2502  \u2502\n\u2502   \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                              \u2502  \u2502\n\u2502   \u2502 \u2502 HEALTH  \u2502 \u25c4\u2500\u2500\u2500 V\u00e9rifier que les ressources sont OK    \u2502  \u2502\n\u2502   \u2502 \u2502 CHECK   \u2502                                              \u2502  \u2502\n\u2502   \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                              \u2502  \u2502\n\u2502   \u2502                                                          \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                 \u2502\n\u2502   Fr\u00e9quence de r\u00e9conciliation : configurable (default 3min)     \u2502\n\u2502   Webhook Git : sync imm\u00e9diat sur push                          \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># Pods du Controller\nkubectl get pods -n argocd -l app.kubernetes.io/name=argocd-application-controller\n\n# Voir les m\u00e9triques\nkubectl port-forward svc/argocd-application-controller -n argocd 8082:8082\ncurl http://localhost:8082/metrics\n</code></pre> <p>Responsabilit\u00e9s :</p> <ul> <li>R\u00e9conciliation continue (Git \u2192 Cluster)</li> <li>D\u00e9tection de drift</li> <li>Health checks des ressources d\u00e9ploy\u00e9es</li> <li>Gestion des Sync Waves et Hooks</li> </ul>"},{"location":"formations/gitops-argocd/01-architecture/#14-repo-server","title":"1.4 Repo Server","text":"<p>Le cache intelligent des repositories Git :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              REPO SERVER PIPELINE                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Git Repo                                                      \u2502\n\u2502      \u2502                                                          \u2502\n\u2502      \u2502 Clone/Fetch                                              \u2502\n\u2502      \u25bc                                                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    REPO SERVER                          \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   1. Clone le repo (ou fetch les updates)               \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   2. D\u00e9tecte le type de manifest :                      \u2502   \u2502\n\u2502   \u2502      \u251c\u2500\u2500 Plain YAML    \u2192 Retourne tel quel             \u2502   \u2502\n\u2502   \u2502      \u251c\u2500\u2500 Kustomize     \u2192 kustomize build               \u2502   \u2502\n\u2502   \u2502      \u251c\u2500\u2500 Helm          \u2192 helm template                 \u2502   \u2502\n\u2502   \u2502      \u251c\u2500\u2500 Jsonnet       \u2192 jsonnet                       \u2502   \u2502\n\u2502   \u2502      \u2514\u2500\u2500 Custom Plugin \u2192 Execute plugin                \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   3. Cache le r\u00e9sultat (performance)                    \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502      \u2502                                                          \u2502\n\u2502      \u2502 Manifests YAML rendus                                    \u2502\n\u2502      \u25bc                                                          \u2502\n\u2502   Application Controller                                        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># Pods du Repo Server\nkubectl get pods -n argocd -l app.kubernetes.io/name=argocd-repo-server\n\n# Voir les repos configur\u00e9s\nargocd repo list\n</code></pre> <p>Responsabilit\u00e9s :</p> <ul> <li>Clone et mise \u00e0 jour des repos Git</li> <li>Rendu des manifests (Helm, Kustomize, Jsonnet)</li> <li>Cache pour \u00e9viter les clones r\u00e9p\u00e9t\u00e9s</li> <li>Gestion des credentials Git</li> </ul>"},{"location":"formations/gitops-argocd/01-architecture/#15-dex-optional-sso","title":"1.5 Dex (Optional, SSO)","text":"<p>Dex est un Identity Provider qui permet l'authentification SSO :</p> <pre><code># Configuration Dex pour Google OIDC\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: argocd-cm\n  namespace: argocd\ndata:\n  dex.config: |\n    connectors:\n      - type: oidc\n        id: google\n        name: Google Workspace\n        config:\n          issuer: https://accounts.google.com\n          clientID: $GOOGLE_CLIENT_ID\n          clientSecret: $GOOGLE_CLIENT_SECRET\n          redirectURI: https://argocd.worldline.internal/api/dex/callback\n          hostedDomains:\n            - worldline.com\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#2-le-dashboard-web","title":"2. Le Dashboard Web","text":""},{"location":"formations/gitops-argocd/01-architecture/#21-pourquoi-les-ops-ladorent","title":"2.1 Pourquoi les Ops l'Adorent","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARGOCD WEB UI                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  \ud83c\udfe0 Applications                     \ud83d\udc64 admin \u25bc   \ud83d\udd14    \u2502   \u2502\n\u2502   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502   \u2502\n\u2502   \u2502  \u2502 \ud83d\udfe2 frontend \u2502 \u2502 \ud83d\udfe2 backend  \u2502 \u2502 \ud83d\udfe1 database \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502             \u2502 \u2502             \u2502 \u2502             \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 Synced      \u2502 \u2502 Synced      \u2502 \u2502 Progressing\u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 Healthy     \u2502 \u2502 Healthy     \u2502 \u2502 Degraded   \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502             \u2502 \u2502             \u2502 \u2502             \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 v2.3.1      \u2502 \u2502 v1.8.0      \u2502 \u2502 v5.4.2     \u2502       \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502   \u2502\n\u2502   \u2502  \u2502 \ud83d\udd34 payment  \u2502 \u2502 \ud83d\udfe2 auth     \u2502 \u2502 \ud83d\udfe2 logging  \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502             \u2502 \u2502             \u2502 \u2502             \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 OutOfSync   \u2502 \u2502 Synced      \u2502 \u2502 Synced      \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 Missing     \u2502 \u2502 Healthy     \u2502 \u2502 Healthy     \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502             \u2502 \u2502             \u2502 \u2502             \u2502       \u2502   \u2502\n\u2502   \u2502  \u2502 v3.0.0      \u2502 \u2502 v2.1.0      \u2502 \u2502 v1.0.5     \u2502       \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   L\u00e9gende :                                                     \u2502\n\u2502   \ud83d\udfe2 Synced + Healthy : Parfait                                \u2502\n\u2502   \ud83d\udfe1 Progressing : D\u00e9ploiement en cours                        \u2502\n\u2502   \ud83d\udd34 OutOfSync : Git \u2260 Cluster (action requise)                \u2502\n\u2502   \ud83d\udd34 Degraded/Missing : Probl\u00e8me de sant\u00e9                      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#22-vue-detaillee-dune-application","title":"2.2 Vue D\u00e9taill\u00e9e d'une Application","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u2190 Applications    frontend                    \ud83d\udd04 Sync  \u2699\ufe0f      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502  Status: \ud83d\udfe2 Synced    Health: \ud83d\udfe2 Healthy    Revision: abc123   \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                    RESOURCE TREE                         \u2502   \u2502\n\u2502  \u2502                                                          \u2502   \u2502\n\u2502  \u2502   \ud83d\udce6 frontend (Application)                              \u2502   \u2502\n\u2502  \u2502   \u2502                                                      \u2502   \u2502\n\u2502  \u2502   \u251c\u2500\u2500 \ud83d\udccb frontend (Deployment) \ud83d\udfe2                       \u2502   \u2502\n\u2502  \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udce6 frontend-7d8f9c6b4-xxxxx (Pod) \ud83d\udfe2          \u2502   \u2502\n\u2502  \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udce6 frontend-7d8f9c6b4-yyyyy (Pod) \ud83d\udfe2          \u2502   \u2502\n\u2502  \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udce6 frontend-7d8f9c6b4-zzzzz (Pod) \ud83d\udfe2          \u2502   \u2502\n\u2502  \u2502   \u2502                                                      \u2502   \u2502\n\u2502  \u2502   \u251c\u2500\u2500 \ud83d\udd0c frontend (Service) \ud83d\udfe2                          \u2502   \u2502\n\u2502  \u2502   \u2502                                                      \u2502   \u2502\n\u2502  \u2502   \u251c\u2500\u2500 \ud83c\udf10 frontend (Ingress) \ud83d\udfe2                          \u2502   \u2502\n\u2502  \u2502   \u2502                                                      \u2502   \u2502\n\u2502  \u2502   \u251c\u2500\u2500 \ud83d\udcc4 frontend-config (ConfigMap) \ud83d\udfe2                 \u2502   \u2502\n\u2502  \u2502   \u2502                                                      \u2502   \u2502\n\u2502  \u2502   \u2514\u2500\u2500 \ud83d\udd10 frontend-secret (Secret) \ud83d\udfe2                    \u2502   \u2502\n\u2502  \u2502                                                          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502Summary\u2502 \u2502 Diff   \u2502 \u2502Parameters\u2502 \u2502 Events  \u2502 \u2502 Manifest \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#23-acceder-au-dashboard","title":"2.3 Acc\u00e9der au Dashboard","text":"<pre><code># Option 1 : Port-forward (dev/debug)\nkubectl port-forward svc/argocd-server -n argocd 8080:443\n# Acc\u00e9der \u00e0 https://localhost:8080\n\n# Option 2 : Ingress (production)\n# Configur\u00e9 dans le Helm chart\n\n# R\u00e9cup\u00e9rer le mot de passe admin initial\nkubectl -n argocd get secret argocd-initial-admin-secret \\\n    -o jsonpath=\"{.data.password}\" | base64 -d &amp;&amp; echo\n\n# Changer le mot de passe admin\nargocd account update-password\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#3-flux-de-synchronisation","title":"3. Flux de Synchronisation","text":""},{"location":"formations/gitops-argocd/01-architecture/#31-diagramme-de-flux-complet","title":"3.1 Diagramme de Flux Complet","text":"<pre><code>sequenceDiagram\n    participant Dev as D\u00e9veloppeur\n    participant Git as Git Repository\n    participant Argo as ArgoCD\n    participant K8s as Cluster GKE\n\n    Dev-&gt;&gt;Git: 1. git push (manifests modifi\u00e9s)\n\n    alt Webhook configur\u00e9\n        Git-&gt;&gt;Argo: 2a. Webhook POST /api/webhook\n        Argo-&gt;&gt;Git: 3a. Fetch imm\u00e9diat\n    else Polling (default 3min)\n        loop Toutes les 3 minutes\n            Argo-&gt;&gt;Git: 2b. Poll for changes\n        end\n    end\n\n    Argo-&gt;&gt;Argo: 4. Repo Server: Render manifests&lt;br/&gt;(Helm/Kustomize/YAML)\n\n    Argo-&gt;&gt;K8s: 5. Compare: \u00c9tat Git vs \u00c9tat Cluster\n\n    alt Diff\u00e9rences d\u00e9tect\u00e9es\n        Argo-&gt;&gt;Argo: 6. Status: OutOfSync\n\n        alt Auto-Sync activ\u00e9\n            Argo-&gt;&gt;K8s: 7a. kubectl apply automatique\n        else Manual Sync\n            Note over Argo: Attendre action utilisateur\n            Dev-&gt;&gt;Argo: 7b. Click \"Sync\" ou argocd sync\n            Argo-&gt;&gt;K8s: 8. kubectl apply\n        end\n\n        K8s--&gt;&gt;Argo: 9. Ressources cr\u00e9\u00e9es/modifi\u00e9es\n\n        loop Health Check\n            Argo-&gt;&gt;K8s: 10. V\u00e9rifier sant\u00e9 des pods\n            K8s--&gt;&gt;Argo: Status des ressources\n        end\n\n        Argo-&gt;&gt;Argo: 11. Status: Synced + Healthy\n    else Aucune diff\u00e9rence\n        Argo-&gt;&gt;Argo: Status: Synced (d\u00e9j\u00e0 \u00e0 jour)\n    end</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#32-etats-dune-application","title":"3.2 \u00c9tats d'une Application","text":"Sync Status Description Action Synced Git = Cluster Aucune OutOfSync Git \u2260 Cluster Sync n\u00e9cessaire Unknown Impossible de d\u00e9terminer V\u00e9rifier la connexion Health Status Description Action Healthy Toutes les ressources sont OK Aucune Progressing D\u00e9ploiement en cours Attendre Degraded Certaines ressources en \u00e9chec Investiguer Suspended Ressources suspendues (scaling \u00e0 0) Normal si voulu Missing Ressources attendues absentes Sync"},{"location":"formations/gitops-argocd/01-architecture/#4-cli-argocd","title":"4. CLI ArgoCD","text":""},{"location":"formations/gitops-argocd/01-architecture/#41-commandes-essentielles","title":"4.1 Commandes Essentielles","text":"<pre><code># === CONNEXION ===\n# Login avec SSO\nargocd login argocd.worldline.internal --sso\n\n# Login avec mot de passe\nargocd login argocd.worldline.internal --username admin --password $ARGOCD_PASSWORD\n\n# V\u00e9rifier la connexion\nargocd account get-user-info\n\n# === APPLICATIONS ===\n# Lister les applications\nargocd app list\n\n# Voir le statut d'une app\nargocd app get frontend\n\n# Voir les diff\u00e9rences (ce qui sera appliqu\u00e9)\nargocd app diff frontend\n\n# Synchroniser une application\nargocd app sync frontend\n\n# Sync avec prune (supprimer les ressources orphelines)\nargocd app sync frontend --prune\n\n# Forcer le sync (ignorer les hooks)\nargocd app sync frontend --force\n\n# Rollback \u00e0 une r\u00e9vision pr\u00e9c\u00e9dente\nargocd app rollback frontend 3\n\n# Voir l'historique des d\u00e9ploiements\nargocd app history frontend\n\n# === REPOS ===\n# Ajouter un repo\nargocd repo add https://github.com/worldline/gitops-manifests.git \\\n    --username $GIT_USER \\\n    --password $GIT_TOKEN\n\n# Lister les repos\nargocd repo list\n\n# === CLUSTERS ===\n# Lister les clusters\nargocd cluster list\n\n# Ajouter un cluster distant\nargocd cluster add gke_project_region_cluster-name\n\n# === DEBUG ===\n# Logs d'une application\nargocd app logs frontend\n\n# Ressources d'une application\nargocd app resources frontend\n\n# Manifests rendus\nargocd app manifests frontend\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#42-creation-dune-application-via-cli","title":"4.2 Cr\u00e9ation d'une Application via CLI","text":"<pre><code># Cr\u00e9er une application\nargocd app create frontend \\\n    --repo https://github.com/worldline/gitops-manifests.git \\\n    --path apps/frontend/overlays/prod \\\n    --dest-server https://kubernetes.default.svc \\\n    --dest-namespace production \\\n    --sync-policy automated \\\n    --auto-prune \\\n    --self-heal\n\n# \u00c9quivalent YAML (recommand\u00e9)\nargocd app create -f - &lt;&lt;EOF\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: frontend\n  namespace: argocd\nspec:\n  project: default\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main\n    path: apps/frontend/overlays/prod\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: production\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\nEOF\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#5-custom-resource-application","title":"5. Custom Resource : Application","text":""},{"location":"formations/gitops-argocd/01-architecture/#51-structure-complete","title":"5.1 Structure Compl\u00e8te","text":"<pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: frontend\n  namespace: argocd\n  # Annotations utiles\n  annotations:\n    notifications.argoproj.io/subscribe.on-sync-succeeded.slack: deployments\n  # Finalizer pour le nettoyage\n  finalizers:\n    - resources-finalizer.argocd.argoproj.io\nspec:\n  # Projet ArgoCD (isolation)\n  project: production\n\n  # Source : o\u00f9 trouver les manifests\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main  # Branch, tag, ou commit SHA\n    path: apps/frontend/overlays/prod\n\n    # Pour Helm\n    # helm:\n    #   valueFiles:\n    #     - values.yaml\n    #     - values-prod.yaml\n    #   parameters:\n    #     - name: image.tag\n    #       value: v2.3.1\n\n    # Pour Kustomize\n    # kustomize:\n    #   images:\n    #     - frontend=gcr.io/project/frontend:v2.3.1\n\n  # Destination : o\u00f9 d\u00e9ployer\n  destination:\n    server: https://kubernetes.default.svc  # In-cluster\n    # Ou pour un cluster distant :\n    # server: https://gke-prod-cluster.example.com\n    namespace: production\n\n  # Politique de synchronisation\n  syncPolicy:\n    # Sync automatique\n    automated:\n      prune: true      # Supprimer les ressources orphelines\n      selfHeal: true   # Corriger le drift automatiquement\n      allowEmpty: false # Ne pas sync si aucun manifest\n\n    # Options de sync\n    syncOptions:\n      - CreateNamespace=true\n      - PrunePropagationPolicy=foreground\n      - PruneLast=true\n\n    # Retry en cas d'\u00e9chec\n    retry:\n      limit: 5\n      backoff:\n        duration: 5s\n        factor: 2\n        maxDuration: 3m\n\n  # Ignorer certaines diff\u00e9rences\n  ignoreDifferences:\n    - group: apps\n      kind: Deployment\n      jsonPointers:\n        - /spec/replicas  # Ignor\u00e9 si HPA actif\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#6-commandes-de-reference","title":"6. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === INSTALLATION ===\n# Installer ArgoCD\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\n\n# R\u00e9cup\u00e9rer le mot de passe initial\nkubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=\"{.data.password}\" | base64 -d\n\n# === PODS ARGOCD ===\n# Voir les pods\nkubectl get pods -n argocd\n\n# Logs du controller\nkubectl logs -n argocd -l app.kubernetes.io/name=argocd-application-controller -f\n\n# Logs du repo server\nkubectl logs -n argocd -l app.kubernetes.io/name=argocd-repo-server -f\n\n# === APPLICATIONS ===\n# Lister les CRD Application\nkubectl get applications -n argocd\n\n# D\u00e9crire une application\nkubectl describe application frontend -n argocd\n\n# Voir les events\nkubectl get events -n argocd --sort-by='.lastTimestamp'\n\n# === TROUBLESHOOTING ===\n# Forcer un refresh\nargocd app get frontend --refresh\n\n# Hard refresh (re-clone le repo)\nargocd app get frontend --hard-refresh\n\n# Voir les manifests g\u00e9n\u00e9r\u00e9s\nargocd app manifests frontend --source live  # \u00c9tat actuel cluster\nargocd app manifests frontend --source git   # \u00c9tat Git\n</code></pre>"},{"location":"formations/gitops-argocd/01-architecture/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quel composant est responsable du rendu des charts Helm ? <p>R\u00e9ponse :</p> <p>Le Repo Server est responsable de :</p> <ol> <li>Cloner les repositories Git</li> <li>D\u00e9tecter le type de manifest (Helm, Kustomize, plain YAML)</li> <li>Ex\u00e9cuter <code>helm template</code> pour rendre les charts</li> <li>Cacher le r\u00e9sultat pour la performance</li> </ol> <p>L'Application Controller re\u00e7oit ensuite les manifests YAML rendus et les applique au cluster.</p> Question 2 : Quelle est la diff\u00e9rence entre OutOfSync et Degraded ? <p>R\u00e9ponse :</p> Status Type Signification OutOfSync Sync Status L'\u00e9tat Git \u2260 l'\u00e9tat Cluster. Action : Sync n\u00e9cessaire Degraded Health Status Les ressources sont d\u00e9ploy\u00e9es mais en mauvaise sant\u00e9 (pods en CrashLoopBackOff, etc.) <p>Une application peut \u00eatre : - Synced + Degraded : D\u00e9ploy\u00e9e mais cass\u00e9e (bug applicatif) - OutOfSync + Healthy : Fonctionne mais pas \u00e0 jour (modifs manuelles non commit\u00e9es)</p> Question 3 : Comment forcer ArgoCD \u00e0 re-cloner un repository ? <p>R\u00e9ponse :</p> <p>Utilisez l'option <code>--hard-refresh</code> :</p> <pre><code>argocd app get frontend --hard-refresh\n</code></pre> <p>Cela force le Repo Server \u00e0 : 1. Invalider le cache 2. Refaire un <code>git clone</code> complet 3. Re-rendre tous les manifests</p> <p>Utile si le cache est corrompu ou apr\u00e8s avoir modifi\u00e9 les credentials du repo.</p>"},{"location":"formations/gitops-argocd/01-architecture/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que vous comprenez l'architecture, apprenez \u00e0 industrialiser la gestion de nombreuses applications.</p> <p>:octicons-arrow-right-24: Module 2 : App of Apps</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/gitops-argocd/02-app-of-apps/","title":"Module 2 : App of Apps","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre le probl\u00e8me de la gestion \u00e0 l'\u00e9chelle</li> <li>:material-check: Impl\u00e9menter le pattern \"App of Apps\"</li> <li>:material-check: Cr\u00e9er des Applications pointant vers des Helm Charts</li> <li>:material-check: Utiliser les ApplicationSets pour l'automatisation</li> </ul>"},{"location":"formations/gitops-argocd/02-app-of-apps/#1-le-probleme-gerer-50-microservices","title":"1. Le Probl\u00e8me : G\u00e9rer 50+ Microservices","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#11-lapproche-naive","title":"1.1 L'Approche Na\u00efve","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              L'ENFER DE LA GESTION MANUELLE                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Situation : 50 microservices \u00e0 d\u00e9ployer sur 3 environnements  \u2502\n\u2502                                                                 \u2502\n\u2502   Approche manuelle :                                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                           \u2502\n\u2502                                                                 \u2502\n\u2502   $ argocd app create frontend-dev ...                          \u2502\n\u2502   $ argocd app create frontend-staging ...                      \u2502\n\u2502   $ argocd app create frontend-prod ...                         \u2502\n\u2502   $ argocd app create backend-dev ...                           \u2502\n\u2502   $ argocd app create backend-staging ...                       \u2502\n\u2502   $ argocd app create backend-prod ...                          \u2502\n\u2502   $ argocd app create auth-dev ...                              \u2502\n\u2502   ... (x 150 commandes) ...                                     \u2502\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8MES :                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                    \u2502\n\u2502   \u274c 150 Applications \u00e0 cr\u00e9er manuellement                      \u2502\n\u2502   \u274c Pas de version control des Applications elles-m\u00eames        \u2502\n\u2502   \u274c Inconsistance entre environnements                         \u2502\n\u2502   \u274c Ajout d'un nouveau service = 3 nouvelles Applications      \u2502\n\u2502   \u274c Modification d'une policy = 150 updates                    \u2502\n\u2502   \u274c \"Qui a cr\u00e9\u00e9 cette Application ? Quand ?\"                   \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udc80 CE N'EST PAS SCALABLE                                      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#12-le-paradoxe","title":"1.2 Le Paradoxe","text":"<p>\"On utilise GitOps pour versionner nos d\u00e9ploiements... mais les Applications ArgoCD elles-m\u00eames ne sont pas versionn\u00e9es ?\"</p> <p>Solution : Les Applications ArgoCD sont des ressources Kubernetes. Elles peuvent donc \u00eatre stock\u00e9es dans Git et d\u00e9ploy\u00e9es... par ArgoCD !</p>"},{"location":"formations/gitops-argocd/02-app-of-apps/#2-le-pattern-app-of-apps","title":"2. Le Pattern \"App of Apps\"","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#21-concept","title":"2.1 Concept","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PATTERN APP OF APPS                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    ROOT APPLICATION                     \u2502   \u2502\n\u2502   \u2502                    \"apps-of-apps\"                       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Source: gitops-manifests/argocd/                      \u2502   \u2502\n\u2502   \u2502   Path: applications/                                   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                            \u2502                                    \u2502\n\u2502                            \u2502 D\u00e9ploie des Applications           \u2502\n\u2502                            \u2502                                    \u2502\n\u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502           \u2502                \u2502                \u2502                   \u2502\n\u2502           \u25bc                \u25bc                \u25bc                   \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502   \u2502  Application  \u2502 \u2502  Application  \u2502 \u2502  Application  \u2502        \u2502\n\u2502   \u2502   frontend    \u2502 \u2502   backend     \u2502 \u2502   database    \u2502        \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2502           \u2502                 \u2502                 \u2502                 \u2502\n\u2502           \u2502 D\u00e9ploie         \u2502 D\u00e9ploie         \u2502 D\u00e9ploie         \u2502\n\u2502           \u2502 des Pods        \u2502 des Pods        \u2502 des Pods        \u2502\n\u2502           \u25bc                 \u25bc                 \u25bc                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502   \u2502  Deployment   \u2502 \u2502  Deployment   \u2502 \u2502  StatefulSet  \u2502        \u2502\n\u2502   \u2502  Service      \u2502 \u2502  Service      \u2502 \u2502  Service      \u2502        \u2502\n\u2502   \u2502  Ingress      \u2502 \u2502  ConfigMap    \u2502 \u2502  PVC          \u2502        \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2502                                                                 \u2502\n\u2502   HI\u00c9RARCHIE :                                                  \u2502\n\u2502   \u2022 Niveau 0 : Root App (g\u00e8re les Applications)                 \u2502\n\u2502   \u2022 Niveau 1 : Applications (g\u00e8rent les workloads)              \u2502\n\u2502   \u2022 Niveau 2 : Workloads (Pods, Services, etc.)                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#22-structure-du-repository-gitops","title":"2.2 Structure du Repository GitOps","text":"<pre><code>gitops-manifests/\n\u2502\n\u251c\u2500\u2500 argocd/                          # Configuration ArgoCD\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 root-app.yaml                # L'Application Root (App of Apps)\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 applications/                # Applications enfants\n\u2502       \u251c\u2500\u2500 frontend.yaml            # Application CRD\n\u2502       \u251c\u2500\u2500 backend.yaml             # Application CRD\n\u2502       \u251c\u2500\u2500 auth-service.yaml        # Application CRD\n\u2502       \u251c\u2500\u2500 payment-service.yaml     # Application CRD\n\u2502       \u2514\u2500\u2500 ...                      # 50+ Applications\n\u2502\n\u251c\u2500\u2500 apps/                            # Manifests des applications\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 frontend/\n\u2502   \u2502   \u251c\u2500\u2500 base/                    # Kustomize base\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 deployment.yaml\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 service.yaml\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 kustomization.yaml\n\u2502   \u2502   \u2514\u2500\u2500 overlays/\n\u2502   \u2502       \u251c\u2500\u2500 dev/\n\u2502   \u2502       \u251c\u2500\u2500 staging/\n\u2502   \u2502       \u2514\u2500\u2500 prod/\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 backend/\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 database/\n\u2502       \u2514\u2500\u2500 ...\n\u2502\n\u2514\u2500\u2500 charts/                          # Helm Charts customs\n    \u251c\u2500\u2500 common-app/\n    \u2514\u2500\u2500 common-job/\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#3-implementation-complete","title":"3. Impl\u00e9mentation Compl\u00e8te","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#31-lapplication-root","title":"3.1 L'Application Root","text":"<pre><code># argocd/root-app.yaml\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: root-apps\n  namespace: argocd\n  finalizers:\n    - resources-finalizer.argocd.argoproj.io\nspec:\n  project: default\n\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main\n    path: argocd/applications  # \u2190 Dossier contenant les Application CRDs\n\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: argocd  # Les Applications vivent dans le namespace argocd\n\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n    syncOptions:\n      - CreateNamespace=false\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#32-application-enfant-plain-yaml-kustomize","title":"3.2 Application Enfant (Plain YAML / Kustomize)","text":"<pre><code># argocd/applications/frontend.yaml\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: frontend\n  namespace: argocd\n  labels:\n    team: platform\n    env: prod\n  annotations:\n    notifications.argoproj.io/subscribe.on-sync-failed.slack: alerts\n  finalizers:\n    - resources-finalizer.argocd.argoproj.io\nspec:\n  project: production\n\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main\n    path: apps/frontend/overlays/prod\n\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: frontend\n\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n    syncOptions:\n      - CreateNamespace=true\n      - PruneLast=true\n    retry:\n      limit: 3\n      backoff:\n        duration: 5s\n        factor: 2\n        maxDuration: 1m\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#33-application-avec-helm-chart","title":"3.3 Application avec Helm Chart","text":"<pre><code># argocd/applications/backend.yaml\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: backend\n  namespace: argocd\n  labels:\n    team: backend\n    env: prod\n  finalizers:\n    - resources-finalizer.argocd.argoproj.io\nspec:\n  project: production\n\n  source:\n    # Chart depuis un repo Git\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main\n    path: charts/backend\n\n    helm:\n      # Fichiers de values (ordre important)\n      valueFiles:\n        - values.yaml\n        - values-prod.yaml\n\n      # Override de param\u00e8tres sp\u00e9cifiques\n      parameters:\n        - name: image.tag\n          value: \"v2.3.1\"\n        - name: replicaCount\n          value: \"5\"\n\n      # Ignorer les CRDs (si d\u00e9j\u00e0 install\u00e9s)\n      skipCrds: false\n\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: backend\n\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n    syncOptions:\n      - CreateNamespace=true\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#34-application-avec-helm-chart-depuis-registry","title":"3.4 Application avec Helm Chart depuis Registry","text":"<pre><code># argocd/applications/nginx-ingress.yaml\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: nginx-ingress\n  namespace: argocd\n  finalizers:\n    - resources-finalizer.argocd.argoproj.io\nspec:\n  project: infrastructure\n\n  source:\n    # Chart depuis un Helm Registry\n    repoURL: https://kubernetes.github.io/ingress-nginx\n    chart: ingress-nginx\n    targetRevision: 4.8.3  # Version du chart\n\n    helm:\n      releaseName: nginx-ingress\n      values: |\n        controller:\n          replicaCount: 3\n          service:\n            type: LoadBalancer\n            loadBalancerIP: 34.78.123.100\n          resources:\n            requests:\n              cpu: 100m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 256Mi\n          metrics:\n            enabled: true\n            serviceMonitor:\n              enabled: true\n\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: ingress-nginx\n\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n    syncOptions:\n      - CreateNamespace=true\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#4-applicationsets-lautomatisation-ultime","title":"4. ApplicationSets : L'Automatisation Ultime","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#41-le-probleme-restant","title":"4.1 Le Probl\u00e8me Restant","text":"<p>M\u00eame avec App of Apps, cr\u00e9er 50 fichiers <code>frontend-dev.yaml</code>, <code>frontend-staging.yaml</code>, <code>frontend-prod.yaml</code>... reste fastidieux.</p> <p>Solution : ApplicationSet g\u00e9n\u00e8re automatiquement des Applications \u00e0 partir de templates.</p>"},{"location":"formations/gitops-argocd/02-app-of-apps/#42-generateur-list","title":"4.2 G\u00e9n\u00e9rateur List","text":"<pre><code># argocd/applicationsets/environments.yaml\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: frontend-environments\n  namespace: argocd\nspec:\n  generators:\n    - list:\n        elements:\n          - env: dev\n            cluster: https://dev-cluster.example.com\n            replicas: \"1\"\n          - env: staging\n            cluster: https://staging-cluster.example.com\n            replicas: \"2\"\n          - env: prod\n            cluster: https://kubernetes.default.svc\n            replicas: \"5\"\n\n  template:\n    metadata:\n      name: \"frontend-{{env}}\"\n      namespace: argocd\n      labels:\n        app: frontend\n        env: \"{{env}}\"\n    spec:\n      project: \"{{env}}\"\n      source:\n        repoURL: https://github.com/worldline/gitops-manifests.git\n        targetRevision: main\n        path: \"apps/frontend/overlays/{{env}}\"\n      destination:\n        server: \"{{cluster}}\"\n        namespace: frontend\n      syncPolicy:\n        automated:\n          prune: true\n          selfHeal: true\n        syncOptions:\n          - CreateNamespace=true\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#43-generateur-git-directory","title":"4.3 G\u00e9n\u00e9rateur Git Directory","text":"<pre><code># argocd/applicationsets/all-apps.yaml\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: all-applications\n  namespace: argocd\nspec:\n  generators:\n    # G\u00e9n\u00e8re une Application pour chaque dossier dans apps/\n    - git:\n        repoURL: https://github.com/worldline/gitops-manifests.git\n        revision: main\n        directories:\n          - path: \"apps/*/overlays/prod\"\n\n  template:\n    metadata:\n      # {{path[1]}} = nom du dossier (frontend, backend, etc.)\n      name: \"{{path[1]}}\"\n      namespace: argocd\n    spec:\n      project: production\n      source:\n        repoURL: https://github.com/worldline/gitops-manifests.git\n        targetRevision: main\n        path: \"{{path}}\"\n      destination:\n        server: https://kubernetes.default.svc\n        namespace: \"{{path[1]}}\"\n      syncPolicy:\n        automated:\n          prune: true\n          selfHeal: true\n        syncOptions:\n          - CreateNamespace=true\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#44-generateur-matrix-combinaisons","title":"4.4 G\u00e9n\u00e9rateur Matrix (Combinaisons)","text":"<pre><code># argocd/applicationsets/matrix.yaml\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: all-apps-all-envs\n  namespace: argocd\nspec:\n  generators:\n    # Produit cart\u00e9sien : apps \u00d7 environments\n    - matrix:\n        generators:\n          # G\u00e9n\u00e9rateur 1 : Liste des apps\n          - git:\n              repoURL: https://github.com/worldline/gitops-manifests.git\n              revision: main\n              directories:\n                - path: \"apps/*\"\n          # G\u00e9n\u00e9rateur 2 : Liste des environnements\n          - list:\n              elements:\n                - env: dev\n                  cluster: https://dev.example.com\n                - env: staging\n                  cluster: https://staging.example.com\n                - env: prod\n                  cluster: https://kubernetes.default.svc\n\n  template:\n    metadata:\n      name: \"{{path.basename}}-{{env}}\"\n      namespace: argocd\n      labels:\n        app: \"{{path.basename}}\"\n        env: \"{{env}}\"\n    spec:\n      project: \"{{env}}\"\n      source:\n        repoURL: https://github.com/worldline/gitops-manifests.git\n        targetRevision: main\n        path: \"{{path}}/overlays/{{env}}\"\n      destination:\n        server: \"{{cluster}}\"\n        namespace: \"{{path.basename}}\"\n      syncPolicy:\n        automated:\n          prune: true\n          selfHeal: true\n</code></pre> <p>R\u00e9sultat : 50 apps \u00d7 3 envs = 150 Applications g\u00e9n\u00e9r\u00e9es automatiquement !</p>"},{"location":"formations/gitops-argocd/02-app-of-apps/#5-projets-argocd-isolation-et-securite","title":"5. Projets ArgoCD : Isolation et S\u00e9curit\u00e9","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#51-concept","title":"5.1 Concept","text":"<p>Les Projects ArgoCD permettent d'isoler les \u00e9quipes et de restreindre les droits :</p> <pre><code># argocd/projects/production.yaml\napiVersion: argoproj.io/v1alpha1\nkind: AppProject\nmetadata:\n  name: production\n  namespace: argocd\nspec:\n  description: \"Applications de production\"\n\n  # Repos autoris\u00e9s\n  sourceRepos:\n    - https://github.com/worldline/gitops-manifests.git\n    - https://github.com/worldline/helm-charts.git\n\n  # Clusters autoris\u00e9s\n  destinations:\n    - namespace: \"*\"\n      server: https://kubernetes.default.svc\n    - namespace: \"*\"\n      server: https://prod-cluster.example.com\n\n  # Namespaces interdits\n  namespaceResourceBlacklist:\n    - group: \"\"\n      kind: Namespace\n    - group: rbac.authorization.k8s.io\n      kind: ClusterRole\n\n  # Types de ressources autoris\u00e9s\n  clusterResourceWhitelist:\n    - group: \"\"\n      kind: Namespace\n    - group: networking.k8s.io\n      kind: Ingress\n\n  # R\u00f4les RBAC du projet\n  roles:\n    - name: developer\n      description: \"D\u00e9veloppeurs - sync uniquement\"\n      policies:\n        - p, proj:production:developer, applications, get, production/*, allow\n        - p, proj:production:developer, applications, sync, production/*, allow\n      groups:\n        - worldline-developers\n\n    - name: admin\n      description: \"Admins - tous les droits\"\n      policies:\n        - p, proj:production:admin, applications, *, production/*, allow\n      groups:\n        - worldline-platform-team\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#6-bonnes-pratiques","title":"6. Bonnes Pratiques","text":""},{"location":"formations/gitops-argocd/02-app-of-apps/#61-checklist-app-of-apps","title":"6.1 Checklist App of Apps","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST APP OF APPS                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   STRUCTURE                                                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   \u2611 Root App d\u00e9ploy\u00e9e manuellement (bootstrap)                  \u2502\n\u2502   \u2611 Applications enfants versionn\u00e9es dans Git                   \u2502\n\u2502   \u2611 Un dossier applications/ d\u00e9di\u00e9 aux CRDs                     \u2502\n\u2502   \u2611 S\u00e9paration apps/ (workloads) et argocd/ (config)           \u2502\n\u2502                                                                 \u2502\n\u2502   S\u00c9CURIT\u00c9                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2611 Projects pour isoler les \u00e9quipes                            \u2502\n\u2502   \u2611 sourceRepos restrictif par projet                           \u2502\n\u2502   \u2611 destinations limit\u00e9es                                       \u2502\n\u2502   \u2611 Finalizers pour le nettoyage                                \u2502\n\u2502                                                                 \u2502\n\u2502   AUTOMATISATION                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u2611 ApplicationSets pour multi-env                              \u2502\n\u2502   \u2611 Labels coh\u00e9rents (team, env, app)                           \u2502\n\u2502   \u2611 Notifications configur\u00e9es                                   \u2502\n\u2502                                                                 \u2502\n\u2502   HELM                                                          \u2502\n\u2502   \u2500\u2500\u2500\u2500                                                          \u2502\n\u2502   \u2611 Version du chart \u00e9pingl\u00e9e (targetRevision)                  \u2502\n\u2502   \u2611 Values s\u00e9par\u00e9es par environnement                           \u2502\n\u2502   \u2611 skipCrds si CRDs g\u00e9r\u00e9es ailleurs                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#62-anti-patterns-a-eviter","title":"6.2 Anti-Patterns \u00e0 \u00c9viter","text":"Anti-Pattern Probl\u00e8me Solution <code>targetRevision: HEAD</code> Version flottante, non reproductible Utiliser un tag ou SHA Applications sans Project Pas d'isolation Cr\u00e9er des Projects par \u00e9quipe/env Secrets dans le repo GitOps Fuite de secrets Sealed Secrets ou External Secrets Sync manuel sur tout Pas d'automatisation Auto-sync en dev/staging Pas de finalizer Ressources orphelines apr\u00e8s delete Toujours ajouter le finalizer"},{"location":"formations/gitops-argocd/02-app-of-apps/#7-commandes-de-reference","title":"7. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === APP OF APPS ===\n# Bootstrap : cr\u00e9er la root app manuellement\nkubectl apply -f argocd/root-app.yaml\n\n# Voir les applications g\u00e9n\u00e9r\u00e9es\nargocd app list\n\n# Sync la root app (cascade vers les enfants)\nargocd app sync root-apps\n\n# === APPLICATIONSETS ===\n# Lister les ApplicationSets\nkubectl get applicationsets -n argocd\n\n# Voir les applications g\u00e9n\u00e9r\u00e9es par un ApplicationSet\nargocd app list -l app.kubernetes.io/instance=all-applications\n\n# === PROJECTS ===\n# Lister les projets\nargocd proj list\n\n# Voir les d\u00e9tails d'un projet\nargocd proj get production\n\n# Voir les applications d'un projet\nargocd app list -p production\n\n# === DEBUG ===\n# Voir pourquoi une app n'est pas cr\u00e9\u00e9e (ApplicationSet)\nkubectl describe applicationset all-applications -n argocd\n\n# Voir les events\nkubectl get events -n argocd --sort-by='.lastTimestamp'\n</code></pre>"},{"location":"formations/gitops-argocd/02-app-of-apps/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi la Root App est-elle cr\u00e9\u00e9e manuellement ? <p>R\u00e9ponse :</p> <p>C'est le probl\u00e8me de l'\u0153uf et de la poule :</p> <ul> <li>ArgoCD g\u00e8re les Applications via Git</li> <li>Mais il faut une Application pour lire Git</li> <li>Cette premi\u00e8re Application (Root) doit \u00eatre cr\u00e9\u00e9e manuellement</li> </ul> <p>Bootstrap : <code>kubectl apply -f root-app.yaml</code></p> <p>Ensuite, la Root App g\u00e8re toutes les autres Applications, y compris ses propres mises \u00e0 jour (si vous modifiez root-app.yaml dans Git, ArgoCD se mettra \u00e0 jour).</p> Question 2 : Quelle est la diff\u00e9rence entre App of Apps et ApplicationSet ? <p>R\u00e9ponse :</p> Aspect App of Apps ApplicationSet D\u00e9finition Applications manuelles dans Git Template + g\u00e9n\u00e9rateur Flexibilit\u00e9 Totale (chaque app unique) Template commun Maintenance 1 fichier par app 1 fichier pour N apps Cas d'usage Apps h\u00e9t\u00e9rog\u00e8nes Apps similaires (multi-env) <p>Recommandation : Combiner les deux. ApplicationSet pour les patterns r\u00e9p\u00e9titifs, App of Apps pour les configurations uniques.</p> Question 3 : Comment ajouter un nouveau microservice au syst\u00e8me ? <p>R\u00e9ponse :</p> <p>Avec un ApplicationSet (g\u00e9n\u00e9rateur git directories) :</p> <ol> <li>Cr\u00e9er le dossier <code>apps/nouveau-service/</code></li> <li>Ajouter les overlays <code>dev/</code>, <code>staging/</code>, <code>prod/</code></li> <li>Commit + Push</li> </ol> <p>ArgoCD d\u00e9tecte automatiquement le nouveau dossier et cr\u00e9e les Applications correspondantes. Zero configuration ArgoCD n\u00e9cessaire.</p>"},{"location":"formations/gitops-argocd/02-app-of-apps/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Vous savez maintenant g\u00e9rer des centaines d'applications. Apprenez \u00e0 contr\u00f4ler finement leur synchronisation.</p> <p>:octicons-arrow-right-24: Module 3 : Strat\u00e9gies de Sync</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/gitops-argocd/03-sync-strategies/","title":"Module 3 : Strat\u00e9gies de Sync","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Choisir entre Auto-Sync et Manual Sync selon l'environnement</li> <li>:material-check: Impl\u00e9menter des Sync Waves pour orchestrer les d\u00e9ploiements</li> <li>:material-check: Configurer le Self-Healing pour corriger le drift</li> <li>:material-check: Utiliser les Sync Hooks pour des actions personnalis\u00e9es</li> </ul>"},{"location":"formations/gitops-argocd/03-sync-strategies/#1-auto-sync-vs-manual-sync","title":"1. Auto-Sync vs Manual Sync","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#11-le-dilemme","title":"1.1 Le Dilemme","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              AUTO-SYNC vs MANUAL SYNC                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   AUTO-SYNC                                                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   Git change \u2192 ArgoCD sync automatiquement                      \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Avantages :                                                \u2502\n\u2502   \u2022 D\u00e9ploiement imm\u00e9diat apr\u00e8s merge                            \u2502\n\u2502   \u2022 Pas d'intervention humaine                                  \u2502\n\u2502   \u2022 GitOps \"pur\" (Git = source de v\u00e9rit\u00e9 absolue)               \u2502\n\u2502                                                                 \u2502\n\u2502   \u274c Risques :                                                  \u2502\n\u2502   \u2022 Un bug merg\u00e9 = d\u00e9ploy\u00e9 en prod instantan\u00e9ment               \u2502\n\u2502   \u2022 Pas de fen\u00eatre de maintenance                               \u2502\n\u2502   \u2022 Rollback plus stressant                                     \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   MANUAL SYNC                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   Git change \u2192 ArgoCD d\u00e9tecte \u2192 Humain valide \u2192 Sync            \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Avantages :                                                \u2502\n\u2502   \u2022 Contr\u00f4le total sur le timing                                \u2502\n\u2502   \u2022 Validation humaine avant d\u00e9ploiement                        \u2502\n\u2502   \u2022 Compatible avec les Change Approvals                        \u2502\n\u2502                                                                 \u2502\n\u2502   \u274c Risques :                                                  \u2502\n\u2502   \u2022 Drift si oubli de sync                                      \u2502\n\u2502   \u2022 Bottleneck humain                                           \u2502\n\u2502   \u2022 Git \u2260 Cluster pendant une p\u00e9riode                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#12-recommandation-par-environnement","title":"1.2 Recommandation par Environnement","text":"Environnement Sync Policy Justification Development Auto-Sync + Self-Heal + Prune Feedback loop rapide, pas de risque Staging Auto-Sync + Self-Heal + Prune Proche de la prod, tests automatiques Production Manual Sync Contr\u00f4le humain, fen\u00eatres de maintenance Hotfix Prod Auto-Sync (temporaire) Correction urgente, puis repasser en manual"},{"location":"formations/gitops-argocd/03-sync-strategies/#13-configuration-auto-sync","title":"1.3 Configuration Auto-Sync","text":"<pre><code># Application Dev : Full Auto\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: frontend-dev\n  namespace: argocd\nspec:\n  project: development\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: develop  # Branche de dev\n    path: apps/frontend/overlays/dev\n  destination:\n    server: https://dev-cluster.example.com\n    namespace: frontend\n  syncPolicy:\n    automated:\n      prune: true      # Supprimer les ressources absentes de Git\n      selfHeal: true   # Corriger les modifications manuelles\n      allowEmpty: false\n    syncOptions:\n      - CreateNamespace=true\n</code></pre> <pre><code># Application Prod : Manual avec options\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: frontend-prod\n  namespace: argocd\nspec:\n  project: production\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: v2.3.1  # Tag sp\u00e9cifique, pas de branche !\n    path: apps/frontend/overlays/prod\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: frontend\n  syncPolicy:\n    # Pas de automated: \u2192 Manual sync requis\n    syncOptions:\n      - CreateNamespace=true\n      - PrunePropagationPolicy=foreground\n      - PruneLast=true\n    retry:\n      limit: 5\n      backoff:\n        duration: 5s\n        factor: 2\n        maxDuration: 3m\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#2-sync-waves-orchestrer-lordre-de-deploiement","title":"2. Sync Waves : Orchestrer l'Ordre de D\u00e9ploiement","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#21-le-probleme","title":"2.1 Le Probl\u00e8me","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PROBL\u00c8ME : ORDRE DE D\u00c9PLOIEMENT                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Situation :                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   \u2022 L'API a besoin de la Database pour d\u00e9marrer                 \u2502\n\u2502   \u2022 Le Frontend a besoin de l'API pour fonctionner              \u2502\n\u2502   \u2022 Le Job de migration doit s'ex\u00e9cuter avant l'API             \u2502\n\u2502                                                                 \u2502\n\u2502   Sans Sync Waves :                                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                             \u2502\n\u2502   ArgoCD d\u00e9ploie tout en parall\u00e8le...                           \u2502\n\u2502                                                                 \u2502\n\u2502   T=0   Database   \u2192 Creating...                                \u2502\n\u2502   T=0   Migration  \u2192 Running... \u274c DB pas pr\u00eate !               \u2502\n\u2502   T=0   API        \u2192 Starting... \u274c DB pas pr\u00eate !              \u2502\n\u2502   T=0   Frontend   \u2192 Starting... \u274c API pas pr\u00eate !             \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udc80 CrashLoopBackOff partout                                   \u2502\n\u2502                                                                 \u2502\n\u2502   Avec Sync Waves :                                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                            \u2502\n\u2502   Wave -1 : Database (attendre Healthy)                         \u2502\n\u2502   Wave  0 : Migration Job (attendre Completed)                  \u2502\n\u2502   Wave  1 : API (attendre Healthy)                              \u2502\n\u2502   Wave  2 : Frontend (attendre Healthy)                         \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 D\u00e9ploiement ordonn\u00e9 et fiable                              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#22-annotation-sync-wave","title":"2.2 Annotation sync-wave","text":"<p>Les Sync Waves utilisent l'annotation <code>argocd.argoproj.io/sync-wave</code> :</p> <pre><code># Wave -1 : Database (d\u00e9ploy\u00e9e en premier)\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: postgres\n  annotations:\n    argocd.argoproj.io/sync-wave: \"-1\"\nspec:\n  # ...\n\n---\n# Wave 0 : Migration (apr\u00e8s la DB)\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: db-migration\n  annotations:\n    argocd.argoproj.io/sync-wave: \"0\"\n    argocd.argoproj.io/hook: Sync\nspec:\n  template:\n    spec:\n      containers:\n        - name: migrate\n          image: myapp/migrations:v2.3.1\n          command: [\"./migrate.sh\"]\n      restartPolicy: Never\n  backoffLimit: 3\n\n---\n# Wave 1 : API (apr\u00e8s la migration)\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api\n  annotations:\n    argocd.argoproj.io/sync-wave: \"1\"\nspec:\n  # ...\n\n---\n# Wave 2 : Frontend (apr\u00e8s l'API)\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\n  annotations:\n    argocd.argoproj.io/sync-wave: \"2\"\nspec:\n  # ...\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#23-comportement-des-waves","title":"2.3 Comportement des Waves","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              EX\u00c9CUTION DES SYNC WAVES                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Wave -1                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                               \u2502\n\u2502   \u2502  postgres   \u2502 \u2192 Apply \u2192 Wait for Healthy \u2705                 \u2502\n\u2502   \u2502  (SS)       \u2502                                               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                               \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u25bc (Wave -1 complete)                                   \u2502\n\u2502                                                                 \u2502\n\u2502   Wave 0                                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                               \u2502\n\u2502   \u2502 db-migration\u2502 \u2192 Apply \u2192 Wait for Succeeded \u2705               \u2502\n\u2502   \u2502  (Job)      \u2502                                               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                               \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u25bc (Wave 0 complete)                                    \u2502\n\u2502                                                                 \u2502\n\u2502   Wave 1                                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                               \u2502\n\u2502   \u2502    api      \u2502 \u2192 Apply \u2192 Wait for Healthy \u2705                 \u2502\n\u2502   \u2502  (Deploy)   \u2502                                               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                               \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u25bc (Wave 1 complete)                                    \u2502\n\u2502                                                                 \u2502\n\u2502   Wave 2                                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                               \u2502\n\u2502   \u2502  frontend   \u2502 \u2192 Apply \u2192 Wait for Healthy \u2705                 \u2502\n\u2502   \u2502  (Deploy)   \u2502                                               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                               \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u25bc                                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502              SYNC COMPLETE \u2705                           \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   Notes :                                                       \u2502\n\u2502   \u2022 Les ressources d'une m\u00eame wave sont d\u00e9ploy\u00e9es en parall\u00e8le  \u2502\n\u2502   \u2022 ArgoCD attend que TOUTES les ressources d'une wave soient   \u2502\n\u2502     \"Healthy\" avant de passer \u00e0 la wave suivante                \u2502\n\u2502   \u2022 Les waves peuvent \u00eatre n\u00e9gatives (-10, -1, 0, 1, 10, etc.)  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#24-exemple-complet-avec-kustomize","title":"2.4 Exemple Complet avec Kustomize","text":"<pre><code># base/kustomization.yaml\napiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\n\nresources:\n  - namespace.yaml\n  - database/\n  - migrations/\n  - api/\n  - frontend/\n\n# Les annotations sync-wave sont dans chaque fichier\n</code></pre> <pre><code># base/namespace.yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: myapp\n  annotations:\n    argocd.argoproj.io/sync-wave: \"-10\"  # Tout premier\n</code></pre> <pre><code># base/database/statefulset.yaml\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: postgres\n  namespace: myapp\n  annotations:\n    argocd.argoproj.io/sync-wave: \"-5\"\nspec:\n  serviceName: postgres\n  replicas: 1\n  selector:\n    matchLabels:\n      app: postgres\n  template:\n    metadata:\n      labels:\n        app: postgres\n    spec:\n      containers:\n        - name: postgres\n          image: postgres:15\n          ports:\n            - containerPort: 5432\n          readinessProbe:\n            exec:\n              command: [\"pg_isready\", \"-U\", \"postgres\"]\n            initialDelaySeconds: 5\n            periodSeconds: 5\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#3-self-heal-correction-automatique-du-drift","title":"3. Self-Heal : Correction Automatique du Drift","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#31-quest-ce-que-le-drift","title":"3.1 Qu'est-ce que le Drift ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              DRIFT : L'ENNEMI DU GITOPS                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Situation :                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   Git dit : replicas = 3                                        \u2502\n\u2502   Cluster dit : replicas = 5                                    \u2502\n\u2502                                                                 \u2502\n\u2502   Comment c'est arriv\u00e9 ?                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502   \u2022 Quelqu'un a fait : kubectl scale deployment api --replicas=5\u2502\n\u2502   \u2022 Un op\u00e9rateur a modifi\u00e9 le HPA manuellement                  \u2502\n\u2502   \u2022 Un script legacy a patch\u00e9 le deployment                     \u2502\n\u2502   \u2022 Un admin a \"fix\" un probl\u00e8me en urgence                     \u2502\n\u2502                                                                 \u2502\n\u2502   Cons\u00e9quences :                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502   \u274c Git n'est plus la source de v\u00e9rit\u00e9                         \u2502\n\u2502   \u274c Le prochain sync va \"casser\" le fix manuel                 \u2502\n\u2502   \u274c Impossible de savoir l'\u00e9tat r\u00e9el attendu                   \u2502\n\u2502   \u274c Rollback Git ne fonctionne plus                            \u2502\n\u2502                                                                 \u2502\n\u2502   Solution : Self-Heal                                          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                       \u2502\n\u2502   ArgoCD d\u00e9tecte la modification et la REVERT automatiquement   \u2502\n\u2502   \u2192 Retour \u00e0 replicas = 3 (\u00e9tat Git)                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#32-configuration-self-heal","title":"3.2 Configuration Self-Heal","text":"<pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: api\n  namespace: argocd\nspec:\n  project: production\n  source:\n    repoURL: https://github.com/worldline/gitops-manifests.git\n    targetRevision: main\n    path: apps/api/overlays/prod\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: api\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true  # \u2190 CRUCIAL : corrige le drift automatiquement\n    syncOptions:\n      - CreateNamespace=true\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#33-comportement-du-self-heal","title":"3.3 Comportement du Self-Heal","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              SELF-HEAL EN ACTION                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   T=0    \u00c9tat Git :    replicas = 3                             \u2502\n\u2502          \u00c9tat Cluster : replicas = 3                            \u2502\n\u2502          Status : Synced \u2705                                     \u2502\n\u2502                                                                 \u2502\n\u2502   T=1    Ops fait : kubectl scale deploy api --replicas=5       \u2502\n\u2502          \u00c9tat Git :    replicas = 3                             \u2502\n\u2502          \u00c9tat Cluster : replicas = 5                            \u2502\n\u2502          Status : OutOfSync \u26a0\ufe0f                                  \u2502\n\u2502                                                                 \u2502\n\u2502   T=2    ArgoCD d\u00e9tecte le drift (poll ou reconciliation)       \u2502\n\u2502          Self-Heal activ\u00e9 \u2192 Sync automatique                    \u2502\n\u2502                                                                 \u2502\n\u2502   T=3    ArgoCD applique : replicas = 3 (\u00e9tat Git)              \u2502\n\u2502          \u00c9tat Cluster : replicas = 3                            \u2502\n\u2502          Status : Synced \u2705                                     \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udce2 Message \u00e0 l'Ops :                                          \u2502\n\u2502   \"Ta modification manuelle a \u00e9t\u00e9 annul\u00e9e. Passe par Git.\"      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#34-ignorer-certains-champs","title":"3.4 Ignorer Certains Champs","text":"<p>Parfois, vous voulez autoriser certains drifts (ex: HPA qui modifie replicas) :</p> <pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: api\n  namespace: argocd\nspec:\n  # ...\n  ignoreDifferences:\n    # Ignorer les changements de replicas (g\u00e9r\u00e9 par HPA)\n    - group: apps\n      kind: Deployment\n      jsonPointers:\n        - /spec/replicas\n\n    # Ignorer certaines annotations ajout\u00e9es par des controllers\n    - group: \"\"\n      kind: Service\n      jsonPointers:\n        - /metadata/annotations/cloud.google.com~1neg-status\n\n    # Ignorer les labels ajout\u00e9s par Istio\n    - group: apps\n      kind: Deployment\n      jqPathExpressions:\n        - .spec.template.metadata.labels | select(.\"istio.io/rev\")\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#4-sync-hooks-actions-personnalisees","title":"4. Sync Hooks : Actions Personnalis\u00e9es","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#41-types-de-hooks","title":"4.1 Types de Hooks","text":"Hook Quand Usage PreSync Avant le sync Backup DB, notification Slack Sync Pendant le sync (avec wave) Migrations PostSync Apr\u00e8s sync r\u00e9ussi Tests smoke, notification SyncFail Apr\u00e8s sync \u00e9chou\u00e9 Alerte, rollback Skip Jamais ex\u00e9cut\u00e9 par ArgoCD Resources g\u00e9r\u00e9es autrement"},{"location":"formations/gitops-argocd/03-sync-strategies/#42-exemple-migration-pre-sync","title":"4.2 Exemple : Migration Pre-Sync","text":"<pre><code># hooks/pre-sync-backup.yaml\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: db-backup\n  annotations:\n    argocd.argoproj.io/hook: PreSync\n    argocd.argoproj.io/hook-delete-policy: HookSucceeded\nspec:\n  template:\n    spec:\n      containers:\n        - name: backup\n          image: postgres:15\n          command:\n            - /bin/sh\n            - -c\n            - |\n              pg_dump -h $DB_HOST -U $DB_USER $DB_NAME | \\\n              gzip &gt; /backup/backup-$(date +%Y%m%d-%H%M%S).sql.gz\n          envFrom:\n            - secretRef:\n                name: db-credentials\n          volumeMounts:\n            - name: backup\n              mountPath: /backup\n      restartPolicy: Never\n      volumes:\n        - name: backup\n          persistentVolumeClaim:\n            claimName: backup-pvc\n  backoffLimit: 2\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#43-exemple-notification-post-sync","title":"4.3 Exemple : Notification Post-Sync","text":"<pre><code># hooks/post-sync-notify.yaml\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: notify-deployment\n  annotations:\n    argocd.argoproj.io/hook: PostSync\n    argocd.argoproj.io/hook-delete-policy: HookSucceeded\nspec:\n  template:\n    spec:\n      containers:\n        - name: notify\n          image: curlimages/curl:latest\n          command:\n            - /bin/sh\n            - -c\n            - |\n              curl -X POST \"$SLACK_WEBHOOK\" \\\n                -H 'Content-type: application/json' \\\n                -d '{\n                  \"text\": \"\u2705 Deployment successful!\",\n                  \"blocks\": [\n                    {\n                      \"type\": \"section\",\n                      \"text\": {\n                        \"type\": \"mrkdwn\",\n                        \"text\": \"*Application:* '\"$APP_NAME\"'\\n*Version:* '\"$APP_VERSION\"'\\n*Environment:* Production\"\n                      }\n                    }\n                  ]\n                }'\n          env:\n            - name: SLACK_WEBHOOK\n              valueFrom:\n                secretKeyRef:\n                  name: slack-webhook\n                  key: url\n            - name: APP_NAME\n              value: \"frontend\"\n            - name: APP_VERSION\n              value: \"v2.3.1\"\n      restartPolicy: Never\n  backoffLimit: 1\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#44-hook-delete-policies","title":"4.4 Hook Delete Policies","text":"<pre><code>annotations:\n  argocd.argoproj.io/hook-delete-policy: HookSucceeded\n  # Autres options :\n  # - HookSucceeded : Supprimer si le hook r\u00e9ussit\n  # - HookFailed : Supprimer si le hook \u00e9choue\n  # - BeforeHookCreation : Supprimer avant de recr\u00e9er (prochain sync)\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#5-prune-nettoyage-des-ressources-orphelines","title":"5. Prune : Nettoyage des Ressources Orphelines","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#51-le-probleme-des-orphelins","title":"5.1 Le Probl\u00e8me des Orphelins","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              RESSOURCES ORPHELINES                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Jour 1 : Git contient                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502   \u251c\u2500\u2500 deployment.yaml (api)                                     \u2502\n\u2502   \u251c\u2500\u2500 deployment.yaml (worker)  \u2190 On supprime ce fichier       \u2502\n\u2502   \u251c\u2500\u2500 service.yaml                                              \u2502\n\u2502   \u2514\u2500\u2500 ingress.yaml                                              \u2502\n\u2502                                                                 \u2502\n\u2502   Jour 2 : Git contient                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502   \u251c\u2500\u2500 deployment.yaml (api)                                     \u2502\n\u2502   \u251c\u2500\u2500 service.yaml                                              \u2502\n\u2502   \u2514\u2500\u2500 ingress.yaml                                              \u2502\n\u2502                                                                 \u2502\n\u2502   Sans Prune :                                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                  \u2502\n\u2502   Le deployment \"worker\" reste dans le cluster !                \u2502\n\u2502   \u2192 Ressource orpheline                                         \u2502\n\u2502   \u2192 Consomme des ressources                                     \u2502\n\u2502   \u2192 Drift invisible                                             \u2502\n\u2502                                                                 \u2502\n\u2502   Avec Prune :                                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   ArgoCD supprime automatiquement le deployment \"worker\"        \u2502\n\u2502   \u2192 Git = Cluster (vraiment)                                    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#52-options-de-prune","title":"5.2 Options de Prune","text":"<pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: api\n  namespace: argocd\nspec:\n  # ...\n  syncPolicy:\n    automated:\n      prune: true  # Activer le prune automatique\n    syncOptions:\n      # Ordre de suppression\n      - PruneLast=true  # Supprimer les orphelins en dernier\n\n      # Politique de propagation\n      - PrunePropagationPolicy=foreground  # Attendre la suppression effective\n      # Autres : background, orphan\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#53-protection-contre-le-prune","title":"5.3 Protection contre le Prune","text":"<pre><code># Prot\u00e9ger une ressource contre le prune\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: critical-config\n  annotations:\n    argocd.argoproj.io/sync-options: Prune=false\ndata:\n  # Cette ConfigMap ne sera JAMAIS supprim\u00e9e par ArgoCD\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#6-bonnes-pratiques-operationnelles","title":"6. Bonnes Pratiques Op\u00e9rationnelles","text":""},{"location":"formations/gitops-argocd/03-sync-strategies/#61-checklist-par-environnement","title":"6.1 Checklist par Environnement","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST SYNC STRATEGIES                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   DEVELOPMENT                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   \u2611 automated.prune: true                                       \u2502\n\u2502   \u2611 automated.selfHeal: true                                    \u2502\n\u2502   \u2611 targetRevision: develop (branche)                          \u2502\n\u2502   \u2611 Sync rapide (webhook GitHub/GitLab)                         \u2502\n\u2502   \u2610 Notifications : optionnelles                                \u2502\n\u2502                                                                 \u2502\n\u2502   STAGING                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2611 automated.prune: true                                       \u2502\n\u2502   \u2611 automated.selfHeal: true                                    \u2502\n\u2502   \u2611 targetRevision: main ou release/*                          \u2502\n\u2502   \u2611 Sync Waves pour l'ordre                                     \u2502\n\u2502   \u2611 Notifications : Slack channel staging                       \u2502\n\u2502                                                                 \u2502\n\u2502   PRODUCTION                                                    \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                    \u2502\n\u2502   \u2611 automated: false (Manual Sync)                              \u2502\n\u2502   \u2611 targetRevision: tag (v2.3.1)                               \u2502\n\u2502   \u2611 Sync Waves obligatoires                                     \u2502\n\u2502   \u2611 PreSync hooks (backup, healthcheck)                         \u2502\n\u2502   \u2611 PostSync hooks (smoke tests, notification)                  \u2502\n\u2502   \u2611 SyncFail hooks (alerte PagerDuty)                           \u2502\n\u2502   \u2611 Prune: true mais avec PruneLast                             \u2502\n\u2502   \u2611 ignoreDifferences pour HPA                                  \u2502\n\u2502   \u2611 Notifications : #prod-deployments + PagerDuty               \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#62-workflow-de-deploiement-production","title":"6.2 Workflow de D\u00e9ploiement Production","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              WORKFLOW D\u00c9PLOIEMENT PRODUCTION                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. PR\u00c9PARATION                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502   \u2022 Cr\u00e9er le tag Git (v2.3.1)                                   \u2502\n\u2502   \u2022 Mettre \u00e0 jour le targetRevision dans l'Application          \u2502\n\u2502   \u2022 Merger la PR dans le repo GitOps                            \u2502\n\u2502                                                                 \u2502\n\u2502   2. V\u00c9RIFICATION                                               \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                               \u2502\n\u2502   \u2022 ArgoCD d\u00e9tecte : Status = OutOfSync                         \u2502\n\u2502   \u2022 Revoir le Diff dans l'UI ArgoCD                             \u2502\n\u2502   \u2022 V\u00e9rifier les Sync Waves                                     \u2502\n\u2502                                                                 \u2502\n\u2502   3. D\u00c9PLOIEMENT                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502   \u2022 Cliquer \"Sync\" dans l'UI (ou argocd app sync)               \u2502\n\u2502   \u2022 ArgoCD ex\u00e9cute :                                            \u2502\n\u2502     - PreSync : Backup DB \u2705                                    \u2502\n\u2502     - Wave -1 : Database \u2705                                     \u2502\n\u2502     - Wave 0 : Migrations \u2705                                    \u2502\n\u2502     - Wave 1 : API \u2705                                           \u2502\n\u2502     - Wave 2 : Frontend \u2705                                      \u2502\n\u2502     - PostSync : Smoke tests \u2705                                 \u2502\n\u2502     - PostSync : Notification Slack \u2705                          \u2502\n\u2502                                                                 \u2502\n\u2502   4. VALIDATION                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u2022 V\u00e9rifier Health = Healthy                                   \u2502\n\u2502   \u2022 V\u00e9rifier les m\u00e9triques (Grafana)                            \u2502\n\u2502   \u2022 Valider le ticket de change                                 \u2502\n\u2502                                                                 \u2502\n\u2502   5. ROLLBACK (si n\u00e9cessaire)                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                  \u2502\n\u2502   Option A : argocd app rollback frontend 5                     \u2502\n\u2502   Option B : git revert + push + sync                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#7-commandes-de-reference","title":"7. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === SYNC ===\n# Sync manuel\nargocd app sync frontend\n\n# Sync avec prune forc\u00e9\nargocd app sync frontend --prune\n\n# Sync avec dry-run (preview)\nargocd app sync frontend --dry-run\n\n# Sync une ressource sp\u00e9cifique\nargocd app sync frontend --resource apps:Deployment:frontend\n\n# === DIFF ===\n# Voir les diff\u00e9rences\nargocd app diff frontend\n\n# Diff avec plus de contexte\nargocd app diff frontend --local ./manifests/\n\n# === ROLLBACK ===\n# Voir l'historique\nargocd app history frontend\n\n# Rollback \u00e0 une r\u00e9vision\nargocd app rollback frontend 5\n\n# === SELF-HEAL ===\n# Forcer un refresh (d\u00e9tection de drift)\nargocd app get frontend --refresh\n\n# === HOOKS ===\n# Voir les hooks d'une app\nkubectl get jobs -n frontend -l argocd.argoproj.io/hook\n\n# Logs d'un hook\nkubectl logs -n frontend job/db-migration\n\n# === DEBUG ===\n# Voir l'\u00e9tat d\u00e9taill\u00e9\nargocd app get frontend\n\n# Voir les ressources\nargocd app resources frontend\n\n# Voir les events ArgoCD\nkubectl get events -n argocd --field-selector reason=ResourceUpdated\n</code></pre>"},{"location":"formations/gitops-argocd/03-sync-strategies/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi d\u00e9sactiver Auto-Sync en production ? <p>R\u00e9ponse :</p> <p>En production, le Manual Sync offre :</p> <ol> <li>Contr\u00f4le du timing : D\u00e9ployer pendant les fen\u00eatres de maintenance</li> <li>Validation humaine : Revue du diff avant apply</li> <li>Conformit\u00e9 : Change Approval Process (ITIL)</li> <li>S\u00e9curit\u00e9 : Un bug merg\u00e9 n'est pas d\u00e9ploy\u00e9 automatiquement</li> <li>Coordination : Synchroniser avec d'autres \u00e9quipes (DBA, Ops)</li> </ol> <p>En dev/staging, Auto-Sync est recommand\u00e9 pour le feedback rapide.</p> Question 2 : Comment garantir que la DB d\u00e9marre avant l'API ? <p>R\u00e9ponse :</p> <p>Utiliser les Sync Waves :</p> <pre><code># Database\nmetadata:\n  annotations:\n    argocd.argoproj.io/sync-wave: \"-1\"\n\n# API\nmetadata:\n  annotations:\n    argocd.argoproj.io/sync-wave: \"1\"\n</code></pre> <p>ArgoCD va : 1. D\u00e9ployer la Database (wave -1) 2. Attendre qu'elle soit Healthy 3. D\u00e9ployer l'API (wave 1)</p> Question 3 : Quelqu'un a fait un kubectl edit en prod. Que se passe-t-il ? <p>R\u00e9ponse :</p> <p>Cela d\u00e9pend de la configuration :</p> <p>Avec <code>selfHeal: true</code> : - ArgoCD d\u00e9tecte le drift lors du prochain cycle de r\u00e9conciliation (3 min) - Annule automatiquement la modification - Remet l'\u00e9tat Git</p> <p>Avec <code>selfHeal: false</code> : - ArgoCD affiche \"OutOfSync\" - La modification reste en place - Attente d'un sync manuel</p> <p>Bonne pratique : <code>selfHeal: true</code> + notifications pour \u00e9duquer les \u00e9quipes \u00e0 passer par Git.</p>"},{"location":"formations/gitops-argocd/03-sync-strategies/#conclusion-de-la-formation","title":"Conclusion de la Formation","text":"<p>Vous ma\u00eetrisez maintenant ArgoCD et le GitOps en entreprise :</p> <ul> <li>Module 1 : Architecture (Controller, Repo Server, API Server)</li> <li>Module 2 : App of Apps (Industrialisation, ApplicationSets)</li> <li>Module 3 : Strat\u00e9gies de Sync (Auto/Manual, Waves, Self-Heal)</li> </ul>"},{"location":"formations/gitops-argocd/03-sync-strategies/#prochaines-etapes-recommandees","title":"Prochaines \u00c9tapes Recommand\u00e9es","text":"<ol> <li>D\u00e9ployer ArgoCD sur votre cluster GKE</li> <li>Impl\u00e9menter App of Apps pour vos microservices</li> <li>Configurer les notifications (Slack, Teams)</li> <li>Explorer : Argo Rollouts (Canary/Blue-Green), Image Updater</li> </ol>"},{"location":"formations/gitops-argocd/03-sync-strategies/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<ul> <li>:material-link: ArgoCD Documentation</li> <li>:material-link: ArgoCD Best Practices</li> <li>:material-link: Argo Rollouts</li> <li>:material-link: GitOps Principles</li> </ul> <p>Le Mantra GitOps</p> <p>\"If it's not in Git, it doesn't exist. If it's in Git, it's deployed.\"</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/linux/edge-services/","title":"Edge Services : Squid Proxy &amp; \u00c9changes S\u00e9curis\u00e9s","text":"<p>Module Critique - SPOF Identifi\u00e9</p> <p>Ce module documente les Single Points of Failure (SPOF) identifi\u00e9s lors de l'audit d'infrastructure. Les services d\u00e9crits ici sont sur le chemin critique de production.</p> <p>En cas de panne de ces services : AUCUN serveur du Site-SPOKE ne peut se mettre \u00e0 jour.</p>"},{"location":"formations/linux/edge-services/#vue-densemble","title":"Vue d'Ensemble","text":""},{"location":"formations/linux/edge-services/#contexte-operationnel","title":"Contexte Op\u00e9rationnel","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE MULTI-SITES                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   SITE-SPOKE (Isol\u00e9)              SITE-HUB (Internet)          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500              \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500          \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502   \u2502 srv-app-spoke-01\u2502            \u2502 srv-proxy-hub-01\u2502           \u2502\n\u2502   \u2502 srv-app-spoke-02\u2502            \u2502 (Squid)         \u2502           \u2502\n\u2502   \u2502 srv-db-spoke-01 \u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502   \u2502 ...             \u2502                     \u2502                    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502                    \u2502\n\u2502            \u2502                              \u2502                    \u2502\n\u2502            \u2502 Pas d'acc\u00e8s                  \u2502 Acc\u00e8s Internet     \u2502\n\u2502            \u2502 Internet direct              \u2502 contr\u00f4l\u00e9           \u2502\n\u2502            \u2502                              \u2502                    \u2502\n\u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2502                                                                 \u2502\n\u2502   CONTRAINTE S\u00c9CURIT\u00c9 :                                         \u2502\n\u2502   \u2022 Site-SPOKE = Zone de confiance restreinte                   \u2502\n\u2502   \u2022 Aucun flux sortant direct vers Internet                     \u2502\n\u2502   \u2022 Tout passe par le proxy HUB (whitelist)                     \u2502\n\u2502                                                                 \u2502\n\u2502   SPOF IDENTIFI\u00c9 :                                              \u2502\n\u2502   \u26a0\ufe0f  srv-proxy-hub-01 = Point unique de sortie                 \u2502\n\u2502   \u26a0\ufe0f  Si DOWN \u2192 Plus de apt update, plus de t\u00e9l\u00e9chargements     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux/edge-services/#section-1-architecture-flux-reseau","title":"Section 1 : Architecture &amp; Flux R\u00e9seau","text":""},{"location":"formations/linux/edge-services/#11-concept-du-proxy-chaine-proxy-cascading","title":"1.1 Concept du Proxy Cha\u00een\u00e9 (Proxy Cascading)","text":"<p>Le Proxy Cha\u00een\u00e9 (ou Proxy Cascading) est une architecture o\u00f9 les requ\u00eates HTTP/HTTPS traversent plusieurs proxies avant d'atteindre Internet.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PROXY CASCADING                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Cas Simple (Site-HUB direct)                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                  \u2502\n\u2502                                                                 \u2502\n\u2502   Client \u2500\u2500\u2500\u2500\u25ba Squid \u2500\u2500\u2500\u2500\u25ba Internet                             \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   Cas Complexe (Site-SPOKE via HUB)                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                             \u2502\n\u2502                                                                 \u2502\n\u2502   Client      Squid        Firewall     Squid        Internet   \u2502\n\u2502   (SPOKE)     (SPOKE)      Inter-site   (HUB)                   \u2502\n\u2502      \u2502          \u2502             \u2502           \u2502             \u2502       \u2502\n\u2502      \u2502\u2500\u2500GET\u2500\u2500\u2500\u2500\u25ba\u2502             \u2502           \u2502             \u2502       \u2502\n\u2502      \u2502          \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502           \u2502             \u2502       \u2502\n\u2502      \u2502          \u2502             \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502             \u2502       \u2502\n\u2502      \u2502          \u2502             \u2502           \u2502\u2500\u2500\u2500\u2500GET\u2500\u2500\u2500\u2500\u2500\u25ba\u2502       \u2502\n\u2502      \u2502          \u2502             \u2502           \u2502\u25c4\u2500\u2500\u2500200 OK\u2500\u2500\u2500\u2502       \u2502\n\u2502      \u2502          \u2502             \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502             \u2502       \u2502\n\u2502      \u2502          \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502           \u2502             \u2502       \u2502\n\u2502      \u2502\u25c4\u2500200 OK\u2500\u2500\u2502             \u2502           \u2502             \u2502       \u2502\n\u2502                                                                 \u2502\n\u2502   Configuration Squid SPOKE :                                   \u2502\n\u2502   cache_peer srv-proxy-hub-01.internal parent 3128 0 no-query   \u2502\n\u2502   never_direct allow all                                        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux/edge-services/#12-scenario-mise-a-jour-des-serveurs-spoke","title":"1.2 Sc\u00e9nario : Mise \u00e0 Jour des Serveurs SPOKE","text":"<p>Probl\u00e9matique : Les serveurs du Site-SPOKE (Debian/Ubuntu) doivent ex\u00e9cuter <code>apt update &amp;&amp; apt upgrade</code>. Ils n'ont pas d'acc\u00e8s Internet direct.</p> <p>Solution : Configurer <code>apt</code> pour utiliser le proxy HUB.</p> <pre><code># Sur chaque serveur SPOKE : /etc/apt/apt.conf.d/95proxy\nAcquire::http::Proxy \"http://srv-proxy-hub-01.internal:3128\";\nAcquire::https::Proxy \"http://srv-proxy-hub-01.internal:3128\";\n</code></pre> <p>Ou via variable d'environnement (temporaire) :</p> <pre><code>export http_proxy=\"http://srv-proxy-hub-01.internal:3128\"\nexport https_proxy=\"http://srv-proxy-hub-01.internal:3128\"\nexport no_proxy=\"localhost,127.0.0.1,.internal\"\n\napt update\n</code></pre>"},{"location":"formations/linux/edge-services/#13-diagramme-de-flux-complet","title":"1.3 Diagramme de Flux Complet","text":"<pre><code>flowchart LR\n    subgraph SPOKE[\"Site-SPOKE (Isol\u00e9)\"]\n        C1[srv-app-spoke-01]\n        C2[srv-app-spoke-02]\n        C3[srv-db-spoke-01]\n    end\n\n    subgraph FW[\"Firewall Inter-Sites\"]\n        FW1[fw-interco-01&lt;br/&gt;TCP 3128 ONLY]\n    end\n\n    subgraph HUB[\"Site-HUB\"]\n        SQUID[srv-proxy-hub-01&lt;br/&gt;Squid 3128]\n        WC3S[srv-exchange-01&lt;br/&gt;HTTPS 443]\n    end\n\n    subgraph INET[\"Internet\"]\n        DEB[deb.debian.org]\n        MS[*.microsoft.com]\n        OTHER[Autres sites]\n    end\n\n    C1 --&gt;|apt update| FW1\n    C2 --&gt;|apt update| FW1\n    C3 --&gt;|apt update| FW1\n    FW1 --&gt;|TCP 3128| SQUID\n    SQUID --&gt;|Whitelist OK| DEB\n    SQUID --&gt;|Whitelist OK| MS\n    SQUID -.-&gt;|DENIED| OTHER\n\n    style SQUID fill:#ff6b6b,stroke:#333,color:#fff\n    style FW1 fill:#ffd93d,stroke:#333\n    style OTHER fill:#ccc,stroke:#333</code></pre>"},{"location":"formations/linux/edge-services/#14-matrice-de-flux","title":"1.4 Matrice de Flux","text":"Source Destination Port Protocole Usage <code>192.168.10.0/24</code> (SPOKE) <code>srv-proxy-hub-01</code> 3128 TCP Proxy HTTP/HTTPS <code>srv-proxy-hub-01</code> <code>0.0.0.0/0</code> 80, 443 TCP Acc\u00e8s Internet (whitelist) <code>192.168.10.0/24</code> (SPOKE) <code>srv-exchange-01</code> 443 TCP Upload/Download fichiers"},{"location":"formations/linux/edge-services/#section-2-administration-squid","title":"Section 2 : Administration Squid","text":""},{"location":"formations/linux/edge-services/#21-installation","title":"2.1 Installation","text":"Debian/UbuntuRHEL/Rocky <pre><code># Installation\napt update\napt install squid -y\n\n# V\u00e9rifier le service\nsystemctl status squid\n\n# Activer au d\u00e9marrage\nsystemctl enable squid\n</code></pre> <pre><code># Installation\ndnf install squid -y\n\n# Firewall\nfirewall-cmd --permanent --add-port=3128/tcp\nfirewall-cmd --reload\n\n# Service\nsystemctl enable --now squid\n</code></pre>"},{"location":"formations/linux/edge-services/#22-configuration-squidconf","title":"2.2 Configuration Squid.conf","text":"<p>Fichier Critique</p> <p>Le fichier <code>/etc/squid/squid.conf</code> est la source de v\u00e9rit\u00e9 pour le comportement du proxy.</p> <p>Avant toute modification : <pre><code>cp /etc/squid/squid.conf /etc/squid/squid.conf.backup-$(date +%Y%m%d)\n</code></pre></p>"},{"location":"formations/linux/edge-services/#configuration-complete-commentee","title":"Configuration Compl\u00e8te Comment\u00e9e","text":"<pre><code># /etc/squid/squid.conf - Configuration Production\n# Serveur: srv-proxy-hub-01\n# Derni\u00e8re modification: 2025-01-28\n\n#####################################################\n# SECTION 1 : D\u00c9FINITION DES ACLs\n#####################################################\n\n# R\u00e9seaux internes autoris\u00e9s\nacl localnet src 192.168.0.0/16      # Tous les r\u00e9seaux internes\nacl localnet src 10.0.0.0/8          # Si autres r\u00e9seaux priv\u00e9s\nacl localnet src 172.16.0.0/12       # Si autres r\u00e9seaux priv\u00e9s\n\n# R\u00e9seau SPOKE sp\u00e9cifique (plus restrictif)\nacl spoke_network src 192.168.10.0/24\n\n# Ports SSL standard\nacl SSL_ports port 443\n\n# Ports HTTP standard\nacl Safe_ports port 80          # http\nacl Safe_ports port 443         # https\nacl Safe_ports port 21          # ftp (si n\u00e9cessaire)\n\n# M\u00e9thode CONNECT (pour HTTPS)\nacl CONNECT method CONNECT\n\n#####################################################\n# SECTION 2 : WHITELIST DE DOMAINES\n#####################################################\n\n# Fichier externe de whitelist (recommand\u00e9)\nacl whitelist_domains dstdomain \"/etc/squid/whitelist.txt\"\n\n# Ou directement dans squid.conf (moins maintenable)\n# acl allowed_domains dstdomain .debian.org\n# acl allowed_domains dstdomain .ubuntu.com\n# acl allowed_domains dstdomain .microsoft.com\n# acl allowed_domains dstdomain .windowsupdate.com\n\n#####################################################\n# SECTION 3 : R\u00c8GLES D'ACC\u00c8S (ORDRE IMPORTANT !)\n#####################################################\n\n# Refuser les ports non-safe\nhttp_access deny !Safe_ports\n\n# Refuser CONNECT vers des ports non-SSL\nhttp_access deny CONNECT !SSL_ports\n\n# Autoriser localhost (pour les tests locaux)\nhttp_access allow localhost\n\n# Autoriser uniquement les domaines whitelist\u00e9s\nhttp_access allow localnet whitelist_domains\n\n# DENY ALL - R\u00e8gle finale (OBLIGATOIRE)\nhttp_access deny all\n\n#####################################################\n# SECTION 4 : CONFIGURATION R\u00c9SEAU\n#####################################################\n\n# Port d'\u00e9coute\nhttp_port 3128\n\n# Nom du serveur (pour les logs et headers)\nvisible_hostname srv-proxy-hub-01.internal\n\n# D\u00e9sactiver les headers r\u00e9v\u00e9lant la topologie\nforwarded_for delete\nvia off\n\n#####################################################\n# SECTION 5 : CACHE (Optionnel mais recommand\u00e9)\n#####################################################\n\n# Cache m\u00e9moire\ncache_mem 256 MB\n\n# Cache disque (attention \u00e0 l'espace)\ncache_dir ufs /var/spool/squid 10000 16 256\n# 10000 MB, 16 r\u00e9pertoires niveau 1, 256 niveau 2\n\n# Taille max des objets en cache\nmaximum_object_size 100 MB\n\n# Rafra\u00eechissement des packages Debian/Ubuntu\nrefresh_pattern -i \\.deb$ 129600 100% 129600 refresh-ims\nrefresh_pattern -i \\.rpm$ 129600 100% 129600 refresh-ims\n\n#####################################################\n# SECTION 6 : LOGGING\n#####################################################\n\n# Format des logs (combin\u00e9 pour analyse)\naccess_log /var/log/squid/access.log squid\n\n# Rotation des logs\nlogfile_rotate 7\n\n# Cache des logs\ncache_log /var/log/squid/cache.log\n</code></pre>"},{"location":"formations/linux/edge-services/#fichier-whitelist","title":"Fichier Whitelist","text":"<pre><code># /etc/squid/whitelist.txt\n# Domaines autoris\u00e9s pour les mises \u00e0 jour syst\u00e8me\n\n# Debian / Ubuntu\n.debian.org\n.ubuntu.com\n.canonical.com\n\n# Red Hat / Rocky / AlmaLinux\n.redhat.com\n.rockylinux.org\n.almalinux.org\n\n# Microsoft (Windows Update, Azure)\n.microsoft.com\n.windowsupdate.com\n.azure.com\n\n# Docker / Container Registries\n.docker.io\n.docker.com\n.gcr.io\n.ghcr.io\n\n# Monitoring / Outils\n.grafana.com\n.elastic.co\n\n# GitHub (releases, scripts)\n.github.com\n.githubusercontent.com\n\n# Python / Node (si n\u00e9cessaire)\n.pypi.org\n.npmjs.org\n</code></pre>"},{"location":"formations/linux/edge-services/#23-validation-et-rechargement","title":"2.3 Validation et Rechargement","text":"<pre><code># V\u00e9rifier la syntaxe AVANT de recharger\nsquid -k parse\n\n# Si OK, recharger la configuration (sans interruption)\nsquid -k reconfigure\n\n# Ou via systemctl\nsystemctl reload squid\n\n# V\u00e9rifier que le service est OK\nsystemctl status squid\n</code></pre>"},{"location":"formations/linux/edge-services/#24-debugging-et-troubleshooting","title":"2.4 Debugging et Troubleshooting","text":""},{"location":"formations/linux/edge-services/#lecture-des-logs-en-temps-reel","title":"Lecture des Logs en Temps R\u00e9el","text":"<pre><code># Suivre les acc\u00e8s en temps r\u00e9el\ntail -f /var/log/squid/access.log\n\n# Filtrer sur une IP sp\u00e9cifique\ntail -f /var/log/squid/access.log | grep \"192.168.10.50\"\n\n# Filtrer les erreurs uniquement\ntail -f /var/log/squid/access.log | grep -E \"(DENIED|ERROR|TIMEOUT)\"\n</code></pre>"},{"location":"formations/linux/edge-services/#comprendre-une-ligne-de-log","title":"Comprendre une Ligne de Log","text":"<pre><code>1706450123.456    150 192.168.10.50 TCP_DENIED/403 3900 GET http://malware.example.com/ - HIER_NONE/- text/html\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2502   \u2502                          \u2502 \u2502          \u2502\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2502   \u2502                          \u2502 \u2502          \u2514\u2500 Content-Type\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2502   \u2502                          \u2502 \u2514\u2500 Hi\u00e9rarchie (NONE = pas de parent)\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2502   \u2502                          \u2514\u2500 User (- = anonyme)\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2502   \u2514\u2500 URL demand\u00e9e\n\u2502                 \u2502   \u2502              \u2502              \u2502    \u2514\u2500 M\u00e9thode HTTP\n\u2502                 \u2502   \u2502              \u2502              \u2514\u2500 Taille r\u00e9ponse (bytes)\n\u2502                 \u2502   \u2502              \u2514\u2500 Code r\u00e9sultat (TCP_DENIED/403)\n\u2502                 \u2502   \u2514\u2500 IP Client\n\u2502                 \u2514\u2500 Dur\u00e9e (ms)\n\u2514\u2500 Timestamp Unix\n</code></pre>"},{"location":"formations/linux/edge-services/#codes-de-resultat-importants","title":"Codes de R\u00e9sultat Importants","text":"Code Signification Action <code>TCP_HIT/200</code> Servi depuis le cache OK <code>TCP_MISS/200</code> R\u00e9cup\u00e9r\u00e9 depuis Internet OK <code>TCP_DENIED/403</code> Bloqu\u00e9 par ACL V\u00e9rifier whitelist <code>TCP_DENIED/407</code> Auth requise V\u00e9rifier credentials <code>TCP_MISS/503</code> Serveur distant indisponible V\u00e9rifier Internet <code>NONE/400</code> Requ\u00eate malform\u00e9e V\u00e9rifier client <code>NONE/503</code> Squid surcharg\u00e9 V\u00e9rifier ressources"},{"location":"formations/linux/edge-services/#diagnostic-rapide","title":"Diagnostic Rapide","text":"<pre><code># Test depuis le serveur Squid lui-m\u00eame\ncurl -x http://localhost:3128 http://deb.debian.org/debian/\n# Doit retourner du HTML\n\n# Test depuis un client SPOKE\ncurl -x http://srv-proxy-hub-01.internal:3128 http://deb.debian.org/debian/\n# Doit retourner du HTML\n\n# Test d'un domaine NON whitelist\u00e9 (doit \u00eatre bloqu\u00e9)\ncurl -x http://srv-proxy-hub-01.internal:3128 http://example.com\n# Doit retourner une page d'erreur Squid (403)\n\n# V\u00e9rifier la connectivit\u00e9 du proxy vers Internet\nsquidclient -h localhost -p 3128 mgr:info | grep \"Request\"\n</code></pre>"},{"location":"formations/linux/edge-services/#problemes-courants-et-solutions","title":"Probl\u00e8mes Courants et Solutions","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              TROUBLESHOOTING SQUID                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8ME : TCP_DENIED/403 sur un domaine whitelist\u00e9          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500         \u2502\n\u2502   Causes possibles :                                            \u2502\n\u2502   1. Typo dans /etc/squid/whitelist.txt                         \u2502\n\u2502   2. Configuration pas recharg\u00e9e (squid -k reconfigure)         \u2502\n\u2502   3. Ordre des ACL incorrect                                    \u2502\n\u2502   4. IP client pas dans 'localnet'                              \u2502\n\u2502                                                                 \u2502\n\u2502   Diagnostic :                                                  \u2502\n\u2502   $ grep -i \"debian\" /etc/squid/whitelist.txt                   \u2502\n\u2502   $ squid -k parse 2&gt;&amp;1 | grep -i error                         \u2502\n\u2502   $ grep \"192.168.10\" /etc/squid/squid.conf                     \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8ME : NONE/503 - Service Unavailable                    \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                     \u2502\n\u2502   Causes possibles :                                            \u2502\n\u2502   1. Squid n'a pas acc\u00e8s \u00e0 Internet (firewall)                  \u2502\n\u2502   2. DNS ne fonctionne pas                                      \u2502\n\u2502   3. Proxy parent (cache_peer) down                             \u2502\n\u2502                                                                 \u2502\n\u2502   Diagnostic :                                                  \u2502\n\u2502   $ ping -c 2 8.8.8.8                                           \u2502\n\u2502   $ nslookup deb.debian.org                                     \u2502\n\u2502   $ curl -I http://deb.debian.org (sans proxy)                  \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8ME : Connexions lentes ou timeout                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                       \u2502\n\u2502   Causes possibles :                                            \u2502\n\u2502   1. Cache disque plein                                         \u2502\n\u2502   2. Trop de connexions simultan\u00e9es                             \u2502\n\u2502   3. DNS lent                                                   \u2502\n\u2502                                                                 \u2502\n\u2502   Diagnostic :                                                  \u2502\n\u2502   $ df -h /var/spool/squid                                      \u2502\n\u2502   $ squidclient mgr:info | grep \"Number of clients\"             \u2502\n\u2502   $ time nslookup deb.debian.org                                \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux/edge-services/#section-3-wc3s-echanges-de-fichiers-securises","title":"Section 3 : WC3S - \u00c9changes de Fichiers S\u00e9curis\u00e9s","text":""},{"location":"formations/linux/edge-services/#31-concept","title":"3.1 Concept","text":"<p>Le WC3S (Web Secure File Exchange) est un serveur de transfert de fichiers s\u00e9curis\u00e9 entre zones de s\u00e9curit\u00e9 diff\u00e9rentes.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE WC3S                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Zone SPOKE                    Zone HUB                        \u2502\n\u2502   (Confiance Basse)             (Confiance Haute)               \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502   \u2502 Utilisateur  \u2502             \u2502      srv-exchange-01         \u2502 \u2502\n\u2502   \u2502              \u2502             \u2502                              \u2502 \u2502\n\u2502   \u2502              \u2502\u2500\u2500\u2500\u2500HTTPS\u2500\u2500\u2500\u25ba\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502   \u2502              \u2502   Upload    \u2502  \u2502  /upload/               \u2502  \u2502 \u2502\n\u2502   \u2502              \u2502             \u2502  \u2502  (Write Only)           \u2502  \u2502 \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502                                \u2502              \u2502               \u2502 \u2502\n\u2502                                \u2502              \u25bc Scan AV       \u2502 \u2502\n\u2502                                \u2502                              \u2502 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502   \u2502 Utilisateur  \u2502             \u2502  \u2502  /download/             \u2502  \u2502 \u2502\n\u2502   \u2502              \u2502\u25c4\u2500\u2500\u2500HTTPS\u2500\u2500\u2500\u2500\u2502  \u2502  (Read Only)            \u2502  \u2502 \u2502\n\u2502   \u2502              \u2502   Download  \u2502  \u2502  (Directory Listing ON) \u2502  \u2502 \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502                                \u2502                              \u2502 \u2502\n\u2502                                \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                 \u2502\n\u2502   FLUX :                                                        \u2502\n\u2502   1. Upload vers /upload/ (pas de listing)                      \u2502\n\u2502   2. Scan antivirus automatique                                 \u2502\n\u2502   3. D\u00e9placement vers /download/ si clean                       \u2502\n\u2502   4. Download depuis /download/ (listing activ\u00e9)                \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux/edge-services/#32-installation-et-configuration-nginx","title":"3.2 Installation et Configuration Nginx","text":""},{"location":"formations/linux/edge-services/#installation","title":"Installation","text":"<pre><code># Debian/Ubuntu\napt update\napt install nginx -y\n\n# Cr\u00e9er les r\u00e9pertoires d'\u00e9change\nmkdir -p /srv/exchange/upload\nmkdir -p /srv/exchange/download\nmkdir -p /srv/exchange/quarantine\n\n# Permissions\nchown -R www-data:www-data /srv/exchange\nchmod 1733 /srv/exchange/upload    # Sticky bit, write-only\nchmod 755 /srv/exchange/download   # Read + listing\n</code></pre>"},{"location":"formations/linux/edge-services/#configuration-nginx-securisee","title":"Configuration Nginx S\u00e9curis\u00e9e","text":"<pre><code># /etc/nginx/sites-available/exchange.conf\n\nserver {\n    listen 443 ssl http2;\n    server_name srv-exchange-01.internal exchange.shellbook.local;\n\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # TLS 1.3 UNIQUEMENT (Exigence s\u00e9curit\u00e9)\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    ssl_certificate     /etc/nginx/ssl/exchange.crt;\n    ssl_certificate_key /etc/nginx/ssl/exchange.key;\n\n    ssl_protocols TLSv1.3;\n    ssl_prefer_server_ciphers off;\n\n    # Headers de s\u00e9curit\u00e9\n    add_header Strict-Transport-Security \"max-age=63072000\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-Frame-Options \"DENY\" always;\n\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Logs d\u00e9di\u00e9s\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    access_log /var/log/nginx/exchange_access.log combined;\n    error_log /var/log/nginx/exchange_error.log warn;\n\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Zone UPLOAD (Write-Only, No Directory Listing)\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    location /upload/ {\n        alias /srv/exchange/upload/;\n\n        # M\u00e9thodes autoris\u00e9es\n        limit_except PUT POST {\n            deny all;\n        }\n\n        # Taille max des fichiers (ajuster selon besoin)\n        client_max_body_size 500M;\n\n        # WebDAV pour les uploads (optionnel)\n        dav_methods PUT;\n        dav_access user:rw group:r all:r;\n\n        # PAS DE DIRECTORY LISTING (s\u00e9curit\u00e9)\n        autoindex off;\n\n        # Authentification Basic (optionnel)\n        # auth_basic \"Upload Zone\";\n        # auth_basic_user_file /etc/nginx/.htpasswd_upload;\n    }\n\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Zone DOWNLOAD (Read-Only, Directory Listing ON)\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    location /download/ {\n        alias /srv/exchange/download/;\n\n        # Lecture seule\n        limit_except GET HEAD {\n            deny all;\n        }\n\n        # Directory Listing ACTIV\u00c9 (pour voir les fichiers)\n        autoindex on;\n        autoindex_exact_size off;\n        autoindex_localtime on;\n        autoindex_format html;\n\n        # Authentification (optionnel)\n        # auth_basic \"Download Zone\";\n        # auth_basic_user_file /etc/nginx/.htpasswd_download;\n    }\n\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Page d'accueil\n    # \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    location / {\n        return 200 '&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;&lt;title&gt;WC3S - Secure Exchange&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Secure File Exchange&lt;/h1&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"/upload/\"&gt;Upload Zone&lt;/a&gt; (Write-Only)&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/download/\"&gt;Download Zone&lt;/a&gt; (Read-Only)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; All transfers are logged and audited.&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;';\n        add_header Content-Type text/html;\n    }\n}\n\n# Redirection HTTP -&gt; HTTPS\nserver {\n    listen 80;\n    server_name srv-exchange-01.internal exchange.shellbook.local;\n    return 301 https://$server_name$request_uri;\n}\n</code></pre>"},{"location":"formations/linux/edge-services/#33-directory-listing-quand-lactiver","title":"3.3 Directory Listing : Quand l'Activer ?","text":"R\u00e9pertoire autoindex Raison <code>/upload/</code> off S\u00e9curit\u00e9 : ne pas r\u00e9v\u00e9ler les fichiers upload\u00e9s <code>/download/</code> on Pratique : permettre aux users de voir les fichiers disponibles <code>/admin/</code> off S\u00e9curit\u00e9 : jamais sur les zones d'administration <code>/public/</code> on Partage intentionnel de fichiers"},{"location":"formations/linux/edge-services/#34-securisation-avancee-chroot-sftp","title":"3.4 S\u00e9curisation Avanc\u00e9e : Chroot SFTP","text":"<p>Pour les utilisateurs qui d\u00e9posent des fichiers via SFTP (au lieu de HTTPS) :</p> <pre><code># /etc/ssh/sshd_config\n\n# Groupe d\u00e9di\u00e9 aux utilisateurs d'\u00e9change\nMatch Group exchange_users\n    # Chroot dans le r\u00e9pertoire d'\u00e9change\n    ChrootDirectory /srv/exchange\n\n    # SFTP uniquement (pas de shell)\n    ForceCommand internal-sftp\n\n    # Restrictions\n    AllowTcpForwarding no\n    X11Forwarding no\n    PermitTunnel no\n\n    # Logging\n    PasswordAuthentication yes\n</code></pre> <pre><code># Cr\u00e9er le groupe et un utilisateur\ngroupadd exchange_users\nuseradd -g exchange_users -s /usr/sbin/nologin -d /srv/exchange uploader\n\n# Le r\u00e9pertoire chroot doit appartenir \u00e0 root\nchown root:root /srv/exchange\nchmod 755 /srv/exchange\n\n# Mais le sous-dossier upload appartient \u00e0 l'utilisateur\nchown uploader:exchange_users /srv/exchange/upload\nchmod 1755 /srv/exchange/upload\n\n# Red\u00e9marrer SSH\nsystemctl restart sshd\n</code></pre> <p>Test : <pre><code>sftp uploader@srv-exchange-01.internal\n# L'utilisateur est \"emprisonn\u00e9\" dans /srv/exchange\n# Il peut \u00e9crire dans /upload mais pas ailleurs\n</code></pre></p>"},{"location":"formations/linux/edge-services/#35-script-de-scan-et-deplacement","title":"3.5 Script de Scan et D\u00e9placement","text":"<pre><code>#!/bin/bash\n# /usr/local/bin/scan-and-move.sh\n# Scanne les fichiers upload\u00e9s et les d\u00e9place si clean\n\nUPLOAD_DIR=\"/srv/exchange/upload\"\nDOWNLOAD_DIR=\"/srv/exchange/download\"\nQUARANTINE_DIR=\"/srv/exchange/quarantine\"\nLOG_FILE=\"/var/log/exchange-scan.log\"\n\nlog() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" &gt;&gt; \"$LOG_FILE\"\n}\n\n# Scanner avec ClamAV\nfor file in \"$UPLOAD_DIR\"/*; do\n    [ -f \"$file\" ] || continue\n\n    filename=$(basename \"$file\")\n    log \"Scanning: $filename\"\n\n    if clamscan --no-summary \"$file\" &gt; /dev/null 2&gt;&amp;1; then\n        # Clean - d\u00e9placer vers download\n        mv \"$file\" \"$DOWNLOAD_DIR/\"\n        chown www-data:www-data \"$DOWNLOAD_DIR/$filename\"\n        chmod 644 \"$DOWNLOAD_DIR/$filename\"\n        log \"CLEAN: $filename moved to download\"\n    else\n        # Infected - quarantaine\n        mv \"$file\" \"$QUARANTINE_DIR/\"\n        log \"INFECTED: $filename moved to quarantine\"\n        # Alerte (optionnel)\n        # mail -s \"ALERT: Infected file detected\" admin@shellbook.local &lt; /dev/null\n    fi\ndone\n</code></pre> <pre><code># Crontab pour ex\u00e9cuter toutes les 5 minutes\necho \"*/5 * * * * root /usr/local/bin/scan-and-move.sh\" &gt;&gt; /etc/crontab\n</code></pre>"},{"location":"formations/linux/edge-services/#commandes-de-reference-rapide","title":"Commandes de R\u00e9f\u00e9rence Rapide","text":""},{"location":"formations/linux/edge-services/#squid","title":"Squid","text":"<pre><code># === SERVICE ===\nsystemctl status squid\nsystemctl restart squid\nsquid -k reconfigure      # Recharger sans interruption\n\n# === VALIDATION ===\nsquid -k parse            # V\u00e9rifier syntaxe\n\n# === LOGS ===\ntail -f /var/log/squid/access.log\ntail -f /var/log/squid/access.log | grep DENIED\n\n# === STATS ===\nsquidclient mgr:info\nsquidclient mgr:utilization\n\n# === CACHE ===\nsquid -k shutdown         # Arr\u00eat propre\nrm -rf /var/spool/squid/* # Vider le cache (si n\u00e9cessaire)\nsquid -z                  # Recr\u00e9er le cache\nsystemctl start squid\n</code></pre>"},{"location":"formations/linux/edge-services/#nginx-wc3s","title":"Nginx (WC3S)","text":"<pre><code># === SERVICE ===\nsystemctl status nginx\nnginx -t                  # V\u00e9rifier syntaxe\nsystemctl reload nginx    # Recharger\n\n# === LOGS ===\ntail -f /var/log/nginx/exchange_access.log\ntail -f /var/log/nginx/exchange_error.log\n\n# === TLS ===\nopenssl s_client -connect srv-exchange-01.internal:443 -tls1_3\n# V\u00e9rifier que TLS 1.3 est bien utilis\u00e9\n</code></pre>"},{"location":"formations/linux/edge-services/#tests-de-connectivite","title":"Tests de Connectivit\u00e9","text":"<pre><code># Depuis un client SPOKE\ncurl -v -x http://srv-proxy-hub-01.internal:3128 https://deb.debian.org\n\n# Upload via curl\ncurl -X PUT --data-binary @fichier.txt https://srv-exchange-01.internal/upload/fichier.txt\n\n# Download\ncurl -O https://srv-exchange-01.internal/download/fichier.txt\n</code></pre>"},{"location":"formations/linux/edge-services/#checklist-operationnelle","title":"Checklist Op\u00e9rationnelle","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST AVANT MISE EN PRODUCTION                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   SQUID PROXY                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   \u2610 squid -k parse retourne 0 erreurs                           \u2502\n\u2502   \u2610 Whitelist contient tous les domaines n\u00e9cessaires            \u2502\n\u2502   \u2610 ACL localnet inclut tous les r\u00e9seaux SPOKE                  \u2502\n\u2502   \u2610 Logs rotation configur\u00e9e (logrotate)                        \u2502\n\u2502   \u2610 Monitoring en place (Prometheus/Grafana)                    \u2502\n\u2502   \u2610 Backup de squid.conf versionn\u00e9                              \u2502\n\u2502                                                                 \u2502\n\u2502   WC3S EXCHANGE                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u2610 TLS 1.3 uniquement (ssl_protocols TLSv1.3)                  \u2502\n\u2502   \u2610 Certificat valide et non expir\u00e9                             \u2502\n\u2502   \u2610 Directory listing OFF sur /upload/                          \u2502\n\u2502   \u2610 Permissions correctes (upload: 1733, download: 755)         \u2502\n\u2502   \u2610 Scan antivirus actif et programm\u00e9                           \u2502\n\u2502   \u2610 Espace disque suffisant sur /srv/exchange                   \u2502\n\u2502                                                                 \u2502\n\u2502   G\u00c9N\u00c9RAL                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2610 Firewall rules document\u00e9es et test\u00e9es                       \u2502\n\u2502   \u2610 Proc\u00e9dure de failover document\u00e9e (si HA)                    \u2502\n\u2502   \u2610 Contacts d'escalade \u00e0 jour                                  \u2502\n\u2502   \u2610 Runbook de troubleshooting accessible                       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux/edge-services/#contacts-et-escalade","title":"Contacts et Escalade","text":"<p>En Cas d'Incident sur ces Services</p> <ol> <li>Niveau 1 : \u00c9quipe Ops (v\u00e9rifier les logs, restart services)</li> <li>Niveau 2 : \u00c9quipe R\u00e9seau (firewall, routing)</li> <li>Niveau 3 : \u00c9quipe S\u00e9curit\u00e9 (si suspicion de compromission)</li> </ol> <p>Astreinte : Consulter le planning d'astreinte interne.</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Infrastructure Team Classification : Interne - Op\u00e9rationnel</p>"},{"location":"formations/linux-perf/","title":"Formation : Investigation de Performance Linux","text":""},{"location":"formations/linux-perf/#introduction","title":"Introduction","text":"<p>\"Le serveur est lent.\"</p> <p>Cette phrase, tout ing\u00e9nieur d'exploitation l'a entendue des centaines de fois. La diff\u00e9rence entre un op\u00e9rateur et un SRE (Site Reliability Engineer) r\u00e9side dans la capacit\u00e9 \u00e0 transformer cette plainte vague en un diagnostic pr\u00e9cis et actionnable.</p> <p>Cette formation vous donnera les outils et la m\u00e9thodologie pour r\u00e9pondre m\u00e9thodiquement \u00e0 la question : \"Pourquoi le serveur est-il lent ?\"</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              LE PROBL\u00c8ME DE L'INVESTIGATION AD-HOC               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Approche Na\u00efve :                                              \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                              \u2502\n\u2502   1. \"Le serveur est lent\"                                      \u2502\n\u2502   2. Lancer `top`                                               \u2502\n\u2502   3. \"Je ne vois rien d'anormal...\"                             \u2502\n\u2502   4. Red\u00e9marrer le service                                      \u2502\n\u2502   5. \"\u00c7a remarche... pour l'instant\"                            \u2502\n\u2502   6. Le probl\u00e8me revient 3 jours plus tard                      \u2502\n\u2502                                                                 \u2502\n\u2502   Approche SRE :                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502   1. \"Le serveur est lent\"                                      \u2502\n\u2502   2. Appliquer la m\u00e9thode USE syst\u00e9matiquement                  \u2502\n\u2502   3. Identifier la ressource satur\u00e9e                            \u2502\n\u2502   4. Trouver le processus responsable                           \u2502\n\u2502   5. Comprendre la cause racine                                 \u2502\n\u2502   6. Corriger ET documenter                                     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/#la-methode-use","title":"La M\u00e9thode USE","text":""},{"location":"formations/linux-perf/#presentation","title":"Pr\u00e9sentation","text":"<p>La m\u00e9thode USE (Utilization, Saturation, Errors) a \u00e9t\u00e9 cr\u00e9\u00e9e par Brendan Gregg, ing\u00e9nieur performance chez Netflix et auteur des outils BPF/eBPF. C'est une approche syst\u00e9matique pour identifier les goulots d'\u00e9tranglement.</p> <p>Les Trois M\u00e9triques Fondamentales</p> <p>Pour chaque ressource du syst\u00e8me (CPU, RAM, Disque, R\u00e9seau), posez ces trois questions :</p> M\u00e9trique Question Exemple Utilization Quel pourcentage de la capacit\u00e9 est utilis\u00e9 ? CPU \u00e0 85% Saturation Y a-t-il une file d'attente ? 10 processus en attente de CPU Errors Y a-t-il des erreurs ? Erreurs disque, paquets dropp\u00e9s"},{"location":"formations/linux-perf/#application-systematique","title":"Application Syst\u00e9matique","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    M\u00c9THODE USE - CHECKLIST                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   RESSOURCE       \u2502 UTILIZATION    \u2502 SATURATION    \u2502 ERRORS    \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502   CPU             \u2502 mpstat, top    \u2502 load average  \u2502 dmesg     \u2502\n\u2502                   \u2502 %usr + %sys    \u2502 vmstat (r)    \u2502 perf      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502   M\u00e9moire         \u2502 free -h        \u2502 vmstat (si/so)\u2502 dmesg     \u2502\n\u2502                   \u2502 /proc/meminfo  \u2502 oom-killer    \u2502 EDAC      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502   Disque          \u2502 iostat %util   \u2502 iostat avgqu  \u2502 smartctl  \u2502\n\u2502                   \u2502 sar -d         \u2502 await \u00e9lev\u00e9   \u2502 dmesg     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502   R\u00e9seau          \u2502 sar -n DEV     \u2502 ifconfig      \u2502 ifconfig  \u2502\n\u2502                   \u2502 nload, iftop   \u2502 (overruns)    \u2502 (errors)  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/#au-dela-de-top","title":"Au-del\u00e0 de <code>top</code>","text":"<p><code>top</code> est un excellent outil pour un premier aper\u00e7u, mais il a ses limites :</p> Ce que <code>top</code> montre Ce que <code>top</code> ne montre PAS Usage CPU global I/O Wait par processus M\u00e9moire utilis\u00e9e Activit\u00e9 Swap en temps r\u00e9el Processus actifs Latence disque PID et commandes D\u00e9bit r\u00e9seau <p>Cette formation vous apprendra \u00e0 utiliser les bons outils pour chaque investigation.</p>"},{"location":"formations/linux-perf/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 4 modules couvrant les 4 ressources critiques :</p>"},{"location":"formations/linux-perf/#module-1-cpu-load-average","title":"Module 1 : CPU &amp; Load Average","text":"<p>:material-cpu-64-bit: Le Processeur | :material-clock-outline: ~45 min</p> <ul> <li>Comprendre le Load Average (ce n'est PAS le % CPU)</li> <li>Le myst\u00e8re du \"High Load, Low CPU\" \u2192 I/O Wait</li> <li>Outils : <code>htop</code>, <code>mpstat</code>, <code>pidstat</code></li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/linux-perf/#module-2-memoire-swap","title":"Module 2 : M\u00e9moire &amp; Swap","text":"<p>:material-memory: La RAM | :material-clock-outline: ~45 min</p> <ul> <li>Free vs Available (le pi\u00e8ge des buffers/cache)</li> <li>Pourquoi le swap d\u00e9truit les performances</li> <li>Outils : <code>free</code>, <code>vmstat</code>, <code>/proc/meminfo</code></li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/linux-perf/#module-3-disque-io","title":"Module 3 : Disque &amp; I/O","text":"<p>:material-harddisk: Le Stockage | :material-clock-outline: ~60 min</p> <ul> <li>IOPS vs Throughput (MB/s)</li> <li>Latence disque : le tueur silencieux</li> <li>Outils : <code>iostat</code>, <code>iotop</code>, analyse du <code>await</code></li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/linux-perf/#module-4-reseau-latence","title":"Module 4 : R\u00e9seau &amp; Latence","text":"<p>:material-lan: Le R\u00e9seau | :material-clock-outline: ~45 min</p> <ul> <li>Bande passante \u2260 Latence</li> <li>Investigation des sockets et connexions</li> <li>Outils : <code>ss</code>, <code>iftop</code>, <code>mtr</code></li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 4</p>"},{"location":"formations/linux-perf/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>Linux CLI : Navigation, pipes, redirections</li> <li>Processus : PID, PPID, signaux (<code>kill</code>, <code>ps</code>)</li> <li>Syst\u00e8me de fichiers : Montage, <code>/proc</code>, <code>/sys</code></li> <li>R\u00e9seau de base : IP, ports, TCP/UDP</li> </ul>"},{"location":"formations/linux-perf/#environnement-de-lab","title":"Environnement de Lab","text":"Distribution Recommand\u00e9eInstallation des Outils <pre><code># Cette formation est test\u00e9e sur :\n# - Ubuntu 20.04+ / Debian 11+\n# - RHEL 8+ / Rocky Linux 8+\n# - Amazon Linux 2\n\n# V\u00e9rifier la version du kernel\nuname -r\n# Recommand\u00e9 : 4.15+ pour les fonctionnalit\u00e9s BPF\n</code></pre> <pre><code># Debian/Ubuntu\nsudo apt update\nsudo apt install -y sysstat htop iotop iftop nload mtr-tiny stress-ng\n\n# RHEL/Rocky/Alma\nsudo dnf install -y sysstat htop iotop iftop nload mtr stress-ng\n\n# Activer la collecte sysstat (pour sar)\nsudo systemctl enable --now sysstat\n</code></pre>"},{"location":"formations/linux-perf/#methodologie-dinvestigation","title":"M\u00e9thodologie d'Investigation","text":""},{"location":"formations/linux-perf/#le-workflow-sre","title":"Le Workflow SRE","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              WORKFLOW D'INVESTIGATION PERFORMANCE                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. TRIAGE INITIAL (30 secondes)                               \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                              \u2502\n\u2502      $ uptime           # Load average                          \u2502\n\u2502      $ dmesg -T | tail  # Erreurs kernel r\u00e9centes               \u2502\n\u2502      $ free -h          # \u00c9tat m\u00e9moire                          \u2502\n\u2502                                                                 \u2502\n\u2502   2. IDENTIFICATION RESSOURCE (2 minutes)                       \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                       \u2502\n\u2502      Appliquer USE sur CPU, RAM, Disk, Network                  \u2502\n\u2502      Identifier la ressource satur\u00e9e                            \u2502\n\u2502                                                                 \u2502\n\u2502   3. IDENTIFICATION PROCESSUS (2 minutes)                       \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                      \u2502\n\u2502      $ pidstat 1        # CPU par process                       \u2502\n\u2502      $ iotop            # I/O par process                       \u2502\n\u2502      $ ss -tulpn        # Sockets par process                   \u2502\n\u2502                                                                 \u2502\n\u2502   4. ANALYSE APPROFONDIE (variable)                             \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2502\n\u2502      Logs applicatifs, traces, profiling                        \u2502\n\u2502                                                                 \u2502\n\u2502   5. REM\u00c9DIATION &amp; DOCUMENTATION                                \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                            \u2502\n\u2502      Corriger, documenter, monitorer                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/#les-60-premieres-secondes","title":"Les 60 Premi\u00e8res Secondes","text":"<p>Brendan Gregg propose cette checklist pour les 60 premi\u00e8res secondes sur un serveur en difficult\u00e9 :</p> <pre><code># 1. Load et uptime\nuptime\n\n# 2. Erreurs kernel\ndmesg -T | tail -20\n\n# 3. Statistiques CPU\nvmstat 1 5\n\n# 4. Statistiques m\u00e9moire\nfree -h\n\n# 5. I/O disque\niostat -xz 1 3\n\n# 6. Statistiques r\u00e9seau\nsar -n DEV 1 3\n\n# 7. Processus par CPU\npidstat 1 3\n\n# 8. Processus par I/O\niotop -b -n 3\n\n# 9. Vue d'ensemble\ntop -b -n 1 | head -20\n</code></pre>"},{"location":"formations/linux-perf/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/linux-perf/#references-essentielles","title":"R\u00e9f\u00e9rences Essentielles","text":"<ul> <li>:material-link: Brendan Gregg - USE Method</li> <li>:material-link: Linux Performance Analysis in 60s</li> <li>:material-link: Netflix Tech Blog - Linux Performance</li> </ul>"},{"location":"formations/linux-perf/#outils-avances-hors-scope","title":"Outils Avanc\u00e9s (Hors Scope)","text":"Outil Usage Niveau <code>perf</code> Profiling CPU Avanc\u00e9 <code>bpftrace</code> Tracing kernel Expert <code>flame graphs</code> Visualisation CPU Avanc\u00e9 <code>strace</code> Syscalls debugging Interm\u00e9diaire <p>Brendan Gregg</p> <p>\"Understanding the USE method means you can apply it to any system, any component, even components that haven't been invented yet.\"</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook SRE Team</p>"},{"location":"formations/linux-perf/01-cpu-load/","title":"Module 1 : CPU &amp; Load Average","text":""},{"location":"formations/linux-perf/01-cpu-load/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Interpr\u00e9ter correctement le Load Average</li> <li>:material-check: Distinguer CPU-bound et I/O-bound</li> <li>:material-check: Diagnostiquer le sc\u00e9nario \"High Load, Low CPU\"</li> <li>:material-check: Identifier le processus responsable de la charge</li> </ul>"},{"location":"formations/linux-perf/01-cpu-load/#1-le-load-average-la-metrique-la-plus-mal-comprise","title":"1. Le Load Average : La M\u00e9trique la Plus Mal Comprise","text":""},{"location":"formations/linux-perf/01-cpu-load/#11-ce-que-tout-le-monde-croit","title":"1.1 Ce que Tout le Monde Croit","text":"<p>\"Le Load Average, c'est le pourcentage d'utilisation CPU.\"</p> <p>FAUX. C'est l'erreur la plus r\u00e9pandue chez les administrateurs syst\u00e8me.</p>"},{"location":"formations/linux-perf/01-cpu-load/#12-la-vraie-definition","title":"1.2 La Vraie D\u00e9finition","text":"<p>D\u00e9finition Correcte</p> <p>Le Load Average repr\u00e9sente le nombre moyen de processus dans la file d'ex\u00e9cution (runnable) OU en attente d'I/O (uninterruptible sleep) sur les 1, 5 et 15 derni\u00e8res minutes.</p> <pre><code>$ uptime\n 14:32:15 up 45 days,  3:21,  2 users,  load average: 4.52, 3.87, 2.15\n                                                      \u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\n                                                      1min  5min  15min\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#13-interpretation","title":"1.3 Interpr\u00e9tation","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              INTERPR\u00c9TATION DU LOAD AVERAGE                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Serveur avec 4 CPUs :                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502                                                                 \u2502\n\u2502   Load = 1.0   \u2502 25% de capacit\u00e9 utilis\u00e9e                       \u2502\n\u2502                \u2502 Tout va bien                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502\n\u2502   Load = 4.0   \u2502 100% de capacit\u00e9 utilis\u00e9e                      \u2502\n\u2502                \u2502 Tous les CPUs sont occup\u00e9s, pas de file        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502\n\u2502   Load = 8.0   \u2502 200% ! Surcharge                               \u2502\n\u2502                \u2502 4 processus actifs + 4 en attente              \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502\n\u2502   Load = 0.5   \u2502 12.5% - Le syst\u00e8me est sous-utilis\u00e9            \u2502\n\u2502                \u2502                                                 \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udcd0 R\u00c8GLE : Load / Nombre_CPUs = Ratio de charge               \u2502\n\u2502              Ratio &gt; 1.0 = Saturation                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># Nombre de CPUs (ou cores)\nnproc\n\n# Ou\ngrep -c processor /proc/cpuinfo\n\n# Calcul du ratio\necho \"Load: $(uptime | awk -F'load average:' '{print $2}' | cut -d, -f1)\"\necho \"CPUs: $(nproc)\"\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#14-la-tendance-est-importante","title":"1.4 La Tendance est Importante","text":"<pre><code>Load Average: 12.52, 8.87, 4.15\n              \u2500\u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\n              Maintenant   Il y a 15 min\n\n              \u2191 La charge AUGMENTE (probl\u00e8me en cours)\n\nLoad Average: 4.15, 8.87, 12.52\n              \u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500  \u2500\u2500\u2500\u2500\u2500\n              Maintenant   Il y a 15 min\n\n              \u2193 La charge DIMINUE (probl\u00e8me en r\u00e9solution)\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#2-le-mystere-high-load-low-cpu-usage","title":"2. Le Myst\u00e8re : High Load, Low CPU Usage","text":""},{"location":"formations/linux-perf/01-cpu-load/#21-le-scenario","title":"2.1 Le Sc\u00e9nario","text":"<p>Vous observez :</p> <pre><code>$ uptime\nload average: 25.43, 24.12, 22.87    # Charge tr\u00e8s \u00e9lev\u00e9e !\n\n$ top\n%Cpu(s):  3.2 us,  1.1 sy,  0.0 ni, 94.5 id,  1.2 wa,  0.0 hi,  0.0 si\n                                     \u2500\u2500\u2500\u2500\n                                     94.5% IDLE ?!\n</code></pre> <p>Comment le CPU peut-il \u00eatre \u00e0 94% idle avec un load de 25 ?!</p>"},{"location":"formations/linux-perf/01-cpu-load/#22-lexplication-io-wait","title":"2.2 L'Explication : I/O Wait","text":"<p>Le Coupable : I/O Wait</p> <p>Le Load Average inclut les processus en \u00e9tat \"D\" (Uninterruptible Sleep), c'est-\u00e0-dire en attente d'I/O disque ou r\u00e9seau.</p> <p>Ces processus sont compt\u00e9s dans le load mais ne consomment pas de CPU.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PROCESSUS ET LOAD AVERAGE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u00c9tat \"R\" (Running/Runnable)     \u2192  Compte dans le Load        \u2502\n\u2502   Le processus utilise ou attend     ET utilise le CPU          \u2502\n\u2502   le CPU                                                        \u2502\n\u2502                                                                 \u2502\n\u2502   \u00c9tat \"D\" (Uninterruptible Sleep) \u2192 Compte dans le Load        \u2502\n\u2502   Le processus attend une I/O         mais N'utilise PAS le CPU \u2502\n\u2502   (disque, r\u00e9seau NFS, etc.)                                    \u2502\n\u2502                                                                 \u2502\n\u2502   \u00c9tat \"S\" (Sleeping)             \u2192  NE compte PAS              \u2502\n\u2502   Le processus dort (attente                                    \u2502\n\u2502   d'\u00e9v\u00e9nement, timer, etc.)                                     \u2502\n\u2502                                                                 \u2502\n\u2502   CONCLUSION :                                                  \u2502\n\u2502   High Load + Low CPU = Beaucoup de processus en \u00e9tat \"D\"       \u2502\n\u2502                       = Probl\u00e8me d'I/O (disque ou r\u00e9seau)       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#23-diagnostic","title":"2.3 Diagnostic","text":"<pre><code># Voir les processus en \u00e9tat D (Uninterruptible Sleep)\nps aux | awk '$8 ~ /D/ {print}'\n\n# Ou avec top (regarder la colonne S pour \"D\")\ntop -b -n 1 | grep \" D \"\n\n# V\u00e9rifier l'I/O Wait dans vmstat\nvmstat 1 5\n# Colonne \"wa\" (wait) dans la section CPU\n\n# V\u00e9rifier avec iostat\niostat -x 1 3\n# Regarder %util et await\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#3-les-outils-dinvestigation-cpu","title":"3. Les Outils d'Investigation CPU","text":""},{"location":"formations/linux-perf/01-cpu-load/#31-htop-la-vue-visuelle","title":"3.1 htop : La Vue Visuelle","text":"<p><code>htop</code> est une version am\u00e9lior\u00e9e de <code>top</code> avec une interface interactive :</p> <pre><code>htop\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  htop - Vue Interactive                                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502  CPU[||||||||||||||||                    45.2%]   Tasks: 234    \u2502\n\u2502  CPU[||||||||||||||||||||||              62.8%]   Load: 4.52    \u2502\n\u2502  CPU[|||||||                             18.3%]   Uptime: 45d   \u2502\n\u2502  CPU[|||||||||||||||||||||||||||||       78.1%]                 \u2502\n\u2502  Mem[||||||||||||||||||||||||||    4.2G/16.0G]                  \u2502\n\u2502  Swp[                               0K/2.0G]                    \u2502\n\u2502                                                                 \u2502\n\u2502  PID  USER   PRI  NI  VIRT   RES   SHR S CPU% MEM%   TIME+  CMD \u2502\n\u2502  1234 mysql   20   0 4096M 2048M  128M S 45.2  12.8 123:45 mysql\u2502\n\u2502  5678 www     20   0  512M  256M   64M S 18.3   1.6  45:23 php  \u2502\n\u2502                                                                 \u2502\n\u2502  F1=Aide  F2=Setup  F3=Search  F4=Filter  F5=Tree  F6=Sort     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Touches Utiles :</p> Touche Action <code>F5</code> Vue arborescente (processus parent/enfant) <code>F6</code> Trier par colonne <code>F4</code> Filtrer par nom <code>u</code> Filtrer par utilisateur <code>H</code> Afficher/masquer les threads <code>t</code> Afficher en mode arbre <code>P</code> Trier par CPU <code>M</code> Trier par M\u00e9moire"},{"location":"formations/linux-perf/01-cpu-load/#32-mpstat-analyse-par-cur","title":"3.2 mpstat : Analyse Par C\u0153ur","text":"<p><code>mpstat</code> montre l'utilisation CPU par c\u0153ur, essentiel pour d\u00e9tecter les d\u00e9s\u00e9quilibres :</p> <pre><code># Statistiques de tous les CPUs, toutes les secondes\nmpstat -P ALL 1\n</code></pre> <pre><code>Linux 5.4.0-generic    01/28/25    _x86_64_    (4 CPU)\n\n14:35:01     CPU    %usr   %nice    %sys %iowait   %irq   %soft  %steal   %idle\n14:35:02     all   45.25    0.00   12.31    8.52   0.00    0.25    0.00   33.67\n14:35:02       0   92.08    0.00    5.94    0.00   0.00    0.99    0.00    0.99\n14:35:02       1   12.00    0.00    4.00   32.00   0.00    0.00    0.00   52.00\n14:35:02       2   45.54    0.00   18.81    2.97   0.00    0.00    0.00   32.67\n14:35:02       3   31.37    0.00   20.59    0.00   0.00    0.00    0.00   48.04\n</code></pre> <p>Colonnes Importantes :</p> Colonne Description Alerte Si <code>%usr</code> Code utilisateur (applications) &gt; 90% soutenu <code>%sys</code> Code kernel (syscalls) &gt; 30% (probl\u00e8me kernel) <code>%iowait</code> Attente I/O &gt; 20% (goulot disque) <code>%steal</code> Vol\u00e9 par hyperviseur &gt; 10% (VM surcommise) <code>%idle</code> Inactif &lt; 10% = saturation <p>CPU0 \u00e0 92% et les autres \u00e0 30-50% ?</p> <p>Cela indique un processus mono-thread\u00e9 qui monopolise un seul c\u0153ur. Typique des applications legacy non parall\u00e9lis\u00e9es.</p>"},{"location":"formations/linux-perf/01-cpu-load/#33-pidstat-analyse-par-processus","title":"3.3 pidstat : Analyse Par Processus","text":"<p><code>pidstat</code> montre l'utilisation CPU par processus :</p> <pre><code># CPU par processus, toutes les secondes\npidstat 1\n\n# Avec les threads (-t)\npidstat -t 1\n\n# Pour un processus sp\u00e9cifique\npidstat -p 1234 1\n</code></pre> <pre><code>Linux 5.4.0-generic    01/28/25    _x86_64_    (4 CPU)\n\n14:40:01      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command\n14:40:02     1000      1234   85.00   12.00    0.00    3.00   97.00     0  stress\n14:40:02       33      5678   15.00    8.00    0.00    0.00   23.00     2  apache2\n14:40:02     1001      9012    5.00    2.00    0.00    1.00    7.00     1  python3\n</code></pre> <p>Colonnes Cl\u00e9s :</p> Colonne Description <code>%usr</code> CPU en mode utilisateur <code>%system</code> CPU en mode kernel <code>%wait</code> Temps pass\u00e9 \u00e0 attendre le CPU <code>%CPU</code> Total (sur tous les c\u0153urs) <code>CPU</code> Num\u00e9ro du c\u0153ur actuellement utilis\u00e9"},{"location":"formations/linux-perf/01-cpu-load/#4-scenarios-dinvestigation","title":"4. Sc\u00e9narios d'Investigation","text":""},{"location":"formations/linux-perf/01-cpu-load/#41-scenario-saturation-cpu-classique","title":"4.1 Sc\u00e9nario : Saturation CPU Classique","text":"<p>Sympt\u00f4mes :</p> <ul> <li>Load Average \u00e9lev\u00e9 (&gt; nombre de CPUs)</li> <li><code>%idle</code> tr\u00e8s bas dans <code>top</code></li> <li>Applications lentes</li> </ul> <p>Investigation :</p> <pre><code># 1. Confirmer la saturation\nmpstat 1 5\n# \u2192 %idle &lt; 10% sur plusieurs c\u0153urs\n\n# 2. Identifier le processus\npidstat 1 | sort -k 8 -rn | head\n# \u2192 Trier par %CPU d\u00e9croissant\n\n# 3. Analyser le processus\ntop -p &lt;PID&gt;\n# ou\nhtop -p &lt;PID&gt;\n\n# 4. Voir ce qu'il fait (syscalls)\nstrace -p &lt;PID&gt; -c\n# Ctrl+C apr\u00e8s quelques secondes pour le rapport\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#42-scenario-high-load-low-cpu-io-bound","title":"4.2 Sc\u00e9nario : High Load, Low CPU (I/O Bound)","text":"<p>Sympt\u00f4mes :</p> <ul> <li>Load Average tr\u00e8s \u00e9lev\u00e9</li> <li><code>%idle</code> &gt; 80%</li> <li><code>%iowait</code> visible</li> </ul> <p>Investigation :</p> <pre><code># 1. Confirmer l'I/O Wait\nvmstat 1 5\n# Regarder colonne \"wa\" (wait) et \"b\" (blocked)\n\n# 2. Identifier la source d'I/O\niotop -o\n# -o = only show processes doing I/O\n\n# 3. Voir les processus en \u00e9tat D\nps aux | awk '$8 ~ /D/'\n# ou\nfor pid in $(ps -eo pid,stat | awk '$2 ~ /D/ {print $1}'); do\n    echo \"=== PID $pid ===\"\n    cat /proc/$pid/cmdline 2&gt;/dev/null | tr '\\0' ' '\n    echo\ndone\n\n# 4. Analyser le disque\niostat -xz 1\n# Regarder %util et await\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#43-scenario-un-seul-core-sature","title":"4.3 Sc\u00e9nario : Un Seul Core Satur\u00e9","text":"<p>Sympt\u00f4mes :</p> <ul> <li>Load Average autour de 1.0</li> <li>Un CPU \u00e0 100%, les autres idle</li> <li>Application mono-thread\u00e9e lente</li> </ul> <p>Investigation :</p> <pre><code># 1. Confirmer avec mpstat\nmpstat -P ALL 1\n# \u2192 CPU0 \u00e0 95%, autres \u00e0 5%\n\n# 2. Trouver le processus\npidstat 1 | grep -E \"CPU|100\"\n# Colonne \"CPU\" indique le c\u0153ur\n\n# 3. Options de r\u00e9solution\n# - Optimiser l'application (parall\u00e9lisation)\n# - Augmenter la fr\u00e9quence CPU (scaling_governor)\n# - Lancer plusieurs instances\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#5-commandes-de-reference-rapide","title":"5. Commandes de R\u00e9f\u00e9rence Rapide","text":"<pre><code># === TRIAGE INITIAL ===\nuptime                          # Load average rapide\nnproc                           # Nombre de CPUs\n\n# === ANALYSE CPU ===\ntop                             # Vue temps r\u00e9el (q pour quitter)\nhtop                            # Vue am\u00e9lior\u00e9e\nmpstat -P ALL 1                 # Par c\u0153ur, chaque seconde\npidstat 1                       # Par processus, chaque seconde\npidstat -t 1                    # Par thread\n\n# === PROCESSUS EN ATTENTE ===\nvmstat 1                        # Colonne \"r\" = runnable, \"b\" = blocked\nps aux | awk '$8 ~ /D/'         # Processus en I/O wait\n\n# === ANALYSE AVANC\u00c9E ===\nperf top                        # Profiling temps r\u00e9el (n\u00e9cessite perf)\nstrace -p &lt;PID&gt; -c              # Syscalls d'un processus\n</code></pre>"},{"location":"formations/linux-perf/01-cpu-load/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Un serveur 4 CPUs affiche un load average de 4.0. Est-ce un probl\u00e8me ? <p>R\u00e9ponse : Pas n\u00e9cessairement. Un load de 4.0 sur 4 CPUs signifie que le syst\u00e8me tourne \u00e0 100% de sa capacit\u00e9 th\u00e9orique. Ce n'est pas une surcharge (pas de file d'attente), mais c'est la limite. Au-del\u00e0 de 4.0, les processus commenceront \u00e0 attendre.</p> <p>La vraie question est : les applications r\u00e9pondent-elles dans des temps acceptables ?</p> Question 2 : Vous voyez un load de 50 mais un %idle de 85%. Que se passe-t-il ? <p>R\u00e9ponse : C'est le sc\u00e9nario classique High Load, Low CPU. De nombreux processus sont en \u00e9tat \"D\" (Uninterruptible Sleep), attendant des I/O disque ou r\u00e9seau. Ils sont compt\u00e9s dans le load mais ne consomment pas de CPU.</p> <p>Action : Investiguer le disque avec <code>iostat</code> et identifier les processus avec <code>iotop</code>.</p> Question 3 : Quelle est la diff\u00e9rence entre %iowait et %steal ? <p>R\u00e9ponse :</p> <ul> <li> <p>%iowait : Le CPU est idle mais attend qu'une I/O se termine. Indique un probl\u00e8me de performance disque.</p> </li> <li> <p>%steal : Dans une VM, c'est le temps o\u00f9 l'hyperviseur a \"vol\u00e9\" du CPU pour d'autres VMs. Indique que l'h\u00f4te physique est surcharg\u00e9.</p> </li> </ul>"},{"location":"formations/linux-perf/01-cpu-load/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Le CPU n'est qu'une partie de l'\u00e9quation. D\u00e9couvrez comment la m\u00e9moire peut affecter les performances.</p> <p>:octicons-arrow-right-24: Module 2 : M\u00e9moire &amp; Swap</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/linux-perf/02-memory-swap/","title":"Module 2 : M\u00e9moire &amp; Swap","text":""},{"location":"formations/linux-perf/02-memory-swap/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre la gestion m\u00e9moire Linux (Buffers, Cache, Available)</li> <li>:material-check: Interpr\u00e9ter correctement la sortie de <code>free</code></li> <li>:material-check: D\u00e9tecter et diagnostiquer l'utilisation du swap</li> <li>:material-check: Identifier les processus consommateurs de m\u00e9moire</li> </ul>"},{"location":"formations/linux-perf/02-memory-swap/#1-la-gestion-memoire-linux","title":"1. La Gestion M\u00e9moire Linux","text":""},{"location":"formations/linux-perf/02-memory-swap/#11-le-mythe-de-la-ram-utilisee","title":"1.1 Le Mythe de la RAM \"Utilis\u00e9e\"","text":"<p>Ne Paniquez Pas !</p> <p>Voir 90% de RAM \"utilis\u00e9e\" sur un serveur Linux est parfaitement normal.</p> <p>Linux utilise la RAM inutilis\u00e9e comme cache disque pour am\u00e9liorer les performances. Cette m\u00e9moire est imm\u00e9diatement lib\u00e9rable si une application en a besoin.</p>"},{"location":"formations/linux-perf/02-memory-swap/#12-anatomie-de-la-memoire-linux","title":"1.2 Anatomie de la M\u00e9moire Linux","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    M\u00c9MOIRE LINUX EXPLIQU\u00c9E                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   RAM Totale : 16 GB                                            \u2502\n\u2502   \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502             UTILIS\u00c9E PAR APPLICATIONS (4 GB)            \u2502   \u2502\n\u2502   \u2502  MySQL, Apache, Java... - NE PEUT PAS \u00eatre lib\u00e9r\u00e9e      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                  BUFFERS (0.5 GB)                       \u2502   \u2502\n\u2502   \u2502  M\u00e9tadonn\u00e9es du syst\u00e8me de fichiers                     \u2502   \u2502\n\u2502   \u2502  PEUT \u00eatre lib\u00e9r\u00e9 si besoin                             \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                   CACHE (10 GB)                         \u2502   \u2502\n\u2502   \u2502  Cache de lecture disque (page cache)                   \u2502   \u2502\n\u2502   \u2502  PEUT \u00eatre lib\u00e9r\u00e9 imm\u00e9diatement si besoin               \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502               R\u00c9ELLEMENT LIBRE (1.5 GB)                 \u2502   \u2502\n\u2502   \u2502  RAM non allou\u00e9e                                        \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udcca \"used\" dans les anciens outils = 4 + 0.5 + 10 = 14.5 GB   \u2502\n\u2502   \ud83d\udcca \"available\" (moderne) = 1.5 + 10 + 0.5 = 12 GB           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#13-free-vs-available","title":"1.3 Free vs Available","text":"M\u00e9trique Signification Usage free RAM non allou\u00e9e du tout M\u00e9trique trompeuse available RAM disponible pour les applications (free + buffers/cache r\u00e9cup\u00e9rables) M\u00e9trique \u00e0 surveiller used RAM r\u00e9ellement utilis\u00e9e (hors cache r\u00e9cup\u00e9rable) Moderne : fiable"},{"location":"formations/linux-perf/02-memory-swap/#2-loutil-free","title":"2. L'Outil <code>free</code>","text":""},{"location":"formations/linux-perf/02-memory-swap/#21-lecture-de-la-sortie","title":"2.1 Lecture de la Sortie","text":"<pre><code>$ free -h\n              total        used        free      shared  buff/cache   available\nMem:           16Gi       4.2Gi       1.5Gi       256Mi       10.3Gi        11.2Gi\nSwap:         2.0Gi          0B       2.0Gi\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    D\u00c9CODAGE DE free -h                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   total        = 16 Gi   \u2192 RAM physique totale                  \u2502\n\u2502                                                                 \u2502\n\u2502   used         = 4.2 Gi  \u2192 RAM utilis\u00e9e par les applications    \u2502\n\u2502                           (SANS le cache r\u00e9cup\u00e9rable)           \u2502\n\u2502                                                                 \u2502\n\u2502   free         = 1.5 Gi  \u2192 RAM compl\u00e8tement libre               \u2502\n\u2502                           \u26a0\ufe0f M\u00e9trique trompeuse !                \u2502\n\u2502                                                                 \u2502\n\u2502   shared       = 256 Mi  \u2192 M\u00e9moire partag\u00e9e (tmpfs, shmem)      \u2502\n\u2502                                                                 \u2502\n\u2502   buff/cache   = 10.3 Gi \u2192 Buffers + Page Cache                 \u2502\n\u2502                           (r\u00e9cup\u00e9rable si besoin)               \u2502\n\u2502                                                                 \u2502\n\u2502   available    = 11.2 Gi \u2192 CE QUI COMPTE : m\u00e9moire disponible   \u2502\n\u2502                           pour lancer de nouvelles apps         \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 R\u00e8gle : Surveillez \"available\", pas \"free\"                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#22-options-utiles","title":"2.2 Options Utiles","text":"<pre><code># Format humain (Gi, Mi)\nfree -h\n\n# En m\u00e9gaoctets\nfree -m\n\n# Avec rafra\u00eechissement toutes les 2 secondes\nfree -h -s 2\n\n# Total (ajoute une ligne de total)\nfree -h -t\n\n# Affichage \u00e9tendu\nfree -h -w   # S\u00e9pare buffers et cache\n</code></pre> <p>La Colonne Importante</p> <p>available est la m\u00e9trique cl\u00e9. Si <code>available</code> est bas (&lt; 10% de total), le syst\u00e8me peut commencer \u00e0 swapper.</p>"},{"location":"formations/linux-perf/02-memory-swap/#3-le-swap-le-tueur-de-performance","title":"3. Le Swap : Le Tueur de Performance","text":""},{"location":"formations/linux-perf/02-memory-swap/#31-quest-ce-que-le-swap","title":"3.1 Qu'est-ce que le Swap ?","text":"<p>Le swap est une zone sur le disque utilis\u00e9e comme extension de la RAM quand celle-ci est pleine. C'est un filet de s\u00e9curit\u00e9, pas une solution de performance.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    IMPACT DU SWAP                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Acc\u00e8s RAM  : ~100 nanosecondes       (0.0001 ms)              \u2502\n\u2502   Acc\u00e8s SSD  : ~100 microsecondes      (0.1 ms)    = 1000x      \u2502\n\u2502   Acc\u00e8s HDD  : ~10 millisecondes       (10 ms)     = 100000x    \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f Le swap est 1000 \u00e0 100000 fois plus LENT que la RAM !      \u2502\n\u2502                                                                 \u2502\n\u2502   CONS\u00c9QUENCE :                                                 \u2502\n\u2502   Une application qui swappe devient extr\u00eamement lente.         \u2502\n\u2502   Les latences explosent de millisecondes \u00e0 SECONDES.           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#32-detecter-lutilisation-du-swap","title":"3.2 D\u00e9tecter l'Utilisation du Swap","text":"<pre><code># Vue basique\nfree -h\n# Regarder la ligne \"Swap\" - used doit \u00eatre \u00e0 0 ou tr\u00e8s bas\n\n# Vue d\u00e9taill\u00e9e avec vmstat\nvmstat 1 5\n</code></pre> <pre><code>procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0 1567432 234567 9876543    0    0     5    12  125  456 15  5 78  2  0\n 2  0      0 1565432 234567 9876543    0    0     0     0  130  478 18  6 74  2  0\n 3  2  51200 1234567 234567 9876543  128  256   145   267  180  890 25  8 45 22  0\n                                     \u2500\u2500\u2500  \u2500\u2500\u2500\n                                      \u2502    \u2514\u2500\u2500 Swap OUT (\u00e9criture vers swap)\n                                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Swap IN (lecture depuis swap)\n</code></pre> <p>Colonnes Critiques de vmstat :</p> Colonne Signification Alerte Si <code>swpd</code> Swap utilis\u00e9 (KB) &gt; 0 et croissant <code>si</code> Swap In (KB/s lu depuis swap) &gt; 0 soutenu <code>so</code> Swap Out (KB/s \u00e9crit vers swap) &gt; 0 soutenu <code>b</code> Processus bloqu\u00e9s (I/O wait) &gt; 0 soutenu <p>Le Signal d'Alarme</p> <p>Si vous voyez des valeurs <code>si</code> ou <code>so</code> non nulles de mani\u00e8re soutenue, le syst\u00e8me swappe activement. C'est le sympt\u00f4me d'un manque de RAM critique.</p> <p>Actions : 1. Identifier les processus gourmands 2. Augmenter la RAM 3. Ou r\u00e9duire la charge</p>"},{"location":"formations/linux-perf/02-memory-swap/#33-analyse-detaillee-du-swap","title":"3.3 Analyse D\u00e9taill\u00e9e du Swap","text":"<pre><code># Voir quels processus utilisent le swap\nfor pid in /proc/[0-9]*; do\n    swap=$(awk '/VmSwap/ {print $2}' \"$pid/status\" 2&gt;/dev/null)\n    if [ -n \"$swap\" ] &amp;&amp; [ \"$swap\" -gt 0 ]; then\n        name=$(cat \"$pid/comm\" 2&gt;/dev/null)\n        echo \"$swap KB - PID ${pid##*/} - $name\"\n    fi\ndone | sort -rn | head -10\n\n# Ou avec smem (si install\u00e9)\nsmem -rs swap | head -10\n\n# Voir l'utilisation du swap par processus\ncat /proc/*/status 2&gt;/dev/null | grep -E \"^(Name|VmSwap)\" | paste - - | sort -k4 -rn | head\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#4-analyse-avancee-avec-procmeminfo","title":"4. Analyse Avanc\u00e9e avec /proc/meminfo","text":""},{"location":"formations/linux-perf/02-memory-swap/#41-les-metriques-importantes","title":"4.1 Les M\u00e9triques Importantes","text":"<pre><code>cat /proc/meminfo\n</code></pre> <pre><code>MemTotal:       16384000 kB    # RAM totale\nMemFree:         1567432 kB    # RAM libre (sans cache)\nMemAvailable:   11534567 kB    # RAM disponible (m\u00e9trique cl\u00e9)\nBuffers:          234567 kB    # Buffer cache (m\u00e9tadonn\u00e9es FS)\nCached:          9876543 kB    # Page cache (contenu fichiers)\nSwapCached:            0 kB    # Swap en cache RAM\nSwapTotal:       2097152 kB    # Swap total\nSwapFree:        2097152 kB    # Swap libre\nDirty:             12345 kB    # Pages modifi\u00e9es pas encore \u00e9crites\nWriteback:             0 kB    # Pages en cours d'\u00e9criture\nAnonPages:       4321098 kB    # M\u00e9moire anonyme (heap, stack)\nMapped:           567890 kB    # Fichiers mapp\u00e9s en m\u00e9moire\nShmem:            262144 kB    # M\u00e9moire partag\u00e9e (tmpfs)\nSlab:             345678 kB    # Cache structures kernel\nSReclaimable:     234567 kB    # Slab r\u00e9cup\u00e9rable\nSUnreclaim:       111111 kB    # Slab non r\u00e9cup\u00e9rable\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#42-script-de-diagnostic-memoire","title":"4.2 Script de Diagnostic M\u00e9moire","text":"<pre><code>#!/bin/bash\n# mem-check.sh - Diagnostic rapide m\u00e9moire\n\necho \"=== Diagnostic M\u00e9moire ===\"\necho\n\n# M\u00e9triques de base\ntotal=$(awk '/MemTotal/ {print $2}' /proc/meminfo)\navailable=$(awk '/MemAvailable/ {print $2}' /proc/meminfo)\nswap_total=$(awk '/SwapTotal/ {print $2}' /proc/meminfo)\nswap_free=$(awk '/SwapFree/ {print $2}' /proc/meminfo)\nswap_used=$((swap_total - swap_free))\n\n# Calculs\navailable_pct=$((available * 100 / total))\nswap_used_pct=0\n[ \"$swap_total\" -gt 0 ] &amp;&amp; swap_used_pct=$((swap_used * 100 / swap_total))\n\necho \"RAM Total    : $((total / 1024)) MB\"\necho \"RAM Available: $((available / 1024)) MB ($available_pct%)\"\necho \"Swap Used    : $((swap_used / 1024)) MB ($swap_used_pct%)\"\necho\n\n# \u00c9valuation\nif [ \"$available_pct\" -lt 10 ]; then\n    echo \"\u26a0\ufe0f  ATTENTION: M\u00e9moire disponible &lt; 10%\"\nelif [ \"$available_pct\" -lt 20 ]; then\n    echo \"\u26a1 AVERTISSEMENT: M\u00e9moire disponible &lt; 20%\"\nelse\n    echo \"\u2705 M\u00e9moire OK\"\nfi\n\nif [ \"$swap_used\" -gt 0 ]; then\n    echo \"\u26a0\ufe0f  ATTENTION: Swap utilis\u00e9 ($((swap_used / 1024)) MB)\"\n\n    # V\u00e9rifier si swap actif\n    si=$(vmstat 1 2 | tail -1 | awk '{print $7}')\n    so=$(vmstat 1 2 | tail -1 | awk '{print $8}')\n    if [ \"$si\" -gt 0 ] || [ \"$so\" -gt 0 ]; then\n        echo \"\ud83d\udd34 CRITIQUE: Swap ACTIF (si=$si so=$so)\"\n    fi\nfi\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#5-le-oom-killer","title":"5. Le OOM Killer","text":""},{"location":"formations/linux-perf/02-memory-swap/#51-quest-ce-que-loom-killer","title":"5.1 Qu'est-ce que l'OOM Killer ?","text":"<p>Quand le syst\u00e8me n'a vraiment plus de m\u00e9moire (RAM + Swap), le kernel Linux active le OOM Killer (Out of Memory Killer) qui tue des processus pour lib\u00e9rer de la m\u00e9moire.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    OOM KILLER EN ACTION                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. La RAM est pleine                                          \u2502\n\u2502   2. Le Swap est plein (ou absent)                              \u2502\n\u2502   3. Une application demande plus de m\u00e9moire                    \u2502\n\u2502   4. Le kernel ne peut pas satisfaire la demande                \u2502\n\u2502   5. OOM Killer s'active                                        \u2502\n\u2502   6. Il calcule un \"score\" pour chaque processus                \u2502\n\u2502   7. Il TUE le processus avec le score le plus \u00e9lev\u00e9            \u2502\n\u2502   8. Souvent = votre application de production !                \u2502\n\u2502                                                                 \u2502\n\u2502   Score bas\u00e9 sur :                                              \u2502\n\u2502   \u2022 Quantit\u00e9 de m\u00e9moire utilis\u00e9e (principal)                    \u2502\n\u2502   \u2022 \u00c2ge du processus                                            \u2502\n\u2502   \u2022 Nice value                                                  \u2502\n\u2502   \u2022 Ajustement manuel (oom_score_adj)                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#52-detecter-un-oom-kill","title":"5.2 D\u00e9tecter un OOM Kill","text":"<pre><code># Dans les logs kernel\ndmesg | grep -i \"out of memory\"\ndmesg | grep -i \"killed process\"\n\n# Ou avec journalctl\njournalctl -k | grep -i \"oom\"\n\n# Exemple de sortie\n# [12345.678901] Out of memory: Killed process 1234 (java) total-vm:8765432kB\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#53-proteger-un-processus-du-oom-killer","title":"5.3 Prot\u00e9ger un Processus du OOM Killer","text":"<pre><code># Voir le score OOM d'un processus (plus \u00e9lev\u00e9 = plus de chances d'\u00eatre tu\u00e9)\ncat /proc/&lt;PID&gt;/oom_score\n\n# Ajuster le score (-1000 \u00e0 +1000)\n# -1000 = jamais tu\u00e9, +1000 = toujours tu\u00e9 en premier\necho -500 &gt; /proc/&lt;PID&gt;/oom_score_adj\n\n# Pour le prot\u00e9ger totalement (d\u00e9conseill\u00e9 sauf cas critique)\necho -1000 &gt; /proc/&lt;PID&gt;/oom_score_adj\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#6-les-top-consommateurs","title":"6. Les Top Consommateurs","text":""},{"location":"formations/linux-perf/02-memory-swap/#61-identifier-les-processus-gourmands","title":"6.1 Identifier les Processus Gourmands","text":"<pre><code># Top 10 par m\u00e9moire r\u00e9sidente (RSS)\nps aux --sort=-%mem | head -11\n\n# Avec plus de d\u00e9tails\nps -eo pid,ppid,user,%mem,%cpu,rss,vsz,comm --sort=-%mem | head -15\n\n# M\u00e9moire par utilisateur\nps -eo user,%mem --sort=-%mem | awk '{arr[$1]+=$2} END {for (i in arr) print arr[i], i}' | sort -rn\n\n# Avec top (mode batch, une it\u00e9ration, tri\u00e9 par m\u00e9moire)\ntop -b -n 1 -o %MEM | head -20\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#62-colonnes-de-memoire-dans-pstop","title":"6.2 Colonnes de M\u00e9moire dans ps/top","text":"Colonne Signification Usage <code>%MEM</code> Pourcentage de RAM physique Vue rapide <code>RSS</code> Resident Set Size : RAM physique utilis\u00e9e M\u00e9trique cl\u00e9 <code>VSZ</code> Virtual Size : M\u00e9moire virtuelle allou\u00e9e Souvent trompeur <code>SHR</code> Shared : M\u00e9moire partag\u00e9e Biblioth\u00e8ques communes <p>RSS vs VSZ</p> <p>RSS est la m\u00e9trique importante. C'est la m\u00e9moire physique r\u00e9ellement utilis\u00e9e.</p> <p>VSZ inclut la m\u00e9moire virtuelle allou\u00e9e mais pas forc\u00e9ment utilis\u00e9e (ex: un processus Java avec -Xmx8G aura un VSZ de 8GB m\u00eame s'il n'utilise que 500MB).</p>"},{"location":"formations/linux-perf/02-memory-swap/#7-commandes-de-reference-rapide","title":"7. Commandes de R\u00e9f\u00e9rence Rapide","text":"<pre><code># === VUE D'ENSEMBLE ===\nfree -h                         # \u00c9tat m\u00e9moire\nfree -h -s 2                    # Rafra\u00eechi toutes les 2s\n\n# === SWAP MONITORING ===\nvmstat 1                        # Colonnes si/so pour swap in/out\nswapon --show                   # Partitions swap\n\n# === ANALYSE D\u00c9TAILL\u00c9E ===\ncat /proc/meminfo               # Toutes les m\u00e9triques kernel\ncat /proc/&lt;PID&gt;/status          # M\u00e9moire d'un processus\ncat /proc/&lt;PID&gt;/smaps           # D\u00e9tails m\u00e9moire tr\u00e8s d\u00e9taill\u00e9s\n\n# === TOP CONSOMMATEURS ===\nps aux --sort=-%mem | head      # Top par RAM\ntop -b -n 1 -o %MEM | head -20  # Top batch mode\n\n# === OOM KILLER ===\ndmesg | grep -i oom             # D\u00e9tection OOM\ncat /proc/&lt;PID&gt;/oom_score       # Score OOM d'un processus\n\n# === LIB\u00c9RER LE CACHE (URGENCE) ===\n# \u26a0\ufe0f D\u00e9conseill\u00e9 en production - peut d\u00e9grader les performances\nsync; echo 3 &gt; /proc/sys/vm/drop_caches\n</code></pre>"},{"location":"formations/linux-perf/02-memory-swap/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Un serveur affiche 'free' \u00e0 200 MB sur 16 GB. Faut-il s'inqui\u00e9ter ? <p>R\u00e9ponse : Pas n\u00e9cessairement ! Il faut regarder la colonne available, pas free.</p> <p>Linux utilise la RAM inutilis\u00e9e comme cache disque. Si <code>available</code> est \u00e0 10+ GB, le syst\u00e8me va tr\u00e8s bien. Le cache sera lib\u00e9r\u00e9 automatiquement si une application en a besoin.</p> Question 2 : Quelle est la diff\u00e9rence entre 'si' et 'so' dans vmstat ? <p>R\u00e9ponse :</p> <ul> <li> <p>si (Swap In) : Pages lues DEPUIS le swap vers la RAM. Le syst\u00e8me r\u00e9cup\u00e8re des donn\u00e9es qu'il avait swapp\u00e9es.</p> </li> <li> <p>so (Swap Out) : Pages \u00e9crites VERS le swap depuis la RAM. Le syst\u00e8me manque de RAM et doit d\u00e9placer des donn\u00e9es vers le disque.</p> </li> </ul> <p>Les deux sont mauvais pour les performances, mais <code>so</code> indique une pression m\u00e9moire active.</p> Question 3 : Pourquoi le RSS d'un processus peut \u00eatre diff\u00e9rent de la somme des RSS de ses threads ? <p>R\u00e9ponse : Parce que les threads partagent le m\u00eame espace m\u00e9moire. Le RSS du processus parent compte la m\u00e9moire partag\u00e9e une seule fois, tandis que chaque thread pourrait la \"revendiquer\" individuellement.</p> <p>C'est pourquoi on regarde toujours le RSS du processus principal, pas des threads.</p>"},{"location":"formations/linux-perf/02-memory-swap/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>La m\u00e9moire est souvent victime, pas coupable. Le vrai probl\u00e8me est souvent le disque. D\u00e9couvrez l'investigation I/O.</p> <p>:octicons-arrow-right-24: Module 3 : Disque &amp; I/O</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/linux-perf/03-disk-io/","title":"Module 3 : Disque &amp; I/O","text":""},{"location":"formations/linux-perf/03-disk-io/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre la diff\u00e9rence entre IOPS et Throughput</li> <li>:material-check: Interpr\u00e9ter les m\u00e9triques d'<code>iostat</code></li> <li>:material-check: Identifier les processus responsables des I/O</li> <li>:material-check: Diagnostiquer les probl\u00e8mes de latence disque</li> </ul>"},{"location":"formations/linux-perf/03-disk-io/#1-iops-vs-throughput-deux-metriques-differentes","title":"1. IOPS vs Throughput : Deux M\u00e9triques Diff\u00e9rentes","text":""},{"location":"formations/linux-perf/03-disk-io/#11-definitions","title":"1.1 D\u00e9finitions","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              IOPS vs THROUGHPUT                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   IOPS (Input/Output Operations Per Second)                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                     \u2502\n\u2502   \u2022 Nombre d'op\u00e9rations I/O par seconde                         \u2502\n\u2502   \u2022 Mesure la R\u00c9ACTIVIT\u00c9 du stockage                            \u2502\n\u2502   \u2022 Important pour : bases de donn\u00e9es, applications             \u2502\n\u2502     transactionnelles, acc\u00e8s al\u00e9atoires                         \u2502\n\u2502   \u2022 Typique HDD : 100-200 IOPS                                  \u2502\n\u2502   \u2022 Typique SSD : 10,000-100,000+ IOPS                          \u2502\n\u2502                                                                 \u2502\n\u2502   THROUGHPUT (D\u00e9bit en MB/s)                                    \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                    \u2502\n\u2502   \u2022 Quantit\u00e9 de donn\u00e9es transf\u00e9r\u00e9es par seconde                 \u2502\n\u2502   \u2022 Mesure la CAPACIT\u00c9 de transfert                             \u2502\n\u2502   \u2022 Important pour : streaming vid\u00e9o, backup,                   \u2502\n\u2502     transferts de gros fichiers, acc\u00e8s s\u00e9quentiels              \u2502\n\u2502   \u2022 Typique HDD : 100-200 MB/s                                  \u2502\n\u2502   \u2022 Typique SSD : 500-7000 MB/s (NVMe)                          \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f Un disque peut avoir un bon throughput mais des IOPS       \u2502\n\u2502      m\u00e9diocres (HDD) ou l'inverse (rare)                        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#12-analogie","title":"1.2 Analogie","text":"M\u00e9trique Analogie Autoroute IOPS Nombre de v\u00e9hicules pouvant entrer sur l'autoroute par minute Throughput Nombre total de passagers transport\u00e9s par heure Latence Temps pour qu'un v\u00e9hicule traverse l'autoroute"},{"location":"formations/linux-perf/03-disk-io/#13-impact-par-workload","title":"1.3 Impact par Workload","text":"Type d'Application M\u00e9trique Critique Pourquoi Base de donn\u00e9es (OLTP) IOPS, Latence Petites requ\u00eates fr\u00e9quentes Data Warehouse (OLAP) Throughput Gros scans s\u00e9quentiels Serveur de fichiers Les deux Mix d'acc\u00e8s Backup/Restore Throughput Transferts massifs Serveur Web (logs) IOPS Write \u00c9critures fr\u00e9quentes"},{"location":"formations/linux-perf/03-disk-io/#2-loutil-roi-iostat","title":"2. L'Outil Roi : iostat","text":""},{"location":"formations/linux-perf/03-disk-io/#21-commande-de-base","title":"2.1 Commande de Base","text":"<pre><code># Installation (si n\u00e9cessaire)\n# Debian/Ubuntu: apt install sysstat\n# RHEL/Rocky: dnf install sysstat\n\n# Commande recommand\u00e9e\niostat -xkz 1\n</code></pre> <ul> <li><code>-x</code> : Mode \u00e9tendu (toutes les m\u00e9triques)</li> <li><code>-k</code> : Affichage en KB (ou <code>-m</code> pour MB)</li> <li><code>-z</code> : Masquer les devices inactifs</li> <li><code>1</code> : Rafra\u00eechir toutes les secondes</li> </ul>"},{"location":"formations/linux-perf/03-disk-io/#22-lecture-de-la-sortie","title":"2.2 Lecture de la Sortie","text":"<pre><code>Linux 5.4.0-generic    01/28/25    _x86_64_    (4 CPU)\n\navg-cpu:  %user   %nice %system %iowait  %steal   %idle\n          15.25    0.00    5.50   12.75    0.00   66.50\n\nDevice     r/s     w/s    rkB/s    wkB/s  rrqm/s  wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util\nsda      125.00  350.00  2048.00  8192.00   5.00   45.00   3.85  11.39    2.50   15.80   1.25    16.38    23.41   1.80  85.50\nsdb       10.00   25.00   512.00  1024.00   0.00    5.00   0.00  16.67    0.50    2.00   0.05    51.20    40.96   1.20   4.20\nnvme0n1  500.00  200.00 32768.00 16384.00   0.00    0.00   0.00   0.00    0.08    0.12   0.01    65.54    81.92   0.05   3.50\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#23-colonnes-critiques","title":"2.3 Colonnes Critiques","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              COLONNES IOSTAT \u00c0 MA\u00ceTRISER                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   r/s, w/s (IOPS)                                               \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                               \u2502\n\u2502   Lectures et \u00e9critures par seconde                             \u2502\n\u2502   \u2192 Charge du disque en op\u00e9rations                              \u2502\n\u2502                                                                 \u2502\n\u2502   rkB/s, wkB/s (Throughput)                                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                     \u2502\n\u2502   D\u00e9bit en KB/s (lecture, \u00e9criture)                             \u2502\n\u2502   \u2192 Volume de donn\u00e9es transf\u00e9r\u00e9es                               \u2502\n\u2502                                                                 \u2502\n\u2502   await (Latence Globale) \u2b50 CRITIQUE                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                             \u2502\n\u2502   Temps moyen d'une I/O (ms) = temps file + temps service       \u2502\n\u2502   \u2022 &lt; 1 ms   : Excellent (NVMe)                                 \u2502\n\u2502   \u2022 1-5 ms   : Bon (SSD SATA)                                   \u2502\n\u2502   \u2022 5-20 ms  : Acceptable (HDD rapide)                          \u2502\n\u2502   \u2022 &gt; 20 ms  : Probl\u00e8me (HDD satur\u00e9 ou d\u00e9faillant)              \u2502\n\u2502   \u2022 &gt; 100 ms : Critique !                                       \u2502\n\u2502                                                                 \u2502\n\u2502   %util (Saturation) \u2b50 CRITIQUE                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2502\n\u2502   Pourcentage de temps o\u00f9 le device traite des I/O              \u2502\n\u2502   \u2022 &lt; 70%  : OK                                                 \u2502\n\u2502   \u2022 70-90% : Attention                                          \u2502\n\u2502   \u2022 &gt; 90%  : Saturation (goulot d'\u00e9tranglement)                 \u2502\n\u2502                                                                 \u2502\n\u2502   aqu-sz (Average Queue Size)                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2502\n\u2502   Nombre moyen de requ\u00eates en file d'attente                    \u2502\n\u2502   \u2022 &lt; 1   : Pas de saturation                                   \u2502\n\u2502   \u2022 &gt; 1   : Les requ\u00eates s'accumulent                           \u2502\n\u2502   \u2022 &gt; 10  : Saturation s\u00e9v\u00e8re                                   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#24-interpretation-des-scenarios","title":"2.4 Interpr\u00e9tation des Sc\u00e9narios","text":"%util await Diagnostic Bas Bas Disque sous-utilis\u00e9, tout va bien Haut Bas Disque bien utilis\u00e9, performant Bas Haut Probl\u00e8me hardware ou r\u00e9seau (NFS, SAN) Haut Haut Saturation - Goulot d'\u00e9tranglement"},{"location":"formations/linux-perf/03-disk-io/#3-identifier-le-coupable-iotop","title":"3. Identifier le Coupable : iotop","text":""},{"location":"formations/linux-perf/03-disk-io/#31-utilisation-de-base","title":"3.1 Utilisation de Base","text":"<pre><code># N\u00e9cessite les droits root\nsudo iotop\n\n# Mode batch (pour scripts)\nsudo iotop -b -n 3\n\n# Afficher seulement les processus actifs\nsudo iotop -o\n\n# Accumuler les I/O (total depuis le lancement)\nsudo iotop -a\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#32-lecture-de-linterface","title":"3.2 Lecture de l'Interface","text":"<pre><code>Total DISK READ:       15.23 M/s | Total DISK WRITE:       8.45 M/s\nCurrent DISK READ:     12.50 M/s | Current DISK WRITE:      6.78 M/s\n\n  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND\n 1234 be/4 mysql       10.50 M/s    5.25 M/s  0.00 %  85.50 % mysqld\n 5678 be/4 www-data     1.25 M/s    2.10 M/s  0.00 %  15.20 % apache2\n 9012 be/4 root         0.50 M/s    1.10 M/s  0.00 %   5.30 % rsync\n</code></pre> <p>Colonnes :</p> Colonne Description <code>TID</code> Thread ID <code>PRIO</code> Priorit\u00e9 I/O (be = best effort) <code>DISK READ/WRITE</code> D\u00e9bit actuel <code>SWAPIN</code> % temps en swap in <code>IO&gt;</code> % temps en attente I/O <code>COMMAND</code> Processus"},{"location":"formations/linux-perf/03-disk-io/#33-alternatives-a-iotop","title":"3.3 Alternatives \u00e0 iotop","text":"<pre><code># pidstat avec I/O (-d)\npidstat -d 1\n\n# Sortie :\n# 14:35:01  UID  PID  kB_rd/s  kB_wr/s  kB_ccwr/s  iodelay  Command\n# 14:35:02 1000 1234  10240.00  5120.00       0.00      125  mysqld\n\n# Avec les threads\npidstat -d -t 1\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#4-analyse-par-device","title":"4. Analyse par Device","text":""},{"location":"formations/linux-perf/03-disk-io/#41-mapper-les-devices-aux-montages","title":"4.1 Mapper les Devices aux Montages","text":"<pre><code># Voir les montages\ndf -h\n\n# Voir les devices block\nlsblk\n\n# Exemple de sortie lsblk\nNAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT\nsda           8:0    0   500G  0 disk\n\u251c\u2500sda1        8:1    0   512M  0 part /boot\n\u2514\u2500sda2        8:2    0 499.5G  0 part /\nnvme0n1     259:0    0   1.8T  0 disk\n\u2514\u2500nvme0n1p1 259:1    0   1.8T  0 part /data\n\n# Identifier quel processus acc\u00e8de \u00e0 quel fichier\nsudo lsof +D /data | head -20\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#42-analyser-un-device-specifique","title":"4.2 Analyser un Device Sp\u00e9cifique","text":"<pre><code># iostat pour un device sp\u00e9cifique\niostat -xkz 1 sda\n\n# Voir les statistiques kernel\ncat /sys/block/sda/stat\n\n# Format : reads_completed reads_merged sectors_read ms_reading ...\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#5-lab-simulation-de-charge-io","title":"5. Lab : Simulation de Charge I/O","text":""},{"location":"formations/linux-perf/03-disk-io/#51-generer-de-la-charge-avec-dd","title":"5.1 G\u00e9n\u00e9rer de la Charge avec dd","text":"<pre><code># \u26a0\ufe0f ATTENTION : \u00c0 ex\u00e9cuter dans un r\u00e9pertoire temporaire !\n# Ne PAS ex\u00e9cuter sur un syst\u00e8me de production !\n\n# Test d'\u00e9criture s\u00e9quentielle (throughput)\ndd if=/dev/zero of=/tmp/testfile bs=1M count=1024 oflag=direct\n\n# Test de lecture s\u00e9quentielle\ndd if=/tmp/testfile of=/dev/null bs=1M iflag=direct\n\n# Nettoyage\nrm /tmp/testfile\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#52-generer-de-la-charge-avec-stress-ng","title":"5.2 G\u00e9n\u00e9rer de la Charge avec stress-ng","text":"<pre><code># Installation\n# apt install stress-ng  ou  dnf install stress-ng\n\n# Stress I/O : 4 workers, pendant 30 secondes\nstress-ng --io 4 --timeout 30s --metrics-brief\n\n# Stress HDD : \u00e9criture/lecture\nstress-ng --hdd 2 --hdd-bytes 1G --timeout 30s\n\n# Pendant ce temps, dans un autre terminal :\niostat -xkz 1\niotop -o\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#53-observer-les-metriques","title":"5.3 Observer les M\u00e9triques","text":"<pre><code># Terminal 1 : Lancer la charge\nstress-ng --hdd 4 --timeout 60s\n\n# Terminal 2 : Observer iostat\nwatch -n 1 'iostat -xkz 1 1 | tail -10'\n\n# Terminal 3 : Observer les processus\nsudo iotop -o\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#6-problemes-courants-et-solutions","title":"6. Probl\u00e8mes Courants et Solutions","text":""},{"location":"formations/linux-perf/03-disk-io/#61-diagnostic-rapide","title":"6.1 Diagnostic Rapide","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARBRE DE D\u00c9CISION I/O                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   %util &gt; 90% ?                                                 \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 OUI \u2192 Disque satur\u00e9                                       \u2502\n\u2502   \u2502         \u2502                                                   \u2502\n\u2502   \u2502         \u251c\u2500\u2500 await \u00e9lev\u00e9 \u2192 File d'attente pleine             \u2502\n\u2502   \u2502         \u2502                 Actions :                         \u2502\n\u2502   \u2502         \u2502                 \u2022 Identifier process (iotop)      \u2502\n\u2502   \u2502         \u2502                 \u2022 Optimiser l'application         \u2502\n\u2502   \u2502         \u2502                 \u2022 Migrer vers SSD/NVMe            \u2502\n\u2502   \u2502         \u2502                                                   \u2502\n\u2502   \u2502         \u2514\u2500\u2500 await normal \u2192 Disque \u00e0 capacit\u00e9 max            \u2502\n\u2502   \u2502                           mais performant                   \u2502\n\u2502   \u2502                           Actions :                         \u2502\n\u2502   \u2502                           \u2022 Ajouter des disques (RAID)      \u2502\n\u2502   \u2502                           \u2022 Distribuer la charge            \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u2514\u2500\u2500 NON \u2192 %util bas                                           \u2502\n\u2502             \u2502                                                   \u2502\n\u2502             \u251c\u2500\u2500 await \u00e9lev\u00e9 \u2192 Probl\u00e8me hardware/r\u00e9seau          \u2502\n\u2502             \u2502                 (latence intrins\u00e8que)             \u2502\n\u2502             \u2502                 Actions :                         \u2502\n\u2502             \u2502                 \u2022 V\u00e9rifier c\u00e2bles, contr\u00f4leur     \u2502\n\u2502             \u2502                 \u2022 V\u00e9rifier r\u00e9seau SAN/NFS         \u2502\n\u2502             \u2502                 \u2022 smartctl pour sant\u00e9 disque      \u2502\n\u2502             \u2502                                                   \u2502\n\u2502             \u2514\u2500\u2500 await normal \u2192 Pas de probl\u00e8me I/O              \u2502\n\u2502                               Le goulot est ailleurs            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#62-verifier-la-sante-du-disque","title":"6.2 V\u00e9rifier la Sant\u00e9 du Disque","text":"<pre><code># SMART status (disques locaux)\nsudo smartctl -H /dev/sda\n\n# Attributs SMART d\u00e9taill\u00e9s\nsudo smartctl -A /dev/sda\n\n# Erreurs r\u00e9centes\nsudo smartctl -l error /dev/sda\n\n# Pour NVMe\nsudo nvme smart-log /dev/nvme0n1\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#63-tuning-io-scheduler","title":"6.3 Tuning I/O Scheduler","text":"<pre><code># Voir le scheduler actuel\ncat /sys/block/sda/queue/scheduler\n# Sortie : [mq-deadline] kyber bfq none\n\n# Schedulers recommand\u00e9s :\n# - mq-deadline : Bon pour les workloads mixtes\n# - none/noop   : Pour SSD/NVMe (pas besoin de r\u00e9ordonnancement)\n# - bfq         : Pour desktop/interactivit\u00e9\n\n# Changer temporairement\necho \"mq-deadline\" | sudo tee /sys/block/sda/queue/scheduler\n\n# Pour NVMe, 'none' est souvent optimal\necho \"none\" | sudo tee /sys/block/nvme0n1/queue/scheduler\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#7-commandes-de-reference-rapide","title":"7. Commandes de R\u00e9f\u00e9rence Rapide","text":"<pre><code># === ANALYSE GLOBALE ===\niostat -xkz 1                   # M\u00e9triques \u00e9tendues, par seconde\niostat -xkz 1 5                 # 5 it\u00e9rations\n\n# === IDENTIFIER LE COUPABLE ===\nsudo iotop -o                   # Processus actifs seulement\nsudo iotop -a                   # Total accumul\u00e9\npidstat -d 1                    # I/O par processus\n\n# === INFORMATIONS SYST\u00c8ME ===\nlsblk                           # Arbre des devices\ndf -h                           # Espace disque\nmount | column -t               # Points de montage\n\n# === SANT\u00c9 DISQUE ===\nsudo smartctl -H /dev/sda       # Health check\nsudo smartctl -A /dev/sda       # Attributs SMART\n\n# === FILES OUVERTES ===\nsudo lsof +D /chemin            # Qui acc\u00e8de \u00e0 ce chemin\nsudo fuser -v /chemin           # Processus utilisant ce chemin\n\n# === SCHEDULER ===\ncat /sys/block/sda/queue/scheduler\n</code></pre>"},{"location":"formations/linux-perf/03-disk-io/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Un disque affiche 95% util mais un await de 0.5 ms. Est-ce un probl\u00e8me ? <p>R\u00e9ponse : Non, c'est un bon signe ! Le disque est tr\u00e8s sollicit\u00e9 (95% util) mais r\u00e9pond tr\u00e8s rapidement (0.5 ms). C'est typique d'un SSD NVMe performant sous charge.</p> <p>Un probl\u00e8me serait : 95% util + await &gt; 20 ms \u2192 saturation avec file d'attente.</p> Question 2 : Quelle est la diff\u00e9rence entre r_await et w_await ? <p>R\u00e9ponse :</p> <ul> <li>r_await : Latence moyenne des op\u00e9rations de lecture</li> <li>w_await : Latence moyenne des op\u00e9rations d'\u00e9criture</li> </ul> <p>Utile pour identifier si le probl\u00e8me est en lecture ou \u00e9criture. Les \u00e9critures sont souvent plus lentes car elles doivent \u00eatre persist\u00e9es (surtout avec write barriers/fsync).</p> Question 3 : Pourquoi 'none' est le scheduler recommand\u00e9 pour NVMe ? <p>R\u00e9ponse : Les schedulers I/O (comme mq-deadline ou bfq) r\u00e9ordonnent les requ\u00eates pour minimiser les mouvements de t\u00eate de lecture sur les HDD.</p> <p>Les SSD NVMe n'ont pas de t\u00eate de lecture - l'acc\u00e8s \u00e0 n'importe quel secteur est instantan\u00e9. Le r\u00e9ordonnancement ajoute de la latence inutile. Le scheduler 'none' passe les requ\u00eates directement au device.</p>"},{"location":"formations/linux-perf/03-disk-io/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Le disque n'est pas le seul goulot. Le r\u00e9seau peut aussi \u00eatre source de latence.</p> <p>:octicons-arrow-right-24: Module 4 : R\u00e9seau &amp; Latence</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire \u00e0 Avanc\u00e9</p>"},{"location":"formations/linux-perf/04-network-latency/","title":"Module 4 : R\u00e9seau &amp; Latence","text":""},{"location":"formations/linux-perf/04-network-latency/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Distinguer bande passante et latence</li> <li>:material-check: Surveiller le trafic r\u00e9seau en temps r\u00e9el</li> <li>:material-check: Investiguer les sockets et connexions</li> <li>:material-check: Diagnostiquer la perte de paquets et les probl\u00e8mes de routage</li> </ul>"},{"location":"formations/linux-perf/04-network-latency/#1-bande-passante-vs-latence","title":"1. Bande Passante vs Latence","text":""},{"location":"formations/linux-perf/04-network-latency/#11-deux-concepts-differents","title":"1.1 Deux Concepts Diff\u00e9rents","text":"<p>La Confusion Courante</p> <p>\"J'ai une connexion 1 Gbps, pourquoi mon application est lente ?\"</p> <p>Parce que bande passante \u2260 latence. Ce sont deux m\u00e9triques ind\u00e9pendantes.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              BANDE PASSANTE vs LATENCE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   BANDE PASSANTE (Throughput)                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2502\n\u2502   \u2022 Quantit\u00e9 de donn\u00e9es pouvant transiter par unit\u00e9 de temps    \u2502\n\u2502   \u2022 Mesur\u00e9e en Mbps, Gbps                                       \u2502\n\u2502   \u2022 Analogie : Largeur d'un tuyau                               \u2502\n\u2502   \u2022 Impact : Transferts de fichiers, streaming                  \u2502\n\u2502                                                                 \u2502\n\u2502   LATENCE (RTT - Round Trip Time)                               \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                               \u2502\n\u2502   \u2022 Temps pour qu'un paquet aille et revienne                   \u2502\n\u2502   \u2022 Mesur\u00e9e en millisecondes (ms)                               \u2502\n\u2502   \u2022 Analogie : Longueur du tuyau                                \u2502\n\u2502   \u2022 Impact : R\u00e9activit\u00e9, applications interactives              \u2502\n\u2502                                                                 \u2502\n\u2502   EXEMPLE :                                                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502 Paris \u2192 New York                                     \u2502      \u2502\n\u2502   \u2502 Bande passante : 10 Gbps (\u00e9norme)                    \u2502      \u2502\n\u2502   \u2502 Latence : 80 ms (incompressible - vitesse lumi\u00e8re)   \u2502      \u2502\n\u2502   \u2502                                                      \u2502      \u2502\n\u2502   \u2502 Une requ\u00eate HTTP simple :                            \u2502      \u2502\n\u2502   \u2502 \u2022 DNS lookup : 80 ms                                 \u2502      \u2502\n\u2502   \u2502 \u2022 TCP handshake : 80 ms                              \u2502      \u2502\n\u2502   \u2502 \u2022 TLS handshake : 160 ms (2 RTT)                     \u2502      \u2502\n\u2502   \u2502 \u2022 Requ\u00eate/r\u00e9ponse : 80 ms                            \u2502      \u2502\n\u2502   \u2502 \u2022 TOTAL : ~400 ms minimum !                          \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f La latence ne peut pas \u00eatre \"fix\u00e9e\" par plus de bande      \u2502\n\u2502      passante. C'est de la physique.                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#12-impact-sur-les-applications","title":"1.2 Impact sur les Applications","text":"Type d'Application M\u00e9trique Critique Pourquoi Transfert de fichiers (scp, rsync) Bande passante Volume de donn\u00e9es Base de donn\u00e9es distante Latence Nombreuses requ\u00eates courtes API REST Latence Requ\u00eate/r\u00e9ponse rapides Streaming vid\u00e9o Bande passante Flux continu VoIP / Visio Latence + Jitter Temps r\u00e9el SSH interactif Latence Chaque frappe = 1 RTT"},{"location":"formations/linux-perf/04-network-latency/#2-surveillance-du-trafic-iftop-nload","title":"2. Surveillance du Trafic : iftop &amp; nload","text":""},{"location":"formations/linux-perf/04-network-latency/#21-iftop-vue-par-connexion","title":"2.1 iftop : Vue par Connexion","text":"<pre><code># Installation\n# Debian/Ubuntu: apt install iftop\n# RHEL/Rocky: dnf install iftop\n\n# Lancer sur l'interface principale\nsudo iftop -i eth0\n\n# Sans r\u00e9solution DNS (plus rapide)\nsudo iftop -i eth0 -n\n\n# Filtrer par port\nsudo iftop -i eth0 -f \"port 443\"\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  iftop - Trafic par Connexion                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   191Mb        381Mb       572Mb       763Mb       954Mb        \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502                                                                 \u2502\n\u2502   server.local     =&gt; 10.0.0.50         45.2Mb  42.1Mb  40.5Mb  \u2502\n\u2502                    &lt;=                   12.3Mb  11.8Mb  11.2Mb  \u2502\n\u2502                                                                 \u2502\n\u2502   server.local     =&gt; database.internal  8.5Mb   7.2Mb   6.8Mb  \u2502\n\u2502                    &lt;=                   25.4Mb  24.1Mb  23.5Mb  \u2502\n\u2502                                                                 \u2502\n\u2502   server.local     =&gt; 203.0.113.45       2.1Mb   1.8Mb   1.5Mb  \u2502\n\u2502                    &lt;=                    0.5Mb   0.4Mb   0.3Mb  \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502\n\u2502   TX: cumul:  125MB   peak:  58.5Mb   rates:  55.8Mb  51.1Mb    \u2502\n\u2502   RX:         234MB           45.2Mb          38.2Mb  35.5Mb    \u2502\n\u2502   TOTAL:      359MB          103.7Mb          94.0Mb  86.6Mb    \u2502\n\u2502                                                                 \u2502\n\u2502   Touches : n=DNS  s=source  d=dest  p=pause  q=quit            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Touches Utiles :</p> Touche Action <code>n</code> Toggle r\u00e9solution DNS <code>s</code> Trier par source <code>d</code> Trier par destination <code>t</code> Cycle affichage (2-lignes, 1-ligne, 1-ligne+total) <code>p</code> Pause <code>P</code> Pause + afficher barres"},{"location":"formations/linux-perf/04-network-latency/#22-nload-vue-par-interface","title":"2.2 nload : Vue par Interface","text":"<pre><code># Installation\n# apt install nload  ou  dnf install nload\n\n# Lancer (naviguez entre interfaces avec \u2190 \u2192)\nnload\n\n# Interface sp\u00e9cifique\nnload eth0\n\n# Plusieurs interfaces\nnload eth0 eth1\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  nload - Interface eth0                                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Incoming:                                                     \u2502\n\u2502                                    \u2584\u2584                           \u2502\n\u2502                                  \u2584\u2588\u2588\u2588\u2588                          \u2502\n\u2502                                \u2584\u2588\u2588\u2588\u2588\u2588\u2588\u2584                         \u2502\n\u2502                              \u2584\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584                     \u2502\n\u2502                            \u2584\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584\u2584                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                 \u2502\n\u2502   Curr: 125.45 MBit/s                                           \u2502\n\u2502   Avg:   98.23 MBit/s                                           \u2502\n\u2502   Min:   12.50 MBit/s                                           \u2502\n\u2502   Max:  187.30 MBit/s                                           \u2502\n\u2502   Ttl:   45.23 GByte                                            \u2502\n\u2502                                                                 \u2502\n\u2502   Outgoing:                                                     \u2502\n\u2502                        \u2584\u2584\u2584\u2584                                     \u2502\n\u2502                      \u2584\u2588\u2588\u2588\u2588\u2588\u2588\u2584                                   \u2502\n\u2502                    \u2584\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                 \u2502\n\u2502   Curr:  45.67 MBit/s                                           \u2502\n\u2502   Avg:   38.12 MBit/s                                           \u2502\n\u2502   Min:    5.20 MBit/s                                           \u2502\n\u2502   Max:   78.90 MBit/s                                           \u2502\n\u2502   Ttl:   18.56 GByte                                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#23-alternatives-sar-et-nethogs","title":"2.3 Alternatives : sar et nethogs","text":"<pre><code># sar pour les statistiques r\u00e9seau (historique)\nsar -n DEV 1 5\n\n# Sortie :\n# IFACE   rxpck/s  txpck/s  rxkB/s  txkB/s  rxcmp/s txcmp/s rxmcst/s  %ifutil\n# eth0   12543.00  8765.00 15234.56  4567.89    0.00    0.00     0.00   12.35\n\n# nethogs : trafic par processus (comme iotop pour le r\u00e9seau)\nsudo nethogs eth0\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#3-investigation-des-sockets-ss","title":"3. Investigation des Sockets : ss","text":""},{"location":"formations/linux-perf/04-network-latency/#31-ss-remplace-netstat","title":"3.1 ss remplace netstat","text":"<p><code>ss</code> (Socket Statistics) est le rempla\u00e7ant moderne de <code>netstat</code>. Il est plus rapide et plus complet.</p> <pre><code># Connexions TCP \u00e9tablies\nss -t\n\n# Tous les sockets (TCP, UDP, UNIX)\nss -a\n\n# Avec les processus associ\u00e9s\nss -tulpn\n\n# Explication des flags :\n# -t : TCP\n# -u : UDP\n# -l : Listening (en \u00e9coute)\n# -p : Processus (PID/nom)\n# -n : Num\u00e9rique (pas de r\u00e9solution DNS)\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#32-lecture-de-la-sortie","title":"3.2 Lecture de la Sortie","text":"<pre><code>$ ss -tulpn\n</code></pre> <pre><code>Netid  State   Recv-Q  Send-Q   Local Address:Port    Peer Address:Port  Process\ntcp    LISTEN  0       128      0.0.0.0:22             0.0.0.0:*          users:((\"sshd\",pid=1234,fd=3))\ntcp    LISTEN  0       511      0.0.0.0:80             0.0.0.0:*          users:((\"nginx\",pid=5678,fd=6))\ntcp    LISTEN  0       128      127.0.0.1:3306         0.0.0.0:*          users:((\"mysqld\",pid=9012,fd=21))\ntcp    ESTAB   0       0        10.0.0.10:22           10.0.0.50:54321    users:((\"sshd\",pid=2345,fd=4))\ntcp    ESTAB   0       52       10.0.0.10:80           203.0.113.45:12345 users:((\"nginx\",pid=5679,fd=12))\nudp    UNCONN  0       0        0.0.0.0:68             0.0.0.0:*          users:((\"dhclient\",pid=789,fd=6))\n</code></pre> <p>Colonnes :</p> Colonne Description <code>Netid</code> Protocole (tcp, udp, unix) <code>State</code> \u00c9tat de la connexion <code>Recv-Q</code> Donn\u00e9es en attente de lecture <code>Send-Q</code> Donn\u00e9es en attente d'envoi <code>Local Address:Port</code> Adresse locale <code>Peer Address:Port</code> Adresse distante <code>Process</code> PID et nom du processus"},{"location":"formations/linux-perf/04-network-latency/#33-etats-tcp-a-connaitre","title":"3.3 \u00c9tats TCP \u00e0 Conna\u00eetre","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u00c9TATS TCP IMPORTANTS                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   LISTEN      : En attente de connexions entrantes              \u2502\n\u2502                 (serveur pr\u00eat)                                  \u2502\n\u2502                                                                 \u2502\n\u2502   ESTABLISHED : Connexion active, donn\u00e9es \u00e9chang\u00e9es             \u2502\n\u2502                 (\u00e9tat normal)                                   \u2502\n\u2502                                                                 \u2502\n\u2502   TIME_WAIT   : Connexion ferm\u00e9e, attente avant r\u00e9utilisation   \u2502\n\u2502                 (normal, mais beaucoup = probl\u00e8me)              \u2502\n\u2502                                                                 \u2502\n\u2502   CLOSE_WAIT  : L'autre c\u00f4t\u00e9 a ferm\u00e9, attente de notre close()  \u2502\n\u2502                 \u26a0\ufe0f Si beaucoup : bug applicatif (fd non ferm\u00e9)  \u2502\n\u2502                                                                 \u2502\n\u2502   SYN_SENT    : Connexion sortante en cours                     \u2502\n\u2502                 \u26a0\ufe0f Si bloqu\u00e9 ici : firewall ou serveur down     \u2502\n\u2502                                                                 \u2502\n\u2502   SYN_RECV    : Connexion entrante en cours (handshake)         \u2502\n\u2502                 \u26a0\ufe0f Si beaucoup : possible SYN flood attack      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#34-requetes-utiles","title":"3.4 Requ\u00eates Utiles","text":"<pre><code># Compter les connexions par \u00e9tat\nss -t state established | wc -l\nss -t state time-wait | wc -l\nss -t state close-wait | wc -l\n\n# R\u00e9sum\u00e9 des \u00e9tats\nss -s\n\n# Connexions vers un port sp\u00e9cifique\nss -tn dport = :443\n\n# Connexions depuis une IP\nss -tn src 10.0.0.50\n\n# Connexions d'un processus sp\u00e9cifique\nss -tp | grep nginx\n\n# Trouver quel processus \u00e9coute sur un port\nss -tlnp | grep :80\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#4-diagnostic-de-latence-mtr","title":"4. Diagnostic de Latence : mtr","text":""},{"location":"formations/linux-perf/04-network-latency/#41-mtr-ping-traceroute","title":"4.1 mtr = ping + traceroute","text":"<p><code>mtr</code> (My Traceroute) combine ping et traceroute pour une analyse continue de la latence et de la perte de paquets sur chaque saut.</p> <pre><code># Installation\n# apt install mtr-tiny  ou  dnf install mtr\n\n# Lancer vers une destination\nmtr google.com\n\n# Mode rapport (non-interactif)\nmtr -r -c 100 google.com\n\n# Sans r\u00e9solution DNS\nmtr -n google.com\n\n# Avec TCP au lieu de ICMP (utile si ICMP bloqu\u00e9)\nmtr -T -P 443 google.com\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#42-lecture-de-la-sortie","title":"4.2 Lecture de la Sortie","text":"<pre><code>                             My traceroute  [v0.94]\nserver.local (10.0.0.10) -&gt; google.com (142.250.179.110)     2025-01-28T14:35:00\n\nKeys:  Help   Display mode   Restart statistics   Order of fields   quit\n                                       Packets               Pings\n Host                                Loss%   Snt   Last   Avg  Best  Wrst StDev\n 1. gateway.local                     0.0%   100    0.5   0.6   0.4   1.2   0.1\n 2. isp-router.example.net            0.0%   100    5.2   5.5   4.8   8.3   0.5\n 3. core-router.isp.net               0.0%   100   12.3  12.8  11.5  18.2   1.2\n 4. peering.google.com                0.0%   100   15.1  15.4  14.2  22.1   1.5\n 5. 142.250.179.110                   0.0%   100   15.8  16.2  15.0  23.5   1.8\n</code></pre> <p>Colonnes :</p> Colonne Description Alerte Si <code>Loss%</code> Pourcentage de paquets perdus &gt; 1% <code>Snt</code> Paquets envoy\u00e9s - <code>Last</code> Latence du dernier paquet (ms) - <code>Avg</code> Latence moyenne (ms) Augmentation soudaine <code>Best</code> Meilleure latence (ms) - <code>Wrst</code> Pire latence (ms) &gt;&gt; Avg = jitter <code>StDev</code> \u00c9cart-type (jitter) &gt; 5 ms"},{"location":"formations/linux-perf/04-network-latency/#43-interpreter-les-resultats","title":"4.3 Interpr\u00e9ter les R\u00e9sultats","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              INTERPR\u00c9TATION MTR                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   SC\u00c9NARIO 1 : Perte sur un saut interm\u00e9diaire uniquement       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500        \u2502\n\u2502   Hop 3 :  5.0% loss                                            \u2502\n\u2502   Hop 4 :  0.0% loss                                            \u2502\n\u2502   Hop 5 :  0.0% loss (destination)                              \u2502\n\u2502                                                                 \u2502\n\u2502   \u2192 FAUX POSITIF : Le routeur au hop 3 rate-limite ICMP         \u2502\n\u2502     mais forward le trafic r\u00e9el. Pas de probl\u00e8me.               \u2502\n\u2502                                                                 \u2502\n\u2502   SC\u00c9NARIO 2 : Perte qui se propage                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                             \u2502\n\u2502   Hop 3 :  5.0% loss                                            \u2502\n\u2502   Hop 4 :  5.2% loss                                            \u2502\n\u2502   Hop 5 :  5.1% loss (destination)                              \u2502\n\u2502                                                                 \u2502\n\u2502   \u2192 VRAI PROBL\u00c8ME : Congestion ou d\u00e9faillance au hop 3          \u2502\n\u2502     Impact sur tout le trafic.                                  \u2502\n\u2502                                                                 \u2502\n\u2502   SC\u00c9NARIO 3 : Latence qui augmente soudainement                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500               \u2502\n\u2502   Hop 1 :  Avg 0.5 ms                                           \u2502\n\u2502   Hop 2 :  Avg 5.0 ms                                           \u2502\n\u2502   Hop 3 :  Avg 150 ms  \u2190 Saut anormal !                         \u2502\n\u2502   Hop 4 :  Avg 155 ms                                           \u2502\n\u2502                                                                 \u2502\n\u2502   \u2192 Lien satur\u00e9 ou probl\u00e8me au hop 3                            \u2502\n\u2502     (changement de ~145 ms entre hop 2 et 3)                    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#5-autres-outils-essentiels","title":"5. Autres Outils Essentiels","text":""},{"location":"formations/linux-perf/04-network-latency/#51-ping-le-basique","title":"5.1 ping : Le Basique","text":"<pre><code># Ping simple\nping -c 5 google.com\n\n# Avec timestamp\nping -D google.com\n\n# Flood ping (attention !)\nsudo ping -f -c 1000 192.168.1.1\n\n# Taille de paquet personnalis\u00e9e (test MTU)\nping -s 1472 -M do google.com\n# Si \"Message too long\" \u2192 MTU trop grand\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#52-diagnostic-dns","title":"5.2 Diagnostic DNS","text":"<pre><code># R\u00e9solution DNS\ndig google.com\n\n# Temps de r\u00e9solution\ndig google.com | grep \"Query time\"\n\n# Tester un serveur DNS sp\u00e9cifique\ndig @8.8.8.8 google.com\n\n# R\u00e9solution inverse\ndig -x 142.250.179.110\n\n# Version courte\nhost google.com\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#53-tcpdump-capture-de-paquets","title":"5.3 tcpdump : Capture de Paquets","text":"<pre><code># Capturer sur une interface\nsudo tcpdump -i eth0\n\n# Filtrer par host\nsudo tcpdump -i eth0 host 10.0.0.50\n\n# Filtrer par port\nsudo tcpdump -i eth0 port 443\n\n# Sauvegarder dans un fichier (pour Wireshark)\nsudo tcpdump -i eth0 -w capture.pcap\n\n# Lire un fichier de capture\ntcpdump -r capture.pcap\n\n# Afficher le contenu ASCII\nsudo tcpdump -i eth0 -A port 80\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#6-scenarios-de-diagnostic","title":"6. Sc\u00e9narios de Diagnostic","text":""},{"location":"formations/linux-perf/04-network-latency/#61-lapplication-est-lente-vers-la-base-de-donnees","title":"6.1 \"L'application est lente vers la base de donn\u00e9es\"","text":"<pre><code># 1. V\u00e9rifier la latence r\u00e9seau\nping -c 10 database.internal\nmtr -r -c 50 database.internal\n\n# 2. V\u00e9rifier les connexions\nss -tn dst database.internal\n\n# 3. V\u00e9rifier le d\u00e9bit\niftop -f \"host database.internal\"\n\n# 4. V\u00e9rifier les \u00e9tats TCP\nss -tn state time-wait dst database.internal | wc -l\n# Beaucoup de TIME_WAIT = connexions courtes, possible pooling manquant\n\n# 5. V\u00e9rifier les erreurs interface\nip -s link show eth0\n# Regarder RX/TX errors, dropped\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#62-le-serveur-ne-repond-plus-sur-le-port-443","title":"6.2 \"Le serveur ne r\u00e9pond plus sur le port 443\"","text":"<pre><code># 1. Le service \u00e9coute-t-il ?\nss -tlnp | grep :443\n\n# 2. Firewall local ?\nsudo iptables -L -n | grep 443\n# ou\nsudo firewall-cmd --list-all\n\n# 3. Connexion depuis l'ext\u00e9rieur ?\n# (depuis une autre machine)\nnc -zv server.example.com 443\ncurl -v https://server.example.com\n\n# 4. Beaucoup de connexions en attente ?\nss -tn state syn-recv | wc -l\n# Si \u00e9lev\u00e9 = possible SYN flood ou backlog trop petit\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#63-perte-de-paquets-intermittente","title":"6.3 \"Perte de paquets intermittente\"","text":"<pre><code># 1. Analyse continue avec mtr\nmtr -r -c 500 destination.com\n\n# 2. V\u00e9rifier les erreurs interface\nwatch -n 1 'ip -s link show eth0 | grep -E \"errors|dropped\"'\n\n# 3. V\u00e9rifier les buffers r\u00e9seau\ncat /proc/net/softnet_stat\n# Colonne 2 = dropped, colonne 3 = time_squeeze\n\n# 4. Statistiques d\u00e9taill\u00e9es\nnetstat -s | grep -i error\nnetstat -s | grep -i drop\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#7-commandes-de-reference-rapide","title":"7. Commandes de R\u00e9f\u00e9rence Rapide","text":"<pre><code># === BANDE PASSANTE ===\niftop -i eth0                   # Trafic par connexion\nnload eth0                      # Trafic par interface\nsar -n DEV 1                    # Statistiques r\u00e9seau\n\n# === SOCKETS ===\nss -tulpn                       # Tous les ports en \u00e9coute\nss -tn                          # Connexions TCP \u00e9tablies\nss -s                           # R\u00e9sum\u00e9 des \u00e9tats\nss -tn dport = :443             # Connexions vers port 443\n\n# === LATENCE ===\nping -c 10 host                 # Test basique\nmtr host                        # Traceroute continu\nmtr -r -c 100 host              # Rapport mtr\n\n# === DNS ===\ndig domain.com                  # R\u00e9solution DNS\ndig @8.8.8.8 domain.com         # Via DNS sp\u00e9cifique\nhost domain.com                 # R\u00e9solution simple\n\n# === DIAGNOSTIC ===\nip -s link show eth0            # Stats interface (errors, drops)\nnetstat -s                      # Stats protocoles\ncat /proc/net/softnet_stat      # Stats softirq r\u00e9seau\n\n# === CAPTURE ===\nsudo tcpdump -i eth0 port 443   # Capturer trafic\nsudo tcpdump -w capture.pcap    # Sauvegarder\n</code></pre>"},{"location":"formations/linux-perf/04-network-latency/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Une connexion a une bande passante de 10 Gbps mais une latence de 100 ms. Le t\u00e9l\u00e9chargement d'un fichier de 1 GB sera-t-il rapide ? <p>R\u00e9ponse : Oui, le transfert sera rapide car un gros fichier exploite la bande passante. Avec 10 Gbps, 1 GB prend ~0.8 seconde en th\u00e9orie.</p> <p>Par contre, une API REST qui fait 1000 requ\u00eates s\u00e9quentielles prendra au minimum 100 secondes (1000 \u00d7 100 ms) quelle que soit la bande passante.</p> Question 2 : Vous voyez beaucoup de sockets en \u00e9tat CLOSE_WAIT. Quel est le probl\u00e8me ? <p>R\u00e9ponse : CLOSE_WAIT signifie que le pair distant a ferm\u00e9 la connexion, mais notre application n'a pas appel\u00e9 <code>close()</code> sur son socket.</p> <p>C'est g\u00e9n\u00e9ralement un bug applicatif : l'application ne ferme pas correctement ses connexions. Les file descriptors s'accumulent jusqu'\u00e0 atteindre la limite (<code>ulimit</code>).</p> Question 3 : Dans mtr, le hop 4 montre 15% de perte, mais la destination (hop 6) montre 0%. Est-ce un probl\u00e8me ? <p>R\u00e9ponse : Probablement pas. De nombreux routeurs rate-limitent les r\u00e9ponses ICMP pour se prot\u00e9ger, mais forward le trafic r\u00e9el normalement.</p> <p>Ce qui compte, c'est la perte \u00e0 la destination finale. Si elle est \u00e0 0%, le chemin fonctionne.</p>"},{"location":"formations/linux-perf/04-network-latency/#felicitations","title":"F\u00e9licitations !","text":"<p>Vous avez termin\u00e9 la formation Investigation de Performance Linux. Vous ma\u00eetrisez maintenant :</p> <ul> <li>:material-check-circle: La m\u00e9thode USE pour une investigation syst\u00e9matique</li> <li>:material-check-circle: L'analyse CPU, M\u00e9moire, Disque et R\u00e9seau</li> <li>:material-check-circle: Les outils de diagnostic pour chaque ressource</li> <li>:material-check-circle: L'interpr\u00e9tation des m\u00e9triques critiques</li> </ul> <p>Vous \u00eates pr\u00eat \u00e0 r\u00e9pondre \u00e0 : \"Pourquoi le serveur est-il lent ?\"</p> <p>:octicons-arrow-left-24: Retour au Module 3 : Disque &amp; I/O</p> <p>:octicons-home: Retour \u00e0 l'index de la formation</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/ntlite/","title":"Formation : Architecture PADSEC &amp; NTLite","text":""},{"location":"formations/ntlite/#introduction","title":"Introduction","text":"<p>Le point d'entr\u00e9e de toute infrastructure s\u00e9curis\u00e9e.</p> <p>L'architecture PADSEC (Plateforme d'Administration S\u00e9curis\u00e9e) repr\u00e9sente le socle fondamental de toute infrastructure respectant les principes de d\u00e9fense en profondeur. Cette formation couvre les concepts essentiels pour comprendre et op\u00e9rer dans un environnement d'administration durci.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE PADSEC - VUE D'ENSEMBLE               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502   \u2502   INTERNET  \u2502         \u2502  ZONE CORP  \u2502                       \u2502\n\u2502   \u2502  (Hostile)  \u2502         \u2502  (Tier 2)   \u2502                       \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502          \u2502                       \u2502                              \u2502\n\u2502          \u2502    \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557                 \u2502\n\u2502          \u2502    \u2551      ZONE D'ADMINISTRATION     \u2551                \u2502\n\u2502          \u2502    \u2551          (PADSEC)              \u2551                \u2502\n\u2502          \u2502    \u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563                 \u2502\n\u2502          \u2502    \u2551                               \u2551                 \u2502\n\u2502          \u25bc    \u2551  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2551                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2551  \u2502 Bastion \u2502   \u2502   PAW   \u2502   \u2551                 \u2502\n\u2502   \u2502 FW-EDGE  \u2502\u2551  \u2502 (Jump)  \u2502   \u2502 (Admin) \u2502   \u2551                 \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\u2551  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2551                 \u2502\n\u2502        \u2502      \u2551       \u2502             \u2502        \u2551                 \u2502\n\u2502        \u2502      \u2551       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2551                 \u2502\n\u2502        \u2502      \u2551              \u2502               \u2551                 \u2502\n\u2502        \u2502      \u2551              \u25bc               \u2551                 \u2502\n\u2502        \u2502      \u2551  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2551                 \u2502\n\u2502        \u2502      \u2551  \u2502   ADMIN FOREST        \u2502   \u2551                 \u2502\n\u2502        \u2502      \u2551  \u2502 admin.shellbook.local \u2502   \u2551                 \u2502\n\u2502        \u2502      \u2551  \u2502      (Tier 0)         \u2502   \u2551                 \u2502\n\u2502        \u2502      \u2551  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2551                 \u2502\n\u2502        \u2502      \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d                 \u2502\n\u2502        \u2502                     \u2502                                  \u2502\n\u2502        \u2502                     \u2502 VPN IPsec                        \u2502\n\u2502        \u2502                     \u25bc                                  \u2502\n\u2502        \u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502        \u2514\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   ZONE RESSOURCES         \u2502                     \u2502\n\u2502               \u2502 corp.shellbook.local      \u2502                     \u2502\n\u2502               \u2502      (Tier 1-2)           \u2502                     \u2502\n\u2502               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ntlite/#concepts-fondamentaux","title":"Concepts Fondamentaux","text":""},{"location":"formations/ntlite/#quest-ce-que-padsec","title":"Qu'est-ce que PADSEC ?","text":"<p>D\u00e9finition</p> <p>PADSEC est une architecture d'administration s\u00e9curis\u00e9e qui isole physiquement et logiquement les ressources d'administration (Tier 0) des ressources de production (Tier 1-2).</p> <p>Les principes cl\u00e9s :</p> Principe Description Isolation r\u00e9seau S\u00e9paration physique entre zones Admin et Corp Moindre privil\u00e8ge Acc\u00e8s uniquement aux ressources n\u00e9cessaires Authentification forte MFA obligatoire pour acc\u00e8s PADSEC Tra\u00e7abilit\u00e9 Logging exhaustif de toutes les actions Bastionnement Passage obligatoire par un Jump Server"},{"location":"formations/ntlite/#les-zones-de-securite","title":"Les Zones de S\u00e9curit\u00e9","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    MOD\u00c8LE DE ZONES PADSEC                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ZONE ADMIN (PADSEC)                     ZONE CORP             \u2502\n\u2502   \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550                     \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550             \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502    TIER 0       \u2502                    \u2502    TIER 1       \u2502    \u2502\n\u2502   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502                    \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502    \u2502\n\u2502   \u2502 \u2022 Domain Ctrl   \u2502    VPN IPsec       \u2502 \u2022 App Servers   \u2502    \u2502\n\u2502   \u2502 \u2022 PKI (Root CA) \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502 \u2022 Databases     \u2502    \u2502\n\u2502   \u2502 \u2022 SIEM          \u2502                    \u2502 \u2022 Middleware    \u2502    \u2502\n\u2502   \u2502 \u2022 Jump Servers  \u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502   \u2502 \u2022 PAW Stations  \u2502                                           \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502                                          \u2502    TIER 2       \u2502    \u2502\n\u2502   Acc\u00e8s : Admins Tier 0 uniquement       \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502    \u2502\n\u2502   Authentification : Smartcard + PIN     \u2502 \u2022 Workstations  \u2502    \u2502\n\u2502   R\u00e9seau : Isol\u00e9, non-routable Internet  \u2502 \u2022 Printers      \u2502    \u2502\n\u2502                                          \u2502 \u2022 End Users     \u2502    \u2502\n\u2502                                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ntlite/#ntlite-durcissement-des-images-windows","title":"NTLite : Durcissement des Images Windows","text":""},{"location":"formations/ntlite/#presentation","title":"Pr\u00e9sentation","text":"<p>NTLite est un outil permettant de personnaliser et durcir les images Windows avant d\u00e9ploiement. Dans le contexte PADSEC, il est utilis\u00e9 pour cr\u00e9er des Golden Images conformes aux exigences de s\u00e9curit\u00e9.</p> <p>Usage Production</p> <p>NTLite est utilis\u00e9 uniquement pour la pr\u00e9paration des images de r\u00e9f\u00e9rence. Ne jamais modifier une image en production directement.</p>"},{"location":"formations/ntlite/#workflow-de-creation-dimage","title":"Workflow de Cr\u00e9ation d'Image","text":"<pre><code>flowchart TD\n    A[ISO Windows Server Original] --&gt; B[Montage dans NTLite]\n    B --&gt; C[Suppression Composants Inutiles]\n    C --&gt; D[Application des Param\u00e8tres S\u00e9curit\u00e9]\n    D --&gt; E[Int\u00e9gration Drivers]\n    E --&gt; F[Int\u00e9gration Updates]\n    F --&gt; G[G\u00e9n\u00e9ration ISO Durcie]\n    G --&gt; H[D\u00e9ploiement SCCM/MDT]\n    H --&gt; I[Validation Conformit\u00e9]</code></pre>"},{"location":"formations/ntlite/#composants-a-supprimer-pawjump-server","title":"Composants \u00e0 Supprimer (PAW/Jump Server)","text":"Applications InutilesServices \u00e0 D\u00e9sactiverFonctionnalit\u00e9s Optionnelles <pre><code># Composants Windows \u00e0 supprimer pour un PAW\n\n- Microsoft Edge (utiliser version manag\u00e9e)\n- Cortana\n- Xbox Game Bar\n- Windows Media Player\n- Internet Explorer\n- Microsoft Store (sauf si requis)\n- OneDrive\n- Skype\n- Weather App\n- News App\n- Tips App\n</code></pre> <pre><code># Services \u00e0 d\u00e9sactiver sur un Jump Server\n\n- Xbox Services (tous)\n- Windows Search (si non requis)\n- Superfetch/SysMain\n- Windows Error Reporting\n- Connected User Experiences (DiagTrack)\n- Remote Registry (sauf besoin sp\u00e9cifique)\n- SSDP Discovery\n- UPnP Device Host\n</code></pre> <pre><code># Fonctionnalit\u00e9s Windows \u00e0 supprimer\n\n- Internet Printing Client\n- Windows Fax and Scan\n- Work Folders Client\n- XPS Viewer\n- WordPad\n- Windows Media Features\n</code></pre>"},{"location":"formations/ntlite/#parametres-de-securite-recommandes","title":"Param\u00e8tres de S\u00e9curit\u00e9 Recommand\u00e9s","text":"<p>Param\u00e8tres Critiques</p> <p>Ces param\u00e8tres doivent \u00eatre appliqu\u00e9s sur toutes les machines PADSEC :</p> <pre><code># Param\u00e8tres Registry - S\u00e9curit\u00e9 PADSEC\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa]\n; D\u00e9sactiver LM Hash\n\"NoLMHash\"=dword:00000001\n; Niveau d'authentification NTLM\n\"LmCompatibilityLevel\"=dword:00000005\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters]\n; D\u00e9sactiver SMBv1\n\"SMB1\"=dword:00000000\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]\n; UAC au maximum\n\"EnableLUA\"=dword:00000001\n\"ConsentPromptBehaviorAdmin\"=dword:00000002\n\"PromptOnSecureDesktop\"=dword:00000001\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation]\n; Restricted Admin Mode\n\"AllowProtectedCreds\"=dword:00000001\n</code></pre>"},{"location":"formations/ntlite/#flux-reseau-padsec","title":"Flux R\u00e9seau PADSEC","text":""},{"location":"formations/ntlite/#matrice-des-flux-autorises","title":"Matrice des Flux Autoris\u00e9s","text":"Source Destination Port Protocole Usage PAW Jump Server 3389 RDP/TLS Administration PAW DC Admin 636 LDAPS Authentification Jump Server DC Corp 636 LDAPS Administration cross-forest Jump Server Servers Corp 5986 WinRM/HTTPS PowerShell Remoting SIEM Tous 514 Syslog/TLS Collecte logs NTP Admin DC Admin 123 NTP Synchronisation temps"},{"location":"formations/ntlite/#flux-interdits-deny-by-default","title":"Flux Interdits (Deny by Default)","text":"<p>R\u00e8gles Firewall Critiques</p> <p>Ces flux doivent \u00eatre explicitement bloqu\u00e9s :</p> <ul> <li>Internet \u2192 PADSEC : TOUT (aucun flux entrant)</li> <li>PADSEC \u2192 Internet : TOUT (sauf proxy whitelist)</li> <li>Corp Workstations \u2192 PADSEC : TOUT</li> <li>PADSEC \u2192 Corp Workstations : TOUT (sauf exceptions document\u00e9es)</li> </ul>"},{"location":"formations/ntlite/#procedure-dacces-padsec","title":"Proc\u00e9dure d'Acc\u00e8s PADSEC","text":""},{"location":"formations/ntlite/#workflow-dauthentification","title":"Workflow d'Authentification","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              WORKFLOW D'ACC\u00c8S PADSEC                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. AUTHENTIFICATION INITIALE                                  \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                 \u2502\n\u2502      L'admin se connecte depuis son poste Corp                  \u2502\n\u2502      avec ses credentials Corp (jdoe@corp.shellbook.local)      \u2502\n\u2502                                                                 \u2502\n\u2502   2. ACC\u00c8S VPN PADSEC                                          \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502      Connexion VPN avec certificat + MFA                        \u2502\n\u2502      Le poste Corp acc\u00e8de au r\u00e9seau PADSEC                      \u2502\n\u2502                                                                 \u2502\n\u2502   3. CONNEXION AU BASTION                                       \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2502\n\u2502      RDP vers srv-bastion-01.admin.shellbook.local              \u2502\n\u2502      Avec compte admin (jdoe-adm@admin.shellbook.local)         \u2502\n\u2502                                                                 \u2502\n\u2502   4. ADMINISTRATION                                             \u2502\n\u2502      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                         \u2502\n\u2502      Depuis le bastion, acc\u00e8s aux ressources Tier 0             \u2502\n\u2502      Ou tunnel vers les serveurs Corp via le VPN backbone       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/ntlite/#comptes-utilisateurs","title":"Comptes Utilisateurs","text":"<p>Mod\u00e8le de Double Compte</p> <p>Chaque administrateur dispose de deux comptes distincts :</p> Type Exemple Usage Forest Compte Standard <code>jdoe@corp.shellbook.local</code> Travail quotidien, email Corp Compte Admin <code>jdoe-adm@admin.shellbook.local</code> Administration uniquement Admin"},{"location":"formations/ntlite/#checklist-de-conformite","title":"Checklist de Conformit\u00e9","text":""},{"location":"formations/ntlite/#validation-dune-machine-padsec","title":"Validation d'une Machine PADSEC","text":"<pre><code># Script de validation conformit\u00e9 PADSEC\n# \u00c0 ex\u00e9cuter sur chaque PAW/Jump Server\n\nfunction Test-PADSECCompliance {\n    [CmdletBinding()]\n    param()\n\n    $results = @()\n\n    # Test 1: SMBv1 d\u00e9sactiv\u00e9\n    $smb1 = Get-WindowsOptionalFeature -Online -FeatureName SMB1Protocol\n    $results += [PSCustomObject]@{\n        Test = \"SMBv1 Disabled\"\n        Status = if ($smb1.State -eq \"Disabled\") { \"PASS\" } else { \"FAIL\" }\n    }\n\n    # Test 2: UAC activ\u00e9\n    $uac = Get-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\"\n    $results += [PSCustomObject]@{\n        Test = \"UAC Enabled\"\n        Status = if ($uac.EnableLUA -eq 1) { \"PASS\" } else { \"FAIL\" }\n    }\n\n    # Test 3: Credential Guard (si support\u00e9)\n    $cg = Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\\Microsoft\\Windows\\DeviceGuard\n    $results += [PSCustomObject]@{\n        Test = \"Credential Guard\"\n        Status = if ($cg.SecurityServicesRunning -contains 1) { \"PASS\" } else { \"WARN\" }\n    }\n\n    # Test 4: BitLocker\n    $bl = Get-BitLockerVolume -MountPoint \"C:\" -ErrorAction SilentlyContinue\n    $results += [PSCustomObject]@{\n        Test = \"BitLocker Enabled\"\n        Status = if ($bl.ProtectionStatus -eq \"On\") { \"PASS\" } else { \"FAIL\" }\n    }\n\n    # Test 5: Windows Firewall\n    $fw = Get-NetFirewallProfile\n    $fwEnabled = ($fw | Where-Object { $_.Enabled -eq $true }).Count -eq 3\n    $results += [PSCustomObject]@{\n        Test = \"Firewall All Profiles\"\n        Status = if ($fwEnabled) { \"PASS\" } else { \"FAIL\" }\n    }\n\n    return $results\n}\n\n# Ex\u00e9cution\nTest-PADSECCompliance | Format-Table -AutoSize\n</code></pre>"},{"location":"formations/ntlite/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/ntlite/#documentation-liee","title":"Documentation Li\u00e9e","text":"<ul> <li>:material-shield-lock: Topologie VPN IPsec \u2014 Backbone PADSEC</li> <li>:material-microsoft-windows: Active Directory Red Forest \u2014 Architecture for\u00eats</li> <li>:material-lock: Hardening AD - Tiering Model \u2014 Mod\u00e8le de Tiers</li> </ul>"},{"location":"formations/ntlite/#references-externes","title":"R\u00e9f\u00e9rences Externes","text":"<ul> <li>:material-link: Microsoft PAW Guidance</li> <li>:material-link: ESAE (Red Forest) Architecture</li> <li>:material-link: ANSSI - Recommandations AD</li> </ul> <p>Principe de S\u00e9curit\u00e9</p> <p>\"La s\u00e9curit\u00e9 de votre infrastructure ne peut pas \u00eatre sup\u00e9rieure \u00e0 la s\u00e9curit\u00e9 de son plan d'administration.\"</p> <p>\u2014 Microsoft Security Best Practices</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-11-28 Version : 1.0 Auteur : ShellBook Security Team</p>"},{"location":"formations/pki-security/","title":"Formation PKI &amp; Gestion des Certificats","text":""},{"location":"formations/pki-security/#introduction","title":"Introduction","text":"<p>Dans un environnement SecNumCloud et plus largement dans toute infrastructure moderne, la PKI (Public Key Infrastructure) constitue le socle fondamental de la s\u00e9curit\u00e9 des communications. Cette formation vous donnera les comp\u00e9tences n\u00e9cessaires pour comprendre, d\u00e9ployer et d\u00e9panner une infrastructure \u00e0 cl\u00e9 publique.</p>"},{"location":"formations/pki-security/#pourquoi-la-pki-est-elle-essentielle","title":"Pourquoi la PKI est-elle essentielle ?","text":"<p>La PKI r\u00e9pond \u00e0 trois besoins fondamentaux de la s\u00e9curit\u00e9 informatique :</p> Besoin Description M\u00e9canisme PKI Identit\u00e9 Garantir l'authenticit\u00e9 d'un serveur ou d'un utilisateur Certificats X.509 sign\u00e9s par une CA de confiance Chiffrement Prot\u00e9ger la confidentialit\u00e9 des donn\u00e9es en transit \u00c9change de cl\u00e9s via TLS/SSL Int\u00e9grit\u00e9 Assurer que les donn\u00e9es n'ont pas \u00e9t\u00e9 alt\u00e9r\u00e9es Signatures num\u00e9riques et hashs cryptographiques <p>Contexte SecNumCloud</p> <p>Dans le cadre de la qualification SecNumCloud de l'ANSSI, la ma\u00eetrise de la PKI est une exigence r\u00e9glementaire. Les op\u00e9rateurs doivent d\u00e9montrer leur capacit\u00e9 \u00e0 g\u00e9rer le cycle de vie complet des certificats.</p>"},{"location":"formations/pki-security/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 4 modules progressifs :</p>"},{"location":"formations/pki-security/#module-1-concepts-fondamentaux","title":"Module 1 : Concepts Fondamentaux","text":"<p>:material-book-open-variant: Th\u00e9orie | :material-clock-outline: ~45 min</p> <ul> <li>Cryptographie asym\u00e9trique (cl\u00e9 publique/priv\u00e9e)</li> <li>Cha\u00eene de confiance (Root CA \u2192 Intermediate \u2192 End-Entity)</li> <li>Anatomie d'un certificat X.509</li> <li>Handshake TLS 1.3 d\u00e9taill\u00e9</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/pki-security/#module-2-lab-openssl-construire-une-pki","title":"Module 2 : Lab OpenSSL - Construire une PKI","text":"<p>:material-flask: Pratique | :material-clock-outline: ~90 min</p> <ul> <li>G\u00e9n\u00e9rer une Autorit\u00e9 de Certification (Root CA)</li> <li>Cr\u00e9er et signer des certificats serveur</li> <li>Comprendre les formats de fichiers (.pem, .der, .pfx)</li> <li>D\u00e9ployer un certificat sur un serveur web</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/pki-security/#module-3-debugging-troubleshooting","title":"Module 3 : Debugging &amp; Troubleshooting","text":"<p>:material-bug: D\u00e9pannage | :material-clock-outline: ~60 min</p> <ul> <li>Inspecter un certificat en ligne de commande</li> <li>Valider une cha\u00eene de certification</li> <li>Diagnostiquer les erreurs TLS courantes</li> <li>Outils de test r\u00e9seau (<code>openssl s_client</code>)</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/pki-security/#module-4-automatisation-avec-acme-certbot","title":"Module 4 : Automatisation avec ACME &amp; Certbot","text":"<p>:material-robot: Automatisation | :material-clock-outline: ~75 min</p> <ul> <li>Protocole ACME et challenges (HTTP-01, DNS-01)</li> <li>Obtention et renouvellement automatique avec Certbot</li> <li>Hooks de d\u00e9ploiement (Nginx, Apache, HAProxy)</li> <li>Int\u00e9gration enterprise (Smallstep, Vault)</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 4</p>"},{"location":"formations/pki-security/#prerequis","title":"Pr\u00e9requis","text":"<p>Comp\u00e9tences requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>Linux CLI : Navigation, \u00e9dition de fichiers, pipes et redirections</li> <li>R\u00e9seau TCP/IP : Notions de ports, DNS, connexions client/serveur</li> <li>\u00c9diteur de texte : vim, nano ou \u00e9quivalent</li> </ul>"},{"location":"formations/pki-security/#environnement-de-lab","title":"Environnement de Lab","text":"<p>Pour les exercices pratiques, vous aurez besoin de :</p> Linux (Recommand\u00e9)Windows (PowerShell) <pre><code># V\u00e9rifier la version d'OpenSSL\nopenssl version\n\n# Version minimale recommand\u00e9e : 1.1.1+\n# Pour TLS 1.3 : OpenSSL 1.1.1 ou sup\u00e9rieur\n</code></pre> <pre><code># Option 1 : OpenSSL via Chocolatey\nchoco install openssl\n\n# Option 2 : Utiliser WSL2 avec une distribution Linux\nwsl --install -d Ubuntu\n</code></pre>"},{"location":"formations/pki-security/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<ul> <li>:material-file-document: Cheat Sheet Certificats \u2014 Commandes rapides</li> <li>:material-link: RFC 5280 - X.509 PKI \u2014 Sp\u00e9cification officielle</li> <li>:material-link: Mozilla SSL Configuration Generator \u2014 Configurations TLS recommand\u00e9es</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Security Team</p>"},{"location":"formations/pki-security/01-concepts/","title":"Module 1 : Concepts Fondamentaux de la PKI","text":""},{"location":"formations/pki-security/01-concepts/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Expliquer le fonctionnement de la cryptographie asym\u00e9trique</li> <li>:material-check: D\u00e9crire la cha\u00eene de confiance d'une PKI</li> <li>:material-check: Comprendre le d\u00e9roulement d'un handshake TLS 1.3</li> <li>:material-check: Identifier les composants d'un certificat X.509</li> </ul>"},{"location":"formations/pki-security/01-concepts/#1-cryptographie-asymetrique","title":"1. Cryptographie Asym\u00e9trique","text":""},{"location":"formations/pki-security/01-concepts/#le-probleme-initial","title":"Le Probl\u00e8me Initial","text":"<p>Imaginez deux personnes, Alice et Bob, qui veulent communiquer de mani\u00e8re s\u00e9curis\u00e9e sur un r\u00e9seau public. Le chiffrement sym\u00e9trique (une seule cl\u00e9 partag\u00e9e) pose un probl\u00e8me fondamental : comment \u00e9changer cette cl\u00e9 secr\u00e8te sans qu'un attaquant l'intercepte ?</p>"},{"location":"formations/pki-security/01-concepts/#la-solution-cle-publique-cle-privee","title":"La Solution : Cl\u00e9 Publique / Cl\u00e9 Priv\u00e9e","text":"<p>La cryptographie asym\u00e9trique r\u00e9sout ce probl\u00e8me en utilisant deux cl\u00e9s math\u00e9matiquement li\u00e9es :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     PAIRE DE CL\u00c9S                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502   \ud83d\udd13 CL\u00c9 PUBLIQUE                 \ud83d\udd10 CL\u00c9 PRIV\u00c9E            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500               \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500         \u2502\n\u2502   \u2022 Peut \u00eatre partag\u00e9e            \u2022 JAMAIS partag\u00e9e         \u2502\n\u2502   \u2022 Utilis\u00e9e pour CHIFFRER        \u2022 Utilis\u00e9e pour D\u00c9CHIFFRER\u2502\n\u2502   \u2022 Utilis\u00e9e pour V\u00c9RIFIER        \u2022 Utilis\u00e9e pour SIGNER    \u2502\n\u2502     une signature                                           \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/pki-security/01-concepts/#principe-de-fonctionnement","title":"Principe de Fonctionnement","text":"Op\u00e9ration Cl\u00e9 Utilis\u00e9e R\u00e9sultat Chiffrement Cl\u00e9 publique du destinataire Seul le destinataire peut d\u00e9chiffrer D\u00e9chiffrement Cl\u00e9 priv\u00e9e du destinataire R\u00e9cup\u00e9ration du message original Signature Cl\u00e9 priv\u00e9e de l'\u00e9metteur Preuve d'authenticit\u00e9 V\u00e9rification Cl\u00e9 publique de l'\u00e9metteur Validation de la signature <p>Analogie du Cadenas</p> <p>Pensez \u00e0 la cl\u00e9 publique comme un cadenas ouvert que vous distribuez \u00e0 tout le monde. N'importe qui peut fermer le cadenas (chiffrer), mais seul vous poss\u00e9dez la cl\u00e9 unique (cl\u00e9 priv\u00e9e) pour l'ouvrir (d\u00e9chiffrer).</p> <p>R\u00c8GLE D'OR : Protection de la Cl\u00e9 Priv\u00e9e</p> <p>La cl\u00e9 priv\u00e9e est le secret absolu de votre infrastructure PKI.</p> <p>Ne JAMAIS :</p> <ul> <li>La transmettre par email, chat ou tout canal non s\u00e9curis\u00e9</li> <li>La stocker sans protection (chiffrement, permissions restrictives)</li> <li>La partager entre plusieurs personnes ou syst\u00e8mes</li> <li>L'inclure dans un d\u00e9p\u00f4t Git (m\u00eame priv\u00e9)</li> </ul> <p>Toujours :</p> <ul> <li>G\u00e9n\u00e9rer la cl\u00e9 sur la machine qui l'utilisera</li> <li>Prot\u00e9ger avec une passphrase forte (pour les CA)</li> <li>Stocker dans un HSM pour les environnements de production</li> <li>Appliquer des permissions <code>chmod 400</code> (lecture seule, propri\u00e9taire uniquement)</li> </ul>"},{"location":"formations/pki-security/01-concepts/#2-la-chaine-de-confiance-chain-of-trust","title":"2. La Cha\u00eene de Confiance (Chain of Trust)","text":""},{"location":"formations/pki-security/01-concepts/#architecture-hierarchique","title":"Architecture Hi\u00e9rarchique","text":"<p>Une PKI est organis\u00e9e en hi\u00e9rarchie de confiance. Cette structure permet de d\u00e9l\u00e9guer la confiance tout en limitant l'exposition de la cl\u00e9 racine.</p> <pre><code>                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502     ROOT CA         \u2502\n                    \u2502  (Autorit\u00e9 Racine)  \u2502\n                    \u2502                     \u2502\n                    \u2502  \ud83d\udd12 OFFLINE         \u2502\n                    \u2502  Validit\u00e9: 20 ans   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u2502 signe\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   INTERMEDIATE CA   \u2502\n                    \u2502  (CA Interm\u00e9diaire) \u2502\n                    \u2502                     \u2502\n                    \u2502  \ud83c\udf10 ONLINE          \u2502\n                    \u2502  Validit\u00e9: 5-10 ans \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u2502 signe\n                               \u25bc\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                                           \u2502\n         \u25bc                                           \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   CERTIFICAT        \u2502                   \u2502   CERTIFICAT        \u2502\n\u2502   SERVEUR WEB       \u2502                   \u2502   SERVEUR MAIL      \u2502\n\u2502                     \u2502                   \u2502                     \u2502\n\u2502  web.example.com    \u2502                   \u2502  mail.example.com   \u2502\n\u2502  Validit\u00e9: 1 an     \u2502                   \u2502  Validit\u00e9: 1 an     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/pki-security/01-concepts/#role-de-chaque-niveau","title":"R\u00f4le de Chaque Niveau","text":"Niveau R\u00f4le S\u00e9curit\u00e9 Dur\u00e9e de Vie Root CA Ancre de confiance ultime Offline, HSM, air-gapped 15-25 ans Intermediate CA Signe les certificats finaux Online, HSM recommand\u00e9 5-10 ans End-Entity Identifie un serveur/utilisateur Serveur applicatif 90 jours - 2 ans <p>Pourquoi une CA Interm\u00e9diaire ?</p> <p>Si la Root CA \u00e9tait compromise, toute la PKI serait \u00e0 reconstruire. En utilisant une CA interm\u00e9diaire :</p> <ul> <li>La Root CA reste hors ligne et prot\u00e9g\u00e9e</li> <li>En cas de compromission de l'interm\u00e9diaire, on peut la r\u00e9voquer sans toucher \u00e0 la racine</li> <li>On peut avoir plusieurs CA interm\u00e9diaires pour diff\u00e9rents usages</li> </ul>"},{"location":"formations/pki-security/01-concepts/#validation-de-la-chaine","title":"Validation de la Cha\u00eene","text":"<p>Lorsqu'un navigateur re\u00e7oit un certificat, il v\u00e9rifie la cha\u00eene compl\u00e8te :</p> <ol> <li>Le certificat serveur est-il sign\u00e9 par une CA interm\u00e9diaire valide ?</li> <li>Cette CA interm\u00e9diaire est-elle sign\u00e9e par une Root CA ?</li> <li>Cette Root CA est-elle dans le magasin de confiance du syst\u00e8me ?</li> </ol> <pre><code># Visualiser la cha\u00eene de confiance d'un certificat\nopenssl s_client -connect example.com:443 -showcerts\n</code></pre>"},{"location":"formations/pki-security/01-concepts/#3-anatomie-dun-certificat-x509","title":"3. Anatomie d'un Certificat X.509","text":"<p>Un certificat X.509 contient plusieurs champs standardis\u00e9s :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CERTIFICAT X.509 v3                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Version          : 3 (0x2)                                   \u2502\n\u2502 Serial Number    : 0A:1B:2C:3D:4E:5F:6A:7B                   \u2502\n\u2502 Signature Algo   : sha256WithRSAEncryption                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Issuer (\u00c9metteur):                                           \u2502\n\u2502   CN = MyCompany Intermediate CA                             \u2502\n\u2502   O  = MyCompany                                             \u2502\n\u2502   C  = FR                                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Validity (Validit\u00e9):                                         \u2502\n\u2502   Not Before: Jan 1 00:00:00 2025 GMT                        \u2502\n\u2502   Not After : Jan 1 00:00:00 2026 GMT                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Subject (Sujet):                                             \u2502\n\u2502   CN = www.example.com                                       \u2502\n\u2502   O  = Example Corp                                          \u2502\n\u2502   L  = Paris                                                 \u2502\n\u2502   C  = FR                                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Public Key:                                                  \u2502\n\u2502   Algorithm: rsaEncryption (2048 bit)                        \u2502\n\u2502   Modulus: 00:bb:c3:45:...                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Extensions X.509 v3:                                         \u2502\n\u2502   Subject Alternative Name (SAN):                            \u2502\n\u2502     DNS: www.example.com                                     \u2502\n\u2502     DNS: example.com                                         \u2502\n\u2502     DNS: api.example.com                                     \u2502\n\u2502   Key Usage: Digital Signature, Key Encipherment             \u2502\n\u2502   Extended Key Usage: TLS Web Server Authentication          \u2502\n\u2502   Basic Constraints: CA:FALSE                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Signature:                                                   \u2502\n\u2502   Algorithm: sha256WithRSAEncryption                         \u2502\n\u2502   Value: 3a:4b:5c:6d:...                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/pki-security/01-concepts/#champs-critiques","title":"Champs Critiques","text":"Champ Description Importance Subject CN Nom commun (historiquement le domaine) D\u00e9pr\u00e9ci\u00e9 pour la validation SAN Subject Alternative Names Obligatoire depuis 2017 pour les navigateurs Key Usage Op\u00e9rations autoris\u00e9es pour la cl\u00e9 S\u00e9curit\u00e9 du certificat Basic Constraints Indique si c'est une CA Pr\u00e9vient les attaques par faux certificats <p>SAN Obligatoire</p> <p>Depuis 2017, les navigateurs ignorent le champ CN et se basent uniquement sur le SAN (Subject Alternative Name) pour valider le domaine. Tout certificat sans SAN sera rejet\u00e9.</p>"},{"location":"formations/pki-security/01-concepts/#4-le-handshake-tls-13","title":"4. Le Handshake TLS 1.3","text":"<p>TLS 1.3 (RFC 8446) a consid\u00e9rablement simplifi\u00e9 et s\u00e9curis\u00e9 le processus de n\u00e9gociation par rapport \u00e0 TLS 1.2.</p>"},{"location":"formations/pki-security/01-concepts/#diagramme-de-sequence","title":"Diagramme de S\u00e9quence","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Serveur\n\n    Note over Client,Serveur: Phase 1: Key Exchange &amp; Server Auth (1-RTT)\n\n    Client-&gt;&gt;Serveur: ClientHello + Key Share (cl\u00e9 publique ECDHE)\n    Note right of Client: Versions TLS, Cipher Suites,&lt;br/&gt;Cl\u00e9 publique \u00e9ph\u00e9m\u00e8re\n\n    Serveur-&gt;&gt;Client: ServerHello + Key Share (cl\u00e9 publique ECDHE)\n    Note left of Serveur: Version choisie, Cipher Suite,&lt;br/&gt;Cl\u00e9 publique \u00e9ph\u00e9m\u00e8re\n\n    Serveur-&gt;&gt;Client: {EncryptedExtensions}\n    Serveur-&gt;&gt;Client: {Certificate}\n    Serveur-&gt;&gt;Client: {CertificateVerify}\n    Serveur-&gt;&gt;Client: {Finished}\n    Note left of Serveur: Messages chiffr\u00e9s avec&lt;br/&gt;handshake keys\n\n    Note over Client,Serveur: Phase 2: Tunnel S\u00e9curis\u00e9 \u00c9tabli\n\n    Client-&gt;&gt;Serveur: {Finished}\n    Note right of Client: Confirmation chiffr\u00e9e\n\n    Client-&gt;&gt;Serveur: [Application Data - HTTP Request]\n    Serveur-&gt;&gt;Client: [Application Data - HTTP Response]\n    Note over Client,Serveur: Trafic chiffr\u00e9 avec application keys</code></pre> <p>L\u00e9gende du diagramme</p> <ul> <li><code>{...}</code> = Messages chiffr\u00e9s avec les handshake keys</li> <li><code>[...]</code> = Donn\u00e9es applicatives chiffr\u00e9es avec les application keys</li> <li>Le Key Share est envoy\u00e9 d\u00e8s le premier message (diff\u00e9rence majeure avec TLS 1.2)</li> </ul>"},{"location":"formations/pki-security/01-concepts/#ameliorations-de-tls-13","title":"Am\u00e9liorations de TLS 1.3","text":"Aspect TLS 1.2 TLS 1.3 Round-trips 2 RTT minimum 1 RTT (0-RTT possible) Suites obsol\u00e8tes RC4, 3DES, MD5 Supprim\u00e9es Perfect Forward Secrecy Optionnel Obligatoire Handshake chiffr\u00e9 Non Oui (apr\u00e8s ServerHello) Ren\u00e9gociation Vuln\u00e9rable Supprim\u00e9e <p>Perfect Forward Secrecy (PFS)</p> <p>Gr\u00e2ce \u00e0 l'\u00e9change de cl\u00e9s \u00e9ph\u00e9m\u00e8res (ECDHE), m\u00eame si la cl\u00e9 priv\u00e9e du serveur est compromise ult\u00e9rieurement, les sessions pass\u00e9es restent prot\u00e9g\u00e9es. Chaque session utilise une cl\u00e9 unique d\u00e9riv\u00e9e d'un \u00e9change Diffie-Hellman.</p>"},{"location":"formations/pki-security/01-concepts/#5-algorithmes-et-standards-actuels","title":"5. Algorithmes et Standards Actuels","text":""},{"location":"formations/pki-security/01-concepts/#recommandations-anssi-2024","title":"Recommandations ANSSI (2024)","text":"Usage Algorithme Recommand\u00e9 Taille Minimale Signature ECDSA (P-256, P-384) 256 bits Signature RSA 3072 bits (2048 tol\u00e9r\u00e9) \u00c9change de cl\u00e9s ECDHE 256 bits Hash SHA-256, SHA-384 256 bits minimum <p>Algorithmes \u00e0 Proscrire</p> <p>Les algorithmes suivants sont consid\u00e9r\u00e9s comme cryptographiquement cass\u00e9s :</p> <ul> <li>MD5 : Collisions triviales</li> <li>SHA-1 : Collisions d\u00e9montr\u00e9es (SHAttered, 2017)</li> <li>RSA &lt; 2048 bits : Factorisable avec des ressources modestes</li> <li>3DES : Attaque Sweet32</li> <li>RC4 : Multiples faiblesses statistiques</li> </ul>"},{"location":"formations/pki-security/01-concepts/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle cl\u00e9 utilise-t-on pour chiffrer un message destin\u00e9 \u00e0 Bob ? <p>R\u00e9ponse : La cl\u00e9 publique de Bob. Seul Bob pourra d\u00e9chiffrer avec sa cl\u00e9 priv\u00e9e.</p> Question 2 : Pourquoi la Root CA doit-elle rester hors ligne ? <p>R\u00e9ponse : Pour minimiser le risque de compromission. Si la Root CA est compromise, toute la PKI doit \u00eatre reconstruite. En la gardant offline (air-gapped), on r\u00e9duit drastiquement la surface d'attaque.</p> Question 3 : Qu'est-ce que le PFS (Perfect Forward Secrecy) ? <p>R\u00e9ponse : C'est la propri\u00e9t\u00e9 garantissant que les sessions pass\u00e9es restent s\u00e9curis\u00e9es m\u00eame si la cl\u00e9 priv\u00e9e du serveur est compromise ult\u00e9rieurement. Cela est rendu possible par l'utilisation de cl\u00e9s \u00e9ph\u00e9m\u00e8res (ECDHE).</p> Question 4 : Pourquoi le SAN est-il obligatoire dans les certificats modernes ? <p>R\u00e9ponse : Depuis 2017, les navigateurs ignorent le champ CN et utilisent exclusivement le SAN (Subject Alternative Name) pour valider le domaine. Un certificat sans SAN sera rejet\u00e9.</p>"},{"location":"formations/pki-security/01-concepts/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que vous ma\u00eetrisez les concepts th\u00e9oriques, passez \u00e0 la pratique !</p> <p>:octicons-arrow-right-24: Module 2 : Lab OpenSSL - Construire une PKI</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/pki-security/02-openssl-lab/","title":"Module 2 : Lab OpenSSL - Construire une PKI Interne","text":""},{"location":"formations/pki-security/02-openssl-lab/#objectifs-du-lab","title":"Objectifs du Lab","text":"<p>\u00c0 l'issue de ce lab, vous serez capable de :</p> <ul> <li>:material-check: G\u00e9n\u00e9rer une Autorit\u00e9 de Certification (Root CA)</li> <li>:material-check: Cr\u00e9er des requ\u00eates de signature (CSR)</li> <li>:material-check: Signer des certificats avec votre CA</li> <li>:material-check: Comprendre et manipuler les diff\u00e9rents formats de fichiers</li> </ul> <p>Sc\u00e9nario du Lab</p> <p>Vous \u00eates l'administrateur s\u00e9curit\u00e9 d'une entreprise. Votre mission est de cr\u00e9er une PKI interne pour s\u00e9curiser les communications entre vos serveurs internes. Vous allez cr\u00e9er :</p> <ol> <li>Une Root CA auto-sign\u00e9e</li> <li>Un certificat pour votre serveur web interne <code>intranet.corp.local</code></li> </ol>"},{"location":"formations/pki-security/02-openssl-lab/#preparation-de-lenvironnement","title":"Pr\u00e9paration de l'Environnement","text":""},{"location":"formations/pki-security/02-openssl-lab/#structure-de-repertoires","title":"Structure de R\u00e9pertoires","text":"LinuxWindows (PowerShell) <pre><code># Cr\u00e9er la structure de r\u00e9pertoires\nmkdir -p ~/pki-lab/{root-ca,intermediate-ca,server-certs}\nmkdir -p ~/pki-lab/root-ca/{certs,private,newcerts,crl}\n\n# Initialiser les fichiers de suivi\ntouch ~/pki-lab/root-ca/index.txt\necho 1000 &gt; ~/pki-lab/root-ca/serial\n\n# D\u00e9finir les permissions restrictives pour les cl\u00e9s priv\u00e9es\nchmod 700 ~/pki-lab/root-ca/private\n\n# Se positionner dans le r\u00e9pertoire de travail\ncd ~/pki-lab\n</code></pre> <pre><code># Cr\u00e9er la structure de r\u00e9pertoires\n$labPath = \"$env:USERPROFILE\\pki-lab\"\nNew-Item -ItemType Directory -Path \"$labPath\\root-ca\\certs\" -Force\nNew-Item -ItemType Directory -Path \"$labPath\\root-ca\\private\" -Force\nNew-Item -ItemType Directory -Path \"$labPath\\root-ca\\newcerts\" -Force\nNew-Item -ItemType Directory -Path \"$labPath\\server-certs\" -Force\n\n# Initialiser les fichiers de suivi\nNew-Item -ItemType File -Path \"$labPath\\root-ca\\index.txt\" -Force\nSet-Content -Path \"$labPath\\root-ca\\serial\" -Value \"1000\"\n\n# Se positionner dans le r\u00e9pertoire de travail\nSet-Location $labPath\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#etape-1-generer-la-root-ca","title":"\u00c9tape 1 : G\u00e9n\u00e9rer la Root CA","text":""},{"location":"formations/pki-security/02-openssl-lab/#11-generer-la-cle-privee-de-la-root-ca","title":"1.1 G\u00e9n\u00e9rer la Cl\u00e9 Priv\u00e9e de la Root CA","text":"<p>ATTENTION : Cl\u00e9 Critique</p> <p>Cette cl\u00e9 priv\u00e9e est l'\u00e9l\u00e9ment le plus sensible de votre PKI. En production :</p> <ul> <li>G\u00e9n\u00e9rez-la sur une machine air-gapped (d\u00e9connect\u00e9e du r\u00e9seau)</li> <li>Stockez-la dans un HSM (Hardware Security Module)</li> <li>Chiffrez-la avec une passphrase forte (min. 20 caract\u00e8res)</li> <li>Faites des sauvegardes s\u00e9curis\u00e9es (coffre-fort physique)</li> </ul> LinuxWindows (PowerShell) <pre><code># G\u00e9n\u00e9rer une cl\u00e9 RSA 4096 bits avec chiffrement AES-256\nopenssl genrsa -aes256 -out root-ca/private/root-ca.key 4096\n\n# Vous serez invit\u00e9 \u00e0 entrer une passphrase\n# Exemple: \"MySecureRootCA_P@ssphrase_2025!\"\n\n# V\u00e9rifier les permissions\nchmod 400 root-ca/private/root-ca.key\nls -la root-ca/private/\n</code></pre> <pre><code># G\u00e9n\u00e9rer une cl\u00e9 RSA 4096 bits avec chiffrement AES-256\nopenssl genrsa -aes256 -out root-ca\\private\\root-ca.key 4096\n\n# V\u00e9rifier le fichier g\u00e9n\u00e9r\u00e9\nGet-Item root-ca\\private\\root-ca.key\n</code></pre> <p>Sortie attendue :</p> <pre><code>Generating RSA private key, 4096 bit long modulus\n.....++\n.......................................++\ne is 65537 (0x10001)\nEnter pass phrase for root-ca/private/root-ca.key: ********\nVerifying - Enter pass phrase for root-ca/private/root-ca.key: ********\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#12-generer-le-certificat-auto-signe-de-la-root-ca","title":"1.2 G\u00e9n\u00e9rer le Certificat Auto-Sign\u00e9 de la Root CA","text":"LinuxWindows (PowerShell) <pre><code>openssl req -x509 -new -nodes \\\n    -key root-ca/private/root-ca.key \\\n    -sha256 \\\n    -days 7300 \\\n    -out root-ca/certs/root-ca.crt \\\n    -subj \"/C=FR/ST=Ile-de-France/L=Paris/O=MyCorp/OU=Security Team/CN=MyCorp Root CA\"\n</code></pre> <pre><code>openssl req -x509 -new -nodes `\n    -key root-ca\\private\\root-ca.key `\n    -sha256 `\n    -days 7300 `\n    -out root-ca\\certs\\root-ca.crt `\n    -subj \"/C=FR/ST=Ile-de-France/L=Paris/O=MyCorp/OU=Security Team/CN=MyCorp Root CA\"\n</code></pre> <p>Explication des param\u00e8tres :</p> Param\u00e8tre Description <code>-x509</code> G\u00e9n\u00e8re un certificat auto-sign\u00e9 (pas une CSR) <code>-new</code> Cr\u00e9e une nouvelle requ\u00eate <code>-nodes</code> Ne pas chiffrer la sortie (la cl\u00e9 est d\u00e9j\u00e0 chiffr\u00e9e) <code>-key</code> Cl\u00e9 priv\u00e9e \u00e0 utiliser <code>-sha256</code> Algorithme de hash pour la signature <code>-days 7300</code> Validit\u00e9 : 20 ans (365 \u00d7 20) <code>-subj</code> Subject du certificat (DN - Distinguished Name)"},{"location":"formations/pki-security/02-openssl-lab/#13-verifier-le-certificat-root-ca","title":"1.3 V\u00e9rifier le Certificat Root CA","text":"<pre><code># Afficher les informations du certificat\nopenssl x509 -in root-ca/certs/root-ca.crt -text -noout\n</code></pre> <p>V\u00e9rifiez ces \u00e9l\u00e9ments :</p> <ul> <li><code>Issuer</code> et <code>Subject</code> sont identiques (auto-sign\u00e9)</li> <li><code>CA:TRUE</code> dans les extensions</li> <li>Validit\u00e9 de 20 ans</li> </ul>"},{"location":"formations/pki-security/02-openssl-lab/#etape-2-generer-un-certificat-serveur","title":"\u00c9tape 2 : G\u00e9n\u00e9rer un Certificat Serveur","text":""},{"location":"formations/pki-security/02-openssl-lab/#21-creer-la-cle-privee-du-serveur","title":"2.1 Cr\u00e9er la Cl\u00e9 Priv\u00e9e du Serveur","text":"LinuxWindows (PowerShell) <pre><code># G\u00e9n\u00e9rer une cl\u00e9 RSA 2048 bits (sans passphrase pour un serveur web)\nopenssl genrsa -out server-certs/intranet.corp.local.key 2048\n\n# Permissions restrictives\nchmod 400 server-certs/intranet.corp.local.key\n</code></pre> <pre><code># G\u00e9n\u00e9rer une cl\u00e9 RSA 2048 bits\nopenssl genrsa -out server-certs\\intranet.corp.local.key 2048\n</code></pre> <p>Pourquoi pas de passphrase ?</p> <p>Pour les serveurs web (Apache, Nginx), une cl\u00e9 sans passphrase permet un red\u00e9marrage automatique du service. En production, utilisez des solutions comme :</p> <ul> <li>Variables d'environnement pour la passphrase</li> <li>Vault (HashiCorp) pour la gestion des secrets</li> <li>HSM avec d\u00e9verrouillage automatis\u00e9</li> </ul>"},{"location":"formations/pki-security/02-openssl-lab/#22-creer-le-fichier-de-configuration-des-extensions","title":"2.2 Cr\u00e9er le Fichier de Configuration des Extensions","text":"<p>Pour inclure les SAN (Subject Alternative Names), cr\u00e9ez un fichier de configuration :</p> LinuxWindows (PowerShell) <pre><code>cat &gt; server-certs/intranet.corp.local.cnf &lt;&lt; 'EOF'\n[req]\ndefault_bits       = 2048\nprompt             = no\ndefault_md         = sha256\ndistinguished_name = dn\nreq_extensions     = req_ext\n\n[dn]\nC  = FR\nST = Ile-de-France\nL  = Paris\nO  = MyCorp\nOU = IT Department\nCN = intranet.corp.local\n\n[req_ext]\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = intranet.corp.local\nDNS.2 = intranet\nDNS.3 = www.intranet.corp.local\nIP.1  = 192.168.1.100\nEOF\n</code></pre> <pre><code>@\"\n[req]\ndefault_bits       = 2048\nprompt             = no\ndefault_md         = sha256\ndistinguished_name = dn\nreq_extensions     = req_ext\n\n[dn]\nC  = FR\nST = Ile-de-France\nL  = Paris\nO  = MyCorp\nOU = IT Department\nCN = intranet.corp.local\n\n[req_ext]\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = intranet.corp.local\nDNS.2 = intranet\nDNS.3 = www.intranet.corp.local\nIP.1  = 192.168.1.100\n\"@ | Out-File -FilePath server-certs\\intranet.corp.local.cnf -Encoding ASCII\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#23-generer-la-csr-certificate-signing-request","title":"2.3 G\u00e9n\u00e9rer la CSR (Certificate Signing Request)","text":"LinuxWindows (PowerShell) <pre><code>openssl req -new \\\n    -key server-certs/intranet.corp.local.key \\\n    -out server-certs/intranet.corp.local.csr \\\n    -config server-certs/intranet.corp.local.cnf\n</code></pre> <pre><code>openssl req -new `\n    -key server-certs\\intranet.corp.local.key `\n    -out server-certs\\intranet.corp.local.csr `\n    -config server-certs\\intranet.corp.local.cnf\n</code></pre> <p>V\u00e9rifier la CSR :</p> <pre><code>openssl req -in server-certs/intranet.corp.local.csr -text -noout\n</code></pre> <p>Confirmez que les SAN sont pr\u00e9sents dans la section <code>Requested Extensions</code>.</p>"},{"location":"formations/pki-security/02-openssl-lab/#etape-3-signer-le-certificat-avec-la-root-ca","title":"\u00c9tape 3 : Signer le Certificat avec la Root CA","text":""},{"location":"formations/pki-security/02-openssl-lab/#31-creer-le-fichier-dextensions-pour-la-signature","title":"3.1 Cr\u00e9er le Fichier d'Extensions pour la Signature","text":"LinuxWindows (PowerShell) <pre><code>cat &gt; server-certs/server-ext.cnf &lt;&lt; 'EOF'\nauthorityKeyIdentifier = keyid,issuer\nbasicConstraints       = CA:FALSE\nkeyUsage               = digitalSignature, keyEncipherment\nextendedKeyUsage       = serverAuth\nsubjectAltName         = @alt_names\n\n[alt_names]\nDNS.1 = intranet.corp.local\nDNS.2 = intranet\nDNS.3 = www.intranet.corp.local\nIP.1  = 192.168.1.100\nEOF\n</code></pre> <pre><code>@\"\nauthorityKeyIdentifier = keyid,issuer\nbasicConstraints       = CA:FALSE\nkeyUsage               = digitalSignature, keyEncipherment\nextendedKeyUsage       = serverAuth\nsubjectAltName         = @alt_names\n\n[alt_names]\nDNS.1 = intranet.corp.local\nDNS.2 = intranet\nDNS.3 = www.intranet.corp.local\nIP.1  = 192.168.1.100\n\"@ | Out-File -FilePath server-certs\\server-ext.cnf -Encoding ASCII\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#32-signer-la-csr","title":"3.2 Signer la CSR","text":"LinuxWindows (PowerShell) <pre><code>openssl x509 -req \\\n    -in server-certs/intranet.corp.local.csr \\\n    -CA root-ca/certs/root-ca.crt \\\n    -CAkey root-ca/private/root-ca.key \\\n    -CAcreateserial \\\n    -out server-certs/intranet.corp.local.crt \\\n    -days 365 \\\n    -sha256 \\\n    -extfile server-certs/server-ext.cnf\n</code></pre> <pre><code>openssl x509 -req `\n    -in server-certs\\intranet.corp.local.csr `\n    -CA root-ca\\certs\\root-ca.crt `\n    -CAkey root-ca\\private\\root-ca.key `\n    -CAcreateserial `\n    -out server-certs\\intranet.corp.local.crt `\n    -days 365 `\n    -sha256 `\n    -extfile server-certs\\server-ext.cnf\n</code></pre> <p>Explication des param\u00e8tres :</p> Param\u00e8tre Description <code>-req</code> Indique que l'entr\u00e9e est une CSR <code>-CA</code> Certificat de la CA signataire <code>-CAkey</code> Cl\u00e9 priv\u00e9e de la CA <code>-CAcreateserial</code> Cr\u00e9e un fichier de num\u00e9ro de s\u00e9rie <code>-days 365</code> Validit\u00e9 : 1 an <code>-extfile</code> Fichier d'extensions \u00e0 inclure"},{"location":"formations/pki-security/02-openssl-lab/#33-verifier-le-certificat-signe","title":"3.3 V\u00e9rifier le Certificat Sign\u00e9","text":"<pre><code># Afficher le certificat\nopenssl x509 -in server-certs/intranet.corp.local.crt -text -noout\n\n# V\u00e9rifier la cha\u00eene\nopenssl verify -CAfile root-ca/certs/root-ca.crt server-certs/intranet.corp.local.crt\n</code></pre> <p>Sortie attendue :</p> <pre><code>server-certs/intranet.corp.local.crt: OK\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#etape-4-creer-un-bundle-pour-deploiement","title":"\u00c9tape 4 : Cr\u00e9er un Bundle pour D\u00e9ploiement","text":""},{"location":"formations/pki-security/02-openssl-lab/#41-creer-la-chaine-complete-full-chain","title":"4.1 Cr\u00e9er la Cha\u00eene Compl\u00e8te (Full Chain)","text":"<pre><code># Concat\u00e9ner le certificat serveur et la CA (ordre important !)\ncat server-certs/intranet.corp.local.crt root-ca/certs/root-ca.crt &gt; server-certs/intranet.corp.local.fullchain.pem\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#42-creer-un-bundle-pkcs12-pour-windowsiis","title":"4.2 Cr\u00e9er un Bundle PKCS#12 (pour Windows/IIS)","text":"LinuxWindows (PowerShell) <pre><code>openssl pkcs12 -export \\\n    -out server-certs/intranet.corp.local.pfx \\\n    -inkey server-certs/intranet.corp.local.key \\\n    -in server-certs/intranet.corp.local.crt \\\n    -certfile root-ca/certs/root-ca.crt \\\n    -name \"Intranet Server Certificate\"\n</code></pre> <pre><code>openssl pkcs12 -export `\n    -out server-certs\\intranet.corp.local.pfx `\n    -inkey server-certs\\intranet.corp.local.key `\n    -in server-certs\\intranet.corp.local.crt `\n    -certfile root-ca\\certs\\root-ca.crt `\n    -name \"Intranet Server Certificate\"\n</code></pre> <p>Vous serez invit\u00e9 \u00e0 d\u00e9finir un mot de passe d'export.</p>"},{"location":"formations/pki-security/02-openssl-lab/#reference-formats-de-fichiers","title":"R\u00e9f\u00e9rence : Formats de Fichiers","text":"Extension Format Contenu Usage Typique <code>.pem</code> ASCII (Base64) Certificat, cl\u00e9, ou les deux Linux/Unix, Apache, Nginx <code>.crt</code> ASCII ou DER Certificat uniquement (partie publique) Universel <code>.cer</code> ASCII ou DER Alias de .crt Windows pr\u00e9f\u00e9rence <code>.key</code> ASCII (Base64) Cl\u00e9 priv\u00e9e uniquement Configuration serveur <code>.der</code> Binaire Certificat en format binaire Java, certains appliances <code>.pfx</code> / <code>.p12</code> Binaire (PKCS#12) Bundle : cl\u00e9 priv\u00e9e + certificat + cha\u00eene Windows/IIS, import/export <code>.csr</code> ASCII (Base64) Certificate Signing Request Soumission \u00e0 une CA"},{"location":"formations/pki-security/02-openssl-lab/#conversions-courantes","title":"Conversions Courantes","text":"<pre><code># PEM vers DER\nopenssl x509 -in cert.pem -outform DER -out cert.der\n\n# DER vers PEM\nopenssl x509 -in cert.der -inform DER -outform PEM -out cert.pem\n\n# Extraire le certificat d'un PFX\nopenssl pkcs12 -in bundle.pfx -clcerts -nokeys -out cert.pem\n\n# Extraire la cl\u00e9 priv\u00e9e d'un PFX\nopenssl pkcs12 -in bundle.pfx -nocerts -out key.pem\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#recapitulatif-des-fichiers-generes","title":"R\u00e9capitulatif des Fichiers G\u00e9n\u00e9r\u00e9s","text":"<p>\u00c0 la fin de ce lab, vous devriez avoir :</p> <pre><code>~/pki-lab/\n\u251c\u2500\u2500 root-ca/\n\u2502   \u251c\u2500\u2500 certs/\n\u2502   \u2502   \u2514\u2500\u2500 root-ca.crt          # Certificat public de la Root CA\n\u2502   \u251c\u2500\u2500 private/\n\u2502   \u2502   \u2514\u2500\u2500 root-ca.key          # \ud83d\udd12 Cl\u00e9 priv\u00e9e de la Root CA (PROT\u00c9GER!)\n\u2502   \u251c\u2500\u2500 root-ca.srl              # Fichier de num\u00e9ro de s\u00e9rie\n\u2502   \u2514\u2500\u2500 index.txt\n\u2514\u2500\u2500 server-certs/\n    \u251c\u2500\u2500 intranet.corp.local.key      # \ud83d\udd12 Cl\u00e9 priv\u00e9e du serveur\n    \u251c\u2500\u2500 intranet.corp.local.csr      # Requ\u00eate de signature (archivage)\n    \u251c\u2500\u2500 intranet.corp.local.crt      # Certificat sign\u00e9\n    \u251c\u2500\u2500 intranet.corp.local.cnf      # Configuration OpenSSL\n    \u251c\u2500\u2500 intranet.corp.local.fullchain.pem  # Cha\u00eene compl\u00e8te\n    \u2514\u2500\u2500 intranet.corp.local.pfx      # Bundle PKCS#12\n</code></pre>"},{"location":"formations/pki-security/02-openssl-lab/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Votre PKI est op\u00e9rationnelle ! Apprenez maintenant \u00e0 diagnostiquer les probl\u00e8mes courants.</p> <p>:octicons-arrow-right-24: Module 3 : Debugging &amp; Troubleshooting</p> <p>Temps estim\u00e9 : 90 minutes Niveau : Interm\u00e9diaire \u00e0 Avanc\u00e9</p>"},{"location":"formations/pki-security/03-debugging/","title":"Module 3 : Debugging &amp; Troubleshooting des Certificats","text":""},{"location":"formations/pki-security/03-debugging/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Inspecter et analyser un certificat en ligne de commande</li> <li>:material-check: Valider une cha\u00eene de certification compl\u00e8te</li> <li>:material-check: Diagnostiquer les erreurs TLS les plus courantes</li> <li>:material-check: Utiliser <code>openssl s_client</code> pour tester les connexions s\u00e9curis\u00e9es</li> </ul>"},{"location":"formations/pki-security/03-debugging/#1-inspecter-un-certificat","title":"1. Inspecter un Certificat","text":""},{"location":"formations/pki-security/03-debugging/#11-lire-un-certificat-en-texte-clair","title":"1.1 Lire un Certificat en Texte Clair","text":"<p>La commande fondamentale pour analyser un certificat :</p> LinuxWindows (PowerShell) <pre><code># Afficher toutes les informations du certificat\nopenssl x509 -in certificate.crt -text -noout\n</code></pre> <pre><code>openssl x509 -in certificate.crt -text -noout\n</code></pre> <p>Explication des param\u00e8tres :</p> Param\u00e8tre Description <code>-in</code> Fichier certificat en entr\u00e9e <code>-text</code> Affiche le contenu en texte lisible <code>-noout</code> N'affiche pas le certificat encod\u00e9 en Base64"},{"location":"formations/pki-security/03-debugging/#12-informations-specifiques","title":"1.2 Informations Sp\u00e9cifiques","text":"<pre><code># Afficher uniquement le Subject\nopenssl x509 -in certificate.crt -subject -noout\n\n# Afficher uniquement l'Issuer (\u00e9metteur)\nopenssl x509 -in certificate.crt -issuer -noout\n\n# Afficher les dates de validit\u00e9\nopenssl x509 -in certificate.crt -dates -noout\n\n# Afficher le num\u00e9ro de s\u00e9rie\nopenssl x509 -in certificate.crt -serial -noout\n\n# Afficher le fingerprint SHA256\nopenssl x509 -in certificate.crt -fingerprint -sha256 -noout\n\n# Afficher les Subject Alternative Names (SAN)\nopenssl x509 -in certificate.crt -text -noout | grep -A1 \"Subject Alternative Name\"\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#13-verifier-lexpiration","title":"1.3 V\u00e9rifier l'Expiration","text":"<pre><code># V\u00e9rifier si le certificat expire dans les 30 prochains jours\nopenssl x509 -in certificate.crt -checkend 2592000 -noout\n\n# Retourne 0 si valide, 1 si expiration imminente\necho $?\n</code></pre> <p>Automatisation</p> <p>Int\u00e9grez cette commande dans vos scripts de monitoring pour alerter avant l'expiration :</p> <pre><code>#!/bin/bash\nCERT=\"/path/to/certificate.crt\"\nDAYS=30\nSECONDS=$((DAYS * 86400))\n\nif ! openssl x509 -in \"$CERT\" -checkend \"$SECONDS\" -noout; then\n    echo \"ALERTE: Le certificat expire dans moins de $DAYS jours!\"\n    # Envoyer une notification (mail, Slack, etc.)\nfi\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#2-valider-une-chaine-de-certification","title":"2. Valider une Cha\u00eene de Certification","text":""},{"location":"formations/pki-security/03-debugging/#21-verification-basique","title":"2.1 V\u00e9rification Basique","text":"<pre><code># V\u00e9rifier un certificat contre une CA\nopenssl verify -CAfile root-ca.crt server-certificate.crt\n</code></pre> <p>R\u00e9sultats possibles :</p> Sortie Signification <code>certificate.crt: OK</code> Cha\u00eene valide <code>unable to get local issuer certificate</code> CA interm\u00e9diaire manquante <code>certificate signature failure</code> Signature invalide <code>certificate has expired</code> Certificat expir\u00e9"},{"location":"formations/pki-security/03-debugging/#22-verification-avec-chaine-complete","title":"2.2 V\u00e9rification avec Cha\u00eene Compl\u00e8te","text":"<p>Si vous avez une CA interm\u00e9diaire :</p> <pre><code># Cr\u00e9er un bundle de CA (root + intermediate)\ncat intermediate-ca.crt root-ca.crt &gt; ca-chain.crt\n\n# V\u00e9rifier avec la cha\u00eene compl\u00e8te\nopenssl verify -CAfile ca-chain.crt server-certificate.crt\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#23-verification-avec-affichage-de-la-chaine","title":"2.3 V\u00e9rification avec Affichage de la Cha\u00eene","text":"<pre><code># Afficher la cha\u00eene de v\u00e9rification compl\u00e8te\nopenssl verify -CAfile ca-chain.crt -show_chain server-certificate.crt\n</code></pre> <p>Sortie attendue :</p> <pre><code>server-certificate.crt: OK\nChain:\ndepth=0: CN = www.example.com (untrusted)\ndepth=1: CN = Example Intermediate CA\ndepth=2: CN = Example Root CA\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#3-test-de-connexion-avec-openssl-s_client","title":"3. Test de Connexion avec <code>openssl s_client</code>","text":""},{"location":"formations/pki-security/03-debugging/#31-connexion-basique","title":"3.1 Connexion Basique","text":"<p>L'outil <code>s_client</code> permet de tester une connexion TLS comme le ferait un navigateur :</p> LinuxWindows (PowerShell) <pre><code># Test de connexion \u00e0 un serveur HTTPS\nopenssl s_client -connect google.com:443\n</code></pre> <pre><code># Test de connexion \u00e0 un serveur HTTPS\nopenssl s_client -connect google.com:443\n</code></pre> <p>Interpr\u00e9tation de la sortie</p> <p>La sortie contient plusieurs sections importantes :</p> <ul> <li>Certificate chain : La cha\u00eene de certificats pr\u00e9sent\u00e9e par le serveur</li> <li>Server certificate : Le certificat du serveur (PEM)</li> <li>SSL handshake : D\u00e9tails de la n\u00e9gociation TLS</li> <li>Verify return code : Code de validation (0 = OK)</li> </ul>"},{"location":"formations/pki-security/03-debugging/#32-options-avancees","title":"3.2 Options Avanc\u00e9es","text":"<pre><code># Afficher la cha\u00eene compl\u00e8te avec d\u00e9tails\nopenssl s_client -connect example.com:443 -showcerts\n\n# Forcer une version TLS sp\u00e9cifique\nopenssl s_client -connect example.com:443 -tls1_3\n\n# Sp\u00e9cifier un SNI (Server Name Indication)\nopenssl s_client -connect example.com:443 -servername www.example.com\n\n# Utiliser un CA bundle personnalis\u00e9\nopenssl s_client -connect example.com:443 -CAfile /path/to/ca-bundle.crt\n\n# Timeout de connexion (en secondes)\ntimeout 5 openssl s_client -connect example.com:443\n\n# V\u00e9rifier le certificat et quitter imm\u00e9diatement\necho | openssl s_client -connect example.com:443 2&gt;/dev/null | openssl x509 -text -noout\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#33-analyser-le-resultat","title":"3.3 Analyser le R\u00e9sultat","text":"<p>Exemple de sortie :</p> <pre><code>CONNECTED(00000003)\ndepth=2 C = US, O = DigiCert Inc, CN = DigiCert Global Root CA\nverify return:1\ndepth=1 C = US, O = DigiCert Inc, CN = DigiCert TLS RSA SHA256 2020 CA1\nverify return:1\ndepth=0 C = US, ST = California, L = Mountain View, O = Google LLC, CN = *.google.com\nverify return:1\n---\nCertificate chain\n 0 s:C = US, ST = California, L = Mountain View, O = Google LLC, CN = *.google.com\n   i:C = US, O = DigiCert Inc, CN = DigiCert TLS RSA SHA256 2020 CA1\n 1 s:C = US, O = DigiCert Inc, CN = DigiCert TLS RSA SHA256 2020 CA1\n   i:C = US, O = DigiCert Inc, CN = DigiCert Global Root CA\n---\n...\nSSL-Session:\n    Protocol  : TLSv1.3\n    Cipher    : TLS_AES_256_GCM_SHA384\n...\n    Verify return code: 0 (ok)\n</code></pre> <p>Points \u00e0 v\u00e9rifier :</p> \u00c9l\u00e9ment Attendu Probl\u00e8me si... <code>Verify return code</code> <code>0 (ok)</code> Tout autre code indique un probl\u00e8me <code>Protocol</code> <code>TLSv1.2</code> ou <code>TLSv1.3</code> Versions ant\u00e9rieures = obsol\u00e8tes <code>Certificate chain</code> Compl\u00e8te Cha\u00eene incompl\u00e8te = erreurs navigateur"},{"location":"formations/pki-security/03-debugging/#4-erreurs-courantes-et-solutions","title":"4. Erreurs Courantes et Solutions","text":""},{"location":"formations/pki-security/03-debugging/#41-tableau-de-diagnostic","title":"4.1 Tableau de Diagnostic","text":"Code d'erreur Message Cause probable Solution <code>2</code> <code>unable to get issuer certificate</code> Cha\u00eene incompl\u00e8te Ajouter les certificats interm\u00e9diaires <code>10</code> <code>certificate has expired</code> Certificat p\u00e9rim\u00e9 Renouveler le certificat <code>18</code> <code>self-signed certificate</code> CA non reconnue Ajouter la Root CA au trust store <code>19</code> <code>self-signed certificate in chain</code> CA interm\u00e9diaire auto-sign\u00e9e V\u00e9rifier la cha\u00eene de confiance <code>20</code> <code>unable to get local issuer certificate</code> Root CA manquante Installer la Root CA <code>21</code> <code>unable to verify first certificate</code> Pas de cha\u00eene pr\u00e9sent\u00e9e Configurer le serveur avec fullchain <code>26</code> <code>unsupported certificate purpose</code> Usage incorrect V\u00e9rifier Key Usage / Extended Key Usage"},{"location":"formations/pki-security/03-debugging/#42-problemes-de-chaine-incomplete","title":"4.2 Probl\u00e8mes de Cha\u00eene Incompl\u00e8te","text":"<p>Erreur la Plus Courante</p> <p>L'erreur <code>unable to verify the first certificate</code> est la plus fr\u00e9quente. Elle survient quand le serveur ne pr\u00e9sente pas la cha\u00eene interm\u00e9diaire.</p> <p>Diagnostic :</p> <pre><code># V\u00e9rifier ce que le serveur envoie\nopenssl s_client -connect problematic-server.com:443 -showcerts 2&gt;/dev/null | \\\n    grep -E \"^(Certificate chain| [0-9]+ s:|   i:)\"\n</code></pre> <p>Solution (Apache) :</p> <pre><code>SSLCertificateFile /etc/ssl/certs/server.crt\nSSLCertificateKeyFile /etc/ssl/private/server.key\nSSLCertificateChainFile /etc/ssl/certs/intermediate.crt\n</code></pre> <p>Solution (Nginx) :</p> <pre><code>ssl_certificate /etc/ssl/certs/server-fullchain.pem;  # cert + intermediates\nssl_certificate_key /etc/ssl/private/server.key;\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#43-problemes-de-sancn","title":"4.3 Probl\u00e8mes de SAN/CN","text":"<p>NET::ERR_CERT_COMMON_NAME_INVALID</p> <p>Cette erreur Chrome/Firefox indique que le domaine demand\u00e9 ne correspond pas au certificat.</p> <p>Diagnostic :</p> <pre><code># Extraire les SAN du certificat\necho | openssl s_client -connect server.com:443 2&gt;/dev/null | \\\n    openssl x509 -noout -text | grep -A1 \"Subject Alternative Name\"\n</code></pre> <p>V\u00e9rifiez que :</p> <ul> <li>Le domaine exact est list\u00e9 dans les SAN</li> <li>Les wildcards sont correctement utilis\u00e9s (<code>*.example.com</code> couvre <code>www.example.com</code> mais PAS <code>example.com</code>)</li> </ul>"},{"location":"formations/pki-security/03-debugging/#44-problemes-de-dateheure","title":"4.4 Probl\u00e8mes de Date/Heure","text":"<pre><code># V\u00e9rifier les dates du certificat\nopenssl x509 -in certificate.crt -noout -dates\n\n# V\u00e9rifier l'heure syst\u00e8me\ndate\ntimedatectl status  # Linux avec systemd\n</code></pre> <p>Synchronisation NTP</p> <p>Une diff\u00e9rence de quelques minutes entre le client et le serveur peut causer des erreurs de validation. Assurez-vous que NTP est configur\u00e9 sur tous vos syst\u00e8mes.</p>"},{"location":"formations/pki-security/03-debugging/#5-outils-de-diagnostic-avances","title":"5. Outils de Diagnostic Avanc\u00e9s","text":""},{"location":"formations/pki-security/03-debugging/#51-ssl-labs-en-ligne","title":"5.1 SSL Labs (En ligne)","text":"<p>Pour un diagnostic complet d'un serveur public :</p> <p>:material-link: https://www.ssllabs.com/ssltest/</p>"},{"location":"formations/pki-security/03-debugging/#52-testsslsh-linux","title":"5.2 testssl.sh (Linux)","text":"<p>Script complet pour tester la configuration TLS :</p> <pre><code># Installation\ngit clone https://github.com/drwetter/testssl.sh.git\ncd testssl.sh\n\n# Ex\u00e9cution\n./testssl.sh https://example.com\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#53-crtsh-certificate-transparency","title":"5.3 crt.sh (Certificate Transparency)","text":"<p>Rechercher tous les certificats \u00e9mis pour un domaine :</p> <p>:material-link: https://crt.sh/?q=example.com</p>"},{"location":"formations/pki-security/03-debugging/#6-script-de-diagnostic-automatise","title":"6. Script de Diagnostic Automatis\u00e9","text":"<p>Voici un script utilitaire pour diagnostiquer rapidement un certificat :</p> Linux (Bash)Windows (PowerShell) <pre><code>#!/bin/bash\n# cert-check.sh - Diagnostic rapide d'un certificat\n\nif [ -z \"$1\" ]; then\n    echo \"Usage: $0 &lt;host:port&gt; OR $0 &lt;certificate.crt&gt;\"\n    exit 1\nfi\n\necho \"========================================\"\necho \"  Diagnostic de Certificat\"\necho \"========================================\"\n\nif [[ \"$1\" == *\":\"* ]]; then\n    # Connexion r\u00e9seau\n    HOST=\"$1\"\n    echo -e \"\\n[*] Connexion \u00e0 $HOST...\"\n\n    CERT=$(echo | openssl s_client -connect \"$HOST\" -servername \"${HOST%%:*}\" 2&gt;/dev/null)\n\n    echo -e \"\\n[*] Cha\u00eene de certificats:\"\n    echo \"$CERT\" | grep -E \"^(Certificate chain| [0-9]+ s:|   i:)\"\n\n    echo -e \"\\n[*] Protocole et Cipher:\"\n    echo \"$CERT\" | grep -E \"(Protocol|Cipher)\"\n\n    echo -e \"\\n[*] Code de v\u00e9rification:\"\n    echo \"$CERT\" | grep \"Verify return code\"\n\n    echo -e \"\\n[*] Dates de validit\u00e9:\"\n    echo \"$CERT\" | openssl x509 -noout -dates 2&gt;/dev/null\n\n    echo -e \"\\n[*] Subject Alternative Names:\"\n    echo \"$CERT\" | openssl x509 -noout -text 2&gt;/dev/null | \\\n        grep -A1 \"Subject Alternative Name\" | tail -1\nelse\n    # Fichier local\n    FILE=\"$1\"\n    echo -e \"\\n[*] Analyse de $FILE...\"\n\n    echo -e \"\\n[*] Subject:\"\n    openssl x509 -in \"$FILE\" -subject -noout\n\n    echo -e \"\\n[*] Issuer:\"\n    openssl x509 -in \"$FILE\" -issuer -noout\n\n    echo -e \"\\n[*] Dates de validit\u00e9:\"\n    openssl x509 -in \"$FILE\" -dates -noout\n\n    echo -e \"\\n[*] Fingerprint SHA256:\"\n    openssl x509 -in \"$FILE\" -fingerprint -sha256 -noout\n\n    echo -e \"\\n[*] Subject Alternative Names:\"\n    openssl x509 -in \"$FILE\" -text -noout | \\\n        grep -A1 \"Subject Alternative Name\" | tail -1\nfi\n\necho -e \"\\n========================================\"\n</code></pre> <pre><code># cert-check.ps1 - Diagnostic rapide d'un certificat\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$Target\n)\n\nWrite-Host \"========================================\"\nWrite-Host \"  Diagnostic de Certificat\"\nWrite-Host \"========================================\"\n\nif ($Target -match \":\") {\n    # Connexion r\u00e9seau\n    Write-Host \"`n[*] Connexion \u00e0 $Target...\"\n    $result = echo \"\" | openssl s_client -connect $Target 2&gt;$null\n\n    Write-Host \"`n[*] Protocole et Cipher:\"\n    $result | Select-String -Pattern \"Protocol|Cipher\"\n\n    Write-Host \"`n[*] Code de v\u00e9rification:\"\n    $result | Select-String -Pattern \"Verify return code\"\n}\nelse {\n    # Fichier local\n    Write-Host \"`n[*] Analyse de $Target...\"\n\n    Write-Host \"`n[*] Subject:\"\n    openssl x509 -in $Target -subject -noout\n\n    Write-Host \"`n[*] Issuer:\"\n    openssl x509 -in $Target -issuer -noout\n\n    Write-Host \"`n[*] Dates de validit\u00e9:\"\n    openssl x509 -in $Target -dates -noout\n}\n\nWrite-Host \"`n========================================\"\n</code></pre> <p>Usage :</p> <pre><code># Test d'un serveur distant\n./cert-check.sh google.com:443\n\n# Analyse d'un fichier local\n./cert-check.sh /path/to/certificate.crt\n</code></pre>"},{"location":"formations/pki-security/03-debugging/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<p>Cheat Sheet</p> <p>Pour une r\u00e9f\u00e9rence rapide de toutes les commandes OpenSSL, consultez notre aide-m\u00e9moire :</p> <p>:material-file-document: Cheat Sheet Certificats</p>"},{"location":"formations/pki-security/03-debugging/#quiz-final","title":"Quiz Final","text":"Question 1 : Quelle commande permet de v\u00e9rifier qu'un certificat n'expire pas dans les 7 jours ? <p>R\u00e9ponse : <pre><code>openssl x509 -in cert.crt -checkend 604800 -noout\n# 604800 = 7 * 24 * 60 * 60 secondes\n</code></pre></p> Question 2 : Comment diagnostiquer une erreur 'unable to verify the first certificate' ? <p>R\u00e9ponse : Cette erreur indique que le serveur ne pr\u00e9sente pas la cha\u00eene interm\u00e9diaire. V\u00e9rifiez avec : <pre><code>openssl s_client -connect server:443 -showcerts\n</code></pre> Puis configurez le serveur pour envoyer le fullchain (certificat + interm\u00e9diaires).</p> Question 3 : Comment extraire le certificat d'un serveur distant et le sauvegarder ? <p>R\u00e9ponse : <pre><code>echo | openssl s_client -connect server.com:443 2&gt;/dev/null | \\\n    sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; server.crt\n</code></pre></p>"},{"location":"formations/pki-security/03-debugging/#felicitations","title":"F\u00e9licitations !","text":"<p>Vous avez termin\u00e9 la formation PKI &amp; Gestion des Certificats. Vous ma\u00eetrisez maintenant :</p> <ul> <li>:material-check-circle: Les fondamentaux de la cryptographie asym\u00e9trique</li> <li>:material-check-circle: La construction d'une PKI interne avec OpenSSL</li> <li>:material-check-circle: Le diagnostic et la r\u00e9solution des probl\u00e8mes TLS</li> </ul> <p>:octicons-arrow-left-24: Retour \u00e0 l'index de la formation</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire \u00e0 Avanc\u00e9</p>"},{"location":"formations/pki-security/04-automation/","title":"Module 4 : Automatisation avec ACME &amp; Certbot","text":""},{"location":"formations/pki-security/04-automation/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre le protocole ACME et ses m\u00e9canismes de validation</li> <li>:material-check: Choisir entre les challenges HTTP-01 et DNS-01 selon votre contexte</li> <li>:material-check: Automatiser l'obtention et le renouvellement de certificats avec Certbot</li> <li>:material-check: Int\u00e9grer le cycle de vie des certificats dans votre infrastructure</li> </ul> <p>Philosophie DevOps</p> <p>\"Un certificat qui expire est un certificat qui n'aurait jamais d\u00fb \u00eatre g\u00e9r\u00e9 manuellement.\"</p> <p>L'automatisation n'est pas une option \u2014 c'est une exigence de production.</p>"},{"location":"formations/pki-security/04-automation/#1-le-protocole-acme","title":"1. Le Protocole ACME","text":""},{"location":"formations/pki-security/04-automation/#11-quest-ce-que-acme","title":"1.1 Qu'est-ce que ACME ?","text":"<p>ACME (Automatic Certificate Management Environment) est un protocole standardis\u00e9 (RFC 8555) qui permet l'automatisation compl\u00e8te du cycle de vie des certificats :</p> <ul> <li>Demande de certificat</li> <li>Validation de la propri\u00e9t\u00e9 du domaine</li> <li>\u00c9mission du certificat</li> <li>Renouvellement automatique</li> <li>R\u00e9vocation si n\u00e9cessaire</li> </ul> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u00c9COSYST\u00c8ME ACME                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         HTTPS/JSON         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502              \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502              \u2502  \u2502\n\u2502   \u2502  CLIENT ACME \u2502                             \u2502 SERVEUR ACME \u2502  \u2502\n\u2502   \u2502  (Certbot)   \u2502                             \u2502 (Let's Encrypt)\u2502\n\u2502   \u2502              \u2502                             \u2502              \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502          \u2502                                            \u2502         \u2502\n\u2502          \u2502 \u00c9crit le certificat                        \u2502         \u2502\n\u2502          \u25bc                                            \u2502         \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                    \u2502         \u2502\n\u2502   \u2502 Serveur Web  \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502   \u2502 (Nginx/Apache)\u2502        Validation HTTP-01 ou DNS-01         \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/pki-security/04-automation/#12-le-flux-de-validation","title":"1.2 Le Flux de Validation","text":"<pre><code>sequenceDiagram\n    participant Client as Client ACME&lt;br/&gt;(Certbot)\n    participant CA as Serveur ACME&lt;br/&gt;(Let's Encrypt)\n    participant Target as Cible de Validation&lt;br/&gt;(Web/DNS)\n\n    Note over Client,Target: Phase 1: Initiation de la Demande\n\n    Client-&gt;&gt;CA: POST /newOrder&lt;br/&gt;{identifiers: [\"example.com\"]}\n    CA-&gt;&gt;Client: 201 Created&lt;br/&gt;{challenges: [http-01, dns-01]}\n\n    Note over Client,Target: Phase 2: R\u00e9ponse au Challenge\n\n    Client-&gt;&gt;Client: G\u00e9n\u00e8re le token de preuve\n    Client-&gt;&gt;Target: D\u00e9ploie le token&lt;br/&gt;(fichier HTTP ou record DNS)\n    Client-&gt;&gt;CA: POST /challenge&lt;br/&gt;\"Je suis pr\u00eat\"\n\n    Note over Client,Target: Phase 3: Validation par la CA\n\n    CA-&gt;&gt;Target: GET /.well-known/acme-challenge/{token}&lt;br/&gt;OU query DNS TXT _acme-challenge\n    Target-&gt;&gt;CA: Token valide\n\n    Note over Client,Target: Phase 4: \u00c9mission du Certificat\n\n    CA-&gt;&gt;CA: Validation OK\n    Client-&gt;&gt;CA: POST /finalize (CSR)\n    CA-&gt;&gt;Client: Certificat sign\u00e9\n    Client-&gt;&gt;Client: Installe le certificat</code></pre>"},{"location":"formations/pki-security/04-automation/#2-les-types-de-challenges","title":"2. Les Types de Challenges","text":""},{"location":"formations/pki-security/04-automation/#21-comparatif-http-01-vs-dns-01","title":"2.1 Comparatif HTTP-01 vs DNS-01","text":"Crit\u00e8re HTTP-01 DNS-01 Pr\u00e9requis Port 80 ouvert vers Internet Acc\u00e8s API au provider DNS Wildcards Non support\u00e9 Support\u00e9 (<code>*.example.com</code>) Serveurs internes Impossible (pas d'acc\u00e8s public) Possible (validation DNS) Complexit\u00e9 Simple Moyenne (n\u00e9cessite plugin DNS) Cas d'usage Serveurs web publics CDN, load balancers, wildcards"},{"location":"formations/pki-security/04-automation/#22-challenge-http-01","title":"2.2 Challenge HTTP-01","text":"<p>Le serveur ACME v\u00e9rifie que vous contr\u00f4lez le domaine en acc\u00e9dant \u00e0 une URL sp\u00e9cifique :</p> <pre><code>http://example.com/.well-known/acme-challenge/&lt;TOKEN&gt;\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     HTTP-01 CHALLENGE                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  1. Certbot g\u00e9n\u00e8re un token: abc123xyz                      \u2502\n\u2502                                                             \u2502\n\u2502  2. Certbot cr\u00e9e le fichier:                                \u2502\n\u2502     /var/www/html/.well-known/acme-challenge/abc123xyz      \u2502\n\u2502                                                             \u2502\n\u2502  3. Let's Encrypt acc\u00e8de \u00e0:                                 \u2502\n\u2502     http://example.com/.well-known/acme-challenge/abc123xyz \u2502\n\u2502                    \u2502                                        \u2502\n\u2502                    \u25bc                                        \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                        \u2502\n\u2502     \u2502  FIREWALL: Port 80 OUVERT    \u2502  \u25c4\u2500\u2500 OBLIGATOIRE      \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                        \u2502\n\u2502                                                             \u2502\n\u2502  4. Si le contenu correspond \u2192 Certificat \u00e9mis              \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Port 80 Obligatoire</p> <p>Le challenge HTTP-01 exige que le port 80 soit accessible depuis Internet, m\u00eame si votre site final est en HTTPS sur le port 443. C'est une exigence du protocole ACME, pas une option.</p>"},{"location":"formations/pki-security/04-automation/#23-challenge-dns-01","title":"2.3 Challenge DNS-01","text":"<p>Le serveur ACME v\u00e9rifie un enregistrement TXT dans votre zone DNS :</p> <pre><code>_acme-challenge.example.com.  300  IN  TXT  \"gfj9Xq...Rg85nM\"\n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     DNS-01 CHALLENGE                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  1. Certbot g\u00e9n\u00e8re un token de validation                   \u2502\n\u2502                                                             \u2502\n\u2502  2. Certbot appelle l'API DNS (via plugin):                 \u2502\n\u2502     POST /zones/example.com/records                         \u2502\n\u2502     {                                                       \u2502\n\u2502       \"type\": \"TXT\",                                        \u2502\n\u2502       \"name\": \"_acme-challenge\",                            \u2502\n\u2502       \"content\": \"gfj9Xq...Rg85nM\"                          \u2502\n\u2502     }                                                       \u2502\n\u2502                                                             \u2502\n\u2502  3. Let's Encrypt query DNS:                                \u2502\n\u2502     dig TXT _acme-challenge.example.com                     \u2502\n\u2502                                                             \u2502\n\u2502  4. Si le TXT correspond \u2192 Certificat \u00e9mis                  \u2502\n\u2502     (y compris wildcards *.example.com)                     \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Cas d'Usage DNS-01</p> <p>Utilisez DNS-01 quand :</p> <ul> <li>Vous avez besoin d'un wildcard (<code>*.example.com</code>)</li> <li>Votre serveur est derri\u00e8re un load balancer sans acc\u00e8s direct</li> <li>Vous g\u00e9rez des serveurs internes non expos\u00e9s sur Internet</li> <li>Le port 80 est bloqu\u00e9 par politique de s\u00e9curit\u00e9</li> </ul>"},{"location":"formations/pki-security/04-automation/#3-certbot-installation-et-utilisation","title":"3. Certbot : Installation et Utilisation","text":""},{"location":"formations/pki-security/04-automation/#31-installation","title":"3.1 Installation","text":"Debian/UbuntuRHEL/CentOS/RockyAlpine Linux <pre><code># Installation via snap (recommand\u00e9 par EFF)\nsudo snap install --classic certbot\nsudo ln -s /snap/bin/certbot /usr/bin/certbot\n\n# V\u00e9rifier l'installation\ncertbot --version\n</code></pre> <pre><code># Activer EPEL\nsudo dnf install epel-release\n\n# Installer Certbot\nsudo dnf install certbot python3-certbot-nginx\n\n# V\u00e9rifier l'installation\ncertbot --version\n</code></pre> <pre><code># Installation via apk\napk add certbot certbot-nginx\n\n# V\u00e9rifier l'installation\ncertbot --version\n</code></pre>"},{"location":"formations/pki-security/04-automation/#32-mode-standalone-testdeveloppement","title":"3.2 Mode Standalone (Test/D\u00e9veloppement)","text":"<p>Le mode standalone lance un serveur web temporaire sur le port 80 :</p> <pre><code># Arr\u00eater temporairement le serveur web existant\nsudo systemctl stop nginx\n\n# Obtenir un certificat (mode test)\nsudo certbot certonly --standalone --dry-run -d example.com -d www.example.com\n\n# Si le dry-run passe, ex\u00e9cuter pour de vrai\nsudo certbot certonly --standalone -d example.com -d www.example.com\n\n# Red\u00e9marrer le serveur web\nsudo systemctl start nginx\n</code></pre> <p>Quand utiliser Standalone ?</p> <ul> <li>Tests initiaux et validation de la configuration</li> <li>Serveurs sans serveur web (mail, VPN, etc.)</li> <li>Environnements de d\u00e9veloppement</li> </ul>"},{"location":"formations/pki-security/04-automation/#33-mode-webroot-production","title":"3.3 Mode Webroot (Production)","text":"<p>Le mode webroot utilise un serveur web existant \u2014 aucune interruption de service :</p> <pre><code># Syntaxe g\u00e9n\u00e9rale\nsudo certbot certonly --webroot \\\n    -w /var/www/html \\\n    -d example.com \\\n    -d www.example.com\n\n# Avec dry-run pour tester d'abord (TOUJOURS recommand\u00e9)\nsudo certbot certonly --dry-run --webroot \\\n    -w /var/www/html \\\n    -d monsite.com\n</code></pre> <p>Configuration Nginx requise :</p> <pre><code>server {\n    listen 80;\n    server_name example.com www.example.com;\n\n    # ACME challenge location - NE PAS SUPPRIMER\n    location /.well-known/acme-challenge/ {\n        root /var/www/html;\n        allow all;\n    }\n\n    # Redirection HTTPS pour le reste\n    location / {\n        return 301 https://$host$request_uri;\n    }\n}\n</code></pre> <p>Configuration Apache requise :</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName example.com\n    ServerAlias www.example.com\n\n    # ACME challenge directory\n    Alias /.well-known/acme-challenge/ /var/www/html/.well-known/acme-challenge/\n    &lt;Directory \"/var/www/html/.well-known/acme-challenge/\"&gt;\n        Options None\n        AllowOverride None\n        Require all granted\n    &lt;/Directory&gt;\n\n    # Redirection HTTPS pour le reste\n    RewriteEngine On\n    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/\n    RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"formations/pki-security/04-automation/#34-mode-dns-wildcards-serveurs-internes","title":"3.4 Mode DNS (Wildcards &amp; Serveurs Internes)","text":"<p>Pour les wildcards ou quand le port 80 n'est pas accessible :</p> <pre><code># Avec plugin Cloudflare\nsudo certbot certonly --dns-cloudflare \\\n    --dns-cloudflare-credentials /etc/letsencrypt/cloudflare.ini \\\n    -d example.com \\\n    -d \"*.example.com\"\n\n# Avec plugin Route53 (AWS)\nsudo certbot certonly --dns-route53 \\\n    -d example.com \\\n    -d \"*.example.com\"\n\n# Avec plugin OVH\nsudo certbot certonly --dns-ovh \\\n    --dns-ovh-credentials /etc/letsencrypt/ovh.ini \\\n    -d example.com \\\n    -d \"*.example.com\"\n</code></pre> <p>Exemple de fichier credentials Cloudflare (<code>/etc/letsencrypt/cloudflare.ini</code>) :</p> <pre><code># Cloudflare API token (recommand\u00e9)\ndns_cloudflare_api_token = YOUR_API_TOKEN\n\n# OU Cloudflare Global API Key (legacy)\n# dns_cloudflare_email = your@email.com\n# dns_cloudflare_api_key = YOUR_GLOBAL_API_KEY\n</code></pre> <pre><code># S\u00e9curiser le fichier\nsudo chmod 600 /etc/letsencrypt/cloudflare.ini\n</code></pre>"},{"location":"formations/pki-security/04-automation/#4-automatisation-du-renouvellement","title":"4. Automatisation du Renouvellement","text":""},{"location":"formations/pki-security/04-automation/#41-le-probleme","title":"4.1 Le Probl\u00e8me","text":"<p>Les certificats Let's Encrypt expirent apr\u00e8s 90 jours. Un renouvellement manuel est :</p> <ul> <li>Source d'erreurs humaines</li> <li>Non scalable</li> <li>Incompatible avec la philosophie DevOps</li> </ul>"},{"location":"formations/pki-security/04-automation/#42-renouvellement-automatique","title":"4.2 Renouvellement Automatique","text":"<p>Certbot installe automatiquement un timer systemd ou une entr\u00e9e cron :</p> <pre><code># V\u00e9rifier le timer systemd\nsudo systemctl status certbot.timer\n\n# Ou v\u00e9rifier la crontab\nsudo cat /etc/cron.d/certbot\n</code></pre> <p>Entr\u00e9e cron typique :</p> <pre><code># /etc/cron.d/certbot\n0 */12 * * * root certbot renew --quiet --deploy-hook \"systemctl reload nginx\"\n</code></pre> <p>Timer systemd (<code>/etc/systemd/system/certbot.timer</code>) :</p> <pre><code>[Unit]\nDescription=Run certbot twice daily\n\n[Timer]\nOnCalendar=*-*-* 00,12:00:00\nRandomizedDelaySec=43200\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n</code></pre>"},{"location":"formations/pki-security/04-automation/#43-deploy-hooks-redemarrage-automatique","title":"4.3 Deploy Hooks : Red\u00e9marrage Automatique","text":"<p>Le deploy hook s'ex\u00e9cute uniquement si un certificat a \u00e9t\u00e9 renouvel\u00e9 :</p> NginxApacheHAProxy <pre><code># Renouvellement avec reload Nginx\nsudo certbot renew --deploy-hook \"systemctl reload nginx\"\n</code></pre> <pre><code># Renouvellement avec reload Apache\nsudo certbot renew --deploy-hook \"systemctl reload apache2\"\n</code></pre> <pre><code># HAProxy n\u00e9cessite un fichier combin\u00e9 (cert + key)\nsudo certbot renew --deploy-hook \"/usr/local/bin/haproxy-renew.sh\"\n</code></pre> <pre><code>#!/bin/bash\n# /usr/local/bin/haproxy-renew.sh\nDOMAIN=\"example.com\"\nLIVE_DIR=\"/etc/letsencrypt/live/${DOMAIN}\"\nHAPROXY_CERT=\"/etc/haproxy/certs/${DOMAIN}.pem\"\n\n# Combiner fullchain + privkey\ncat \"${LIVE_DIR}/fullchain.pem\" \"${LIVE_DIR}/privkey.pem\" &gt; \"${HAPROXY_CERT}\"\n\n# Reload HAProxy\nsystemctl reload haproxy\n</code></pre>"},{"location":"formations/pki-security/04-automation/#44-configuration-permanente-des-hooks","title":"4.4 Configuration Permanente des Hooks","text":"<p>Cr\u00e9ez un fichier de configuration pour persister les hooks :</p> <pre><code># /etc/letsencrypt/cli.ini\n# Configuration globale Certbot\n\n# Hooks de d\u00e9ploiement\ndeploy-hook = systemctl reload nginx\n\n# Email pour les notifications d'expiration\nemail = security@example.com\n\n# Accepter les ToS automatiquement\nagree-tos = true\n\n# Pas de newsletter EFF\nno-eff-email = true\n</code></pre> <p>Ou par domaine (<code>/etc/letsencrypt/renewal/example.com.conf</code>) :</p> <pre><code>[renewalparams]\n# ... autres param\u00e8tres ...\n\n[[ webroot ]]\n# ... config webroot ...\n\n# Hook personnalis\u00e9 pour ce domaine\nrenew_hook = /usr/local/bin/deploy-example.sh\n</code></pre>"},{"location":"formations/pki-security/04-automation/#45-test-du-renouvellement","title":"4.5 Test du Renouvellement","text":"<p>Toujours tester avant de mettre en production :</p> <pre><code># Dry-run complet\nsudo certbot renew --dry-run\n\n# Forcer le renouvellement d'un domaine sp\u00e9cifique (test)\nsudo certbot renew --cert-name example.com --dry-run --force-renewal\n</code></pre>"},{"location":"formations/pki-security/04-automation/#5-monitoring-et-alerting","title":"5. Monitoring et Alerting","text":""},{"location":"formations/pki-security/04-automation/#51-script-de-monitoring","title":"5.1 Script de Monitoring","text":"<pre><code>#!/bin/bash\n# /usr/local/bin/check-cert-expiry.sh\n\nWARN_DAYS=30\nCRIT_DAYS=7\n\nfor cert in /etc/letsencrypt/live/*/cert.pem; do\n    domain=$(basename $(dirname \"$cert\"))\n    expiry=$(openssl x509 -in \"$cert\" -noout -enddate | cut -d= -f2)\n    expiry_epoch=$(date -d \"$expiry\" +%s)\n    now_epoch=$(date +%s)\n    days_left=$(( (expiry_epoch - now_epoch) / 86400 ))\n\n    if [ $days_left -lt $CRIT_DAYS ]; then\n        echo \"CRITICAL: $domain expire dans $days_left jours!\"\n        # Envoyer alerte (mail, Slack, PagerDuty...)\n    elif [ $days_left -lt $WARN_DAYS ]; then\n        echo \"WARNING: $domain expire dans $days_left jours\"\n    else\n        echo \"OK: $domain - $days_left jours restants\"\n    fi\ndone\n</code></pre>"},{"location":"formations/pki-security/04-automation/#52-integration-prometheus","title":"5.2 Int\u00e9gration Prometheus","text":"<pre><code># prometheus-certbot-exporter configuration\nscrape_configs:\n  - job_name: 'ssl-certificates'\n    static_configs:\n      - targets: ['localhost:9219']\n</code></pre>"},{"location":"formations/pki-security/04-automation/#6-contexte-entreprise","title":"6. Contexte Entreprise","text":"<p>Environnement Corporate (Worldline/SecNumCloud)</p> <p>Dans un contexte d'entreprise soumis \u00e0 des exigences r\u00e9glementaires (SecNumCloud, PCI-DSS, HDS), l'utilisation de Let's Encrypt public peut \u00eatre limit\u00e9e ou interdite pour plusieurs raisons :</p> <p>Contraintes :</p> <ul> <li>Les certificats publics peuvent r\u00e9v\u00e9ler l'existence de sous-domaines internes</li> <li>Pas de contr\u00f4le sur la CA \u00e9mettrice</li> <li>Logs de Certificate Transparency publics</li> <li>Dur\u00e9e de vie de 90 jours non n\u00e9gociable</li> </ul> <p>Solutions Enterprise :</p> Solution Description Cas d'usage Smallstep CA CA interne compatible ACME PKI priv\u00e9e, microservices HashiCorp Vault PKI Secrets management + CA Infrastructure cloud-native EJBCA CA enterprise open-source Grande \u00e9chelle, compliance Microsoft AD CS + ACME Int\u00e9gration Active Directory Environnements Windows Venafi Plateforme enterprise Multi-cloud, compliance <p>Bonne nouvelle : Les commandes Certbot restent identiques ! Seule l'URL du serveur ACME change :</p> <pre><code># Let's Encrypt (public)\ncertbot certonly --server https://acme-v02.api.letsencrypt.org/directory ...\n\n# Smallstep CA (interne)\ncertbot certonly --server https://ca.internal.corp:9000/acme/acme/directory ...\n\n# HashiCorp Vault\ncertbot certonly --server https://vault.internal.corp:8200/v1/pki/acme/directory ...\n</code></pre> <p>Recommandation Architecture</p> <p>Pour une infrastructure hybride, consid\u00e9rez :</p> <ul> <li>Certificats publics (Let's Encrypt) \u2192 Services expos\u00e9s sur Internet</li> <li>Certificats internes (Smallstep/Vault) \u2192 Services internes, mTLS, microservices</li> </ul> <p>Utilisez le m\u00eame tooling (Certbot) pour les deux, seul le <code>--server</code> change.</p>"},{"location":"formations/pki-security/04-automation/#7-troubleshooting-acme","title":"7. Troubleshooting ACME","text":""},{"location":"formations/pki-security/04-automation/#71-erreurs-courantes","title":"7.1 Erreurs Courantes","text":"Erreur Cause Solution <code>Connection refused</code> Port 80 bloqu\u00e9 Ouvrir le firewall, v\u00e9rifier security groups <code>DNS problem: NXDOMAIN</code> Domaine inexistant V\u00e9rifier la configuration DNS <code>Timeout during connect</code> Serveur inaccessible V\u00e9rifier la connectivit\u00e9 r\u00e9seau <code>Too many certificates</code> Rate limiting Attendre ou utiliser staging <code>CAA record prevents issuance</code> Enregistrement CAA DNS restrictif Ajouter <code>0 issue \"letsencrypt.org\"</code>"},{"location":"formations/pki-security/04-automation/#72-environnement-de-staging","title":"7.2 Environnement de Staging","text":"<p>Toujours tester sur le staging avant la production :</p> <pre><code># Utiliser le serveur de staging (pas de rate limiting)\nsudo certbot certonly --staging --webroot \\\n    -w /var/www/html \\\n    -d test.example.com\n\n# Les certificats staging ne sont PAS valides pour les navigateurs\n# Mais permettent de tester toute la cha\u00eene\n</code></pre>"},{"location":"formations/pki-security/04-automation/#73-logs-et-debugging","title":"7.3 Logs et Debugging","text":"<pre><code># Logs Certbot\nsudo cat /var/log/letsencrypt/letsencrypt.log\n\n# Mode verbose\nsudo certbot renew --dry-run -v\n\n# Mode tr\u00e8s verbose (debug)\nsudo certbot renew --dry-run -vvv\n</code></pre>"},{"location":"formations/pki-security/04-automation/#8-checklist-de-production","title":"8. Checklist de Production","text":"<p>Avant de passer en production, validez cette checklist :</p> <ul> <li>[ ] Dry-run r\u00e9ussi : <code>certbot certonly --dry-run</code> passe sans erreur</li> <li>[ ] Port 80 accessible (HTTP-01) ou API DNS configur\u00e9e (DNS-01)</li> <li>[ ] Webroot configur\u00e9 dans Nginx/Apache</li> <li>[ ] Deploy hook test\u00e9 : le service red\u00e9marre correctement</li> <li>[ ] Timer/cron actif : <code>systemctl status certbot.timer</code></li> <li>[ ] Monitoring configur\u00e9 : alertes avant expiration</li> <li>[ ] Backup des cl\u00e9s : <code>/etc/letsencrypt</code> sauvegard\u00e9</li> <li>[ ] Documentation : proc\u00e9dure de recovery document\u00e9e</li> </ul>"},{"location":"formations/pki-security/04-automation/#quiz-final","title":"Quiz Final","text":"Question 1 : Pourquoi le challenge HTTP-01 ne supporte pas les wildcards ? <p>R\u00e9ponse : Le challenge HTTP-01 valide un domaine sp\u00e9cifique en acc\u00e9dant \u00e0 une URL pr\u00e9cise. Un wildcard (<code>*.example.com</code>) repr\u00e9sente une infinit\u00e9 de sous-domaines \u2014 impossible de tous les valider via HTTP. Seul DNS-01 peut prouver le contr\u00f4le de toute la zone DNS.</p> Question 2 : Quelle est la diff\u00e9rence entre <code>--pre-hook</code>, <code>--deploy-hook</code> et <code>--post-hook</code> ? <p>R\u00e9ponse :</p> <ul> <li><code>--pre-hook</code> : Ex\u00e9cut\u00e9 avant toute tentative de renouvellement</li> <li><code>--deploy-hook</code> : Ex\u00e9cut\u00e9 uniquement si un certificat a \u00e9t\u00e9 renouvel\u00e9 avec succ\u00e8s</li> <li><code>--post-hook</code> : Ex\u00e9cut\u00e9 apr\u00e8s toute tentative, succ\u00e8s ou \u00e9chec</li> </ul> <p>Pour red\u00e9marrer un service, utilisez <code>--deploy-hook</code> pour \u00e9viter les red\u00e9marrages inutiles.</p> Question 3 : Comment obtenir un certificat pour un serveur qui n'est pas accessible depuis Internet ? <p>R\u00e9ponse : Utilisez le challenge DNS-01. Il ne n\u00e9cessite pas d'acc\u00e8s HTTP au serveur \u2014 seul l'acc\u00e8s API \u00e0 votre provider DNS est requis. Certbot cr\u00e9e un enregistrement TXT que Let's Encrypt v\u00e9rifie, puis le supprime.</p>"},{"location":"formations/pki-security/04-automation/#felicitations","title":"F\u00e9licitations !","text":"<p>Vous avez termin\u00e9 le module d'automatisation. Votre infrastructure PKI est maintenant :</p> <ul> <li>:material-check-circle: Automatis\u00e9e : Plus de renouvellements manuels</li> <li>:material-check-circle: R\u00e9siliente : Hooks de d\u00e9ploiement configur\u00e9s</li> <li>:material-check-circle: Monitor\u00e9e : Alertes avant expiration</li> <li>:material-check-circle: Scalable : M\u00eame process pour N domaines</li> </ul> <p>:octicons-arrow-left-24: Retour au Module 3 : Debugging</p> <p>:octicons-home: Retour \u00e0 l'index de la formation</p> <p>Temps estim\u00e9 : 75 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/powershell-advanced/","title":"Formation : PowerShell Avanc\u00e9 &amp; Tooling","text":""},{"location":"formations/powershell-advanced/#introduction","title":"Introduction","text":"<p>Arr\u00eatez d'\u00e9crire des scripts. Commencez \u00e0 construire des outils.</p> <p>La diff\u00e9rence entre un administrateur syst\u00e8me et un ing\u00e9nieur DevOps ne r\u00e9side pas dans les t\u00e2ches qu'ils accomplissent, mais dans comment ils les accomplissent. Un script r\u00e9sout un probl\u00e8me une fois. Un outil r\u00e9sout une cat\u00e9gorie de probl\u00e8mes, de mani\u00e8re fiable, maintenable et r\u00e9utilisable.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u00c9VOLUTION DU SCRIPTING POWERSHELL                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   NIVEAU 1 : Script Proc\u00e9dural                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                               \u2502\n\u2502   \u2022 Code lin\u00e9aire, pas de fonctions                             \u2502\n\u2502   \u2022 Variables en dur                                            \u2502\n\u2502   \u2022 Pas de gestion d'erreur                                     \u2502\n\u2502   \u2022 \"\u00c7a marche sur ma machine\"                                  \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 2 : Script avec Fonctions                              \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                              \u2502\n\u2502   \u2022 D\u00e9coupage en fonctions                                      \u2502\n\u2502   \u2022 Param\u00e8tres basiques                                         \u2502\n\u2502   \u2022 Quelques try/catch                                          \u2502\n\u2502   \u2022 R\u00e9utilisable... parfois                                     \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 3 : Outil Industrialis\u00e9                     \u25c4\u2500\u2500 CIBLE  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                \u2502\n\u2502   \u2022 Advanced Functions (CmdletBinding)                          \u2502\n\u2502   \u2022 Gestion d'erreur compl\u00e8te                                   \u2502\n\u2502   \u2022 Support du pipeline                                         \u2502\n\u2502   \u2022 Module packag\u00e9 avec manifeste                               \u2502\n\u2502   \u2022 Tests Pester, documentation int\u00e9gr\u00e9e                        \u2502\n\u2502   \u2022 \"\u00c7a marche partout, tout le temps\"                          \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Philosophie DevOps</p> <p>\"Treat your infrastructure code with the same discipline you would treat production application code.\"</p> <p>Un script PowerShell d\u00e9ploy\u00e9 en production est du code de production.</p>"},{"location":"formations/powershell-advanced/#pourquoi-cette-formation","title":"Pourquoi cette formation ?","text":"<p>Cette formation vous transformera de scripteur en toolmaker. Vous apprendrez \u00e0 :</p> <ul> <li>:material-tools: Construire des fonctions de qualit\u00e9 professionnelle</li> <li>:material-shield-check: G\u00e9rer les erreurs de mani\u00e8re robuste</li> <li>:material-package-variant: Packager vos outils en modules r\u00e9utilisables</li> <li>:material-file-document: Documenter automatiquement vos commandes</li> </ul>"},{"location":"formations/powershell-advanced/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 3 modules :</p>"},{"location":"formations/powershell-advanced/#module-1-advanced-functions","title":"Module 1 : Advanced Functions","text":"<p>:material-function: Le C\u0153ur du Tooling | :material-clock-outline: ~60 min</p> <ul> <li>La magie de <code>[CmdletBinding()]</code></li> <li>Param\u00e8tres avanc\u00e9s (<code>Mandatory</code>, <code>ValidateSet</code>, <code>ValueFromPipeline</code>)</li> <li>Support natif de <code>-Verbose</code>, <code>-Debug</code>, <code>-WhatIf</code></li> <li>Construction d'une fonction template production-ready</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/powershell-advanced/#module-2-gestion-des-erreurs","title":"Module 2 : Gestion des Erreurs","text":"<p>:material-alert-circle: Robustesse | :material-clock-outline: ~45 min</p> <ul> <li>Erreurs terminantes vs non-terminantes</li> <li>Pattern <code>Try / Catch / Finally</code></li> <li>Strat\u00e9gie \"Fail Fast\" avec <code>$ErrorActionPreference</code></li> <li>Logging et tra\u00e7abilit\u00e9 des erreurs</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/powershell-advanced/#module-3-conception-de-modules","title":"Module 3 : Conception de Modules","text":"<p>:material-package-variant-closed: Industrialisation | :material-clock-outline: ~60 min</p> <ul> <li>Structure d'un module (<code>.psm1</code> / <code>.psd1</code>)</li> <li>API publique vs fonctions internes</li> <li>Versioning et manifeste</li> <li>D\u00e9ploiement et auto-loading</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/powershell-advanced/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>PowerShell Fondamentaux : Variables, boucles, conditions</li> <li>Fonctions Basiques : Cr\u00e9ation de fonctions simples avec <code>param()</code></li> <li>Pipeline : Compr\u00e9hension du cha\u00eenage de commandes (<code>|</code>)</li> <li>Cmdlets Natifs : <code>Get-*</code>, <code>Set-*</code>, <code>New-*</code>, <code>Remove-*</code></li> </ul>"},{"location":"formations/powershell-advanced/#environnement-de-lab","title":"Environnement de Lab","text":"Windows PowerShell 5.1PowerShell 7+ (Cross-Platform) <pre><code># V\u00e9rifier la version\n$PSVersionTable.PSVersion\n\n# Version minimale recommand\u00e9e : 5.1\n# Disponible nativement sur Windows 10/11 et Server 2016+\n</code></pre> <pre><code># Installation via winget (Windows)\nwinget install Microsoft.PowerShell\n\n# Installation via apt (Linux)\nsudo apt-get install -y powershell\n\n# V\u00e9rifier la version\npwsh -Version\n</code></pre>"},{"location":"formations/powershell-advanced/#outils-recommandes","title":"Outils Recommand\u00e9s","text":"Outil Usage Installation VS Code \u00c9diteur principal <code>winget install Microsoft.VisualStudioCode</code> Extension PowerShell IntelliSense, debugging Extension VS Code <code>ms-vscode.powershell</code> Pester Framework de tests <code>Install-Module Pester -Force</code> PSScriptAnalyzer Linting et best practices <code>Install-Module PSScriptAnalyzer -Force</code>"},{"location":"formations/powershell-advanced/#conventions-de-nommage","title":"Conventions de Nommage","text":"<p>Verb-Noun : La Convention PowerShell</p> <p>PowerShell impose une convention de nommage stricte : Verbe-Nom.</p> Verbe Usage Exemple <code>Get-</code> R\u00e9cup\u00e9rer des donn\u00e9es <code>Get-WorldlineUser</code> <code>Set-</code> Modifier des donn\u00e9es existantes <code>Set-WorldlineUserPassword</code> <code>New-</code> Cr\u00e9er une nouvelle ressource <code>New-WorldlineUser</code> <code>Remove-</code> Supprimer une ressource <code>Remove-WorldlineUser</code> <code>Invoke-</code> Ex\u00e9cuter une action <code>Invoke-WorldlineAudit</code> <code>Test-</code> V\u00e9rifier une condition (retourne bool) <code>Test-WorldlineConnection</code> <code>Export-</code> Exporter vers un fichier/format <code>Export-WorldlineReport</code> <code>Import-</code> Importer depuis un fichier/format <code>Import-WorldlineConfig</code> <pre><code># Lister tous les verbes approuv\u00e9s\nGet-Verb | Sort-Object Verb\n</code></pre>"},{"location":"formations/powershell-advanced/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/powershell-advanced/#documentation-officielle","title":"Documentation Officielle","text":"<ul> <li>:material-link: about_Functions_Advanced</li> <li>:material-link: about_Modules</li> <li>:material-link: PowerShell Best Practices</li> </ul>"},{"location":"formations/powershell-advanced/#ressources-communautaires","title":"Ressources Communautaires","text":"<ul> <li>:material-book: IT-Connect - Cours PowerShell</li> <li>:material-book: PowerShell Practice Primer</li> <li>:material-tools: PSScriptAnalyzer Rules</li> </ul> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Automation Team</p>"},{"location":"formations/powershell-advanced/01-advanced-functions/","title":"Module 1 : Advanced Functions","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre la diff\u00e9rence entre une fonction basique et une Advanced Function</li> <li>:material-check: Utiliser <code>[CmdletBinding()]</code> pour transformer vos fonctions en cmdlets</li> <li>:material-check: D\u00e9finir des param\u00e8tres robustes avec validation</li> <li>:material-check: Supporter le pipeline PowerShell nativement</li> </ul>"},{"location":"formations/powershell-advanced/01-advanced-functions/#1-la-ligne-magique-cmdletbinding","title":"1. La Ligne Magique : <code>[CmdletBinding()]</code>","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#11-fonction-basique-vs-advanced-function","title":"1.1 Fonction Basique vs Advanced Function","text":"<p>Fonction basique (niveau d\u00e9butant) :</p> <pre><code>function Get-UserInfo {\n    param($Username)\n\n    Write-Host \"Recherche de l'utilisateur $Username...\"\n    Get-ADUser -Identity $Username\n}\n</code></pre> <p>Advanced Function (niveau professionnel) :</p> <pre><code>function Get-UserInfo {\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory = $true)]\n        [string]$Username\n    )\n\n    Write-Verbose \"Recherche de l'utilisateur $Username...\"\n    Get-ADUser -Identity $Username\n}\n</code></pre> <p>Qu'apporte <code>[CmdletBinding()]</code> ?</p> <p>Cette simple ligne transforme votre fonction en une cmdlet \u00e0 part enti\u00e8re, avec :</p> Fonctionnalit\u00e9 Sans CmdletBinding Avec CmdletBinding <code>-Verbose</code> Non disponible Automatique <code>-Debug</code> Non disponible Automatique <code>-ErrorAction</code> Non disponible Automatique <code>-WhatIf</code> / <code>-Confirm</code> Non disponible Activable Validation des param\u00e8tres Manuelle D\u00e9clarative Pipeline support Limit\u00e9 Complet"},{"location":"formations/powershell-advanced/01-advanced-functions/#12-les-parametres-communs","title":"1.2 Les Param\u00e8tres Communs","text":"<p>Avec <code>[CmdletBinding()]</code>, votre fonction h\u00e9rite automatiquement des Common Parameters :</p> <pre><code># Tous ces appels fonctionnent automatiquement !\nGet-UserInfo -Username \"jdupont\" -Verbose\nGet-UserInfo -Username \"jdupont\" -Debug\nGet-UserInfo -Username \"jdupont\" -ErrorAction Stop\nGet-UserInfo -Username \"jdupont\" -OutVariable result\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#2-definition-des-parametres","title":"2. D\u00e9finition des Param\u00e8tres","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#21-syntaxe-complete","title":"2.1 Syntaxe Compl\u00e8te","text":"<pre><code>function Verb-Noun {\n    [CmdletBinding()]\n    param(\n        [Parameter(\n            Mandatory = $true,\n            Position = 0,\n            ValueFromPipeline = $true,\n            ValueFromPipelineByPropertyName = $true,\n            HelpMessage = \"Description du param\u00e8tre\"\n        )]\n        [ValidateNotNullOrEmpty()]\n        [string]$ParameterName\n    )\n\n    # Corps de la fonction\n}\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#22-attributs-de-parametres","title":"2.2 Attributs de Param\u00e8tres","text":"Attribut Description Exemple <code>Mandatory</code> Param\u00e8tre obligatoire <code>Mandatory = $true</code> <code>Position</code> Position dans l'appel (sans nommer) <code>Position = 0</code> <code>ValueFromPipeline</code> Accepte l'objet entier du pipe <code>ValueFromPipeline = $true</code> <code>ValueFromPipelineByPropertyName</code> Accepte une propri\u00e9t\u00e9 sp\u00e9cifique Mappe la propri\u00e9t\u00e9 \"Name\" <code>HelpMessage</code> Message d'aide si omis Affich\u00e9 \u00e0 l'utilisateur <code>ParameterSetName</code> Groupe de param\u00e8tres exclusifs Pour des modes diff\u00e9rents"},{"location":"formations/powershell-advanced/01-advanced-functions/#23-validateurs-de-parametres","title":"2.3 Validateurs de Param\u00e8tres","text":"<pre><code>param(\n    # Ne doit pas \u00eatre null ou vide\n    [ValidateNotNullOrEmpty()]\n    [string]$Username,\n\n    # Doit \u00eatre dans une liste d\u00e9finie\n    [ValidateSet(\"Production\", \"Staging\", \"Development\")]\n    [string]$Environment,\n\n    # Doit correspondre \u00e0 un pattern regex\n    [ValidatePattern(\"^[a-zA-Z0-9._%+-]+@worldline\\.com$\")]\n    [string]$Email,\n\n    # Doit \u00eatre dans une plage num\u00e9rique\n    [ValidateRange(1, 100)]\n    [int]$Percentage,\n\n    # Doit avoir une longueur sp\u00e9cifique\n    [ValidateLength(8, 64)]\n    [string]$Password,\n\n    # Validation par script personnalis\u00e9\n    [ValidateScript({\n        if (Test-Path $_) { $true }\n        else { throw \"Le chemin '$_' n'existe pas.\" }\n    })]\n    [string]$FilePath,\n\n    # Nombre d'\u00e9l\u00e9ments dans un tableau\n    [ValidateCount(1, 10)]\n    [string[]]$ServerList\n)\n</code></pre> <p>Fail Fast</p> <p>Les validateurs s'ex\u00e9cutent avant le corps de la fonction. Si la validation \u00e9choue, la fonction ne s'ex\u00e9cute jamais. C'est le principe du \"Fail Fast\" : d\u00e9tecter les erreurs le plus t\u00f4t possible.</p>"},{"location":"formations/powershell-advanced/01-advanced-functions/#3-support-du-pipeline","title":"3. Support du Pipeline","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#31-comprendre-le-pipeline","title":"3.1 Comprendre le Pipeline","text":"<p>Le pipeline PowerShell passe des objets d'une commande \u00e0 l'autre :</p> <pre><code># Chaque utilisateur est pass\u00e9 un par un \u00e0 la fonction suivante\nGet-ADUser -Filter * | ForEach-Object { ... }\n</code></pre> <p>Pour supporter le pipeline, votre fonction doit impl\u00e9menter les blocs <code>Begin</code>, <code>Process</code> et <code>End</code> :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CYCLE DE VIE DU PIPELINE                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      BEGIN                              \u2502   \u2502\n\u2502   \u2502  Ex\u00e9cut\u00e9 UNE SEULE FOIS au d\u00e9but                       \u2502   \u2502\n\u2502   \u2502  \u2192 Initialisation, connexions, variables               \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      PROCESS                            \u2502   \u2502\n\u2502   \u2502  Ex\u00e9cut\u00e9 POUR CHAQUE OBJET du pipeline                 \u2502   \u2502\n\u2502   \u2502  \u2192 Traitement de $_ ou du param\u00e8tre pipeline           \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Objet 1 \u2192 PROCESS                                     \u2502   \u2502\n\u2502   \u2502  Objet 2 \u2192 PROCESS                                     \u2502   \u2502\n\u2502   \u2502  Objet 3 \u2192 PROCESS                                     \u2502   \u2502\n\u2502   \u2502  ...                                                    \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                     \u2502\n\u2502                           \u25bc                                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                       END                               \u2502   \u2502\n\u2502   \u2502  Ex\u00e9cut\u00e9 UNE SEULE FOIS \u00e0 la fin                       \u2502   \u2502\n\u2502   \u2502  \u2192 Nettoyage, fermeture connexions, rapport final      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#32-exemple-avec-pipeline","title":"3.2 Exemple avec Pipeline","text":"<pre><code>function Get-UserStatus {\n    [CmdletBinding()]\n    param(\n        [Parameter(\n            Mandatory = $true,\n            ValueFromPipeline = $true,\n            ValueFromPipelineByPropertyName = $true\n        )]\n        [string]$SamAccountName\n    )\n\n    begin {\n        Write-Verbose \"Initialisation - Connexion \u00e0 Active Directory\"\n        $results = @()\n    }\n\n    process {\n        Write-Verbose \"Traitement de l'utilisateur : $SamAccountName\"\n\n        try {\n            $user = Get-ADUser -Identity $SamAccountName -Properties Enabled, LastLogonDate\n            $results += [PSCustomObject]@{\n                Username      = $SamAccountName\n                Enabled       = $user.Enabled\n                LastLogonDate = $user.LastLogonDate\n                Status        = if ($user.Enabled) { \"Actif\" } else { \"D\u00e9sactiv\u00e9\" }\n            }\n        }\n        catch {\n            Write-Warning \"Utilisateur non trouv\u00e9 : $SamAccountName\"\n        }\n    }\n\n    end {\n        Write-Verbose \"Fin du traitement - $($results.Count) utilisateurs trait\u00e9s\"\n        return $results\n    }\n}\n\n# Utilisation via pipeline\n\"jdupont\", \"mmartin\", \"adurand\" | Get-UserStatus -Verbose\n\n# Ou avec des objets AD\nGet-ADGroupMember -Identity \"IT-Team\" | Get-UserStatus\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#4-supportsshouldprocess-whatif-et-confirm","title":"4. SupportsShouldProcess : WhatIf et Confirm","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#41-activation","title":"4.1 Activation","text":"<p>Pour les fonctions qui modifient des donn\u00e9es, activez <code>SupportsShouldProcess</code> :</p> <pre><code>function Remove-OldUsers {\n    [CmdletBinding(SupportsShouldProcess = $true, ConfirmImpact = 'High')]\n    param(\n        [Parameter(Mandatory = $true)]\n        [int]$InactiveDays = 90\n    )\n\n    $oldUsers = Get-ADUser -Filter * -Properties LastLogonDate |\n        Where-Object { $_.LastLogonDate -lt (Get-Date).AddDays(-$InactiveDays) }\n\n    foreach ($user in $oldUsers) {\n        # $PSCmdlet.ShouldProcess v\u00e9rifie -WhatIf et -Confirm\n        if ($PSCmdlet.ShouldProcess($user.SamAccountName, \"D\u00e9sactiver le compte\")) {\n            Disable-ADAccount -Identity $user.SamAccountName\n            Write-Verbose \"Compte d\u00e9sactiv\u00e9 : $($user.SamAccountName)\"\n        }\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#42-utilisation","title":"4.2 Utilisation","text":"<pre><code># Mode simulation : montre ce qui SERAIT fait\nRemove-OldUsers -InactiveDays 90 -WhatIf\n\n# Mode confirmation : demande pour chaque action\nRemove-OldUsers -InactiveDays 90 -Confirm\n\n# Mode automatique (attention en production !)\nRemove-OldUsers -InactiveDays 90 -Confirm:$false\n</code></pre> <p>Sortie WhatIf :</p> <pre><code>What if: Performing the operation \"D\u00e9sactiver le compte\" on target \"jdupont\".\nWhat if: Performing the operation \"D\u00e9sactiver le compte\" on target \"ancien_user\".\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#5-template-production-ready","title":"5. Template Production-Ready","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#51-fonction-complete-new-worldlineuser","title":"5.1 Fonction Compl\u00e8te : <code>New-WorldlineUser</code>","text":"<pre><code>function New-WorldlineUser {\n    &lt;#\n    .SYNOPSIS\n        Cr\u00e9e un nouvel utilisateur dans Active Directory selon les standards Worldline.\n\n    .DESCRIPTION\n        Cette fonction cr\u00e9e un utilisateur AD avec les attributs standards Worldline :\n        - G\u00e9n\u00e9ration automatique du SamAccountName\n        - Placement dans l'OU appropri\u00e9e selon le d\u00e9partement\n        - Application des groupes par d\u00e9faut\n        - Envoi d'un email de bienvenue (optionnel)\n\n    .PARAMETER FirstName\n        Pr\u00e9nom de l'utilisateur. Obligatoire.\n\n    .PARAMETER LastName\n        Nom de famille de l'utilisateur. Obligatoire.\n\n    .PARAMETER Department\n        D\u00e9partement de l'utilisateur. Doit \u00eatre une valeur valide.\n\n    .PARAMETER Manager\n        SamAccountName du manager. Optionnel.\n\n    .PARAMETER SendWelcomeEmail\n        Si sp\u00e9cifi\u00e9, envoie un email de bienvenue \u00e0 l'utilisateur.\n\n    .EXAMPLE\n        New-WorldlineUser -FirstName \"Jean\" -LastName \"Dupont\" -Department \"IT\"\n\n        Cr\u00e9e l'utilisateur Jean Dupont dans le d\u00e9partement IT.\n\n    .EXAMPLE\n        Import-Csv users.csv | New-WorldlineUser -Verbose\n\n        Cr\u00e9e tous les utilisateurs depuis un fichier CSV via le pipeline.\n\n    .NOTES\n        Auteur  : ShellBook Automation Team\n        Version : 1.0\n        Date    : 2025-01-28\n    #&gt;\n\n    [CmdletBinding(SupportsShouldProcess = $true, ConfirmImpact = 'Medium')]\n    [OutputType([Microsoft.ActiveDirectory.Management.ADUser])]\n    param(\n        [Parameter(\n            Mandatory = $true,\n            Position = 0,\n            ValueFromPipelineByPropertyName = $true,\n            HelpMessage = \"Pr\u00e9nom de l'utilisateur\"\n        )]\n        [ValidateNotNullOrEmpty()]\n        [ValidatePattern(\"^[a-zA-Z\u00c0-\u00ff\\s\\-']+$\")]\n        [Alias(\"Prenom\", \"GivenName\")]\n        [string]$FirstName,\n\n        [Parameter(\n            Mandatory = $true,\n            Position = 1,\n            ValueFromPipelineByPropertyName = $true,\n            HelpMessage = \"Nom de famille de l'utilisateur\"\n        )]\n        [ValidateNotNullOrEmpty()]\n        [ValidatePattern(\"^[a-zA-Z\u00c0-\u00ff\\s\\-']+$\")]\n        [Alias(\"Nom\", \"Surname\")]\n        [string]$LastName,\n\n        [Parameter(\n            Mandatory = $true,\n            ValueFromPipelineByPropertyName = $true\n        )]\n        [ValidateSet(\"IT\", \"HR\", \"Finance\", \"Sales\", \"Operations\", \"Legal\")]\n        [string]$Department,\n\n        [Parameter(ValueFromPipelineByPropertyName = $true)]\n        [ValidateScript({\n            if ([string]::IsNullOrEmpty($_)) { return $true }\n            try {\n                Get-ADUser -Identity $_ -ErrorAction Stop | Out-Null\n                return $true\n            }\n            catch {\n                throw \"Le manager '$_' n'existe pas dans Active Directory.\"\n            }\n        })]\n        [string]$Manager,\n\n        [Parameter()]\n        [switch]$SendWelcomeEmail\n    )\n\n    begin {\n        Write-Verbose \"=== D\u00e9but de New-WorldlineUser ===\"\n        Write-Verbose \"V\u00e9rification des pr\u00e9requis...\"\n\n        # V\u00e9rifier le module AD\n        if (-not (Get-Module -Name ActiveDirectory -ErrorAction SilentlyContinue)) {\n            try {\n                Import-Module ActiveDirectory -ErrorAction Stop\n                Write-Verbose \"Module ActiveDirectory charg\u00e9.\"\n            }\n            catch {\n                throw \"Impossible de charger le module ActiveDirectory. Erreur : $_\"\n            }\n        }\n\n        # Configuration\n        $domainDN = (Get-ADDomain).DistinguishedName\n        $basePath = \"OU=Users,OU=Worldline,$domainDN\"\n        $defaultPassword = ConvertTo-SecureString \"Welcome2024!\" -AsPlainText -Force\n        $createdUsers = @()\n    }\n\n    process {\n        Write-Verbose \"Traitement : $FirstName $LastName ($Department)\"\n\n        # G\u00e9n\u00e9rer le SamAccountName (premi\u00e8re lettre pr\u00e9nom + nom, max 20 chars)\n        $samBase = ($FirstName.Substring(0, 1) + $LastName) -replace \"[^a-zA-Z]\", \"\"\n        $samAccountName = $samBase.ToLower().Substring(0, [Math]::Min(20, $samBase.Length))\n\n        # V\u00e9rifier si l'utilisateur existe d\u00e9j\u00e0\n        $existingUser = Get-ADUser -Filter \"SamAccountName -eq '$samAccountName'\" -ErrorAction SilentlyContinue\n        if ($existingUser) {\n            Write-Warning \"L'utilisateur '$samAccountName' existe d\u00e9j\u00e0. Ajout d'un suffixe...\"\n            $counter = 1\n            do {\n                $samAccountName = \"$($samBase.ToLower().Substring(0, [Math]::Min(17, $samBase.Length)))$counter\"\n                $counter++\n            } while (Get-ADUser -Filter \"SamAccountName -eq '$samAccountName'\" -ErrorAction SilentlyContinue)\n        }\n\n        # Construire l'UPN et le DisplayName\n        $upn = \"$samAccountName@worldline.com\"\n        $displayName = \"$FirstName $LastName\"\n\n        # D\u00e9finir l'OU cible selon le d\u00e9partement\n        $targetOU = \"OU=$Department,$basePath\"\n\n        # Cr\u00e9er l'utilisateur\n        if ($PSCmdlet.ShouldProcess($displayName, \"Cr\u00e9er l'utilisateur AD\")) {\n            try {\n                $userParams = @{\n                    Name              = $displayName\n                    GivenName         = $FirstName\n                    Surname           = $LastName\n                    SamAccountName    = $samAccountName\n                    UserPrincipalName = $upn\n                    DisplayName       = $displayName\n                    Department        = $Department\n                    Path              = $targetOU\n                    AccountPassword   = $defaultPassword\n                    Enabled           = $true\n                    ChangePasswordAtLogon = $true\n                }\n\n                if (-not [string]::IsNullOrEmpty($Manager)) {\n                    $userParams.Manager = $Manager\n                }\n\n                $newUser = New-ADUser @userParams -PassThru -ErrorAction Stop\n                Write-Verbose \"Utilisateur cr\u00e9\u00e9 : $samAccountName\"\n\n                # Ajouter aux groupes par d\u00e9faut\n                $defaultGroups = @(\"Domain Users\", \"Worldline-AllUsers\")\n                foreach ($group in $defaultGroups) {\n                    try {\n                        Add-ADGroupMember -Identity $group -Members $samAccountName -ErrorAction Stop\n                        Write-Verbose \"  Ajout\u00e9 au groupe : $group\"\n                    }\n                    catch {\n                        Write-Warning \"  Impossible d'ajouter au groupe '$group' : $_\"\n                    }\n                }\n\n                # Envoyer l'email de bienvenue si demand\u00e9\n                if ($SendWelcomeEmail) {\n                    Write-Verbose \"  Envoi de l'email de bienvenue...\"\n                    # Ici, impl\u00e9menter l'envoi d'email\n                    # Send-MailMessage -To $upn -Subject \"Bienvenue chez Worldline\" -Body \"...\"\n                }\n\n                $createdUsers += $newUser\n                Write-Output $newUser\n            }\n            catch {\n                Write-Error \"\u00c9chec de cr\u00e9ation de '$displayName' : $_\"\n            }\n        }\n    }\n\n    end {\n        Write-Verbose \"=== Fin de New-WorldlineUser ===\"\n        Write-Verbose \"Utilisateurs cr\u00e9\u00e9s : $($createdUsers.Count)\"\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#52-utilisation-du-template","title":"5.2 Utilisation du Template","text":"<pre><code># Import du module (si dans un module)\nImport-Module WorldlineTools\n\n# Cr\u00e9ation simple\nNew-WorldlineUser -FirstName \"Jean\" -LastName \"Dupont\" -Department \"IT\" -Verbose\n\n# Cr\u00e9ation avec manager\nNew-WorldlineUser -FirstName \"Marie\" -LastName \"Martin\" -Department \"HR\" -Manager \"pdurand\"\n\n# Mode simulation\nNew-WorldlineUser -FirstName \"Test\" -LastName \"User\" -Department \"IT\" -WhatIf\n\n# Cr\u00e9ation en masse via CSV\nImport-Csv \"C:\\Data\\new_users.csv\" | New-WorldlineUser -SendWelcomeEmail -Verbose\n\n# Aide int\u00e9gr\u00e9e\nGet-Help New-WorldlineUser -Full\nGet-Help New-WorldlineUser -Examples\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#6-bonnes-pratiques","title":"6. Bonnes Pratiques","text":""},{"location":"formations/powershell-advanced/01-advanced-functions/#61-checklist-advanced-function","title":"6.1 Checklist Advanced Function","text":"<ul> <li>[ ] <code>[CmdletBinding()]</code> en premi\u00e8re ligne du bloc <code>param</code></li> <li>[ ] Param\u00e8tres typ\u00e9s (<code>[string]</code>, <code>[int]</code>, <code>[switch]</code>)</li> <li>[ ] Validateurs appropri\u00e9s (<code>ValidateNotNullOrEmpty</code>, <code>ValidateSet</code>, etc.)</li> <li>[ ] Blocs <code>Begin</code>/<code>Process</code>/<code>End</code> si support pipeline</li> <li>[ ] <code>SupportsShouldProcess</code> pour les actions destructives</li> <li>[ ] Documentation Comment-Based Help (<code>.SYNOPSIS</code>, <code>.EXAMPLE</code>)</li> <li>[ ] <code>Write-Verbose</code> pour le debugging (pas <code>Write-Host</code>)</li> <li>[ ] <code>Write-Warning</code> pour les alertes non bloquantes</li> <li>[ ] <code>Write-Error</code> ou <code>throw</code> pour les erreurs</li> </ul>"},{"location":"formations/powershell-advanced/01-advanced-functions/#62-anti-patterns-a-eviter","title":"6.2 Anti-Patterns \u00e0 \u00c9viter","text":"<pre><code># \u274c MAUVAIS : Write-Host pour les informations\nWrite-Host \"Traitement en cours...\"\n\n# \u2705 BON : Write-Verbose (contr\u00f4lable par l'appelant)\nWrite-Verbose \"Traitement en cours...\"\n\n# \u274c MAUVAIS : Param\u00e8tre sans validation\nparam($Username)\n\n# \u2705 BON : Param\u00e8tre valid\u00e9\nparam(\n    [ValidateNotNullOrEmpty()]\n    [string]$Username\n)\n\n# \u274c MAUVAIS : Modifier des donn\u00e9es sans ShouldProcess\nRemove-Item $Path\n\n# \u2705 BON : V\u00e9rifier avec ShouldProcess\nif ($PSCmdlet.ShouldProcess($Path, \"Supprimer\")) {\n    Remove-Item $Path\n}\n</code></pre>"},{"location":"formations/powershell-advanced/01-advanced-functions/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence entre <code>ValueFromPipeline</code> et <code>ValueFromPipelineByPropertyName</code> ? <p>R\u00e9ponse :</p> <ul> <li> <p><code>ValueFromPipeline = $true</code> : Le param\u00e8tre accepte l'objet entier du pipeline. Utile quand vous attendez un type d'objet sp\u00e9cifique.</p> </li> <li> <p><code>ValueFromPipelineByPropertyName = $true</code> : Le param\u00e8tre accepte une propri\u00e9t\u00e9 sp\u00e9cifique de l'objet, dont le nom correspond au nom du param\u00e8tre (ou \u00e0 un alias).</p> </li> </ul> <p>Exemple : Si votre param\u00e8tre s'appelle <code>SamAccountName</code>, PowerShell mappera automatiquement la propri\u00e9t\u00e9 <code>SamAccountName</code> des objets pass\u00e9s via le pipeline.</p> Question 2 : Pourquoi utiliser <code>Write-Verbose</code> plut\u00f4t que <code>Write-Host</code> ? <p>R\u00e9ponse :</p> <ul> <li> <p><code>Write-Host</code> : Affiche toujours du texte, impossible \u00e0 d\u00e9sactiver, ne peut pas \u00eatre redirig\u00e9, pollue la sortie.</p> </li> <li> <p><code>Write-Verbose</code> : Affich\u00e9 uniquement si l'appelant utilise <code>-Verbose</code>. Permet un debugging conditionnel et respecte les pratiques de scripting propre.</p> </li> </ul> <p>En production, les scripts doivent \u00eatre silencieux par d\u00e9faut. Le verbose est une option pour le debugging.</p> Question 3 : Quand utiliser <code>ConfirmImpact = 'High'</code> ? <p>R\u00e9ponse : Quand votre fonction effectue des op\u00e9rations dangereuses ou irr\u00e9versibles :</p> <ul> <li>Suppression de donn\u00e9es</li> <li>Modification de configuration critique</li> <li>Actions affectant de nombreux objets</li> </ul> <p>Avec <code>ConfirmImpact = 'High'</code>, PowerShell demandera automatiquement confirmation m\u00eame si l'utilisateur n'a pas sp\u00e9cifi\u00e9 <code>-Confirm</code>.</p>"},{"location":"formations/powershell-advanced/01-advanced-functions/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Vous savez construire des fonctions avanc\u00e9es. Apprenez maintenant \u00e0 les rendre robustes face aux erreurs.</p> <p>:octicons-arrow-right-24: Module 2 : Gestion des Erreurs</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/powershell-advanced/02-error-handling/","title":"Module 2 : Gestion des Erreurs","text":""},{"location":"formations/powershell-advanced/02-error-handling/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Distinguer les erreurs terminantes des erreurs non-terminantes</li> <li>:material-check: Impl\u00e9menter le pattern <code>Try / Catch / Finally</code></li> <li>:material-check: Appliquer la strat\u00e9gie \"Fail Fast\"</li> <li>:material-check: Logger les erreurs proprement sans interrompre l'ex\u00e9cution</li> </ul>"},{"location":"formations/powershell-advanced/02-error-handling/#1-types-derreurs-en-powershell","title":"1. Types d'Erreurs en PowerShell","text":""},{"location":"formations/powershell-advanced/02-error-handling/#11-le-probleme","title":"1.1 Le Probl\u00e8me","text":"<p>PowerShell a un comportement par d\u00e9faut permissif : quand une erreur survient, le script continue souvent son ex\u00e9cution. C'est dangereux en production.</p> <pre><code># Ce script continue m\u00eame si le fichier n'existe pas !\nGet-Content \"fichier_inexistant.txt\"\nWrite-Host \"Cette ligne s'ex\u00e9cute quand m\u00eame...\"\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#12-erreurs-terminantes-vs-non-terminantes","title":"1.2 Erreurs Terminantes vs Non-Terminantes","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    TYPES D'ERREURS POWERSHELL                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ERREUR NON-TERMINANTE (Non-Terminating)                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                      \u2502\n\u2502   \u2022 Comportement par D\u00c9FAUT de la plupart des cmdlets           \u2502\n\u2502   \u2022 Le script CONTINUE apr\u00e8s l'erreur                           \u2502\n\u2502   \u2022 Erreur \u00e9crite dans $Error, affich\u00e9e en rouge                \u2502\n\u2502   \u2022 Exemples : fichier non trouv\u00e9, permission refus\u00e9e           \u2502\n\u2502                                                                 \u2502\n\u2502   Comportement :                                                \u2502\n\u2502   Get-Item \"inexistant.txt\"  # Erreur affich\u00e9e                  \u2502\n\u2502   Write-Host \"Continue...\"    # \u2190 S'ex\u00e9cute quand m\u00eame !        \u2502\n\u2502                                                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ERREUR TERMINANTE (Terminating)                               \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                               \u2502\n\u2502   \u2022 ARR\u00caTE l'ex\u00e9cution imm\u00e9diatement                            \u2502\n\u2502   \u2022 Peut \u00eatre intercept\u00e9e par Try/Catch                         \u2502\n\u2502   \u2022 G\u00e9n\u00e9r\u00e9e par : throw, erreurs de syntaxe, -ErrorAction Stop  \u2502\n\u2502   \u2022 Exemples : division par z\u00e9ro, cmdlet avec -ErrorAction Stop \u2502\n\u2502                                                                 \u2502\n\u2502   Comportement :                                                \u2502\n\u2502   throw \"Erreur critique\"     # Arr\u00eat imm\u00e9diat                  \u2502\n\u2502   Write-Host \"Jamais atteint\" # \u2190 Ne s'ex\u00e9cute PAS              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#13-demonstration","title":"1.3 D\u00e9monstration","text":"<pre><code># Erreur NON-terminante (continue)\nWrite-Host \"=== Test 1 : Non-Terminating ===\" -ForegroundColor Cyan\nGet-Item \"C:\\fichier_qui_nexiste_pas.txt\"\nWrite-Host \"Cette ligne s'affiche malgr\u00e9 l'erreur`n\"\n\n# Erreur TERMINANTE (arr\u00eate)\nWrite-Host \"=== Test 2 : Terminating ===\" -ForegroundColor Cyan\nthrow \"Ceci est une erreur terminante\"\nWrite-Host \"Cette ligne ne s'affiche JAMAIS\"\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#2-le-pattern-try-catch-finally","title":"2. Le Pattern Try / Catch / Finally","text":""},{"location":"formations/powershell-advanced/02-error-handling/#21-syntaxe-de-base","title":"2.1 Syntaxe de Base","text":"<pre><code>try {\n    # Code susceptible de g\u00e9n\u00e9rer une erreur\n    # Les erreurs TERMINANTES sont intercept\u00e9es\n}\ncatch {\n    # Code ex\u00e9cut\u00e9 SI une erreur survient\n    # $_ contient l'objet erreur\n}\nfinally {\n    # Code TOUJOURS ex\u00e9cut\u00e9 (erreur ou pas)\n    # Id\u00e9al pour le nettoyage (fermer connexions, etc.)\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#22-convertir-les-erreurs-en-terminantes","title":"2.2 Convertir les Erreurs en Terminantes","text":"<p>Point Crucial</p> <p>Par d\u00e9faut, <code>Try/Catch</code> n'intercepte pas les erreurs non-terminantes ! Il faut forcer la conversion avec <code>-ErrorAction Stop</code>.</p> <pre><code># \u274c MAUVAIS : L'erreur n'est PAS intercept\u00e9e\ntry {\n    Get-Item \"inexistant.txt\"  # Erreur non-terminante\n}\ncatch {\n    Write-Host \"Catch jamais atteint !\"\n}\n\n# \u2705 BON : L'erreur EST intercept\u00e9e\ntry {\n    Get-Item \"inexistant.txt\" -ErrorAction Stop  # Converti en terminante\n}\ncatch {\n    Write-Host \"Erreur intercept\u00e9e : $($_.Exception.Message)\"\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#23-acceder-aux-informations-derreur","title":"2.3 Acc\u00e9der aux Informations d'Erreur","text":"<p>Dans le bloc <code>catch</code>, l'objet <code>$_</code> (ou <code>$PSItem</code>) contient l'erreur :</p> <pre><code>try {\n    Get-ADUser -Identity \"utilisateur_inexistant\" -ErrorAction Stop\n}\ncatch {\n    # Informations disponibles\n    Write-Host \"Message         : $($_.Exception.Message)\"\n    Write-Host \"Type d'erreur   : $($_.Exception.GetType().FullName)\"\n    Write-Host \"Cat\u00e9gorie       : $($_.CategoryInfo.Category)\"\n    Write-Host \"Cmdlet fautive  : $($_.InvocationInfo.MyCommand)\"\n    Write-Host \"Ligne           : $($_.InvocationInfo.ScriptLineNumber)\"\n    Write-Host \"Stack Trace     : $($_.ScriptStackTrace)\"\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#24-catch-par-type-dexception","title":"2.4 Catch par Type d'Exception","text":"<p>Vous pouvez intercepter des types d'erreurs sp\u00e9cifiques :</p> <pre><code>try {\n    $connection = Connect-Database -Server \"sql01\" -ErrorAction Stop\n    $data = Invoke-SqlQuery -Query \"SELECT * FROM Users\" -ErrorAction Stop\n}\ncatch [System.Net.Sockets.SocketException] {\n    # Erreur r\u00e9seau sp\u00e9cifique\n    Write-Error \"Impossible de se connecter au serveur : $($_.Exception.Message)\"\n    Send-Alert -Message \"Serveur SQL inaccessible\"\n}\ncatch [System.Data.SqlClient.SqlException] {\n    # Erreur SQL sp\u00e9cifique\n    Write-Error \"Erreur SQL : $($_.Exception.Message)\"\n    Write-Log -Level Error -Message \"Query failed: $($_.Exception.Number)\"\n}\ncatch [Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException] {\n    # Utilisateur AD non trouv\u00e9\n    Write-Warning \"Utilisateur non trouv\u00e9 dans Active Directory\"\n}\ncatch {\n    # Catch-all pour toutes les autres erreurs\n    Write-Error \"Erreur inattendue : $($_.Exception.Message)\"\n    throw  # Relancer l'erreur pour le niveau sup\u00e9rieur\n}\nfinally {\n    # Nettoyage garanti\n    if ($connection) {\n        $connection.Close()\n        Write-Verbose \"Connexion ferm\u00e9e.\"\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#3-strategie-fail-fast","title":"3. Strat\u00e9gie \"Fail Fast\"","text":""},{"location":"formations/powershell-advanced/02-error-handling/#31-le-principe","title":"3.1 Le Principe","text":"<p>Fail Fast = \u00c9chouer Rapidement</p> <p>Plut\u00f4t que de laisser un script continuer avec des donn\u00e9es corrompues ou un \u00e9tat incoh\u00e9rent, il vaut mieux arr\u00eater imm\u00e9diatement d\u00e8s qu'une erreur survient.</p> <p>Avantages : - \u00c9vite les corruptions de donn\u00e9es - Facilite le debugging (l'erreur est proche de la cause) - Comportement pr\u00e9visible et d\u00e9terministe</p>"},{"location":"formations/powershell-advanced/02-error-handling/#32-implementation-avec-erroractionpreference","title":"3.2 Impl\u00e9mentation avec <code>$ErrorActionPreference</code>","text":"<pre><code>function Invoke-CriticalOperation {\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory)]\n        [string]$ServerName\n    )\n\n    # Activer le mode \"Fail Fast\" pour TOUTE la fonction\n    $ErrorActionPreference = 'Stop'\n\n    try {\n        Write-Verbose \"Connexion \u00e0 $ServerName...\"\n        $session = New-PSSession -ComputerName $ServerName\n\n        Write-Verbose \"Ex\u00e9cution de la maintenance...\"\n        Invoke-Command -Session $session -ScriptBlock {\n            Stop-Service -Name \"MonService\"\n            # Si cette ligne \u00e9choue, tout s'arr\u00eate imm\u00e9diatement\n            Copy-Item \"C:\\Source\\*\" -Destination \"C:\\Backup\\\" -Recurse\n            Start-Service -Name \"MonService\"\n        }\n\n        Write-Verbose \"Op\u00e9ration termin\u00e9e avec succ\u00e8s.\"\n    }\n    catch {\n        Write-Error \"\u00c9chec de l'op\u00e9ration sur $ServerName : $($_.Exception.Message)\"\n        throw  # Propager l'erreur\n    }\n    finally {\n        if ($session) {\n            Remove-PSSession -Session $session\n            Write-Verbose \"Session ferm\u00e9e.\"\n        }\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#33-valeurs-de-erroractionpreference","title":"3.3 Valeurs de <code>$ErrorActionPreference</code>","text":"Valeur Comportement Usage <code>Continue</code> Affiche l'erreur, continue (d\u00e9faut) Scripts interactifs <code>Stop</code> Convertit TOUTES les erreurs en terminantes Production recommand\u00e9 <code>SilentlyContinue</code> Ignore les erreurs, continue Cas tr\u00e8s sp\u00e9cifiques <code>Inquire</code> Demande \u00e0 l'utilisateur Debugging interactif <code>Ignore</code> Ignore compl\u00e8tement (m\u00eame pas dans $Error) Rarement utile"},{"location":"formations/powershell-advanced/02-error-handling/#4-logging-propre-des-erreurs","title":"4. Logging Propre des Erreurs","text":""},{"location":"formations/powershell-advanced/02-error-handling/#41-fonction-de-logging-reutilisable","title":"4.1 Fonction de Logging R\u00e9utilisable","text":"<pre><code>function Write-Log {\n    &lt;#\n    .SYNOPSIS\n        \u00c9crit un message format\u00e9 dans un fichier de log et optionnellement dans la console.\n    #&gt;\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory, Position = 0)]\n        [string]$Message,\n\n        [Parameter()]\n        [ValidateSet(\"INFO\", \"WARNING\", \"ERROR\", \"DEBUG\")]\n        [string]$Level = \"INFO\",\n\n        [Parameter()]\n        [string]$LogPath = \"$env:TEMP\\script_$(Get-Date -Format 'yyyyMMdd').log\",\n\n        [Parameter()]\n        [switch]$NoConsole\n    )\n\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logEntry = \"[$timestamp] [$Level] $Message\"\n\n    # \u00c9crire dans le fichier\n    Add-Content -Path $LogPath -Value $logEntry -Encoding UTF8\n\n    # \u00c9crire dans la console selon le niveau\n    if (-not $NoConsole) {\n        switch ($Level) {\n            \"ERROR\"   { Write-Host $logEntry -ForegroundColor Red }\n            \"WARNING\" { Write-Host $logEntry -ForegroundColor Yellow }\n            \"DEBUG\"   { Write-Host $logEntry -ForegroundColor Gray }\n            default   { Write-Host $logEntry -ForegroundColor White }\n        }\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#42-pattern-complet-avec-logging","title":"4.2 Pattern Complet avec Logging","text":"<pre><code>function Sync-ADUsersFromHR {\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory)]\n        [string]$CsvPath,\n\n        [Parameter()]\n        [string]$LogPath = \"C:\\Logs\\HR_Sync_$(Get-Date -Format 'yyyyMMdd_HHmmss').log\"\n    )\n\n    # Configuration Fail Fast\n    $ErrorActionPreference = 'Stop'\n\n    # Compteurs\n    $stats = @{\n        Total     = 0\n        Created   = 0\n        Updated   = 0\n        Errors    = 0\n    }\n\n    Write-Log \"=== D\u00e9but de la synchronisation HR ===\" -Level INFO -LogPath $LogPath\n    Write-Log \"Fichier source : $CsvPath\" -Level INFO -LogPath $LogPath\n\n    try {\n        # V\u00e9rifier le fichier\n        if (-not (Test-Path $CsvPath)) {\n            throw \"Le fichier CSV n'existe pas : $CsvPath\"\n        }\n\n        # Charger les donn\u00e9es\n        $users = Import-Csv -Path $CsvPath -Delimiter \";\" -Encoding UTF8\n        $stats.Total = $users.Count\n        Write-Log \"Utilisateurs \u00e0 traiter : $($stats.Total)\" -Level INFO -LogPath $LogPath\n\n        foreach ($user in $users) {\n            try {\n                $samAccountName = ($user.Prenom.Substring(0,1) + $user.Nom).ToLower()\n\n                # V\u00e9rifier si l'utilisateur existe\n                $adUser = Get-ADUser -Filter \"SamAccountName -eq '$samAccountName'\" -ErrorAction SilentlyContinue\n\n                if ($adUser) {\n                    # Mise \u00e0 jour\n                    Set-ADUser -Identity $samAccountName `\n                        -Department $user.Departement `\n                        -Title $user.Poste `\n                        -ErrorAction Stop\n\n                    $stats.Updated++\n                    Write-Log \"Mis \u00e0 jour : $samAccountName\" -Level INFO -LogPath $LogPath\n                }\n                else {\n                    # Cr\u00e9ation\n                    New-ADUser -Name \"$($user.Prenom) $($user.Nom)\" `\n                        -GivenName $user.Prenom `\n                        -Surname $user.Nom `\n                        -SamAccountName $samAccountName `\n                        -Department $user.Departement `\n                        -Enabled $true `\n                        -ErrorAction Stop\n\n                    $stats.Created++\n                    Write-Log \"Cr\u00e9\u00e9 : $samAccountName\" -Level INFO -LogPath $LogPath\n                }\n            }\n            catch [Microsoft.ActiveDirectory.Management.ADException] {\n                # Erreur AD sp\u00e9cifique - on log mais on continue\n                $stats.Errors++\n                Write-Log \"Erreur AD pour $($user.Nom) : $($_.Exception.Message)\" -Level ERROR -LogPath $LogPath\n                # Ne pas throw - continuer avec l'utilisateur suivant\n            }\n            catch {\n                # Autre erreur - on log et continue\n                $stats.Errors++\n                Write-Log \"Erreur pour $($user.Nom) : $($_.Exception.Message)\" -Level ERROR -LogPath $LogPath\n            }\n        }\n    }\n    catch {\n        # Erreur fatale (fichier inexistant, probl\u00e8me de connexion AD global...)\n        Write-Log \"ERREUR FATALE : $($_.Exception.Message)\" -Level ERROR -LogPath $LogPath\n        Write-Log \"Stack Trace : $($_.ScriptStackTrace)\" -Level DEBUG -LogPath $LogPath\n        throw  # Relancer pour l'appelant\n    }\n    finally {\n        # Rapport final\n        Write-Log \"=== Fin de la synchronisation ===\" -Level INFO -LogPath $LogPath\n        Write-Log \"Total trait\u00e9 : $($stats.Total)\" -Level INFO -LogPath $LogPath\n        Write-Log \"Cr\u00e9\u00e9s        : $($stats.Created)\" -Level INFO -LogPath $LogPath\n        Write-Log \"Mis \u00e0 jour   : $($stats.Updated)\" -Level INFO -LogPath $LogPath\n        Write-Log \"Erreurs      : $($stats.Errors)\" -Level INFO -LogPath $LogPath\n\n        # Retourner les statistiques\n        [PSCustomObject]$stats\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#5-relancer-ou-encapsuler-les-erreurs","title":"5. Relancer ou Encapsuler les Erreurs","text":""},{"location":"formations/powershell-advanced/02-error-handling/#51-relancer-une-erreur","title":"5.1 Relancer une Erreur","text":"<pre><code>try {\n    Do-Something -ErrorAction Stop\n}\ncatch {\n    # Logger l'erreur\n    Write-Log \"Erreur dans Do-Something : $($_.Exception.Message)\" -Level ERROR\n\n    # Relancer l'erreur originale (conserve le stack trace)\n    throw\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#52-encapsuler-avec-un-message-personnalise","title":"5.2 Encapsuler avec un Message Personnalis\u00e9","text":"<pre><code>try {\n    Do-Something -ErrorAction Stop\n}\ncatch {\n    # Cr\u00e9er une nouvelle erreur avec contexte\n    $errorMessage = \"\u00c9chec de l'op\u00e9ration X sur le serveur Y. Erreur originale : $($_.Exception.Message)\"\n    throw [System.Exception]::new($errorMessage, $_.Exception)\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#53-erreurs-personnalisees","title":"5.3 Erreurs Personnalis\u00e9es","text":"<pre><code># D\u00e9finir une classe d'exception personnalis\u00e9e\nclass WorldlineConfigException : System.Exception {\n    [string]$ConfigFile\n\n    WorldlineConfigException([string]$message, [string]$configFile) : base($message) {\n        $this.ConfigFile = $configFile\n    }\n}\n\n# Utilisation\nfunction Get-WorldlineConfig {\n    param([string]$Path)\n\n    if (-not (Test-Path $Path)) {\n        throw [WorldlineConfigException]::new(\n            \"Fichier de configuration introuvable\",\n            $Path\n        )\n    }\n\n    Get-Content $Path | ConvertFrom-Json\n}\n\n# Catch sp\u00e9cifique\ntry {\n    $config = Get-WorldlineConfig -Path \"C:\\Config\\app.json\"\n}\ncatch [WorldlineConfigException] {\n    Write-Error \"Configuration manquante : $($_.Exception.ConfigFile)\"\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#6-lab-gestion-derreur-ad-complete","title":"6. Lab : Gestion d'Erreur AD Compl\u00e8te","text":""},{"location":"formations/powershell-advanced/02-error-handling/#61-scenario","title":"6.1 Sc\u00e9nario","text":"<p>Cr\u00e9er une fonction qui v\u00e9rifie la connectivit\u00e9 AD et retourne un status propre sans crasher la console.</p> <pre><code>function Test-ADConnectivity {\n    &lt;#\n    .SYNOPSIS\n        Teste la connectivit\u00e9 \u00e0 Active Directory et retourne un rapport de status.\n\n    .EXAMPLE\n        Test-ADConnectivity -DomainController \"DC01\"\n    #&gt;\n    [CmdletBinding()]\n    [OutputType([PSCustomObject])]\n    param(\n        [Parameter()]\n        [string]$DomainController = $env:LOGONSERVER -replace '\\\\\\\\',''\n    )\n\n    $result = [PSCustomObject]@{\n        DomainController = $DomainController\n        Timestamp        = Get-Date\n        DNSResolution    = $false\n        PortLDAP         = $false\n        PortLDAPS        = $false\n        Authentication   = $false\n        ErrorMessage     = $null\n        Status           = \"Unknown\"\n    }\n\n    Write-Verbose \"Test de connectivit\u00e9 AD vers $DomainController\"\n\n    try {\n        # Test 1 : R\u00e9solution DNS\n        Write-Verbose \"  [1/4] Test DNS...\"\n        try {\n            $dns = Resolve-DnsName -Name $DomainController -ErrorAction Stop\n            $result.DNSResolution = $true\n            Write-Verbose \"    \u2713 DNS OK : $($dns.IPAddress)\"\n        }\n        catch {\n            throw \"\u00c9chec DNS : $($_.Exception.Message)\"\n        }\n\n        # Test 2 : Port LDAP (389)\n        Write-Verbose \"  [2/4] Test port LDAP (389)...\"\n        try {\n            $tcpLDAP = Test-NetConnection -ComputerName $DomainController -Port 389 -WarningAction SilentlyContinue\n            if ($tcpLDAP.TcpTestSucceeded) {\n                $result.PortLDAP = $true\n                Write-Verbose \"    \u2713 LDAP OK\"\n            }\n            else {\n                throw \"Port LDAP 389 ferm\u00e9\"\n            }\n        }\n        catch {\n            Write-Warning \"    \u2717 LDAP : $($_.Exception.Message)\"\n            # Continuer les tests\n        }\n\n        # Test 3 : Port LDAPS (636)\n        Write-Verbose \"  [3/4] Test port LDAPS (636)...\"\n        try {\n            $tcpLDAPS = Test-NetConnection -ComputerName $DomainController -Port 636 -WarningAction SilentlyContinue\n            if ($tcpLDAPS.TcpTestSucceeded) {\n                $result.PortLDAPS = $true\n                Write-Verbose \"    \u2713 LDAPS OK\"\n            }\n            else {\n                Write-Verbose \"    \u2717 LDAPS non disponible (optionnel)\"\n            }\n        }\n        catch {\n            Write-Verbose \"    \u2717 LDAPS : $($_.Exception.Message)\"\n        }\n\n        # Test 4 : Authentification AD\n        Write-Verbose \"  [4/4] Test authentification AD...\"\n        try {\n            $domain = Get-ADDomain -Server $DomainController -ErrorAction Stop\n            $result.Authentication = $true\n            Write-Verbose \"    \u2713 Auth OK - Domaine : $($domain.DNSRoot)\"\n        }\n        catch [Microsoft.ActiveDirectory.Management.ADServerDownException] {\n            throw \"Serveur AD inaccessible : $($_.Exception.Message)\"\n        }\n        catch [System.Security.Authentication.AuthenticationException] {\n            throw \"\u00c9chec d'authentification : v\u00e9rifiez vos credentials\"\n        }\n        catch {\n            throw \"Erreur AD : $($_.Exception.Message)\"\n        }\n\n        # Si on arrive ici, tout est OK\n        $result.Status = \"Healthy\"\n        Write-Verbose \"R\u00e9sultat : HEALTHY\"\n    }\n    catch {\n        $result.ErrorMessage = $_.Exception.Message\n        $result.Status = \"Unhealthy\"\n        Write-Verbose \"R\u00e9sultat : UNHEALTHY - $($_.Exception.Message)\"\n    }\n\n    return $result\n}\n\n# Utilisation\n$status = Test-ADConnectivity -Verbose\n\n# Affichage format\u00e9\n$status | Format-List\n\n# V\u00e9rification programmatique\nif ($status.Status -eq \"Healthy\") {\n    Write-Host \"AD est accessible\" -ForegroundColor Green\n}\nelse {\n    Write-Host \"Probl\u00e8me AD : $($status.ErrorMessage)\" -ForegroundColor Red\n}\n</code></pre>"},{"location":"formations/powershell-advanced/02-error-handling/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi <code>Try/Catch</code> n'intercepte pas une erreur <code>Get-Item</code> par d\u00e9faut ? <p>R\u00e9ponse : Par d\u00e9faut, <code>Get-Item</code> g\u00e9n\u00e8re une erreur non-terminante. <code>Try/Catch</code> ne capture que les erreurs terminantes.</p> <p>Solution : Ajouter <code>-ErrorAction Stop</code> pour convertir l'erreur en terminante.</p> Question 2 : Quelle est la diff\u00e9rence entre <code>throw</code> et <code>Write-Error</code> ? <p>R\u00e9ponse :</p> <ul> <li> <p><code>throw</code> : G\u00e9n\u00e8re une erreur terminante. Arr\u00eate l'ex\u00e9cution (sauf si intercept\u00e9e par catch). Utilis\u00e9 pour les erreurs critiques.</p> </li> <li> <p><code>Write-Error</code> : G\u00e9n\u00e8re une erreur non-terminante par d\u00e9faut. L'ex\u00e9cution continue. Utilis\u00e9 pour signaler un probl\u00e8me sans arr\u00eater le script.</p> </li> </ul> Question 3 : Quand utiliser le bloc <code>finally</code> ? <p>R\u00e9ponse : Le bloc <code>finally</code> s'ex\u00e9cute toujours, qu'il y ait eu une erreur ou non. Il est id\u00e9al pour :</p> <ul> <li>Fermer des connexions (base de donn\u00e9es, sessions distantes)</li> <li>Lib\u00e9rer des ressources (fichiers, locks)</li> <li>\u00c9crire des logs de fin d'ex\u00e9cution</li> <li>Remettre l'\u00e9tat initial (restaurer <code>$ErrorActionPreference</code>)</li> </ul>"},{"location":"formations/powershell-advanced/02-error-handling/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Vous savez g\u00e9rer les erreurs proprement. Apprenez maintenant \u00e0 packager vos fonctions en modules r\u00e9utilisables.</p> <p>:octicons-arrow-right-24: Module 3 : Conception de Modules</p> <p>Temps estim\u00e9 : 45 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/powershell-advanced/03-module-design/","title":"Module 3 : Conception de Modules PowerShell","text":""},{"location":"formations/powershell-advanced/03-module-design/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre la structure d'un module PowerShell</li> <li>:material-check: Cr\u00e9er un fichier module (<code>.psm1</code>) et son manifeste (<code>.psd1</code>)</li> <li>:material-check: Contr\u00f4ler l'API publique avec <code>Export-ModuleMember</code></li> <li>:material-check: D\u00e9ployer et distribuer vos modules</li> </ul>"},{"location":"formations/powershell-advanced/03-module-design/#1-pourquoi-creer-des-modules","title":"1. Pourquoi Cr\u00e9er des Modules ?","text":""},{"location":"formations/powershell-advanced/03-module-design/#11-du-script-au-module","title":"1.1 Du Script au Module","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u00c9VOLUTION DE L'ORGANISATION DU CODE                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   NIVEAU 1 : Script Unique                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502   MonScript.ps1                                                 \u2502\n\u2502   \u2022 500+ lignes de code                                         \u2502\n\u2502   \u2022 Difficile \u00e0 maintenir                                       \u2502\n\u2502   \u2022 Impossible \u00e0 r\u00e9utiliser                                     \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 2 : Script avec Dot-Sourcing                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                           \u2502\n\u2502   Main.ps1                                                      \u2502\n\u2502   . .\\Functions\\Get-User.ps1                                    \u2502\n\u2502   . .\\Functions\\Set-User.ps1                                    \u2502\n\u2502   \u2022 Mieux organis\u00e9                                              \u2502\n\u2502   \u2022 D\u00e9pendances manuelles                                       \u2502\n\u2502   \u2022 Chemins fragiles                                            \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 3 : Module                                 \u25c4\u2500\u2500 CIBLE   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                           \u2502\n\u2502   WorldlineTools/                                               \u2502\n\u2502   \u251c\u2500\u2500 WorldlineTools.psd1  (Manifeste)                         \u2502\n\u2502   \u251c\u2500\u2500 WorldlineTools.psm1  (Code)                              \u2502\n\u2502   \u2514\u2500\u2500 Public/Private/      (Organisation)                       \u2502\n\u2502   \u2022 Auto-loading                                                \u2502\n\u2502   \u2022 Versionn\u00e9                                                   \u2502\n\u2502   \u2022 Distribuable via PowerShell Gallery                         \u2502\n\u2502   \u2022 Encapsulation (fonctions priv\u00e9es/publiques)                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#12-avantages-des-modules","title":"1.2 Avantages des Modules","text":"Avantage Description R\u00e9utilisabilit\u00e9 <code>Import-Module</code> et c'est pr\u00eat Encapsulation Cacher les fonctions internes (helpers) Versioning Gestion des versions via le manifeste D\u00e9pendances D\u00e9clarer les modules requis Auto-discovery PowerShell trouve les modules automatiquement Distribution Publier sur PowerShell Gallery ou NuGet"},{"location":"formations/powershell-advanced/03-module-design/#2-structure-dun-module","title":"2. Structure d'un Module","text":""},{"location":"formations/powershell-advanced/03-module-design/#21-structure-minimale","title":"2.1 Structure Minimale","text":"<pre><code>WorldlineTools/\n\u251c\u2500\u2500 WorldlineTools.psd1    # Manifeste (m\u00e9tadonn\u00e9es)\n\u2514\u2500\u2500 WorldlineTools.psm1    # Code du module\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#22-structure-professionnelle","title":"2.2 Structure Professionnelle","text":"<pre><code>WorldlineTools/\n\u251c\u2500\u2500 WorldlineTools.psd1           # Manifeste\n\u251c\u2500\u2500 WorldlineTools.psm1           # Loader principal\n\u251c\u2500\u2500 Public/                       # Fonctions EXPORT\u00c9ES\n\u2502   \u251c\u2500\u2500 New-WorldlineUser.ps1\n\u2502   \u251c\u2500\u2500 Get-WorldlineUser.ps1\n\u2502   \u251c\u2500\u2500 Set-WorldlineUser.ps1\n\u2502   \u2514\u2500\u2500 Remove-WorldlineUser.ps1\n\u251c\u2500\u2500 Private/                      # Fonctions INTERNES\n\u2502   \u251c\u2500\u2500 Write-Log.ps1\n\u2502   \u251c\u2500\u2500 Test-Prerequisites.ps1\n\u2502   \u2514\u2500\u2500 ConvertTo-NormalizedName.ps1\n\u251c\u2500\u2500 Classes/                      # Classes PowerShell\n\u2502   \u2514\u2500\u2500 WorldlineUser.ps1\n\u251c\u2500\u2500 Data/                         # Fichiers de donn\u00e9es\n\u2502   \u2514\u2500\u2500 config.json\n\u251c\u2500\u2500 Tests/                        # Tests Pester\n\u2502   \u251c\u2500\u2500 New-WorldlineUser.Tests.ps1\n\u2502   \u2514\u2500\u2500 Module.Tests.ps1\n\u251c\u2500\u2500 docs/                         # Documentation\n\u2502   \u2514\u2500\u2500 README.md\n\u2514\u2500\u2500 en-US/                        # Aide localis\u00e9e\n    \u2514\u2500\u2500 about_WorldlineTools.help.txt\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#3-le-fichier-module-psm1","title":"3. Le Fichier Module (.psm1)","text":""},{"location":"formations/powershell-advanced/03-module-design/#31-approche-simple-tout-dans-un-fichier","title":"3.1 Approche Simple (Tout dans un Fichier)","text":"<pre><code># WorldlineTools.psm1\n\n#region Private Functions\n\nfunction Write-Log {\n    # Fonction interne - ne sera PAS export\u00e9e\n    param([string]$Message, [string]$Level = \"INFO\")\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    Write-Verbose \"[$timestamp] [$Level] $Message\"\n}\n\nfunction ConvertTo-NormalizedName {\n    # Fonction interne\n    param([string]$Name)\n    $Name -replace \"[^a-zA-Z]\", \"\" | ForEach-Object { $_.ToLower() }\n}\n\n#endregion\n\n#region Public Functions\n\nfunction New-WorldlineUser {\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory)]\n        [string]$FirstName,\n\n        [Parameter(Mandatory)]\n        [string]$LastName\n    )\n\n    Write-Log \"Cr\u00e9ation de l'utilisateur $FirstName $LastName\"\n    $normalizedName = ConvertTo-NormalizedName -Name \"$FirstName$LastName\"\n    # ... reste du code\n}\n\nfunction Get-WorldlineUser {\n    [CmdletBinding()]\n    param([string]$Username)\n\n    Write-Log \"Recherche de $Username\"\n    # ... code\n}\n\n#endregion\n\n# Exporter UNIQUEMENT les fonctions publiques\nExport-ModuleMember -Function New-WorldlineUser, Get-WorldlineUser\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#32-approche-modulaire-fichiers-separes","title":"3.2 Approche Modulaire (Fichiers S\u00e9par\u00e9s)","text":"<pre><code># WorldlineTools.psm1 - Loader\n\n$ModuleRoot = $PSScriptRoot\n\n# Charger les classes en premier (si n\u00e9cessaire)\n$classFiles = Get-ChildItem -Path \"$ModuleRoot\\Classes\\*.ps1\" -ErrorAction SilentlyContinue\nforeach ($file in $classFiles) {\n    try {\n        . $file.FullName\n        Write-Verbose \"Classe charg\u00e9e : $($file.Name)\"\n    }\n    catch {\n        Write-Error \"\u00c9chec du chargement de la classe $($file.Name) : $_\"\n    }\n}\n\n# Charger les fonctions priv\u00e9es\n$privateFiles = Get-ChildItem -Path \"$ModuleRoot\\Private\\*.ps1\" -ErrorAction SilentlyContinue\nforeach ($file in $privateFiles) {\n    try {\n        . $file.FullName\n        Write-Verbose \"Fonction priv\u00e9e charg\u00e9e : $($file.Name)\"\n    }\n    catch {\n        Write-Error \"\u00c9chec du chargement de $($file.Name) : $_\"\n    }\n}\n\n# Charger les fonctions publiques\n$publicFiles = Get-ChildItem -Path \"$ModuleRoot\\Public\\*.ps1\" -ErrorAction SilentlyContinue\nforeach ($file in $publicFiles) {\n    try {\n        . $file.FullName\n        Write-Verbose \"Fonction publique charg\u00e9e : $($file.Name)\"\n    }\n    catch {\n        Write-Error \"\u00c9chec du chargement de $($file.Name) : $_\"\n    }\n}\n\n# Exporter uniquement les fonctions publiques\n$publicFunctions = $publicFiles | ForEach-Object { $_.BaseName }\nExport-ModuleMember -Function $publicFunctions\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#4-le-manifeste-psd1","title":"4. Le Manifeste (.psd1)","text":""},{"location":"formations/powershell-advanced/03-module-design/#41-generer-un-manifeste","title":"4.1 G\u00e9n\u00e9rer un Manifeste","text":"<pre><code># Cr\u00e9er un manifeste avec les param\u00e8tres de base\nNew-ModuleManifest -Path \".\\WorldlineTools\\WorldlineTools.psd1\" `\n    -RootModule \"WorldlineTools.psm1\" `\n    -ModuleVersion \"1.0.0\" `\n    -Author \"ShellBook Automation Team\" `\n    -CompanyName \"Worldline\" `\n    -Description \"Outils d'administration Worldline pour Active Directory et Azure AD\" `\n    -PowerShellVersion \"5.1\" `\n    -FunctionsToExport @('New-WorldlineUser', 'Get-WorldlineUser', 'Set-WorldlineUser', 'Remove-WorldlineUser') `\n    -CmdletsToExport @() `\n    -VariablesToExport @() `\n    -AliasesToExport @() `\n    -Tags @('ActiveDirectory', 'Worldline', 'UserManagement') `\n    -ProjectUri \"https://github.com/worldline/WorldlineTools\" `\n    -LicenseUri \"https://github.com/worldline/WorldlineTools/blob/main/LICENSE\"\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#42-anatomie-du-manifeste","title":"4.2 Anatomie du Manifeste","text":"<pre><code># WorldlineTools.psd1\n@{\n    # Identit\u00e9 du module\n    RootModule        = 'WorldlineTools.psm1'\n    ModuleVersion     = '1.2.0'\n    GUID              = 'a1b2c3d4-e5f6-7890-abcd-ef1234567890'\n\n    # Informations sur l'auteur\n    Author            = 'ShellBook Automation Team'\n    CompanyName       = 'Worldline'\n    Copyright         = '(c) 2025 Worldline. Tous droits r\u00e9serv\u00e9s.'\n    Description       = 'Outils d administration Worldline pour Active Directory'\n\n    # Pr\u00e9requis\n    PowerShellVersion = '5.1'\n    # CLRVersion      = '4.0'\n    # DotNetFrameworkVersion = '4.5'\n\n    # Modules requis (d\u00e9pendances)\n    RequiredModules   = @(\n        @{ ModuleName = 'ActiveDirectory'; ModuleVersion = '1.0.0.0' }\n    )\n\n    # Assemblies .NET requis\n    # RequiredAssemblies = @('System.Web.dll')\n\n    # Scripts \u00e0 ex\u00e9cuter au chargement\n    # ScriptsToProcess = @('.\\Initialize.ps1')\n\n    # Nested modules (sous-modules)\n    # NestedModules = @('.\\SubModule\\SubModule.psm1')\n\n    # \u00c9l\u00e9ments \u00e0 exporter (IMPORTANT pour la s\u00e9curit\u00e9)\n    FunctionsToExport = @(\n        'New-WorldlineUser',\n        'Get-WorldlineUser',\n        'Set-WorldlineUser',\n        'Remove-WorldlineUser',\n        'Test-WorldlineConnection'\n    )\n    CmdletsToExport   = @()  # Pas de cmdlets compil\u00e9s\n    VariablesToExport = @()  # Ne pas exporter de variables\n    AliasesToExport   = @()  # Pas d'alias\n\n    # M\u00e9tadonn\u00e9es pour PowerShell Gallery\n    PrivateData       = @{\n        PSData = @{\n            Tags         = @('ActiveDirectory', 'Worldline', 'UserManagement', 'Automation')\n            LicenseUri   = 'https://github.com/worldline/WorldlineTools/blob/main/LICENSE'\n            ProjectUri   = 'https://github.com/worldline/WorldlineTools'\n            IconUri      = 'https://www.worldline.com/favicon.ico'\n            ReleaseNotes = @'\n## Version 1.2.0\n- Ajout de Test-WorldlineConnection\n- Correction du bug #42 sur New-WorldlineUser\n- Am\u00e9lioration des performances de Get-WorldlineUser\n'@\n        }\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#43-champs-importants","title":"4.3 Champs Importants","text":"Champ Description Impact <code>RootModule</code> Fichier .psm1 principal Obligatoire <code>ModuleVersion</code> Version SemVer Gestion des mises \u00e0 jour <code>FunctionsToExport</code> Liste des fonctions publiques S\u00e9curit\u00e9 : masque les helpers <code>RequiredModules</code> D\u00e9pendances Installation automatique <code>PowerShellVersion</code> Version PS minimale Compatibilit\u00e9 <code>PrivateData.PSData</code> M\u00e9tadonn\u00e9es Gallery Publication <p>S\u00e9curit\u00e9 : <code>FunctionsToExport</code></p> <p>Si vous mettez <code>'*'</code> dans <code>FunctionsToExport</code>, TOUTES vos fonctions seront visibles, y compris les fonctions priv\u00e9es/helpers.</p> <p>Toujours lister explicitement les fonctions \u00e0 exporter.</p>"},{"location":"formations/powershell-advanced/03-module-design/#5-controle-de-lapi-publique","title":"5. Contr\u00f4le de l'API Publique","text":""},{"location":"formations/powershell-advanced/03-module-design/#51-export-modulemember","title":"5.1 Export-ModuleMember","text":"<pre><code># \u00c0 la fin du fichier .psm1\n\n# M\u00e9thode 1 : Liste explicite\nExport-ModuleMember -Function @(\n    'New-WorldlineUser',\n    'Get-WorldlineUser',\n    'Set-WorldlineUser',\n    'Remove-WorldlineUser'\n)\n\n# M\u00e9thode 2 : Pattern (attention aux fonctions priv\u00e9es !)\n# Export-ModuleMember -Function *-Worldline*\n\n# Exporter aussi des alias\nExport-ModuleMember -Function 'New-WorldlineUser' -Alias 'nwu'\n\n# Exporter des variables (rare, \u00e0 \u00e9viter g\u00e9n\u00e9ralement)\n$ModuleConfig = @{ LogPath = \"C:\\Logs\" }\nExport-ModuleMember -Variable 'ModuleConfig'\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#52-priorite-dexport","title":"5.2 Priorit\u00e9 d'Export","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  PRIORIT\u00c9 DES EXPORTS                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. FunctionsToExport dans .psd1        \u25c4\u2500\u2500 PRIORIT\u00c9 HAUTE    \u2502\n\u2502      Si d\u00e9fini, SEULES ces fonctions sont export\u00e9es             \u2502\n\u2502                                                                 \u2502\n\u2502   2. Export-ModuleMember dans .psm1      \u25c4\u2500\u2500 PRIORIT\u00c9 BASSE    \u2502\n\u2502      Utilis\u00e9 si FunctionsToExport = '*' ou non d\u00e9fini           \u2502\n\u2502                                                                 \u2502\n\u2502   Recommandation :                                              \u2502\n\u2502   \u2022 D\u00e9finir FunctionsToExport explicitement dans .psd1          \u2502\n\u2502   \u2022 Utiliser aussi Export-ModuleMember pour la clart\u00e9           \u2502\n\u2502   \u2022 Les deux doivent correspondre                               \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#6-emplacement-et-auto-loading","title":"6. Emplacement et Auto-Loading","text":""},{"location":"formations/powershell-advanced/03-module-design/#61-chemins-de-modules","title":"6.1 Chemins de Modules","text":"<p>O\u00f9 Stocker vos Modules ?</p> <p>PowerShell recherche automatiquement les modules dans les chemins d\u00e9finis par <code>$env:PSModulePath</code> :</p> <pre><code># Afficher les chemins de recherche\n$env:PSModulePath -split ';'\n</code></pre> Chemin Port\u00e9e Usage <code>$HOME\\Documents\\PowerShell\\Modules</code> Utilisateur Modules personnels <code>C:\\Program Files\\PowerShell\\Modules</code> Machine (tous users) Modules partag\u00e9s <code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\Modules</code> Syst\u00e8me Modules Windows"},{"location":"formations/powershell-advanced/03-module-design/#62-installation-manuelle","title":"6.2 Installation Manuelle","text":"<pre><code># Chemin utilisateur (Windows PowerShell 5.1)\n$userModulePath = \"$HOME\\Documents\\WindowsPowerShell\\Modules\"\n\n# Chemin utilisateur (PowerShell 7+)\n$userModulePath = \"$HOME\\Documents\\PowerShell\\Modules\"\n\n# Cr\u00e9er le dossier du module\n$modulePath = Join-Path $userModulePath \"WorldlineTools\"\nNew-Item -ItemType Directory -Path $modulePath -Force\n\n# Copier les fichiers\nCopy-Item -Path \".\\WorldlineTools\\*\" -Destination $modulePath -Recurse\n\n# V\u00e9rifier\nGet-Module -ListAvailable -Name WorldlineTools\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#63-auto-loading","title":"6.3 Auto-Loading","text":"<p>PowerShell charge automatiquement un module lorsque vous appelez une de ses fonctions :</p> <pre><code># Le module est charg\u00e9 automatiquement au premier appel\nNew-WorldlineUser -FirstName \"Jean\" -LastName \"Dupont\"\n\n# \u00c9quivalent \u00e0 :\nImport-Module WorldlineTools\nNew-WorldlineUser -FirstName \"Jean\" -LastName \"Dupont\"\n</code></pre> <p>Condition pour l'Auto-Loading</p> <p>L'auto-loading fonctionne uniquement si :</p> <ol> <li>Le module est dans un chemin de <code>$env:PSModulePath</code></li> <li>Le nom du dossier = nom du module = nom du fichier <code>.psd1</code></li> </ol>"},{"location":"formations/powershell-advanced/03-module-design/#7-lab-creer-un-module-complet","title":"7. Lab : Cr\u00e9er un Module Complet","text":""},{"location":"formations/powershell-advanced/03-module-design/#71-structure-du-projet","title":"7.1 Structure du Projet","text":"<pre><code># Cr\u00e9er la structure\n$moduleName = \"WorldlineTools\"\n$modulePath = \"$HOME\\Documents\\PowerShell\\Modules\\$moduleName\"\n\nNew-Item -ItemType Directory -Path $modulePath -Force\nNew-Item -ItemType Directory -Path \"$modulePath\\Public\" -Force\nNew-Item -ItemType Directory -Path \"$modulePath\\Private\" -Force\nNew-Item -ItemType Directory -Path \"$modulePath\\Tests\" -Force\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#72-fonction-privee-privatewrite-logps1","title":"7.2 Fonction Priv\u00e9e : Private/Write-Log.ps1","text":"<pre><code># Private/Write-Log.ps1\nfunction Write-Log {\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory, Position = 0)]\n        [string]$Message,\n\n        [ValidateSet(\"INFO\", \"WARNING\", \"ERROR\", \"DEBUG\")]\n        [string]$Level = \"INFO\"\n    )\n\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logMessage = \"[$timestamp] [$Level] $Message\"\n\n    switch ($Level) {\n        \"ERROR\"   { Write-Verbose $logMessage; Write-Error $Message }\n        \"WARNING\" { Write-Verbose $logMessage; Write-Warning $Message }\n        default   { Write-Verbose $logMessage }\n    }\n}\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#73-fonction-publique-publictest-worldlineconnectionps1","title":"7.3 Fonction Publique : Public/Test-WorldlineConnection.ps1","text":"<pre><code># Public/Test-WorldlineConnection.ps1\nfunction Test-WorldlineConnection {\n    &lt;#\n    .SYNOPSIS\n        Teste la connectivit\u00e9 aux services Worldline.\n\n    .EXAMPLE\n        Test-WorldlineConnection -Service ActiveDirectory\n    #&gt;\n    [CmdletBinding()]\n    [OutputType([PSCustomObject])]\n    param(\n        [Parameter(Mandatory)]\n        [ValidateSet(\"ActiveDirectory\", \"AzureAD\", \"Exchange\")]\n        [string]$Service\n    )\n\n    Write-Log \"Test de connexion au service $Service\" -Level INFO\n\n    $result = [PSCustomObject]@{\n        Service   = $Service\n        Status    = \"Unknown\"\n        Timestamp = Get-Date\n        Message   = $null\n    }\n\n    switch ($Service) {\n        \"ActiveDirectory\" {\n            try {\n                $domain = Get-ADDomain -ErrorAction Stop\n                $result.Status = \"Connected\"\n                $result.Message = \"Connect\u00e9 au domaine $($domain.DNSRoot)\"\n            }\n            catch {\n                $result.Status = \"Failed\"\n                $result.Message = $_.Exception.Message\n            }\n        }\n        \"AzureAD\" {\n            try {\n                $context = Get-AzContext -ErrorAction Stop\n                if ($context) {\n                    $result.Status = \"Connected\"\n                    $result.Message = \"Connect\u00e9 \u00e0 $($context.Account.Id)\"\n                }\n                else {\n                    $result.Status = \"NotConnected\"\n                    $result.Message = \"Utilisez Connect-AzAccount\"\n                }\n            }\n            catch {\n                $result.Status = \"Failed\"\n                $result.Message = $_.Exception.Message\n            }\n        }\n        \"Exchange\" {\n            # Impl\u00e9mentation Exchange...\n            $result.Status = \"NotImplemented\"\n        }\n    }\n\n    Write-Log \"R\u00e9sultat : $($result.Status)\" -Level INFO\n    return $result\n}\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#74-module-loader-worldlinetoolspsm1","title":"7.4 Module Loader : WorldlineTools.psm1","text":"<pre><code># WorldlineTools.psm1\n$ModuleRoot = $PSScriptRoot\n\n# Dot-source des fichiers priv\u00e9s\nGet-ChildItem -Path \"$ModuleRoot\\Private\\*.ps1\" -ErrorAction SilentlyContinue |\n    ForEach-Object { . $_.FullName }\n\n# Dot-source des fichiers publics\n$publicFunctions = Get-ChildItem -Path \"$ModuleRoot\\Public\\*.ps1\" -ErrorAction SilentlyContinue\n$publicFunctions | ForEach-Object { . $_.FullName }\n\n# Exporter les fonctions publiques\nExport-ModuleMember -Function ($publicFunctions.BaseName)\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#75-manifeste-worldlinetoolspsd1","title":"7.5 Manifeste : WorldlineTools.psd1","text":"<pre><code># G\u00e9n\u00e9rer le manifeste\nNew-ModuleManifest -Path \"$modulePath\\WorldlineTools.psd1\" `\n    -RootModule \"WorldlineTools.psm1\" `\n    -ModuleVersion \"1.0.0\" `\n    -Author \"VotreNom\" `\n    -Description \"Outils Worldline pour l'administration IT\" `\n    -PowerShellVersion \"5.1\" `\n    -FunctionsToExport @('Test-WorldlineConnection') `\n    -Tags @('Worldline', 'IT', 'Administration')\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#76-test-du-module","title":"7.6 Test du Module","text":"<pre><code># Recharger le module (force)\nRemove-Module WorldlineTools -ErrorAction SilentlyContinue\nImport-Module WorldlineTools -Force -Verbose\n\n# V\u00e9rifier les fonctions export\u00e9es\nGet-Command -Module WorldlineTools\n\n# Tester\nTest-WorldlineConnection -Service ActiveDirectory -Verbose\n\n# La fonction priv\u00e9e n'est PAS accessible\nWrite-Log \"Test\"  # Erreur : commande non trouv\u00e9e\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#8-distribution-et-publication","title":"8. Distribution et Publication","text":""},{"location":"formations/powershell-advanced/03-module-design/#81-powershell-gallery","title":"8.1 PowerShell Gallery","text":"<pre><code># Pr\u00e9requis : Cl\u00e9 API de PowerShell Gallery\n# https://www.powershellgallery.com/account/apikeys\n\n# Tester le module avant publication\nTest-ModuleManifest -Path \".\\WorldlineTools\\WorldlineTools.psd1\"\n\n# Publier\nPublish-Module -Path \".\\WorldlineTools\" -NuGetApiKey \"VOTRE_CLE_API\"\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#82-repository-prive-nuget","title":"8.2 Repository Priv\u00e9 (NuGet)","text":"<pre><code># Enregistrer un repository priv\u00e9\nRegister-PSRepository -Name \"WorldlineInternal\" `\n    -SourceLocation \"https://nuget.worldline.internal/api/v2\" `\n    -PublishLocation \"https://nuget.worldline.internal/api/v2/package\" `\n    -InstallationPolicy Trusted\n\n# Publier sur le repo priv\u00e9\nPublish-Module -Path \".\\WorldlineTools\" `\n    -Repository \"WorldlineInternal\" `\n    -NuGetApiKey \"VOTRE_CLE\"\n\n# Installer depuis le repo priv\u00e9\nInstall-Module -Name WorldlineTools -Repository \"WorldlineInternal\"\n</code></pre>"},{"location":"formations/powershell-advanced/03-module-design/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Quelle est la diff\u00e9rence entre <code>.psm1</code> et <code>.psd1</code> ? <p>R\u00e9ponse :</p> <ul> <li> <p><code>.psm1</code> (Module Script) : Contient le code PowerShell (fonctions, classes, logique).</p> </li> <li> <p><code>.psd1</code> (Module Manifest) : Contient les m\u00e9tadonn\u00e9es du module (version, auteur, d\u00e9pendances, fonctions \u00e0 exporter). C'est un fichier de configuration, pas de code.</p> </li> </ul> <p>Le manifeste r\u00e9f\u00e9rence le module script via la propri\u00e9t\u00e9 <code>RootModule</code>.</p> Question 2 : Pourquoi sp\u00e9cifier explicitement <code>FunctionsToExport</code> au lieu de <code>'*'</code> ? <p>R\u00e9ponse :</p> <ol> <li>S\u00e9curit\u00e9 : Emp\u00eache l'exposition accidentelle de fonctions internes/helpers</li> <li>Performance : PowerShell n'a pas \u00e0 d\u00e9couvrir les exports dynamiquement</li> <li>Documentation : Liste claire de l'API publique</li> <li>Auto-completion : Am\u00e9liore IntelliSense en limitant les suggestions</li> </ol> Question 3 : Comment faire pour qu'un module soit auto-charg\u00e9 ? <p>R\u00e9ponse : Le module doit \u00eatre dans un des chemins de <code>$env:PSModulePath</code>, avec la structure :</p> <pre><code>.../Modules/NomDuModule/NomDuModule.psd1\n</code></pre> <p>Le nom du dossier doit correspondre au nom du module. PowerShell chargera automatiquement le module lorsqu'une de ses fonctions export\u00e9es sera appel\u00e9e.</p>"},{"location":"formations/powershell-advanced/03-module-design/#felicitations","title":"F\u00e9licitations !","text":"<p>Vous avez termin\u00e9 la formation PowerShell Avanc\u00e9 &amp; Tooling. Vous ma\u00eetrisez maintenant :</p> <ul> <li>:material-check-circle: Les Advanced Functions avec <code>[CmdletBinding()]</code></li> <li>:material-check-circle: La gestion d'erreurs robuste (Fail Fast)</li> <li>:material-check-circle: La cr\u00e9ation de modules professionnels</li> </ul> <p>Vous \u00eates pr\u00eat \u00e0 construire des outils de qualit\u00e9 production !</p> <p>:octicons-arrow-left-24: Retour au Module 2 : Gestion des Erreurs</p> <p>:octicons-home: Retour \u00e0 l'index de la formation</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/terraform-ops/","title":"Formation : Terraform &amp; Industrialisation","text":""},{"location":"formations/terraform-ops/#introduction","title":"Introduction","text":"<p>Infrastructure is Code.</p> <p>Cette phrase n'est pas un slogan marketing. C'est un changement de paradigme fondamental dans la fa\u00e7on dont nous concevons, d\u00e9ployons et maintenons l'infrastructure. En environnement r\u00e9gul\u00e9 (Worldline, SecNumCloud), l'Infrastructure as Code (IaC) n'est pas optionnelle : elle est obligatoire.</p> <p>Ce que cette formation N'EST PAS</p> <p>Cette formation n'est pas un tutoriel \"Hello World\" pour d\u00e9ployer une VM en 5 minutes.</p> <p>Elle traite de Terraform en production : gestion du state, collaboration d'\u00e9quipe, s\u00e9curit\u00e9 des secrets, et structure de code maintenable \u00e0 l'\u00e9chelle de l'entreprise.</p>"},{"location":"formations/terraform-ops/#pourquoi-terraform","title":"Pourquoi Terraform ?","text":""},{"location":"formations/terraform-ops/#le-probleme-du-clickops","title":"Le Probl\u00e8me du ClickOps","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLICKOPS vs INFRASTRUCTURE AS CODE                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   CLICKOPS (Console Web)                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                        \u2502\n\u2502   \u2022 Ing\u00e9nieur A cr\u00e9e une VM via la console                      \u2502\n\u2502   \u2022 Ing\u00e9nieur B modifie le firewall manuellement                \u2502\n\u2502   \u2022 6 mois plus tard : \"Qui a cr\u00e9\u00e9 \u00e7a ? Pourquoi ?\"            \u2502\n\u2502   \u2022 Recr\u00e9er l'environnement ? Impossible.                       \u2502\n\u2502   \u2022 Audit de conformit\u00e9 ? Cauchemar.                            \u2502\n\u2502                                                                 \u2502\n\u2502   \u274c Non reproductible                                          \u2502\n\u2502   \u274c Non auditable                                              \u2502\n\u2502   \u274c Non versionn\u00e9                                              \u2502\n\u2502   \u274c Drift incontr\u00f4l\u00e9                                           \u2502\n\u2502                                                                 \u2502\n\u2502   INFRASTRUCTURE AS CODE (Terraform)                            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                          \u2502\n\u2502   \u2022 Tout est d\u00e9crit dans des fichiers .tf                       \u2502\n\u2502   \u2022 Versionn\u00e9 dans Git (historique complet)                     \u2502\n\u2502   \u2022 Review de code = Review d'infrastructure                    \u2502\n\u2502   \u2022 Recr\u00e9er l'environnement ? terraform apply                   \u2502\n\u2502   \u2022 Audit de conformit\u00e9 ? git log + terraform state             \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Reproductible                                              \u2502\n\u2502   \u2705 Auditable                                                  \u2502\n\u2502   \u2705 Versionn\u00e9                                                  \u2502\n\u2502   \u2705 Drift d\u00e9tectable                                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/#terraform-vs-alternatives","title":"Terraform vs Alternatives","text":"Outil Type Cloud Support Maturit\u00e9 Terraform D\u00e9claratif, Multi-cloud AWS, GCP, Azure, +3000 providers Production Pulumi Imp\u00e9ratif (Python, TS) Multi-cloud Production CloudFormation D\u00e9claratif AWS uniquement Production Deployment Manager D\u00e9claratif GCP uniquement Legacy OpenTofu Fork Terraform Multi-cloud \u00c9mergent <p>Choix Worldline : Terraform</p> <p>Terraform est le standard de facto pour l'IaC multi-cloud. Sa syntaxe d\u00e9clarative (HCL) et son \u00e9cosyst\u00e8me de providers en font l'outil de r\u00e9f\u00e9rence.</p>"},{"location":"formations/terraform-ops/#le-cycle-de-vie-terraform","title":"Le Cycle de Vie Terraform","text":""},{"location":"formations/terraform-ops/#write-plan-apply","title":"Write \u2192 Plan \u2192 Apply","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CYCLE DE VIE TERRAFORM                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. WRITE (\u00c9crire)                                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                             \u2502\n\u2502   D\u00e9crire l'infrastructure d\u00e9sir\u00e9e en HCL                       \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  resource \"google_compute_instance\" \"web\" {             \u2502   \u2502\n\u2502   \u2502    name         = \"web-server\"                          \u2502   \u2502\n\u2502   \u2502    machine_type = \"e2-medium\"                           \u2502   \u2502\n\u2502   \u2502    zone         = \"europe-west1-b\"                      \u2502   \u2502\n\u2502   \u2502  }                                                      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   2. PLAN (Planifier)                                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                           \u2502\n\u2502   Terraform compare l'\u00e9tat d\u00e9sir\u00e9 vs l'\u00e9tat actuel              \u2502\n\u2502                                                                 \u2502\n\u2502   $ terraform plan                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  + google_compute_instance.web                          \u2502   \u2502\n\u2502   \u2502      + name         = \"web-server\"                      \u2502   \u2502\n\u2502   \u2502      + machine_type = \"e2-medium\"                       \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Plan: 1 to add, 0 to change, 0 to destroy.            \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   3. APPLY (Appliquer)                                          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                          \u2502\n\u2502   Ex\u00e9cuter les changements apr\u00e8s validation                     \u2502\n\u2502                                                                 \u2502\n\u2502   $ terraform apply                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  google_compute_instance.web: Creating...               \u2502   \u2502\n\u2502   \u2502  google_compute_instance.web: Creation complete [32s]   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Apply complete! Resources: 1 added, 0 changed.         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    STATE FILE                           \u2502   \u2502\n\u2502   \u2502   terraform.tfstate                                     \u2502   \u2502\n\u2502   \u2502   (Repr\u00e9sentation de l'infrastructure r\u00e9elle)           \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/#les-commandes-essentielles","title":"Les Commandes Essentielles","text":"<pre><code># Initialiser le projet (t\u00e9l\u00e9charge les providers)\nterraform init\n\n# Valider la syntaxe\nterraform validate\n\n# Formater le code (style canonique)\nterraform fmt -recursive\n\n# Planifier les changements (LECTURE SEULE)\nterraform plan -out=tfplan\n\n# Appliquer les changements\nterraform apply tfplan\n\n# Voir l'\u00e9tat actuel\nterraform state list\nterraform state show google_compute_instance.web\n\n# D\u00e9truire l'infrastructure\nterraform destroy\n</code></pre>"},{"location":"formations/terraform-ops/#infrastructure-immutable","title":"Infrastructure Immutable","text":""},{"location":"formations/terraform-ops/#le-concept","title":"Le Concept","text":"<p>L'Infrastructure Immutable est un paradigme o\u00f9 les serveurs ne sont jamais modifi\u00e9s apr\u00e8s leur cr\u00e9ation. Au lieu de patcher un serveur, on le remplace par un nouveau.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MUTABLE vs IMMUTABLE INFRASTRUCTURE                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   INFRASTRUCTURE MUTABLE (Pets)                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                 \u2502\n\u2502                                                                 \u2502\n\u2502   Serveur \"web-prod-01\" cr\u00e9\u00e9 en 2020                           \u2502\n\u2502        \u2502                                                        \u2502\n\u2502        \u251c\u2500\u2500 Patch s\u00e9curit\u00e9 (2020-06)                            \u2502\n\u2502        \u251c\u2500\u2500 Upgrade Apache (2021-01)                            \u2502\n\u2502        \u251c\u2500\u2500 Fix hotfix (2021-03)                                \u2502\n\u2502        \u251c\u2500\u2500 Nouveau certificat (2021-12)                        \u2502\n\u2502        \u251c\u2500\u2500 Migration PHP (2022-06)                             \u2502\n\u2502        \u2514\u2500\u2500 ???                                                  \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  Configuration Drift : l'\u00e9tat r\u00e9el != l'\u00e9tat document\u00e9     \u2502\n\u2502   \u26a0\ufe0f  \"Snowflake Server\" : impossible \u00e0 recr\u00e9er                 \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   INFRASTRUCTURE IMMUTABLE (Cattle)                             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                            \u2502\n\u2502                                                                 \u2502\n\u2502   Image v1.0 \u2500\u2500\u25ba Serveur A (d\u00e9truit)                           \u2502\n\u2502   Image v1.1 \u2500\u2500\u25ba Serveur B (d\u00e9truit)                           \u2502\n\u2502   Image v1.2 \u2500\u2500\u25ba Serveur C (actif)                             \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Chaque serveur est identique \u00e0 sa d\u00e9finition              \u2502\n\u2502   \u2705 Rollback = Red\u00e9ployer l'image pr\u00e9c\u00e9dente                  \u2502\n\u2502   \u2705 Pas de configuration drift                                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/#application-avec-terraform","title":"Application avec Terraform","text":"<pre><code># Au lieu de modifier une VM existante...\nresource \"google_compute_instance\" \"web\" {\n  name         = \"web-${var.version}\"  # Nouvelle VM \u00e0 chaque version\n  machine_type = \"e2-medium\"\n\n  boot_disk {\n    initialize_params {\n      image = \"projects/my-project/global/images/web-${var.image_version}\"\n    }\n  }\n\n  # Forcer le remplacement si l'image change\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n</code></pre> <p>Golden Images avec Packer</p> <p>Pour l'infrastructure immutable, combinez Terraform avec Packer :</p> <ol> <li>Packer : Construit des images VM standardis\u00e9es (Golden Images)</li> <li>Terraform : D\u00e9ploie ces images de mani\u00e8re d\u00e9clarative</li> </ol>"},{"location":"formations/terraform-ops/#syllabus-de-la-formation","title":"Syllabus de la Formation","text":"<p>Cette formation est organis\u00e9e en 3 modules :</p>"},{"location":"formations/terraform-ops/#module-1-gestion-du-state","title":"Module 1 : Gestion du State","text":"<p>:material-database-lock: Le Risque N\u00b01 | :material-clock-outline: ~60 min</p> <ul> <li>Comprendre le <code>terraform.tfstate</code></li> <li>Remote Backend (GCS)</li> <li>State Locking pour la collaboration</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 1</p>"},{"location":"formations/terraform-ops/#module-2-structure-modules","title":"Module 2 : Structure &amp; Modules","text":"<p>:material-folder-multiple: Principe DRY | :material-clock-outline: ~75 min</p> <ul> <li>Organisation d'un projet Terraform</li> <li>Modules r\u00e9utilisables</li> <li>Gestion des versions de providers</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 2</p>"},{"location":"formations/terraform-ops/#module-3-secrets-variables","title":"Module 3 : Secrets &amp; Variables","text":"<p>:material-shield-key: S\u00e9curit\u00e9 | :material-clock-outline: ~60 min</p> <ul> <li>Variables sensibles et non-sensibles</li> <li>Int\u00e9gration avec GCP Secret Manager</li> <li>Variables d'environnement (<code>TF_VAR_*</code>)</li> </ul> <p>:octicons-arrow-right-24: Acc\u00e9der au Module 3</p>"},{"location":"formations/terraform-ops/#prerequis","title":"Pr\u00e9requis","text":"<p>Connaissances requises</p> <p>Avant de commencer cette formation, assurez-vous de ma\u00eetriser :</p> <ul> <li>GCP Fundamentals : Projets, IAM, VPC, Service Accounts</li> <li>CLI : <code>gcloud</code> et <code>terraform</code> install\u00e9s</li> <li>Git : Branches, commits, pull requests</li> <li>Concepts Cloud : VMs, r\u00e9seaux, stockage</li> </ul>"},{"location":"formations/terraform-ops/#installation-terraform","title":"Installation Terraform","text":"macOSLinux (Debian/Ubuntu)Windows <pre><code>brew tap hashicorp/tap\nbrew install hashicorp/tap/terraform\n\n# V\u00e9rifier\nterraform version\n</code></pre> <pre><code>wget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg\necho \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/hashicorp.list\nsudo apt update &amp;&amp; sudo apt install terraform\n\n# V\u00e9rifier\nterraform version\n</code></pre> <pre><code># Via Chocolatey\nchoco install terraform\n\n# Ou t\u00e9l\u00e9charger depuis https://www.terraform.io/downloads\n\n# V\u00e9rifier\nterraform version\n</code></pre>"},{"location":"formations/terraform-ops/#architecture-de-reference-worldline","title":"Architecture de R\u00e9f\u00e9rence Worldline","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PIPELINE TERRAFORM WORLDLINE                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    D\u00c9VELOPPEUR                          \u2502   \u2502\n\u2502   \u2502   1. Modifie les fichiers .tf                           \u2502   \u2502\n\u2502   \u2502   2. terraform fmt &amp;&amp; terraform validate                \u2502   \u2502\n\u2502   \u2502   3. Commit + Push + Pull Request                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    CI/CD (GitLab/GitHub)                \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502   \u2502\n\u2502   \u2502   \u2502  Validate   \u2502\u2500\u25ba\u2502    Plan     \u2502\u2500\u25ba\u2502   Review    \u2502    \u2502   \u2502\n\u2502   \u2502   \u2502  fmt check  \u2502  \u2502  (output)   \u2502  \u2502  (humain)   \u2502    \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502   \u2502\n\u2502   \u2502                                           \u2502             \u2502   \u2502\n\u2502   \u2502                                           \u25bc             \u2502   \u2502\n\u2502   \u2502                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502                               \u2502  Apply (protected)  \u2502   \u2502   \u2502\n\u2502   \u2502                               \u2502  main branch only   \u2502   \u2502   \u2502\n\u2502   \u2502                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    GCP INFRASTRUCTURE                   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502   VPC   \u2502  \u2502   GKE   \u2502  \u2502Cloud SQL\u2502  \u2502   IAM   \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    REMOTE STATE (GCS)                   \u2502   \u2502\n\u2502   \u2502   gs://worldline-terraform-state/env/terraform.tfstate  \u2502   \u2502\n\u2502   \u2502   + State Locking via GCS                               \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/#regles-dor-terraform","title":"R\u00e8gles d'Or Terraform","text":"<p>Les 5 R\u00e8gles Inviolables</p> <ol> <li> <p>JAMAIS de <code>terraform apply</code> en local sur la production    \u2192 Toujours passer par la CI/CD</p> </li> <li> <p>JAMAIS de secrets dans le code    \u2192 Utiliser Secret Manager ou variables d'environnement</p> </li> <li> <p>TOUJOURS un remote backend    \u2192 Le state local est une bombe \u00e0 retardement</p> </li> <li> <p>TOUJOURS verrouiller les versions    \u2192 Providers et modules avec versions explicites</p> </li> <li> <p>TOUJOURS un <code>terraform plan</code> avant <code>apply</code>    \u2192 Lire et comprendre les changements</p> </li> </ol>"},{"location":"formations/terraform-ops/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":""},{"location":"formations/terraform-ops/#documentation-officielle","title":"Documentation Officielle","text":"<ul> <li>:material-link: Terraform Documentation</li> <li>:material-link: Google Cloud Provider</li> <li>:material-link: Terraform Best Practices</li> </ul>"},{"location":"formations/terraform-ops/#outils-essentiels","title":"Outils Essentiels","text":"Outil Usage Installation <code>terraform</code> CLI Terraform <code>brew install terraform</code> <code>tflint</code> Linter Terraform <code>brew install tflint</code> <code>terraform-docs</code> G\u00e9n\u00e8re la doc automatiquement <code>brew install terraform-docs</code> <code>tfsec</code> Analyse s\u00e9curit\u00e9 statique <code>brew install tfsec</code> <code>infracost</code> Estimation des co\u00fbts <code>brew install infracost</code> <p>Philosophie DevOps</p> <p>\"Infrastructure as Code means treating your infrastructure with the same rigor as application code: version control, code review, testing, and automation.\"</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Auteur : ShellBook Cloud Team</p>"},{"location":"formations/terraform-ops/01-state-management/","title":"Module 1 : Gestion du State","text":""},{"location":"formations/terraform-ops/01-state-management/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Comprendre le r\u00f4le et le contenu du <code>terraform.tfstate</code></li> <li>:material-check: Identifier les risques du state local</li> <li>:material-check: Configurer un Remote Backend sur GCS</li> <li>:material-check: Impl\u00e9menter le State Locking pour le travail en \u00e9quipe</li> </ul>"},{"location":"formations/terraform-ops/01-state-management/#1-le-terraformtfstate-la-memoire-de-terraform","title":"1. Le terraform.tfstate : La M\u00e9moire de Terraform","text":""},{"location":"formations/terraform-ops/01-state-management/#11-quest-ce-que-le-state","title":"1.1 Qu'est-ce que le State ?","text":"<p>Le state est un fichier JSON qui repr\u00e9sente la r\u00e9alit\u00e9 de votre infrastructure d\u00e9ploy\u00e9e. C'est la source de v\u00e9rit\u00e9 que Terraform utilise pour :</p> <ol> <li>Mapper les ressources du code aux ressources r\u00e9elles</li> <li>Calculer les changements n\u00e9cessaires (plan)</li> <li>Suivre les m\u00e9tadonn\u00e9es (d\u00e9pendances, attributs)</li> </ol> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              LE R\u00d4LE DU STATE FILE                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502   \u2502   Code Terraform  \u2502        \u2502  Infrastructure   \u2502           \u2502\n\u2502   \u2502      (.tf)        \u2502        \u2502   R\u00e9elle (GCP)    \u2502           \u2502\n\u2502   \u2502                   \u2502        \u2502                   \u2502           \u2502\n\u2502   \u2502  resource \"vm\" {  \u2502        \u2502  VM: web-prod-01  \u2502           \u2502\n\u2502   \u2502    name = \"web\"   \u2502        \u2502  IP: 10.0.1.5     \u2502           \u2502\n\u2502   \u2502  }                \u2502        \u2502  Zone: eu-west1-b \u2502           \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502            \u2502                            \u2502                       \u2502\n\u2502            \u2502                            \u2502                       \u2502\n\u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                       \u2502    \u2502                                    \u2502\n\u2502                       \u25bc    \u25bc                                    \u2502\n\u2502            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                \u2502\n\u2502            \u2502  terraform.tfstate \u2502                               \u2502\n\u2502            \u2502                   \u2502                                \u2502\n\u2502            \u2502  \"Voici ce qui    \u2502                                \u2502\n\u2502            \u2502   existe r\u00e9ellement\u2502                               \u2502\n\u2502            \u2502   et comment le   \u2502                                \u2502\n\u2502            \u2502   code s'y        \u2502                                \u2502\n\u2502            \u2502   rapporte\"       \u2502                                \u2502\n\u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                \u2502\n\u2502                                                                 \u2502\n\u2502   terraform plan = Comparer Code vs State vs R\u00e9el               \u2502\n\u2502   terraform apply = Synchroniser R\u00e9el avec Code (via State)     \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#12-contenu-du-state","title":"1.2 Contenu du State","text":"<p>Voici un exemple de ce que contient r\u00e9ellement un state file :</p> <pre><code>{\n  \"version\": 4,\n  \"terraform_version\": \"1.6.0\",\n  \"serial\": 42,\n  \"lineage\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"outputs\": {\n    \"instance_ip\": {\n      \"value\": \"34.78.123.45\",\n      \"type\": \"string\"\n    }\n  },\n  \"resources\": [\n    {\n      \"mode\": \"managed\",\n      \"type\": \"google_compute_instance\",\n      \"name\": \"web\",\n      \"provider\": \"provider[\\\"registry.terraform.io/hashicorp/google\\\"]\",\n      \"instances\": [\n        {\n          \"schema_version\": 6,\n          \"attributes\": {\n            \"id\": \"projects/my-project/zones/europe-west1-b/instances/web-prod-01\",\n            \"name\": \"web-prod-01\",\n            \"machine_type\": \"e2-medium\",\n            \"zone\": \"europe-west1-b\",\n            \"network_interface\": [\n              {\n                \"network_ip\": \"10.0.1.5\",\n                \"access_config\": [\n                  {\n                    \"nat_ip\": \"34.78.123.45\"\n                  }\n                ]\n              }\n            ],\n            \"metadata\": {\n              \"ssh-keys\": \"admin:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB...\"\n            }\n          }\n        }\n      ]\n    },\n    {\n      \"mode\": \"managed\",\n      \"type\": \"google_sql_database_instance\",\n      \"name\": \"main\",\n      \"instances\": [\n        {\n          \"attributes\": {\n            \"name\": \"prod-db-instance\",\n            \"root_password\": \"SuperSecret123!\",\n            \"ip_address\": [\n              {\n                \"ip_address\": \"10.0.2.50\"\n              }\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n</code></pre> <p>Le State Contient des SECRETS</p> <p>Regardez attentivement l'exemple ci-dessus. Le state contient :</p> <ul> <li><code>root_password</code> : Le mot de passe root de la base de donn\u00e9es en clair</li> <li><code>ssh-keys</code> : Les cl\u00e9s SSH des utilisateurs</li> <li><code>nat_ip</code> : Les IPs publiques de vos serveurs</li> <li>Toute information sensible retourn\u00e9e par les APIs GCP</li> </ul> <p>Le state file EST un secret. Traitez-le comme tel.</p>"},{"location":"formations/terraform-ops/01-state-management/#2-le-risque-n1-le-state-local","title":"2. Le Risque N\u00b01 : Le State Local","text":""},{"location":"formations/terraform-ops/01-state-management/#21-le-scenario-catastrophe","title":"2.1 Le Sc\u00e9nario Catastrophe","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              SC\u00c9NARIO : STATE LOCAL EN \u00c9QUIPE                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Jour 1 : Alice d\u00e9ploie l'infrastructure                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                      \u2502\n\u2502   $ terraform apply                                             \u2502\n\u2502   \u2192 Cr\u00e9e : VPC, GKE, Cloud SQL                                  \u2502\n\u2502   \u2192 State sauv\u00e9 localement : /home/alice/project/terraform.tfstate\u2502\n\u2502                                                                 \u2502\n\u2502   Jour 2 : Bob veut ajouter une VM                              \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                          \u2502\n\u2502   $ git pull  # Bob r\u00e9cup\u00e8re le code                            \u2502\n\u2502   $ terraform apply                                             \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  PROBL\u00c8ME : Bob n'a PAS le state d'Alice !                 \u2502\n\u2502                                                                 \u2502\n\u2502   Terraform pense que RIEN n'existe.                            \u2502\n\u2502   \u2192 Essaie de recr\u00e9er VPC, GKE, Cloud SQL                       \u2502\n\u2502   \u2192 \u00c9CHEC : \"Resource already exists\"                           \u2502\n\u2502   \u2192 OU PIRE : Cr\u00e9e des doublons                                 \u2502\n\u2502                                                                 \u2502\n\u2502   Jour 3 : Alice supprime son laptop                            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2502\n\u2502   \u2192 Le state est PERDU                                          \u2502\n\u2502   \u2192 Plus aucun moyen de g\u00e9rer l'infrastructure via Terraform    \u2502\n\u2502   \u2192 `terraform destroy` ne fonctionne plus                      \u2502\n\u2502   \u2192 Nettoyage manuel obligatoire                                \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udc80 GAME OVER                                                  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#22-les-problemes-du-state-local","title":"2.2 Les Probl\u00e8mes du State Local","text":"Probl\u00e8me Cons\u00e9quence Pas de partage Impossible de travailler en \u00e9quipe Pas de backup Perte du laptop = perte du state Pas de locking Deux apply simultan\u00e9s = corruption Secrets en clair Sur le disque local, accessible Pas d'audit Qui a fait quoi, quand ? <p>R\u00e8gle Absolue</p> <p>JAMAIS de state local en production.</p> <p>Le state local est acceptable uniquement pour : - Apprentissage personnel - Tests locaux temporaires - Prototypage rapide</p> <p>D\u00e8s qu'un projet devient s\u00e9rieux \u2192 Remote Backend.</p>"},{"location":"formations/terraform-ops/01-state-management/#3-la-solution-remote-backend-gcs","title":"3. La Solution : Remote Backend (GCS)","text":""},{"location":"formations/terraform-ops/01-state-management/#31-architecture-remote-state","title":"3.1 Architecture Remote State","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              REMOTE STATE AVEC GCS                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502   Alice     \u2502     \u2502    Bob      \u2502     \u2502    CI/CD    \u2502      \u2502\n\u2502   \u2502  (laptop)   \u2502     \u2502  (laptop)   \u2502     \u2502  (runner)   \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502          \u2502                   \u2502                   \u2502              \u2502\n\u2502          \u2502 terraform         \u2502 terraform         \u2502 terraform   \u2502\n\u2502          \u2502 init/plan/apply   \u2502 init/plan/apply   \u2502 apply       \u2502\n\u2502          \u2502                   \u2502                   \u2502              \u2502\n\u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                              \u2502                                  \u2502\n\u2502                              \u25bc                                  \u2502\n\u2502          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502          \u2502         Google Cloud Storage          \u2502              \u2502\n\u2502          \u2502                                       \u2502              \u2502\n\u2502          \u2502   Bucket: worldline-tf-state          \u2502              \u2502\n\u2502          \u2502   \u251c\u2500\u2500 dev/terraform.tfstate           \u2502              \u2502\n\u2502          \u2502   \u251c\u2500\u2500 staging/terraform.tfstate       \u2502              \u2502\n\u2502          \u2502   \u2514\u2500\u2500 prod/terraform.tfstate          \u2502              \u2502\n\u2502          \u2502                                       \u2502              \u2502\n\u2502          \u2502   \u2705 Chiffrement at-rest (AES-256)    \u2502              \u2502\n\u2502          \u2502   \u2705 Versioning activ\u00e9                \u2502              \u2502\n\u2502          \u2502   \u2705 Object Locking                   \u2502              \u2502\n\u2502          \u2502   \u2705 IAM granulaire                   \u2502              \u2502\n\u2502          \u2502   \u2705 Audit Logs                       \u2502              \u2502\n\u2502          \u2502                                       \u2502              \u2502\n\u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#32-creation-du-bucket-gcs","title":"3.2 Cr\u00e9ation du Bucket GCS","text":"<pre><code># Variables\nPROJECT_ID=\"worldline-prod\"\nBUCKET_NAME=\"worldline-terraform-state\"\nREGION=\"europe-west1\"\n\n# Cr\u00e9er le bucket\ngcloud storage buckets create gs://${BUCKET_NAME} \\\n    --project=${PROJECT_ID} \\\n    --location=${REGION} \\\n    --uniform-bucket-level-access\n\n# Activer le versioning (CRITIQUE pour la r\u00e9cup\u00e9ration)\ngcloud storage buckets update gs://${BUCKET_NAME} \\\n    --versioning\n\n# Activer le chiffrement avec une cl\u00e9 KMS (optionnel mais recommand\u00e9)\ngcloud storage buckets update gs://${BUCKET_NAME} \\\n    --default-encryption-key=projects/${PROJECT_ID}/locations/${REGION}/keyRings/terraform/cryptoKeys/state-key\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#33-configuration-du-backend","title":"3.3 Configuration du Backend","text":"<p>Cr\u00e9ez un fichier <code>backend.tf</code> :</p> <pre><code># backend.tf\nterraform {\n  backend \"gcs\" {\n    bucket = \"worldline-terraform-state\"\n    prefix = \"prod\"  # Cr\u00e9e prod/default.tfstate\n  }\n}\n</code></pre> <p>Ou avec plus d'options :</p> <pre><code># backend.tf - Configuration compl\u00e8te\nterraform {\n  backend \"gcs\" {\n    bucket = \"worldline-terraform-state\"\n    prefix = \"environments/prod\"\n\n    # Optionnel : Impersonation de Service Account\n    # impersonate_service_account = \"terraform@worldline-prod.iam.gserviceaccount.com\"\n  }\n}\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#34-migration-du-state-local-vers-remote","title":"3.4 Migration du State Local vers Remote","text":"<pre><code># Situation : Vous avez un state local et voulez migrer vers GCS\n\n# 1. Ajouter la configuration backend (backend.tf ci-dessus)\n\n# 2. R\u00e9initialiser Terraform\nterraform init -migrate-state\n\n# Terraform affiche :\n# Initializing the backend...\n# Do you want to copy existing state to the new backend?\n#   Enter a value: yes\n\n# 3. V\u00e9rifier que le state est bien sur GCS\ngsutil ls gs://worldline-terraform-state/prod/\n\n# 4. Supprimer le state local (il est maintenant sur GCS)\nrm terraform.tfstate terraform.tfstate.backup\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#4-state-locking-collaboration-sans-collision","title":"4. State Locking : Collaboration Sans Collision","text":""},{"location":"formations/terraform-ops/01-state-management/#41-le-probleme-de-la-concurrence","title":"4.1 Le Probl\u00e8me de la Concurrence","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              RACE CONDITION SANS LOCKING                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   T=0    Alice lit le state (VM count = 2)                      \u2502\n\u2502   T=1    Bob lit le state (VM count = 2)                        \u2502\n\u2502   T=2    Alice calcule : \"Ajouter 1 VM, total = 3\"              \u2502\n\u2502   T=3    Bob calcule : \"Supprimer 1 VM, total = 1\"              \u2502\n\u2502   T=4    Alice \u00e9crit le state (VM count = 3)                    \u2502\n\u2502   T=5    Bob \u00e9crit le state (VM count = 1) \u2190 \u00c9CRASE Alice !     \u2502\n\u2502                                                                 \u2502\n\u2502   R\u00c9SULTAT :                                                    \u2502\n\u2502   - State dit : 1 VM                                            \u2502\n\u2502   - R\u00e9alit\u00e9 GCP : 3 VMs (Alice a cr\u00e9\u00e9 avant Bob)               \u2502\n\u2502   - State CORROMPU : Terraform ne sait plus ce qui existe       \u2502\n\u2502                                                                 \u2502\n\u2502   \ud83d\udc80 STATE CORRUPTION                                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#42-gcs-native-locking","title":"4.2 GCS Native Locking","text":"<p>Bonne nouvelle : GCS supporte le locking nativement depuis Terraform 0.14+. Aucune configuration suppl\u00e9mentaire n'est n\u00e9cessaire.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              STATE LOCKING AVEC GCS                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   T=0    Alice : terraform apply                                \u2502\n\u2502          \u2192 Terraform cr\u00e9e un lock file sur GCS                  \u2502\n\u2502          \u2192 Lock acquis \u2705                                       \u2502\n\u2502                                                                 \u2502\n\u2502   T=1    Bob : terraform apply                                  \u2502\n\u2502          \u2192 Terraform d\u00e9tecte le lock                            \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u2502  Error: Error acquiring the state lock               \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u2502  Lock Info:                                          \u2502\n\u2502          \u2502    ID:        a1b2c3d4-5678-90ab-cdef                \u2502\n\u2502          \u2502    Path:      gs://bucket/prod/default.tflock        \u2502\n\u2502          \u2502    Operation: OperationTypeApply                     \u2502\n\u2502          \u2502    Who:       alice@worldline.com                    \u2502\n\u2502          \u2502    Version:   1.6.0                                  \u2502\n\u2502          \u2502    Created:   2025-01-28 14:32:15 UTC                \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u2502  Terraform acquires a state lock to protect          \u2502\n\u2502          \u2502  the state from being written by multiple users.     \u2502\n\u2502          \u2502                                                      \u2502\n\u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500     \u2502\n\u2502                                                                 \u2502\n\u2502   T=10   Alice : apply termin\u00e9                                  \u2502\n\u2502          \u2192 Lock automatiquement lib\u00e9r\u00e9                          \u2502\n\u2502                                                                 \u2502\n\u2502   T=11   Bob : peut maintenant lancer son apply                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#43-forcer-le-deverrouillage-urgence","title":"4.3 Forcer le D\u00e9verrouillage (Urgence)","text":"<p>\u00c0 utiliser avec pr\u00e9caution</p> <p>Le force-unlock ne doit \u00eatre utilis\u00e9 que si :</p> <ul> <li>Le processus Terraform a crash\u00e9</li> <li>Le lock est orphelin (personne ne l'utilise)</li> <li>Vous avez v\u00e9rifi\u00e9 qu'aucun apply n'est en cours</li> </ul> <pre><code># Voir les informations du lock\nterraform force-unlock -help\n\n# Forcer le d\u00e9verrouillage (DANGEREUX)\nterraform force-unlock LOCK_ID\n\n# Exemple\nterraform force-unlock a1b2c3d4-5678-90ab-cdef\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#5-bonnes-pratiques-de-gestion-du-state","title":"5. Bonnes Pratiques de Gestion du State","text":""},{"location":"formations/terraform-ops/01-state-management/#51-checklist-state-management","title":"5.1 Checklist State Management","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST STATE MANAGEMENT                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   BACKEND                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2611 Remote backend configur\u00e9 (GCS)                              \u2502\n\u2502   \u2611 Versioning activ\u00e9 sur le bucket                             \u2502\n\u2502   \u2611 Chiffrement at-rest (default ou KMS)                        \u2502\n\u2502   \u2611 IAM restrictif (pas de public access)                       \u2502\n\u2502                                                                 \u2502\n\u2502   S\u00c9CURIT\u00c9                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2611 Bucket non public                                           \u2502\n\u2502   \u2611 Acc\u00e8s limit\u00e9 (Service Accounts d\u00e9di\u00e9s)                      \u2502\n\u2502   \u2611 Audit Logs activ\u00e9s                                          \u2502\n\u2502   \u2611 State jamais commit\u00e9 dans Git (.gitignore)                  \u2502\n\u2502                                                                 \u2502\n\u2502   ORGANISATION                                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                  \u2502\n\u2502   \u2611 Un state par environnement (dev/staging/prod)               \u2502\n\u2502   \u2611 Un state par composant si n\u00e9cessaire (r\u00e9seau, app, db)      \u2502\n\u2502   \u2611 Naming convention claire                                    \u2502\n\u2502                                                                 \u2502\n\u2502   OP\u00c9RATIONS                                                    \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                    \u2502\n\u2502   \u2611 Ne jamais \u00e9diter le state manuellement                      \u2502\n\u2502   \u2611 Utiliser terraform state mv pour renommer                   \u2502\n\u2502   \u2611 Backup avant op\u00e9rations risqu\u00e9es                            \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#52-fichier-gitignore","title":"5.2 Fichier .gitignore","text":"<pre><code># Terraform State - NEVER COMMIT\n*.tfstate\n*.tfstate.*\n.terraform.tfstate.lock.info\n\n# Terraform files\n.terraform/\n*.tfplan\n*.tfplan.json\n\n# Sensitive variable files\n*.auto.tfvars\nterraform.tfvars\nsecrets.tfvars\n\n# Override files (local testing)\noverride.tf\noverride.tf.json\n*_override.tf\n*_override.tf.json\n\n# Crash logs\ncrash.log\ncrash.*.log\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#53-commandes-state-utiles","title":"5.3 Commandes State Utiles","text":"<pre><code># === CONSULTATION ===\n# Lister toutes les ressources dans le state\nterraform state list\n\n# Voir les d\u00e9tails d'une ressource\nterraform state show google_compute_instance.web\n\n# Afficher tout le state (JSON)\nterraform state pull\n\n# === MANIPULATION (AVEC PR\u00c9CAUTION) ===\n# Renommer une ressource (refactoring)\nterraform state mv google_compute_instance.web google_compute_instance.frontend\n\n# Supprimer une ressource du state (sans la d\u00e9truire dans GCP)\nterraform state rm google_compute_instance.legacy\n\n# Importer une ressource existante dans le state\nterraform import google_compute_instance.existing projects/my-proj/zones/eu-west1-b/instances/existing-vm\n\n# === BACKUP ===\n# Sauvegarder le state\nterraform state pull &gt; backup-$(date +%Y%m%d-%H%M%S).tfstate\n\n# Restaurer un state (depuis backup GCS avec versioning)\ngsutil cp gs://bucket/prod/default.tfstate#1234567890 restored.tfstate\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#6-state-splitting-quand-diviser","title":"6. State Splitting : Quand Diviser ?","text":""},{"location":"formations/terraform-ops/01-state-management/#61-mono-state-vs-multi-state","title":"6.1 Mono-State vs Multi-State","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MONO-STATE vs MULTI-STATE                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   MONO-STATE (Tout dans un seul state)                          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2502\n\u2502                                                                 \u2502\n\u2502   terraform.tfstate                                             \u2502\n\u2502   \u251c\u2500\u2500 VPC                                                       \u2502\n\u2502   \u251c\u2500\u2500 GKE Cluster                                               \u2502\n\u2502   \u251c\u2500\u2500 Cloud SQL                                                 \u2502\n\u2502   \u251c\u2500\u2500 Applications (20+ deployments)                            \u2502\n\u2502   \u2514\u2500\u2500 IAM Bindings                                              \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  Probl\u00e8mes :                                               \u2502\n\u2502   \u2022 terraform plan prend 10 minutes                             \u2502\n\u2502   \u2022 Un changement app bloque tout le monde                      \u2502\n\u2502   \u2022 Risque : toucher le VPC en modifiant une app                \u2502\n\u2502   \u2022 Blast radius maximum                                        \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   MULTI-STATE (S\u00e9paration par composant)                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                        \u2502\n\u2502                                                                 \u2502\n\u2502   network/terraform.tfstate     \u2190 \u00c9quipe Infra (rare changes)  \u2502\n\u2502   \u251c\u2500\u2500 VPC                                                       \u2502\n\u2502   \u251c\u2500\u2500 Subnets                                                   \u2502\n\u2502   \u2514\u2500\u2500 Firewall Rules                                            \u2502\n\u2502                                                                 \u2502\n\u2502   gke/terraform.tfstate         \u2190 \u00c9quipe Platform               \u2502\n\u2502   \u251c\u2500\u2500 GKE Cluster                                               \u2502\n\u2502   \u2514\u2500\u2500 Node Pools                                                \u2502\n\u2502                                                                 \u2502\n\u2502   database/terraform.tfstate    \u2190 \u00c9quipe DBA                    \u2502\n\u2502   \u2514\u2500\u2500 Cloud SQL                                                 \u2502\n\u2502                                                                 \u2502\n\u2502   app-frontend/terraform.tfstate \u2190 \u00c9quipe Dev Frontend          \u2502\n\u2502   app-backend/terraform.tfstate  \u2190 \u00c9quipe Dev Backend           \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Avantages :                                                \u2502\n\u2502   \u2022 Plans rapides (scope limit\u00e9)                                \u2502\n\u2502   \u2022 \u00c9quipes autonomes                                           \u2502\n\u2502   \u2022 Blast radius r\u00e9duit                                         \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#62-data-sources-pour-lier-les-states","title":"6.2 Data Sources pour Lier les States","text":"<pre><code># Dans le projet \"app\", r\u00e9f\u00e9rencer le VPC du projet \"network\"\n\n# Option 1 : Data source Terraform Remote State\ndata \"terraform_remote_state\" \"network\" {\n  backend = \"gcs\"\n  config = {\n    bucket = \"worldline-terraform-state\"\n    prefix = \"network\"\n  }\n}\n\nresource \"google_compute_instance\" \"app\" {\n  # ...\n  network_interface {\n    network    = data.terraform_remote_state.network.outputs.vpc_id\n    subnetwork = data.terraform_remote_state.network.outputs.subnet_id\n  }\n}\n\n# Option 2 : Data source GCP (plus d\u00e9coupl\u00e9)\ndata \"google_compute_network\" \"main\" {\n  name    = \"worldline-vpc\"\n  project = \"worldline-network\"\n}\n\nresource \"google_compute_instance\" \"app\" {\n  # ...\n  network_interface {\n    network = data.google_compute_network.main.id\n  }\n}\n</code></pre>"},{"location":"formations/terraform-ops/01-state-management/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi le state file est-il consid\u00e9r\u00e9 comme un secret ? <p>R\u00e9ponse :</p> <p>Le state file contient :</p> <ol> <li>Mots de passe : Root passwords de bases de donn\u00e9es en clair</li> <li>Cl\u00e9s SSH : Cl\u00e9s publiques (et parfois priv\u00e9es) des utilisateurs</li> <li>IPs et endpoints : Informations de r\u00e9seau internes</li> <li>Tokens et secrets : Tout attribut retourn\u00e9 par les APIs</li> </ol> <p>Ces informations permettraient \u00e0 un attaquant de : - Se connecter directement aux bases de donn\u00e9es - Cartographier l'infrastructure - Acc\u00e9der aux syst\u00e8mes via SSH</p> <p>Traitement : Chiffrement, acc\u00e8s restreint, jamais dans Git.</p> Question 2 : Que se passe-t-il si deux personnes lancent terraform apply simultan\u00e9ment sans locking ? <p>R\u00e9ponse :</p> <p>Race condition : Les deux processus :</p> <ol> <li>Lisent le m\u00eame state initial</li> <li>Calculent leurs changements ind\u00e9pendamment</li> <li>Appliquent leurs modifications</li> <li>\u00c9crivent le state final</li> </ol> <p>Le dernier \u00e0 \u00e9crire \u00e9crase les changements du premier.</p> <p>Cons\u00e9quences : - State corrompu (ne refl\u00e8te pas la r\u00e9alit\u00e9) - Ressources orphelines (existent mais pas dans le state) - <code>terraform destroy</code> incomplet - Reconstruction manuelle n\u00e9cessaire</p> Question 3 : Comment r\u00e9cup\u00e9rer un state perdu si le versioning GCS est activ\u00e9 ? <p>R\u00e9ponse :</p> <pre><code># 1. Lister les versions du state\ngsutil ls -a gs://worldline-terraform-state/prod/default.tfstate\n\n# 2. Identifier la version \u00e0 restaurer (par date)\n# Format: gs://bucket/object#generation\n\n# 3. Copier la version vers le state actuel\ngsutil cp \"gs://worldline-terraform-state/prod/default.tfstate#1706453245123456\" \\\n    gs://worldline-terraform-state/prod/default.tfstate\n\n# 4. V\u00e9rifier\nterraform state pull | jq '.serial'\n</code></pre> <p>C'est pourquoi le versioning GCS est obligatoire pour les buckets de state.</p>"},{"location":"formations/terraform-ops/01-state-management/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Maintenant que votre state est s\u00e9curis\u00e9 et partag\u00e9, apprenez \u00e0 structurer votre code Terraform pour le rendre maintenable.</p> <p>:octicons-arrow-right-24: Module 2 : Structure &amp; Modules</p> <p>Temps estim\u00e9 : 60 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/terraform-ops/02-modules-structure/","title":"Module 2 : Structure &amp; Modules","text":""},{"location":"formations/terraform-ops/02-modules-structure/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Organiser un projet Terraform de mani\u00e8re maintenable</li> <li>:material-check: Cr\u00e9er des modules r\u00e9utilisables</li> <li>:material-check: G\u00e9rer plusieurs environnements (dev, staging, prod)</li> <li>:material-check: Verrouiller les versions des providers et modules</li> </ul>"},{"location":"formations/terraform-ops/02-modules-structure/#1-le-probleme-le-fichier-monolithique","title":"1. Le Probl\u00e8me : Le Fichier Monolithique","text":""},{"location":"formations/terraform-ops/02-modules-structure/#11-lanti-pattern-du-maintf-geant","title":"1.1 L'Anti-Pattern du main.tf G\u00e9ant","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              L'ANTI-PATTERN : TOUT DANS main.tf                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   projet/                                                       \u2502\n\u2502   \u2514\u2500\u2500 main.tf (2847 lignes)                                     \u2502\n\u2502       \u2502                                                         \u2502\n\u2502       \u251c\u2500\u2500 Lines 1-150     : Variables                           \u2502\n\u2502       \u251c\u2500\u2500 Lines 151-400   : Provider config                     \u2502\n\u2502       \u251c\u2500\u2500 Lines 401-800   : VPC + Subnets + Firewall           \u2502\n\u2502       \u251c\u2500\u2500 Lines 801-1200  : GKE Cluster + Node Pools           \u2502\n\u2502       \u251c\u2500\u2500 Lines 1201-1600 : Cloud SQL + Users + DBs            \u2502\n\u2502       \u251c\u2500\u2500 Lines 1601-2000 : IAM Bindings                       \u2502\n\u2502       \u251c\u2500\u2500 Lines 2001-2400 : Pub/Sub + Cloud Functions          \u2502\n\u2502       \u2514\u2500\u2500 Lines 2401-2847 : Outputs                            \u2502\n\u2502                                                                 \u2502\n\u2502   PROBL\u00c8MES :                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   \u274c Impossible \u00e0 lire (scrolling infini)                       \u2502\n\u2502   \u274c Conflits Git constants (tout le monde touche le m\u00eame fichier)\u2502\n\u2502   \u274c Pas de r\u00e9utilisation (copier-coller entre projets)         \u2502\n\u2502   \u274c Difficile \u00e0 tester                                         \u2502\n\u2502   \u274c Blast radius maximum (un changement = tout re-plan)        \u2502\n\u2502   \u274c Onboarding cauchemardesque pour les nouveaux               \u2502\n\u2502                                                                 \u2502\n\u2502   \"Mais \u00e7a marchait bien au d\u00e9but...\"                           \u2502\n\u2502   Oui, jusqu'\u00e0 ce que le projet grandisse.                      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#12-les-signaux-dalerte","title":"1.2 Les Signaux d'Alerte","text":"<p>Votre code Terraform a besoin de refactoring si :</p> Signal Seuil Critique Taille de <code>main.tf</code> &gt; 500 lignes Temps de <code>terraform plan</code> &gt; 2 minutes Copier-coller entre projets Plus de 2 fois Conflits Git \u00c0 chaque PR Nouveaux d\u00e9veloppeurs \"Je ne comprends rien\""},{"location":"formations/terraform-ops/02-modules-structure/#2-la-solution-structure-modulaire","title":"2. La Solution : Structure Modulaire","text":""},{"location":"formations/terraform-ops/02-modules-structure/#21-structure-de-projet-recommandee","title":"2.1 Structure de Projet Recommand\u00e9e","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              STRUCTURE PROJET TERRAFORM WORLDLINE                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   terraform-infra/                                              \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 modules/                    # Briques r\u00e9utilisables       \u2502\n\u2502   \u2502   \u251c\u2500\u2500 vpc/                                                  \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 main.tf                                           \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 README.md                                         \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u251c\u2500\u2500 gke/                                                  \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 main.tf                                           \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 README.md                                         \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2514\u2500\u2500 cloudsql/                                             \u2502\n\u2502   \u2502       \u251c\u2500\u2500 main.tf                                           \u2502\n\u2502   \u2502       \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502       \u251c\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502       \u2514\u2500\u2500 README.md                                         \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 environments/               # D\u00e9ploiements par env        \u2502\n\u2502   \u2502   \u251c\u2500\u2500 dev/                                                  \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 main.tf             # Appelle les modules         \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 backend.tf          # Backend GCS (dev state)     \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars    # Valeurs dev                 \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u251c\u2500\u2500 staging/                                              \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 main.tf                                           \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 backend.tf          # Backend GCS (staging state) \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars                                  \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2514\u2500\u2500 prod/                                                 \u2502\n\u2502   \u2502       \u251c\u2500\u2500 main.tf                                           \u2502\n\u2502   \u2502       \u251c\u2500\u2500 backend.tf          # Backend GCS (prod state)    \u2502\n\u2502   \u2502       \u251c\u2500\u2500 variables.tf                                      \u2502\n\u2502   \u2502       \u251c\u2500\u2500 terraform.tfvars                                  \u2502\n\u2502   \u2502       \u2514\u2500\u2500 outputs.tf                                        \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 .gitignore                                                \u2502\n\u2502   \u251c\u2500\u2500 .terraform-version          # Version Terraform (tfenv)   \u2502\n\u2502   \u2514\u2500\u2500 README.md                                                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#22-conventions-de-fichiers","title":"2.2 Conventions de Fichiers","text":"Fichier Contenu Obligatoire <code>main.tf</code> Ressources et appels de modules Oui <code>variables.tf</code> D\u00e9claration des variables d'entr\u00e9e Oui <code>outputs.tf</code> Valeurs expos\u00e9es Oui <code>backend.tf</code> Configuration du remote state Oui (env) <code>providers.tf</code> Configuration des providers Oui <code>versions.tf</code> Contraintes de versions Recommand\u00e9 <code>locals.tf</code> Variables locales calcul\u00e9es Optionnel <code>data.tf</code> Data sources Optionnel"},{"location":"formations/terraform-ops/02-modules-structure/#3-creation-de-modules-reutilisables","title":"3. Cr\u00e9ation de Modules R\u00e9utilisables","text":""},{"location":"formations/terraform-ops/02-modules-structure/#31-anatomie-dun-module","title":"3.1 Anatomie d'un Module","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ANATOMIE D'UN MODULE TERRAFORM                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   modules/vpc/                                                  \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 main.tf         # Ressources du module                    \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  resource \"google_compute_network\" \"main\" {             \u2502\n\u2502   \u2502   \u2502    name                    = var.name                   \u2502\n\u2502   \u2502   \u2502    auto_create_subnetworks = false                      \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  resource \"google_compute_subnetwork\" \"subnets\" {       \u2502\n\u2502   \u2502   \u2502    for_each      = var.subnets                          \u2502\n\u2502   \u2502   \u2502    name          = each.key                             \u2502\n\u2502   \u2502   \u2502    ip_cidr_range = each.value.cidr                      \u2502\n\u2502   \u2502   \u2502    region        = each.value.region                    \u2502\n\u2502   \u2502   \u2502    network       = google_compute_network.main.id       \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 variables.tf    # Inputs (param\u00e8tres)                     \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  variable \"name\" {                                      \u2502\n\u2502   \u2502   \u2502    description = \"Nom du VPC\"                           \u2502\n\u2502   \u2502   \u2502    type        = string                                 \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  variable \"subnets\" {                                   \u2502\n\u2502   \u2502   \u2502    description = \"Map des subnets\"                      \u2502\n\u2502   \u2502   \u2502    type = map(object({                                  \u2502\n\u2502   \u2502   \u2502      cidr   = string                                    \u2502\n\u2502   \u2502   \u2502      region = string                                    \u2502\n\u2502   \u2502   \u2502    }))                                                  \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u251c\u2500\u2500 outputs.tf      # Outputs (valeurs expos\u00e9es)              \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  output \"network_id\" {                                  \u2502\n\u2502   \u2502   \u2502    description = \"ID du VPC\"                            \u2502\n\u2502   \u2502   \u2502    value       = google_compute_network.main.id         \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502   \u2502  output \"subnet_ids\" {                                  \u2502\n\u2502   \u2502   \u2502    description = \"Map des IDs de subnets\"               \u2502\n\u2502   \u2502   \u2502    value = {                                            \u2502\n\u2502   \u2502   \u2502      for k, v in google_compute_subnetwork.subnets :    \u2502\n\u2502   \u2502   \u2502      k =&gt; v.id                                          \u2502\n\u2502   \u2502   \u2502    }                                                    \u2502\n\u2502   \u2502   \u2502  }                                                      \u2502\n\u2502   \u2502   \u2502                                                         \u2502\n\u2502   \u2502                                                             \u2502\n\u2502   \u2514\u2500\u2500 README.md       # Documentation du module                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#32-exemple-complet-module-vpc","title":"3.2 Exemple Complet : Module VPC","text":"<p>modules/vpc/main.tf <pre><code># modules/vpc/main.tf\n\nresource \"google_compute_network\" \"main\" {\n  name                    = var.name\n  project                 = var.project_id\n  auto_create_subnetworks = false\n  routing_mode            = var.routing_mode\n  description             = var.description\n}\n\nresource \"google_compute_subnetwork\" \"subnets\" {\n  for_each = var.subnets\n\n  name                     = each.key\n  project                  = var.project_id\n  network                  = google_compute_network.main.id\n  ip_cidr_range           = each.value.cidr\n  region                  = each.value.region\n  private_ip_google_access = true\n\n  dynamic \"secondary_ip_range\" {\n    for_each = lookup(each.value, \"secondary_ranges\", {})\n    content {\n      range_name    = secondary_ip_range.key\n      ip_cidr_range = secondary_ip_range.value\n    }\n  }\n\n  dynamic \"log_config\" {\n    for_each = var.flow_logs_enabled ? [1] : []\n    content {\n      aggregation_interval = \"INTERVAL_5_SEC\"\n      flow_sampling        = 0.5\n      metadata             = \"INCLUDE_ALL_METADATA\"\n    }\n  }\n}\n\nresource \"google_compute_router\" \"router\" {\n  for_each = var.create_nat ? var.subnets : {}\n\n  name    = \"${each.key}-router\"\n  project = var.project_id\n  network = google_compute_network.main.id\n  region  = each.value.region\n}\n\nresource \"google_compute_router_nat\" \"nat\" {\n  for_each = var.create_nat ? var.subnets : {}\n\n  name                               = \"${each.key}-nat\"\n  project                            = var.project_id\n  router                             = google_compute_router.router[each.key].name\n  region                             = each.value.region\n  nat_ip_allocate_option            = \"AUTO_ONLY\"\n  source_subnetwork_ip_ranges_to_nat = \"ALL_SUBNETWORKS_ALL_IP_RANGES\"\n\n  log_config {\n    enable = true\n    filter = \"ERRORS_ONLY\"\n  }\n}\n</code></pre></p> <p>modules/vpc/variables.tf <pre><code># modules/vpc/variables.tf\n\nvariable \"project_id\" {\n  description = \"ID du projet GCP\"\n  type        = string\n}\n\nvariable \"name\" {\n  description = \"Nom du VPC\"\n  type        = string\n\n  validation {\n    condition     = can(regex(\"^[a-z][a-z0-9-]{0,62}$\", var.name))\n    error_message = \"Le nom du VPC doit respecter les conventions GCP.\"\n  }\n}\n\nvariable \"description\" {\n  description = \"Description du VPC\"\n  type        = string\n  default     = \"VPC cr\u00e9\u00e9 par Terraform\"\n}\n\nvariable \"routing_mode\" {\n  description = \"Mode de routage (REGIONAL ou GLOBAL)\"\n  type        = string\n  default     = \"GLOBAL\"\n\n  validation {\n    condition     = contains([\"REGIONAL\", \"GLOBAL\"], var.routing_mode)\n    error_message = \"routing_mode doit \u00eatre REGIONAL ou GLOBAL.\"\n  }\n}\n\nvariable \"subnets\" {\n  description = \"Map des subnets \u00e0 cr\u00e9er\"\n  type = map(object({\n    cidr             = string\n    region           = string\n    secondary_ranges = optional(map(string), {})\n  }))\n}\n\nvariable \"flow_logs_enabled\" {\n  description = \"Activer les Flow Logs VPC\"\n  type        = bool\n  default     = false\n}\n\nvariable \"create_nat\" {\n  description = \"Cr\u00e9er un Cloud NAT pour chaque subnet\"\n  type        = bool\n  default     = true\n}\n</code></pre></p> <p>modules/vpc/outputs.tf <pre><code># modules/vpc/outputs.tf\n\noutput \"network_id\" {\n  description = \"ID du VPC\"\n  value       = google_compute_network.main.id\n}\n\noutput \"network_name\" {\n  description = \"Nom du VPC\"\n  value       = google_compute_network.main.name\n}\n\noutput \"network_self_link\" {\n  description = \"Self-link du VPC\"\n  value       = google_compute_network.main.self_link\n}\n\noutput \"subnet_ids\" {\n  description = \"Map des IDs de subnets\"\n  value = {\n    for k, v in google_compute_subnetwork.subnets :\n    k =&gt; v.id\n  }\n}\n\noutput \"subnet_self_links\" {\n  description = \"Map des self-links de subnets\"\n  value = {\n    for k, v in google_compute_subnetwork.subnets :\n    k =&gt; v.self_link\n  }\n}\n\noutput \"nat_ips\" {\n  description = \"IPs NAT allou\u00e9es\"\n  value = {\n    for k, v in google_compute_router_nat.nat :\n    k =&gt; v.nat_ips\n  }\n}\n</code></pre></p>"},{"location":"formations/terraform-ops/02-modules-structure/#33-appel-du-module-depuis-un-environnement","title":"3.3 Appel du Module depuis un Environnement","text":"<p>environments/prod/main.tf <pre><code># environments/prod/main.tf\n\nterraform {\n  required_version = \"&gt;= 1.5.0\"\n\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \"~&gt; 5.0\"\n    }\n  }\n}\n\nprovider \"google\" {\n  project = var.project_id\n  region  = var.region\n}\n\n# Appel du module VPC\nmodule \"vpc\" {\n  source = \"../../modules/vpc\"\n\n  project_id  = var.project_id\n  name        = \"worldline-prod-vpc\"\n  description = \"VPC Production Worldline\"\n\n  subnets = {\n    \"prod-gke-subnet\" = {\n      cidr   = \"10.0.0.0/20\"\n      region = \"europe-west1\"\n      secondary_ranges = {\n        \"pods\"     = \"10.1.0.0/16\"\n        \"services\" = \"10.2.0.0/20\"\n      }\n    }\n    \"prod-db-subnet\" = {\n      cidr   = \"10.0.16.0/24\"\n      region = \"europe-west1\"\n    }\n  }\n\n  flow_logs_enabled = true\n  create_nat        = true\n}\n\n# Appel du module GKE (utilise les outputs du VPC)\nmodule \"gke\" {\n  source = \"../../modules/gke\"\n\n  project_id     = var.project_id\n  cluster_name   = \"worldline-prod-gke\"\n  region         = \"europe-west1\"\n  network_id     = module.vpc.network_id\n  subnet_id      = module.vpc.subnet_ids[\"prod-gke-subnet\"]\n  pods_range     = \"pods\"\n  services_range = \"services\"\n\n  # Configuration sp\u00e9cifique prod\n  node_count     = 3\n  machine_type   = \"e2-standard-4\"\n  enable_autopilot = false\n}\n\n# Appel du module Cloud SQL\nmodule \"cloudsql\" {\n  source = \"../../modules/cloudsql\"\n\n  project_id    = var.project_id\n  instance_name = \"worldline-prod-db\"\n  region        = \"europe-west1\"\n  network_id    = module.vpc.network_id\n\n  database_version = \"POSTGRES_15\"\n  tier             = \"db-custom-4-16384\"  # 4 vCPU, 16GB RAM\n\n  # HA pour la prod\n  availability_type = \"REGIONAL\"\n\n  databases = [\"app_db\", \"analytics_db\"]\n}\n</code></pre></p>"},{"location":"formations/terraform-ops/02-modules-structure/#4-gestion-des-versions","title":"4. Gestion des Versions","text":""},{"location":"formations/terraform-ops/02-modules-structure/#41-pourquoi-verrouiller-les-versions","title":"4.1 Pourquoi Verrouiller les Versions ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              LE DANGER DES VERSIONS FLOTTANTES                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Lundi :  Alice d\u00e9ploie avec google provider 5.0.0             \u2502\n\u2502            \u2192 terraform apply \u2705                                 \u2502\n\u2502                                                                 \u2502\n\u2502   Mardi :  HashiCorp publie google provider 5.1.0               \u2502\n\u2502            \u2192 Nouveau comportement sur les firewalls             \u2502\n\u2502                                                                 \u2502\n\u2502   Mercredi : Bob fait terraform init (t\u00e9l\u00e9charge 5.1.0)         \u2502\n\u2502              terraform plan                                     \u2502\n\u2502              \u2192 \"15 resources will be DESTROYED\"                 \u2502\n\u2502              \u2192 \ud83d\ude31                                               \u2502\n\u2502                                                                 \u2502\n\u2502   CAUSE : Pas de version pinning                                \u2502\n\u2502   SOLUTION : Verrouiller les versions explicitement             \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#42-version-constraints","title":"4.2 Version Constraints","text":"<p>versions.tf <pre><code># versions.tf\n\nterraform {\n  # Version Terraform minimale requise\n  required_version = \"&gt;= 1.5.0, &lt; 2.0.0\"\n\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \"~&gt; 5.0\"  # &gt;= 5.0.0, &lt; 6.0.0\n    }\n    google-beta = {\n      source  = \"hashicorp/google-beta\"\n      version = \"~&gt; 5.0\"\n    }\n    random = {\n      source  = \"hashicorp/random\"\n      version = \"&gt;= 3.0.0, &lt; 4.0.0\"\n    }\n  }\n}\n</code></pre></p> <p>Syntaxe des Contraintes :</p> Syntaxe Signification Exemple <code>= 5.0.0</code> Version exacte Uniquement 5.0.0 <code>&gt;= 5.0.0</code> Minimum 5.0.0, 5.1.0, 6.0.0... <code>~&gt; 5.0</code> Pessimistic (patch) &gt;= 5.0.0, &lt; 6.0.0 <code>~&gt; 5.0.0</code> Pessimistic (minor) &gt;= 5.0.0, &lt; 5.1.0 <code>&gt;= 5.0, &lt; 6.0</code> Range 5.x uniquement <p>Recommandation Worldline</p> <p>Utilisez <code>~&gt; X.0</code> pour les providers (permet les mises \u00e0 jour mineures).</p> <p>Utilisez des versions exactes pour les modules internes.</p>"},{"location":"formations/terraform-ops/02-modules-structure/#43-le-fichier-terraformlockhcl","title":"4.3 Le Fichier .terraform.lock.hcl","text":"<p>Terraform g\u00e9n\u00e8re automatiquement un fichier de lock :</p> <pre><code># .terraform.lock.hcl - DOIT \u00caTRE COMMIT\u00c9 DANS GIT\n\nprovider \"registry.terraform.io/hashicorp/google\" {\n  version     = \"5.12.0\"\n  constraints = \"~&gt; 5.0\"\n  hashes = [\n    \"h1:ABC123...\",\n    \"zh:DEF456...\",\n  ]\n}\n</code></pre> <pre><code># Mettre \u00e0 jour le lock file apr\u00e8s changement de version\nterraform init -upgrade\n\n# V\u00e9rifier l'int\u00e9grit\u00e9\nterraform providers lock -platform=linux_amd64 -platform=darwin_amd64\n</code></pre> <p>Commit le Lock File</p> <p>Le fichier <code>.terraform.lock.hcl</code> DOIT \u00eatre versionn\u00e9 dans Git.</p> <p>Il garantit que toute l'\u00e9quipe utilise exactement les m\u00eames versions de providers.</p>"},{"location":"formations/terraform-ops/02-modules-structure/#44-versionnement-des-modules","title":"4.4 Versionnement des Modules","text":"<p>Modules Locaux : <pre><code>module \"vpc\" {\n  source = \"../../modules/vpc\"  # Chemin relatif, pas de version\n}\n</code></pre></p> <p>Modules Git : <pre><code>module \"vpc\" {\n  source = \"git::https://github.com/worldline/terraform-modules.git//vpc?ref=v1.2.0\"\n}\n</code></pre></p> <p>Modules Registry (Terraform Cloud ou priv\u00e9) : <pre><code>module \"vpc\" {\n  source  = \"terraform-google-modules/network/google\"\n  version = \"~&gt; 7.0\"\n}\n</code></pre></p>"},{"location":"formations/terraform-ops/02-modules-structure/#5-bonnes-pratiques-de-structure","title":"5. Bonnes Pratiques de Structure","text":""},{"location":"formations/terraform-ops/02-modules-structure/#51-checklist-organisation","title":"5.1 Checklist Organisation","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST STRUCTURE TERRAFORM                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   FICHIERS                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2611 Un fichier par type (main, variables, outputs, etc.)        \u2502\n\u2502   \u2611 Modules dans un dossier d\u00e9di\u00e9 /modules                      \u2502\n\u2502   \u2611 Environnements s\u00e9par\u00e9s /environments/{dev,staging,prod}     \u2502\n\u2502   \u2611 README.md \u00e0 la racine et dans chaque module                 \u2502\n\u2502                                                                 \u2502\n\u2502   MODULES                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2611 Module = une responsabilit\u00e9 (VPC, GKE, SQL)                 \u2502\n\u2502   \u2611 Variables document\u00e9es (description obligatoire)             \u2502\n\u2502   \u2611 Validations sur les variables critiques                     \u2502\n\u2502   \u2611 Outputs pour tout ce qui peut \u00eatre r\u00e9f\u00e9renc\u00e9                \u2502\n\u2502                                                                 \u2502\n\u2502   VERSIONS                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2611 required_version dans tous les environnements               \u2502\n\u2502   \u2611 required_providers avec contraintes explicites              \u2502\n\u2502   \u2611 .terraform.lock.hcl commit\u00e9 dans Git                        \u2502\n\u2502   \u2611 Modules Git avec tags (pas de ref=main)                     \u2502\n\u2502                                                                 \u2502\n\u2502   NOMMAGE                                                       \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502   \u2611 Ressources : {projet}-{env}-{type} (worldline-prod-vpc)     \u2502\n\u2502   \u2611 Variables : snake_case (project_id, cluster_name)           \u2502\n\u2502   \u2611 Modules : snake_case (module \"gke_cluster\")                 \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#52-documentation-automatique-avec-terraform-docs","title":"5.2 Documentation Automatique avec terraform-docs","text":"<pre><code># Installer terraform-docs\nbrew install terraform-docs\n\n# G\u00e9n\u00e9rer la documentation d'un module\ncd modules/vpc\nterraform-docs markdown . &gt; README.md\n</code></pre> <p>Exemple de README g\u00e9n\u00e9r\u00e9 :</p> <pre><code># VPC Module\n\n## Inputs\n\n| Name | Description | Type | Default | Required |\n|------|-------------|------|---------|:--------:|\n| project_id | ID du projet GCP | `string` | n/a | yes |\n| name | Nom du VPC | `string` | n/a | yes |\n| subnets | Map des subnets | `map(object(...))` | n/a | yes |\n| flow_logs_enabled | Activer les Flow Logs | `bool` | `false` | no |\n\n## Outputs\n\n| Name | Description |\n|------|-------------|\n| network_id | ID du VPC |\n| subnet_ids | Map des IDs de subnets |\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#6-commandes-de-reference","title":"6. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === STRUCTURE ===\n# Valider la syntaxe de tous les fichiers\nterraform validate\n\n# Formater r\u00e9cursivement\nterraform fmt -recursive\n\n# V\u00e9rifier le formatage (CI/CD)\nterraform fmt -check -recursive\n\n# === MODULES ===\n# T\u00e9l\u00e9charger les modules\nterraform get\n\n# Mettre \u00e0 jour les modules\nterraform get -update\n\n# Voir le graphe de d\u00e9pendances\nterraform graph | dot -Tpng &gt; graph.png\n\n# === VERSIONS ===\n# Mettre \u00e0 jour les providers\nterraform init -upgrade\n\n# Verrouiller pour plusieurs plateformes\nterraform providers lock \\\n    -platform=linux_amd64 \\\n    -platform=darwin_amd64 \\\n    -platform=windows_amd64\n\n# === DOCUMENTATION ===\n# G\u00e9n\u00e9rer la doc d'un module\nterraform-docs markdown table . &gt; README.md\n\n# G\u00e9n\u00e9rer avec template custom\nterraform-docs markdown table --output-file README.md .\n</code></pre>"},{"location":"formations/terraform-ops/02-modules-structure/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi s\u00e9parer les modules des environnements ? <p>R\u00e9ponse :</p> <p>La s\u00e9paration modules/environnements applique le principe DRY (Don't Repeat Yourself) :</p> <ol> <li>Modules : Code r\u00e9utilisable, test\u00e9, versionn\u00e9</li> <li>Environnements : Configuration sp\u00e9cifique (tailles, nombres, options)</li> </ol> <p>Avantages : - Un bug corrig\u00e9 dans un module b\u00e9n\u00e9ficie \u00e0 tous les environnements - Coh\u00e9rence entre dev/staging/prod - Review de code centralis\u00e9e sur les modules - Tests unitaires possibles sur les modules</p> Question 2 : Que signifie la contrainte <code>~&gt; 5.0</code> ? <p>R\u00e9ponse :</p> <p><code>~&gt; 5.0</code> est une contrainte pessimistic qui signifie :</p> <ul> <li>Minimum : <code>&gt;= 5.0.0</code></li> <li>Maximum : <code>&lt; 6.0.0</code></li> </ul> <p>Donc versions accept\u00e9es : 5.0.0, 5.0.1, 5.1.0, 5.99.99...</p> <p>Diff\u00e9rence avec <code>~&gt; 5.0.0</code> : - <code>~&gt; 5.0.0</code> = <code>&gt;= 5.0.0, &lt; 5.1.0</code> (plus restrictif)</p> Question 3 : Le fichier .terraform.lock.hcl doit-il \u00eatre commit\u00e9 ? <p>R\u00e9ponse :</p> <p>OUI, absolument.</p> <p>Ce fichier contient : - Les versions exactes des providers t\u00e9l\u00e9charg\u00e9s - Les checksums (hashes) pour v\u00e9rification d'int\u00e9grit\u00e9</p> <p>Si non commit\u00e9 : - Chaque d\u00e9veloppeur peut avoir des versions diff\u00e9rentes - Les builds CI/CD ne sont pas reproductibles - Risque de r\u00e9gressions silencieuses</p> <p>R\u00e8gle : Toujours commit <code>.terraform.lock.hcl</code>, jamais commit <code>.terraform/</code>.</p>"},{"location":"formations/terraform-ops/02-modules-structure/#prochaine-etape","title":"Prochaine \u00c9tape","text":"<p>Votre code est maintenant structur\u00e9. Apprenez \u00e0 g\u00e9rer les secrets de mani\u00e8re s\u00e9curis\u00e9e.</p> <p>:octicons-arrow-right-24: Module 3 : Secrets &amp; Variables</p> <p>Temps estim\u00e9 : 75 minutes Niveau : Interm\u00e9diaire</p>"},{"location":"formations/terraform-ops/03-secrets-and-vars/","title":"Module 3 : Secrets &amp; Variables","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#objectifs-du-module","title":"Objectifs du Module","text":"<p>\u00c0 l'issue de ce module, vous serez capable de :</p> <ul> <li>:material-check: Distinguer variables sensibles et non-sensibles</li> <li>:material-check: Utiliser les fichiers <code>.tfvars</code> de mani\u00e8re s\u00e9curis\u00e9e</li> <li>:material-check: Injecter des secrets via variables d'environnement (<code>TF_VAR_*</code>)</li> <li>:material-check: Int\u00e9grer GCP Secret Manager avec Terraform</li> </ul>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#1-variables-terraform-les-bases","title":"1. Variables Terraform : Les Bases","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#11-declaration-de-variables","title":"1.1 D\u00e9claration de Variables","text":"<pre><code># variables.tf\n\n# Variable simple avec valeur par d\u00e9faut\nvariable \"region\" {\n  description = \"R\u00e9gion GCP de d\u00e9ploiement\"\n  type        = string\n  default     = \"europe-west1\"\n}\n\n# Variable obligatoire (pas de default)\nvariable \"project_id\" {\n  description = \"ID du projet GCP\"\n  type        = string\n}\n\n# Variable avec validation\nvariable \"environment\" {\n  description = \"Environnement de d\u00e9ploiement\"\n  type        = string\n\n  validation {\n    condition     = contains([\"dev\", \"staging\", \"prod\"], var.environment)\n    error_message = \"L'environnement doit \u00eatre dev, staging ou prod.\"\n  }\n}\n\n# Variable sensible (masqu\u00e9e dans les logs)\nvariable \"db_password\" {\n  description = \"Mot de passe de la base de donn\u00e9es\"\n  type        = string\n  sensitive   = true\n}\n\n# Variable complexe (object)\nvariable \"gke_config\" {\n  description = \"Configuration du cluster GKE\"\n  type = object({\n    node_count   = number\n    machine_type = string\n    disk_size_gb = number\n    preemptible  = bool\n  })\n  default = {\n    node_count   = 3\n    machine_type = \"e2-standard-2\"\n    disk_size_gb = 100\n    preemptible  = false\n  }\n}\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#12-ordre-de-precedence-des-variables","title":"1.2 Ordre de Pr\u00e9c\u00e9dence des Variables","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ORDRE DE PR\u00c9C\u00c9DENCE DES VARIABLES                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   Priorit\u00e9 BASSE \u2192 HAUTE                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                       \u2502\n\u2502                                                                 \u2502\n\u2502   1. default dans variable \"xxx\" { default = \"...\" }            \u2502\n\u2502      \u2514\u2500 Valeur par d\u00e9faut si rien d'autre                       \u2502\n\u2502                                                                 \u2502\n\u2502   2. terraform.tfvars (charg\u00e9 automatiquement)                  \u2502\n\u2502      \u2514\u2500 Fichier par d\u00e9faut dans le r\u00e9pertoire courant           \u2502\n\u2502                                                                 \u2502\n\u2502   3. *.auto.tfvars (charg\u00e9 automatiquement, ordre alphab\u00e9tique) \u2502\n\u2502      \u2514\u2500 01-network.auto.tfvars, 02-gke.auto.tfvars              \u2502\n\u2502                                                                 \u2502\n\u2502   4. -var-file=\"custom.tfvars\" (ligne de commande)              \u2502\n\u2502      \u2514\u2500 terraform apply -var-file=\"prod.tfvars\"                 \u2502\n\u2502                                                                 \u2502\n\u2502   5. TF_VAR_xxx (variable d'environnement)                      \u2502\n\u2502      \u2514\u2500 export TF_VAR_db_password=\"secret\"                      \u2502\n\u2502                                                                 \u2502\n\u2502   6. -var=\"xxx=value\" (ligne de commande)                       \u2502\n\u2502      \u2514\u2500 terraform apply -var=\"region=europe-west1\"              \u2502\n\u2502                                                                 \u2502\n\u2502   \u26a0\ufe0f  Le DERNIER gagne (\u00e9crase les pr\u00e9c\u00e9dents)                  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#2-la-regle-dor-separer-sensible-et-non-sensible","title":"2. La R\u00e8gle d'Or : S\u00e9parer Sensible et Non-Sensible","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#21-classification-des-variables","title":"2.1 Classification des Variables","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CLASSIFICATION DES VARIABLES                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   NON-SENSIBLE (peut \u00eatre commit\u00e9 dans Git)                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                    \u2502\n\u2502   \u2022 project_id          (visible dans GCP Console)              \u2502\n\u2502   \u2022 region              (publique)                              \u2502\n\u2502   \u2022 environment         (dev/staging/prod)                      \u2502\n\u2502   \u2022 machine_type        (configuration)                         \u2502\n\u2502   \u2022 node_count          (sizing)                                \u2502\n\u2502   \u2022 network_name        (publique)                              \u2502\n\u2502   \u2022 labels/tags         (m\u00e9tadonn\u00e9es)                           \u2502\n\u2502                                                                 \u2502\n\u2502   SENSIBLE (NE JAMAIS COMMITER)                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                 \u2502\n\u2502   \u2022 db_password         (acc\u00e8s direct \u00e0 la DB)                  \u2502\n\u2502   \u2022 api_keys            (acc\u00e8s aux services)                    \u2502\n\u2502   \u2022 private_keys        (authentification)                      \u2502\n\u2502   \u2022 service_account_key (JSON key - \u00e0 \u00e9viter)                   \u2502\n\u2502   \u2022 oauth_client_secret (authentification)                      \u2502\n\u2502   \u2022 encryption_keys     (chiffrement)                           \u2502\n\u2502   \u2022 tokens              (acc\u00e8s temporaire)                      \u2502\n\u2502                                                                 \u2502\n\u2502   R\u00c8GLE : Si la valeur permet d'acc\u00e9der \u00e0 quelque chose,        \u2502\n\u2502           c'est SENSIBLE.                                       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#22-organisation-des-fichiers-tfvars","title":"2.2 Organisation des Fichiers .tfvars","text":"<pre><code>environments/prod/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u251c\u2500\u2500 backend.tf\n\u2502\n\u251c\u2500\u2500 terraform.tfvars        # \u274c \u00c0 \u00e9viter (ambigu)\n\u2502\n\u251c\u2500\u2500 config.auto.tfvars      # \u2705 Non-sensible (commit\u00e9)\n\u2502   \u2502\n\u2502   \u2502  # config.auto.tfvars - PEUT \u00caTRE COMMIT\u00c9\n\u2502   \u2502  project_id   = \"worldline-prod\"\n\u2502   \u2502  region       = \"europe-west1\"\n\u2502   \u2502  environment  = \"prod\"\n\u2502   \u2502  gke_node_count = 5\n\u2502   \u2502\n\u2502\n\u2514\u2500\u2500 secrets.tfvars          # \u274c JAMAIS COMMIT\u00c9 (.gitignore)\n    \u2502\n    \u2502  # secrets.tfvars - JAMAIS DANS GIT\n    \u2502  db_password      = \"SuperSecret123!\"\n    \u2502  api_key          = \"sk-live-xxx...\"\n    \u2502\n</code></pre> <p>.gitignore : <pre><code># Terraform secrets - NEVER COMMIT\nsecrets.tfvars\n*.secrets.tfvars\nterraform.tfvars  # Par pr\u00e9caution\n\n# Exceptions explicites si besoin\n!config.auto.tfvars\n</code></pre></p>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#3-variables-denvironnement-tf_var_","title":"3. Variables d'Environnement : TF_VAR_*","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#31-concept","title":"3.1 Concept","text":"<p>Terraform lit automatiquement les variables d'environnement pr\u00e9fix\u00e9es par <code>TF_VAR_</code> :</p> <pre><code># Variable: db_password\nexport TF_VAR_db_password=\"SuperSecret123!\"\n\n# Variable: api_key\nexport TF_VAR_api_key=\"sk-live-xxx...\"\n\n# Terraform les utilise automatiquement\nterraform apply\n# \u2192 Pas besoin de -var ou -var-file pour ces variables\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#32-avantages-pour-la-cicd","title":"3.2 Avantages pour la CI/CD","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              INJECTION DE SECRETS EN CI/CD                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    GitLab CI/CD                         \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   Settings &gt; CI/CD &gt; Variables                          \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502   \u2502\n\u2502   \u2502   \u2502 Key: TF_VAR_db_password                       \u2502     \u2502   \u2502\n\u2502   \u2502   \u2502 Value: \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022                         \u2502     \u2502   \u2502\n\u2502   \u2502   \u2502 [x] Masked                                    \u2502     \u2502   \u2502\n\u2502   \u2502   \u2502 [x] Protected (main branch only)              \u2502     \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                       \u2502\n\u2502                         \u25bc                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    Pipeline Job                         \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   script:                                               \u2502   \u2502\n\u2502   \u2502     - terraform init                                    \u2502   \u2502\n\u2502   \u2502     - terraform plan -out=tfplan                        \u2502   \u2502\n\u2502   \u2502     - terraform apply tfplan                            \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502   # TF_VAR_db_password est automatiquement inject\u00e9      \u2502   \u2502\n\u2502   \u2502   # par GitLab dans l'environnement du runner           \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Secrets jamais dans le code                                \u2502\n\u2502   \u2705 Secrets jamais dans les logs (masked)                      \u2502\n\u2502   \u2705 Secrets prot\u00e9g\u00e9s (branches prot\u00e9g\u00e9es uniquement)           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#33-exemple-gitlab-ci","title":"3.3 Exemple GitLab CI","text":"<pre><code># .gitlab-ci.yml\n\nstages:\n  - validate\n  - plan\n  - apply\n\nvariables:\n  TF_ROOT: environments/prod\n  TF_STATE_NAME: prod\n\n.terraform_base:\n  image: hashicorp/terraform:1.6\n  before_script:\n    - cd $TF_ROOT\n    - terraform init -backend-config=\"prefix=$TF_STATE_NAME\"\n\nvalidate:\n  extends: .terraform_base\n  stage: validate\n  script:\n    - terraform validate\n    - terraform fmt -check\n\nplan:\n  extends: .terraform_base\n  stage: plan\n  script:\n    - terraform plan -out=tfplan\n  artifacts:\n    paths:\n      - $TF_ROOT/tfplan\n    expire_in: 1 week\n\napply:\n  extends: .terraform_base\n  stage: apply\n  script:\n    - terraform apply -auto-approve tfplan\n  dependencies:\n    - plan\n  when: manual  # Approbation manuelle requise\n  only:\n    - main\n  environment:\n    name: production\n\n# Les variables TF_VAR_* sont configur\u00e9es dans\n# Settings &gt; CI/CD &gt; Variables (protected + masked)\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#34-script-local-securise","title":"3.4 Script Local S\u00e9curis\u00e9","text":"<pre><code>#!/bin/bash\n# deploy.sh - Script de d\u00e9ploiement local s\u00e9curis\u00e9\n\nset -euo pipefail\n\n# Charger les secrets depuis un fichier local (non commit\u00e9)\nif [[ -f \".secrets.env\" ]]; then\n    # shellcheck disable=SC1091\n    source .secrets.env\nelse\n    echo \"ERROR: .secrets.env not found\"\n    echo \"Create it from .secrets.env.example\"\n    exit 1\nfi\n\n# V\u00e9rifier que les variables requises sont d\u00e9finies\nrequired_vars=(\n    \"TF_VAR_db_password\"\n    \"TF_VAR_api_key\"\n)\n\nfor var in \"${required_vars[@]}\"; do\n    if [[ -z \"${!var:-}\" ]]; then\n        echo \"ERROR: $var is not set\"\n        exit 1\n    fi\ndone\n\n# Ex\u00e9cuter Terraform\ncd environments/prod\nterraform init\nterraform plan -out=tfplan\nterraform apply tfplan\n</code></pre> <p>.secrets.env (non commit\u00e9) : <pre><code># .secrets.env - JAMAIS DANS GIT\nexport TF_VAR_db_password=\"SuperSecret123!\"\nexport TF_VAR_api_key=\"sk-live-xxx...\"\n</code></pre></p> <p>.secrets.env.example (commit\u00e9) : <pre><code># .secrets.env.example - Template pour les d\u00e9veloppeurs\n# Copier ce fichier vers .secrets.env et remplir les valeurs\nexport TF_VAR_db_password=\"\"\nexport TF_VAR_api_key=\"\"\n</code></pre></p>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#4-integration-avec-gcp-secret-manager","title":"4. Int\u00e9gration avec GCP Secret Manager","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#41-pourquoi-secret-manager","title":"4.1 Pourquoi Secret Manager ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              VARIABLES D'ENV vs SECRET MANAGER                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   VARIABLES D'ENVIRONNEMENT (TF_VAR_*)                          \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2502\n\u2502   \u2705 Simple \u00e0 configurer                                        \u2502\n\u2502   \u2705 Support\u00e9 par toutes les CI/CD                              \u2502\n\u2502   \u274c Rotation manuelle                                          \u2502\n\u2502   \u274c Pas d'audit centralis\u00e9                                     \u2502\n\u2502   \u274c Duplication si plusieurs pipelines                         \u2502\n\u2502                                                                 \u2502\n\u2502   GCP SECRET MANAGER                                            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                            \u2502\n\u2502   \u2705 Rotation automatique possible                              \u2502\n\u2502   \u2705 Audit centralis\u00e9 (Cloud Audit Logs)                        \u2502\n\u2502   \u2705 Versionnement des secrets                                  \u2502\n\u2502   \u2705 IAM granulaire (qui peut lire quel secret)                 \u2502\n\u2502   \u2705 Source unique de v\u00e9rit\u00e9                                    \u2502\n\u2502   \u274c Plus complexe \u00e0 configurer                                 \u2502\n\u2502   \u274c D\u00e9pendance GCP                                             \u2502\n\u2502                                                                 \u2502\n\u2502   RECOMMANDATION :                                              \u2502\n\u2502   \u2022 Secrets \"infrastructure\" \u2192 TF_VAR_* (simples, un par env)   \u2502\n\u2502   \u2022 Secrets \"application\" \u2192 Secret Manager (partag\u00e9s, rot\u00e9s)    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#42-creer-des-secrets-dans-secret-manager","title":"4.2 Cr\u00e9er des Secrets dans Secret Manager","text":"<pre><code># Cr\u00e9er un secret\necho -n \"SuperSecret123!\" | gcloud secrets create db-password \\\n    --project=worldline-prod \\\n    --replication-policy=\"user-managed\" \\\n    --locations=\"europe-west1,europe-west4\" \\\n    --data-file=-\n\n# Ajouter une nouvelle version\necho -n \"NewPassword456!\" | gcloud secrets versions add db-password \\\n    --project=worldline-prod \\\n    --data-file=-\n\n# Lister les versions\ngcloud secrets versions list db-password --project=worldline-prod\n\n# Acc\u00e9der \u00e0 un secret\ngcloud secrets versions access latest --secret=db-password --project=worldline-prod\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#43-lire-un-secret-avec-data-source","title":"4.3 Lire un Secret avec Data Source","text":"<pre><code># data.tf\n\n# Lire un secret depuis Secret Manager\ndata \"google_secret_manager_secret_version\" \"db_password\" {\n  project = var.project_id\n  secret  = \"db-password\"\n  version = \"latest\"  # Ou un num\u00e9ro de version sp\u00e9cifique\n}\n\n# Utilisation dans une ressource\nresource \"google_sql_user\" \"app_user\" {\n  project  = var.project_id\n  instance = google_sql_database_instance.main.name\n  name     = \"app\"\n  password = data.google_secret_manager_secret_version.db_password.secret_data\n}\n</code></pre> <p>Attention au State</p> <p>M\u00eame en utilisant Secret Manager, le secret sera stock\u00e9 dans le state Terraform apr\u00e8s le <code>terraform apply</code>.</p> <p>C'est pourquoi le state doit toujours \u00eatre prot\u00e9g\u00e9 (remote backend, chiffrement, IAM).</p>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#44-creer-des-secrets-avec-terraform","title":"4.4 Cr\u00e9er des Secrets avec Terraform","text":"<pre><code># Cr\u00e9er un secret (le conteneur)\nresource \"google_secret_manager_secret\" \"db_password\" {\n  project   = var.project_id\n  secret_id = \"db-password\"\n\n  replication {\n    user_managed {\n      replicas {\n        location = \"europe-west1\"\n      }\n      replicas {\n        location = \"europe-west4\"\n      }\n    }\n  }\n\n  labels = {\n    environment = var.environment\n    managed_by  = \"terraform\"\n  }\n}\n\n# Cr\u00e9er une version du secret (la valeur)\nresource \"google_secret_manager_secret_version\" \"db_password_v1\" {\n  secret      = google_secret_manager_secret.db_password.id\n  secret_data = var.db_password  # Vient de TF_VAR_db_password\n\n  # Ne pas recr\u00e9er si la valeur n'a pas chang\u00e9\n  lifecycle {\n    ignore_changes = [secret_data]\n  }\n}\n\n# Donner acc\u00e8s \u00e0 un service account\nresource \"google_secret_manager_secret_iam_member\" \"app_access\" {\n  project   = var.project_id\n  secret_id = google_secret_manager_secret.db_password.secret_id\n  role      = \"roles/secretmanager.secretAccessor\"\n  member    = \"serviceAccount:${google_service_account.app.email}\"\n}\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#45-pattern-complet-generation-et-stockage","title":"4.5 Pattern Complet : G\u00e9n\u00e9ration et Stockage","text":"<pre><code># G\u00e9n\u00e9rer un mot de passe al\u00e9atoire\nresource \"random_password\" \"db_password\" {\n  length           = 32\n  special          = true\n  override_special = \"!#$%&amp;*()-_=+[]{}&lt;&gt;:?\"\n}\n\n# Stocker dans Secret Manager\nresource \"google_secret_manager_secret\" \"db_password\" {\n  project   = var.project_id\n  secret_id = \"${var.environment}-db-password\"\n\n  replication {\n    auto {}\n  }\n}\n\nresource \"google_secret_manager_secret_version\" \"db_password\" {\n  secret      = google_secret_manager_secret.db_password.id\n  secret_data = random_password.db_password.result\n}\n\n# Utiliser le secret dans Cloud SQL\nresource \"google_sql_user\" \"app\" {\n  project  = var.project_id\n  instance = google_sql_database_instance.main.name\n  name     = \"app\"\n  password = random_password.db_password.result\n}\n\n# Output pour r\u00e9f\u00e9rence (ne sera pas affich\u00e9 car sensible)\noutput \"db_password_secret_id\" {\n  description = \"ID du secret dans Secret Manager\"\n  value       = google_secret_manager_secret.db_password.id\n}\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#5-variables-sensibles-bonnes-pratiques","title":"5. Variables Sensibles : Bonnes Pratiques","text":""},{"location":"formations/terraform-ops/03-secrets-and-vars/#51-marquer-les-variables-comme-sensibles","title":"5.1 Marquer les Variables comme Sensibles","text":"<pre><code>variable \"db_password\" {\n  description = \"Mot de passe de la base de donn\u00e9es\"\n  type        = string\n  sensitive   = true  # \u2190 CRUCIAL\n}\n\nvariable \"api_key\" {\n  description = \"Cl\u00e9 API du service externe\"\n  type        = string\n  sensitive   = true\n}\n</code></pre> <p>Effet de <code>sensitive = true</code> :</p> <pre><code>$ terraform plan\n\n# Sans sensitive = true :\n+ resource \"google_sql_user\" \"app\" {\n    + password = \"SuperSecret123!\"  # \u274c Visible !\n  }\n\n# Avec sensitive = true :\n+ resource \"google_sql_user\" \"app\" {\n    + password = (sensitive value)  # \u2705 Masqu\u00e9\n  }\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#52-outputs-sensibles","title":"5.2 Outputs Sensibles","text":"<pre><code>output \"db_connection_string\" {\n  description = \"Cha\u00eene de connexion \u00e0 la DB\"\n  value       = \"postgres://app:${random_password.db.result}@${google_sql_database_instance.main.private_ip_address}/appdb\"\n  sensitive   = true  # \u2190 Ne sera pas affich\u00e9 dans les logs\n}\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#53-eviter-les-fuites-dans-les-logs","title":"5.3 \u00c9viter les Fuites dans les Logs","text":"<pre><code># \u274c MAUVAIS : Le secret peut appara\u00eetre dans les logs\nresource \"null_resource\" \"debug\" {\n  provisioner \"local-exec\" {\n    command = \"echo Password is: ${var.db_password}\"\n  }\n}\n\n# \u274c MAUVAIS : Le secret est dans un fichier\nresource \"local_file\" \"config\" {\n  content  = \"password=${var.db_password}\"\n  filename = \"config.txt\"\n}\n\n# \u2705 BON : Utiliser Secret Manager dans l'application\nresource \"google_secret_manager_secret_version\" \"db_password\" {\n  secret      = google_secret_manager_secret.db_password.id\n  secret_data = var.db_password\n}\n# L'application lit le secret via l'API Secret Manager\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#6-checklist-securite-des-variables","title":"6. Checklist S\u00e9curit\u00e9 des Variables","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST S\u00c9CURIT\u00c9 DES VARIABLES                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   FICHIERS                                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502   \u2611 terraform.tfvars dans .gitignore                            \u2502\n\u2502   \u2611 secrets.tfvars dans .gitignore                              \u2502\n\u2502   \u2611 *.auto.tfvars pour config non-sensible uniquement           \u2502\n\u2502   \u2611 .secrets.env.example fourni (template)                      \u2502\n\u2502                                                                 \u2502\n\u2502   VARIABLES                                                     \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502   \u2611 sensitive = true sur toutes les variables sensibles         \u2502\n\u2502   \u2611 description sur chaque variable                             \u2502\n\u2502   \u2611 validation sur les variables critiques                      \u2502\n\u2502   \u2611 Pas de default pour les secrets                             \u2502\n\u2502                                                                 \u2502\n\u2502   CI/CD                                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500                                                         \u2502\n\u2502   \u2611 Secrets en variables CI (masked + protected)                \u2502\n\u2502   \u2611 Prefix TF_VAR_ pour injection automatique                   \u2502\n\u2502   \u2611 Pas de secrets dans les scripts ou Dockerfiles              \u2502\n\u2502   \u2611 Logs sans secrets (v\u00e9rifier terraform plan output)          \u2502\n\u2502                                                                 \u2502\n\u2502   SECRET MANAGER                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502   \u2611 Secrets applicatifs dans Secret Manager                     \u2502\n\u2502   \u2611 IAM restrictif (least privilege)                            \u2502\n\u2502   \u2611 Rotation planifi\u00e9e pour les secrets critiques               \u2502\n\u2502   \u2611 Audit logs activ\u00e9s                                          \u2502\n\u2502                                                                 \u2502\n\u2502   STATE                                                         \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500                                                         \u2502\n\u2502   \u2611 Remote backend obligatoire                                  \u2502\n\u2502   \u2611 Chiffrement at-rest                                         \u2502\n\u2502   \u2611 IAM restrictif sur le bucket                                \u2502\n\u2502   \u2611 Versioning activ\u00e9                                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#7-commandes-de-reference","title":"7. Commandes de R\u00e9f\u00e9rence","text":"<pre><code># === VARIABLES ===\n# Voir les variables requises\nterraform console\n&gt; var.project_id  # Error si non d\u00e9finie\n\n# Passer une variable en ligne de commande\nterraform plan -var=\"environment=dev\"\n\n# Utiliser un fichier de variables sp\u00e9cifique\nterraform plan -var-file=\"prod.tfvars\"\n\n# === VARIABLES D'ENVIRONNEMENT ===\n# D\u00e9finir une variable\nexport TF_VAR_db_password=\"secret\"\n\n# V\u00e9rifier qu'elle est d\u00e9finie\necho $TF_VAR_db_password\n\n# Lister toutes les TF_VAR_*\nenv | grep TF_VAR_\n\n# === SECRET MANAGER ===\n# Cr\u00e9er un secret\necho -n \"password\" | gcloud secrets create my-secret --data-file=-\n\n# Lire un secret\ngcloud secrets versions access latest --secret=my-secret\n\n# Lister les secrets\ngcloud secrets list\n\n# Donner acc\u00e8s \u00e0 un service account\ngcloud secrets add-iam-policy-binding my-secret \\\n    --member=\"serviceAccount:app@project.iam.gserviceaccount.com\" \\\n    --role=\"roles/secretmanager.secretAccessor\"\n\n# === DEBUG ===\n# V\u00e9rifier la valeur d'une variable (avec pr\u00e9caution)\nterraform console\n&gt; var.region\n\"europe-west1\"\n\n# Voir le plan sans appliquer\nterraform plan -out=tfplan\n\n# Inspecter le plan\nterraform show tfplan\n</code></pre>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#quiz-dauto-evaluation","title":"Quiz d'Auto-\u00c9valuation","text":"Question 1 : Pourquoi ne pas commiter terraform.tfvars ? <p>R\u00e9ponse :</p> <p>Le fichier <code>terraform.tfvars</code> est automatiquement charg\u00e9 par Terraform. Si des secrets y sont stock\u00e9s :</p> <ol> <li>Ils seront dans l'historique Git pour toujours</li> <li>M\u00eame apr\u00e8s suppression du fichier, ils restent dans <code>git log</code></li> <li>Tout clone du repo expose les secrets</li> <li>Les secrets peuvent fuiter via des forks publics</li> </ol> <p>Solution : - Utiliser <code>*.auto.tfvars</code> pour les configs non-sensibles - Utiliser <code>TF_VAR_*</code> pour les secrets - Ajouter <code>terraform.tfvars</code> dans <code>.gitignore</code> par pr\u00e9caution</p> Question 2 : Quelle est la diff\u00e9rence entre TF_VAR_* et Secret Manager ? <p>R\u00e9ponse :</p> Aspect TF_VAR_* Secret Manager Scope Pipeline/Environnement Application/Organisation Rotation Manuelle Automatisable Audit Logs CI/CD Cloud Audit Logs Versioning Non Oui Acc\u00e8s runtime Non (build-time) Oui (runtime) <p>Quand utiliser quoi : - TF_VAR_ : Secrets Terraform (mots de passe initiaux, API keys pour providers) - Secret Manager* : Secrets applicatifs (acc\u00e9d\u00e9s par les pods/VMs au runtime)</p> Question 3 : Le secret est-il en s\u00e9curit\u00e9 s'il est dans Secret Manager ? <p>R\u00e9ponse :</p> <p>Partiellement. Le secret est s\u00e9curis\u00e9 dans Secret Manager, mais :</p> <ol> <li>Le state Terraform contient le secret apr\u00e8s <code>apply</code></li> <li>Les data sources ram\u00e8nent le secret dans le state</li> <li>Le plan peut afficher le secret (d'o\u00f9 <code>sensitive = true</code>)</li> </ol> <p>Mitigation : - State chiffr\u00e9 et acc\u00e8s restreint - Variables marqu\u00e9es <code>sensitive = true</code> - G\u00e9n\u00e9rer les secrets avec <code>random_password</code> + stockage dans Secret Manager - L'application lit depuis Secret Manager (pas depuis le state)</p>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#conclusion-de-la-formation","title":"Conclusion de la Formation","text":"<p>Vous ma\u00eetrisez maintenant les fondamentaux de Terraform en production :</p> <ul> <li>Module 1 : State Management (Remote Backend, Locking)</li> <li>Module 2 : Structure &amp; Modules (DRY, Versioning)</li> <li>Module 3 : Secrets &amp; Variables (TF_VAR_*, Secret Manager)</li> </ul>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#prochaines-etapes-recommandees","title":"Prochaines \u00c9tapes Recommand\u00e9es","text":"<ol> <li>Impl\u00e9menter un Remote Backend sur votre projet existant</li> <li>Refactorer en modules un code monolithique</li> <li>Migrer les secrets vers des variables d'environnement CI/CD</li> <li>Explorer : Terratest, Atlantis, Terraform Cloud</li> </ol>"},{"location":"formations/terraform-ops/03-secrets-and-vars/#ressources-complementaires","title":"Ressources Compl\u00e9mentaires","text":"<ul> <li>:material-link: Terraform Best Practices</li> <li>:material-link: Google Cloud Provider</li> <li>:material-link: Terraform Security</li> </ul> <p>Temps estim\u00e9 : 60 minutes Niveau : Avanc\u00e9</p>"},{"location":"formations/windows/active-directory/","title":"Architecture Active Directory - Mod\u00e8le Red Forest","text":"<p>Infrastructure Critique - Tier 0</p> <p>Ce document d\u00e9crit l'architecture AD de production bas\u00e9e sur le mod\u00e8le Red Forest (Enhanced Security Admin Environment - ESAE).</p> <p>Toute modification sur ces composants n\u00e9cessite un Change Approval.</p>"},{"location":"formations/windows/active-directory/#vue-densemble-de-larchitecture","title":"Vue d'Ensemble de l'Architecture","text":""},{"location":"formations/windows/active-directory/#le-modele-red-forest","title":"Le Mod\u00e8le Red Forest","text":"<p>Le Red Forest (ou ESAE) est une architecture de s\u00e9curit\u00e9 Microsoft o\u00f9 l'administration des ressources est isol\u00e9e dans une for\u00eat d\u00e9di\u00e9e, s\u00e9par\u00e9e des utilisateurs et ressources de production.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE RED FOREST - SHELLBOOK                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   FOR\u00caT ADMIN (Tier 0)              FOR\u00caT CORP (Production)    \u2502\n\u2502   \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550              \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550     \u2502\n\u2502   admin.shellbook.local             corp.shellbook.local        \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502   srv-dc-admin-01   \u2502          \u2502   srv-dc-corp-01    \u2502     \u2502\n\u2502   \u2502   (PDC Emulator)    \u2502          \u2502   (PDC Emulator)    \u2502     \u2502\n\u2502   \u2502                     \u2502          \u2502                     \u2502     \u2502\n\u2502   \u2502   FSMO Roles:       \u2502          \u2502   FSMO Roles:       \u2502     \u2502\n\u2502   \u2502   \u2022 Schema Master   \u2502          \u2502   \u2022 PDC Emulator    \u2502     \u2502\n\u2502   \u2502   \u2022 Domain Naming   \u2502          \u2502   \u2022 RID Master      \u2502     \u2502\n\u2502   \u2502   \u2022 PDC Emulator    \u2502          \u2502   \u2022 Infra Master    \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502              \u2502                                \u2502                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502   srv-dc-admin-02   \u2502          \u2502   srv-dc-corp-02    \u2502     \u2502\n\u2502   \u2502   (R\u00e9plica)         \u2502          \u2502   (R\u00e9plica)         \u2502     \u2502\n\u2502   \u2502                     \u2502          \u2502                     \u2502     \u2502\n\u2502   \u2502   FSMO Roles:       \u2502          \u2502                     \u2502     \u2502\n\u2502   \u2502   \u2022 RID Master      \u2502          \u2502                     \u2502     \u2502\n\u2502   \u2502   \u2022 Infra Master    \u2502          \u2502                     \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                                                                 \u2502\n\u2502              \u2502                                \u2502                 \u2502\n\u2502              \u2502      TRUST UNIDIRECTIONNEL     \u2502                 \u2502\n\u2502              \u2502\u25c4\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2502                 \u2502\n\u2502              \u2502   admin G\u00c8RE corp              \u2502                 \u2502\n\u2502              \u2502   corp NE G\u00c8RE PAS admin       \u2502                 \u2502\n\u2502                                                                 \u2502\n\u2502   CONTENU:                          CONTENU:                    \u2502\n\u2502   \u2022 Comptes admin (*-adm)           \u2022 Comptes utilisateurs      \u2502\n\u2502   \u2022 PAW (Privileged Access)         \u2022 Groupes m\u00e9tiers           \u2502\n\u2502   \u2022 Outils de gestion               \u2022 Serveurs applicatifs      \u2502\n\u2502   \u2022 Aucun utilisateur final         \u2022 Postes de travail         \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/windows/active-directory/#pourquoi-cette-architecture","title":"Pourquoi Cette Architecture ?","text":"Aspect For\u00eat Unique (Classique) Red Forest (ESAE) Compromission Attaquant = Domain Admin partout Attaquant sur <code>corp</code> \u2260 acc\u00e8s \u00e0 <code>admin</code> Isolation Aucune For\u00eat d\u00e9di\u00e9e pour Tier 0 Pass-the-Hash Risque \u00e9lev\u00e9 Limit\u00e9 \u00e0 une for\u00eat Comptes Admin M\u00e9lang\u00e9s avec users Isol\u00e9s dans <code>admin</code> Compliance Difficile \u00e0 auditer S\u00e9paration claire"},{"location":"formations/windows/active-directory/#section-1-trust-unidirectionnel","title":"Section 1 : Trust Unidirectionnel","text":""},{"location":"formations/windows/active-directory/#11-diagramme-du-trust","title":"1.1 Diagramme du Trust","text":"<pre><code>flowchart LR\n    subgraph ADMIN[\"For\u00eat ADMIN (admin.shellbook.local)\"]\n        DC_ADMIN1[srv-dc-admin-01&lt;br/&gt;PDC Emulator]\n        DC_ADMIN2[srv-dc-admin-02&lt;br/&gt;R\u00e9plica]\n        ADMINS[Comptes *-adm&lt;br/&gt;Enterprise Admins]\n    end\n\n    subgraph CORP[\"For\u00eat CORP (corp.shellbook.local)\"]\n        DC_CORP1[srv-dc-corp-01&lt;br/&gt;PDC Emulator]\n        DC_CORP2[srv-dc-corp-02&lt;br/&gt;R\u00e9plica]\n        USERS[Utilisateurs&lt;br/&gt;Ressources]\n    end\n\n    ADMIN --&gt;|\"Trust Unidirectionnel&lt;br/&gt;(admin \u2192 corp)\"| CORP\n    ADMINS --&gt;|\"Peut administrer\"| USERS\n\n    style ADMIN fill:#ff6b6b,stroke:#333,color:#fff\n    style CORP fill:#4ecdc4,stroke:#333,color:#fff</code></pre>"},{"location":"formations/windows/active-directory/#12-direction-du-trust","title":"1.2 Direction du Trust","text":"<p>Comprendre la Direction</p> <p>La direction du trust peut \u00eatre confuse. Voici la r\u00e8gle :</p> <ul> <li>Trust Direction : <code>corp.shellbook.local</code> FAIT CONFIANCE \u00c0 <code>admin.shellbook.local</code></li> <li>Acc\u00e8s Direction : Les comptes de <code>admin</code> PEUVENT ACC\u00c9DER aux ressources de <code>corp</code></li> <li>Inverse : Les comptes de <code>corp</code> NE PEUVENT PAS acc\u00e9der \u00e0 <code>admin</code></li> </ul> <pre><code># V\u00e9rifier le trust depuis srv-dc-admin-01\nGet-ADTrust -Filter * | Select-Object Name, Direction, TrustType\n\n# R\u00e9sultat attendu :\n# Name                    Direction    TrustType\n# ----                    ---------    ---------\n# corp.shellbook.local    Outbound     Forest\n</code></pre> Propri\u00e9t\u00e9 Valeur Type Forest Trust Direction Unidirectionnel (Outbound depuis ADMIN) Transitivit\u00e9 Oui (tous les domaines enfants) Authentification Selective Authentication (recommand\u00e9) SID Filtering Activ\u00e9"},{"location":"formations/windows/active-directory/#13-le-modele-de-comptes-doubles","title":"1.3 Le Mod\u00e8le de Comptes Doubles","text":"<p>Chaque administrateur poss\u00e8de deux comptes distincts :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              MOD\u00c8LE DE COMPTES DOUBLES                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   UTILISATEUR : Jean Dupont                                     \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  COMPTE STANDARD (For\u00eat CORP)                           \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Username:  corp\\jdupont                                \u2502   \u2502\n\u2502   \u2502  Type:      Utilisateur standard                        \u2502   \u2502\n\u2502   \u2502  Usage:     Email, bureautique, navigation              \u2502   \u2502\n\u2502   \u2502  Droits:    Aucun droit admin                           \u2502   \u2502\n\u2502   \u2502  Poste:     PC standard (Tier 2)                        \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  \u26a0\ufe0f  Ce compte NE DOIT JAMAIS se connecter \u00e0 un serveur \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  COMPTE ADMIN (For\u00eat ADMIN)                             \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  Username:  admin\\jdupont-adm                           \u2502   \u2502\n\u2502   \u2502  Type:      Compte privil\u00e9gi\u00e9                           \u2502   \u2502\n\u2502   \u2502  Usage:     Administration uniquement                   \u2502   \u2502\n\u2502   \u2502  Droits:    Domain Admins (corp), Server Operators      \u2502   \u2502\n\u2502   \u2502  Poste:     PAW uniquement (Tier 0)                     \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2502  \u26a0\ufe0f  Ce compte NE DOIT JAMAIS ouvrir un navigateur      \u2502   \u2502\n\u2502   \u2502  \u26a0\ufe0f  Ce compte NE DOIT JAMAIS lire ses emails           \u2502   \u2502\n\u2502   \u2502                                                         \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                 \u2502\n\u2502   R\u00c8GLE D'OR : Un compte = Un usage = Un niveau de risque      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/windows/active-directory/#14-matrice-de-flux-reseau-ports-critiques","title":"1.4 Matrice de Flux R\u00e9seau (Ports Critiques)","text":"Source Destination Port Protocole Service Criticit\u00e9 <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 88 TCP/UDP Kerberos CRITIQUE <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 389 TCP/UDP LDAP CRITIQUE <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 636 TCP LDAPS \u00c9lev\u00e9e <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 445 TCP SMB CRITIQUE <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 135 TCP RPC Endpoint CRITIQUE <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 49152-65535 TCP RPC Dynamic \u00c9lev\u00e9e <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 3268 TCP Global Catalog \u00c9lev\u00e9e <code>srv-dc-admin-*</code> <code>srv-dc-corp-*</code> 53 TCP/UDP DNS CRITIQUE <code>srv-dc-*</code> <code>srv-dc-*</code> 123 UDP NTP (w32tm) CRITIQUE <p>Ports Critiques pour le Trust</p> <p>Si TCP 88 (Kerberos) ou TCP 389 (LDAP) sont bloqu\u00e9s entre les for\u00eats, le trust ne fonctionnera pas.</p> <p>Test rapide : <pre><code>Test-NetConnection -ComputerName srv-dc-corp-01 -Port 88\nTest-NetConnection -ComputerName srv-dc-corp-01 -Port 389\nTest-NetConnection -ComputerName srv-dc-corp-01 -Port 445\n</code></pre></p>"},{"location":"formations/windows/active-directory/#section-2-topologie-fsmo","title":"Section 2 : Topologie FSMO","text":""},{"location":"formations/windows/active-directory/#21-repartition-des-roles-fsmo","title":"2.1 R\u00e9partition des R\u00f4les FSMO","text":"<p>Les r\u00f4les FSMO (Flexible Single Master Operations) sont r\u00e9partis strat\u00e9giquement :</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              R\u00c9PARTITION FSMO                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   FOR\u00caT admin.shellbook.local                                   \u2502\n\u2502   \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550                                   \u2502\n\u2502                                                                 \u2502\n\u2502   srv-dc-admin-01 (PDC Principal)                               \u2502\n\u2502   \u251c\u2500\u2500 Schema Master          \u2190 For\u00eat-wide (unique)             \u2502\n\u2502   \u251c\u2500\u2500 Domain Naming Master   \u2190 For\u00eat-wide (unique)             \u2502\n\u2502   \u2514\u2500\u2500 PDC Emulator           \u2190 Domaine (critique pour NTP)     \u2502\n\u2502                                                                 \u2502\n\u2502   srv-dc-admin-02 (R\u00e9plica)                                     \u2502\n\u2502   \u251c\u2500\u2500 RID Master             \u2190 Domaine                         \u2502\n\u2502   \u2514\u2500\u2500 Infrastructure Master  \u2190 Domaine                         \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   FOR\u00caT corp.shellbook.local                                    \u2502\n\u2502   \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550                                    \u2502\n\u2502                                                                 \u2502\n\u2502   srv-dc-corp-01 (PDC Principal)                                \u2502\n\u2502   \u251c\u2500\u2500 Schema Master          \u2190 For\u00eat-wide                      \u2502\n\u2502   \u251c\u2500\u2500 Domain Naming Master   \u2190 For\u00eat-wide                      \u2502\n\u2502   \u251c\u2500\u2500 PDC Emulator           \u2190 Domaine (SOURCE NTP)            \u2502\n\u2502   \u251c\u2500\u2500 RID Master             \u2190 Domaine                         \u2502\n\u2502   \u2514\u2500\u2500 Infrastructure Master  \u2190 Domaine                         \u2502\n\u2502                                                                 \u2502\n\u2502   srv-dc-corp-02 (R\u00e9plica)                                      \u2502\n\u2502   \u2514\u2500\u2500 (Aucun r\u00f4le FSMO)      \u2190 Failover uniquement             \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/windows/active-directory/#22-verification-des-roles-fsmo","title":"2.2 V\u00e9rification des R\u00f4les FSMO","text":"<pre><code># V\u00e9rifier tous les r\u00f4les FSMO du domaine\nGet-ADDomain | Select-Object PDCEmulator, RIDMaster, InfrastructureMaster\n\n# V\u00e9rifier les r\u00f4les FSMO de la for\u00eat\nGet-ADForest | Select-Object SchemaMaster, DomainNamingMaster\n\n# Commande alternative (netdom)\nnetdom query fsmo\n</code></pre> <p>R\u00e9sultat attendu (admin.shellbook.local) : <pre><code>Schema Master           : srv-dc-admin-01.admin.shellbook.local\nDomain Naming Master    : srv-dc-admin-01.admin.shellbook.local\nPDC Emulator            : srv-dc-admin-01.admin.shellbook.local\nRID Master              : srv-dc-admin-02.admin.shellbook.local\nInfrastructure Master   : srv-dc-admin-02.admin.shellbook.local\n</code></pre></p>"},{"location":"formations/windows/active-directory/#23-pdc-emulator-et-synchronisation-ntp","title":"2.3 PDC Emulator et Synchronisation NTP","text":"<p>D\u00e9pendance Critique : PDC Emulator = Source de Temps</p> <p>Le PDC Emulator est la source de temps autoritaire pour tous les clients du domaine.</p> <ul> <li>Kerberos tol\u00e8re un d\u00e9calage maximum de 5 minutes</li> <li>Au-del\u00e0 : \u00e9chec d'authentification, erreur KRB_AP_ERR_SKEW</li> <li>Sympt\u00f4me : \"La diff\u00e9rence de temps entre le client et le serveur est trop importante\"</li> </ul> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              HI\u00c9RARCHIE NTP (W32TM)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502          SOURCE EXTERNE (pool.ntp.org)                  \u2502   \u2502\n\u2502   \u2502          ou Serveur NTP interne d\u00e9di\u00e9                   \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                            \u2502                                    \u2502\n\u2502                            \u25bc                                    \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502          srv-dc-admin-01 (PDC Emulator)                 \u2502   \u2502\n\u2502   \u2502          For\u00eat ADMIN - Source autoritaire               \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                            \u2502                                    \u2502\n\u2502              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                      \u2502\n\u2502              \u2502                           \u2502                      \u2502\n\u2502              \u25bc                           \u25bc                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502   \u2502   srv-dc-admin-02    \u2502    \u2502   srv-dc-corp-01     \u2502         \u2502\n\u2502   \u2502   (R\u00e9plica ADMIN)    \u2502    \u2502   (PDC Emulator CORP)\u2502         \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502                                          \u2502                      \u2502\n\u2502                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502                               \u2502                     \u2502           \u2502\n\u2502                               \u25bc                     \u25bc           \u2502\n\u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502                    \u2502 srv-dc-corp-02 \u2502    \u2502 Clients CORP   \u2502    \u2502\n\u2502                    \u2502 (R\u00e9plica)      \u2502    \u2502 (Workstations) \u2502    \u2502\n\u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Configuration du PDC Emulator (srv-dc-admin-01) :</p> <pre><code># Configurer le PDC Emulator pour utiliser une source externe\nw32tm /config /manualpeerlist:\"pool.ntp.org\" /syncfromflags:manual /reliable:yes /update\n\n# Red\u00e9marrer le service\nRestart-Service w32time\n\n# Forcer la synchronisation\nw32tm /resync /rediscover\n</code></pre>"},{"location":"formations/windows/active-directory/#section-3-troubleshooting","title":"Section 3 : Troubleshooting","text":""},{"location":"formations/windows/active-directory/#31-erreur-de-synchronisation-temps-event-id-1749","title":"3.1 Erreur de Synchronisation Temps (Event ID 1749)","text":"<p>Sympt\u00f4me</p> <p>Event ID 1749 dans le journal System : \"The time provider NtpClient was unable to find a domain controller to use as a time source.\"</p> <p>Diagnostic :</p> <pre><code># V\u00e9rifier le statut de synchronisation\nw32tm /query /status\n\n# V\u00e9rifier la source de temps\nw32tm /query /source\n\n# V\u00e9rifier la configuration\nw32tm /query /configuration\n</code></pre> <p>R\u00e9solution :</p> <pre><code># Sur le DC avec le probl\u00e8me\nw32tm /resync /computer:srv-dc-admin-01.admin.shellbook.local\n\n# Si le service est bloqu\u00e9\nStop-Service w32time\nw32tm /unregister\nw32tm /register\nStart-Service w32time\n\n# Forcer la red\u00e9couverte\nw32tm /resync /rediscover\n\n# V\u00e9rifier\nw32tm /query /status\n</code></pre> <p>V\u00e9rification du d\u00e9calage :</p> <pre><code># Comparer l'heure avec le PDC\nw32tm /stripchart /computer:srv-dc-admin-01.admin.shellbook.local /samples:5 /dataonly\n</code></pre>"},{"location":"formations/windows/active-directory/#32-problemes-de-replication-dfsr-sysvol","title":"3.2 Probl\u00e8mes de R\u00e9plication DFSR (SYSVOL)","text":"<p>Sympt\u00f4me</p> <ul> <li>GPO non appliqu\u00e9es sur certains DCs</li> <li>Contenu de SYSVOL diff\u00e9rent entre DCs</li> <li>Event ID 4012, 5002, 5008 dans DFS Replication</li> </ul> <p>Diagnostic :</p> <pre><code># V\u00e9rifier l'\u00e9tat DFSR\nGet-DfsrMember -GroupName \"Domain System Volume\"\n\n# V\u00e9rifier les backlogs de r\u00e9plication\nGet-DfsrBacklog -SourceComputerName srv-dc-admin-01 -DestinationComputerName srv-dc-admin-02 -GroupName \"Domain System Volume\"\n\n# \u00c9tat d\u00e9taill\u00e9\ndfsrdiag.exe pollad\n</code></pre> <p>R\u00e9solution :</p> <pre><code># Forcer la r\u00e9plication imm\u00e9diate\nrepadmin /syncall /AdeP\n\n# Red\u00e9marrer le service DFSR sur le DC probl\u00e9matique\nRestart-Service DFSR\n\n# Attendre et v\u00e9rifier\nStart-Sleep -Seconds 30\ndfsrdiag.exe pollad\n</code></pre> <p>Si le probl\u00e8me persiste (reconstruction SYSVOL) :</p> <pre><code># ATTENTION : Proc\u00e9dure invasive - Backup d'abord !\n\n# 1. Identifier le DC autoritaire (habituellement le PDC)\n# 2. Sur le DC NON-autoritaire, arr\u00eater DFSR\nStop-Service DFSR\n\n# 3. D\u00e9finir l'attribut pour reconstruction\n# Via ADSIEDIT : CN=SYSVOL Subscription -&gt; msDFSR-Enabled = FALSE\n\n# 4. Red\u00e9marrer DFSR\nStart-Service DFSR\n\n# 5. Attendre la reconstruction, puis r\u00e9activer\n# msDFSR-Enabled = TRUE\n</code></pre>"},{"location":"formations/windows/active-directory/#33-problemes-de-trust-inter-forets","title":"3.3 Probl\u00e8mes de Trust Inter-For\u00eats","text":"<p>Sympt\u00f4me</p> <ul> <li>Impossible de r\u00e9soudre les comptes de l'autre for\u00eat</li> <li>Erreur \"The trust relationship between this workstation and the primary domain failed\"</li> <li>\u00c9chec d'authentification cross-forest</li> </ul> <p>Diagnostic :</p> <pre><code># V\u00e9rifier que le trust existe\nGet-ADTrust -Filter * | Format-List *\n\n# Tester la connectivit\u00e9 r\u00e9seau vers les DCs de l'autre for\u00eat\nTest-NetConnection -ComputerName srv-dc-corp-01.corp.shellbook.local -Port 88\nTest-NetConnection -ComputerName srv-dc-corp-01.corp.shellbook.local -Port 389\nTest-NetConnection -ComputerName srv-dc-corp-01.corp.shellbook.local -Port 445\n\n# Lister les domaines de confiance\nnltest /trusted_domains\n\n# V\u00e9rifier le secure channel\nnltest /sc_query:corp.shellbook.local\n</code></pre> <p>R\u00e9solution :</p> <pre><code># R\u00e9initialiser le secure channel du trust\nnetdom trust admin.shellbook.local /domain:corp.shellbook.local /reset /passwordt:*\n\n# Ou via PowerShell (pr\u00e9f\u00e9r\u00e9)\n$trustPassword = Read-Host -AsSecureString \"Entrez le mot de passe du trust\"\nReset-ADTrust -Identity \"corp.shellbook.local\" -TrustPassword $trustPassword\n\n# V\u00e9rifier\nnltest /sc_verify:corp.shellbook.local\n</code></pre>"},{"location":"formations/windows/active-directory/#34-tableau-de-diagnostic-rapide","title":"3.4 Tableau de Diagnostic Rapide","text":"Sympt\u00f4me Event ID Commande de Diagnostic R\u00e9solution Rapide D\u00e9calage horaire 1749 <code>w32tm /query /status</code> <code>w32tm /resync</code> GPO non appliqu\u00e9e 4012, 5002 <code>dfsrdiag pollad</code> <code>Restart-Service DFSR</code> Trust cass\u00e9 1789, 5719 <code>nltest /sc_query:corp</code> <code>netdom trust /reset</code> R\u00e9plication AD 1311, 1388 <code>repadmin /showrepl</code> <code>repadmin /syncall</code> DNS inter-for\u00eat - <code>nslookup srv-dc-corp-01</code> V\u00e9rifier conditional forwarders"},{"location":"formations/windows/active-directory/#35-script-de-diagnostic-complet","title":"3.5 Script de Diagnostic Complet","text":"<pre><code>&lt;#\n.SYNOPSIS\n    Diagnostic complet de l'infrastructure AD Red Forest\n.DESCRIPTION\n    V\u00e9rifie : FSMO, R\u00e9plication, Trust, NTP, DNS\n#&gt;\n\nWrite-Host \"=== DIAGNOSTIC AD RED FOREST ===\" -ForegroundColor Cyan\nWrite-Host \"\"\n\n# 1. FSMO Roles\nWrite-Host \"[1/5] V\u00e9rification des r\u00f4les FSMO...\" -ForegroundColor Yellow\ntry {\n    $domain = Get-ADDomain\n    $forest = Get-ADForest\n    Write-Host \"  PDC Emulator     : $($domain.PDCEmulator)\" -ForegroundColor Green\n    Write-Host \"  RID Master       : $($domain.RIDMaster)\" -ForegroundColor Green\n    Write-Host \"  Infra Master     : $($domain.InfrastructureMaster)\" -ForegroundColor Green\n    Write-Host \"  Schema Master    : $($forest.SchemaMaster)\" -ForegroundColor Green\n    Write-Host \"  Domain Naming    : $($forest.DomainNamingMaster)\" -ForegroundColor Green\n} catch {\n    Write-Host \"  ERREUR: $($_.Exception.Message)\" -ForegroundColor Red\n}\nWrite-Host \"\"\n\n# 2. R\u00e9plication\nWrite-Host \"[2/5] V\u00e9rification de la r\u00e9plication AD...\" -ForegroundColor Yellow\n$replStatus = repadmin /showrepl /csv | ConvertFrom-Csv\n$failures = $replStatus | Where-Object { $_.'Number of Failures' -gt 0 }\nif ($failures) {\n    Write-Host \"  ATTENTION: \u00c9checs de r\u00e9plication d\u00e9tect\u00e9s!\" -ForegroundColor Red\n    $failures | ForEach-Object { Write-Host \"  - $($_.'Source DSA')\" }\n} else {\n    Write-Host \"  R\u00e9plication OK\" -ForegroundColor Green\n}\nWrite-Host \"\"\n\n# 3. Trusts\nWrite-Host \"[3/5] V\u00e9rification des trusts...\" -ForegroundColor Yellow\n$trusts = Get-ADTrust -Filter *\nforeach ($trust in $trusts) {\n    $testResult = nltest /sc_query:$($trust.Name) 2&gt;&amp;1\n    if ($testResult -match \"NERR_Success\") {\n        Write-Host \"  Trust $($trust.Name) : OK\" -ForegroundColor Green\n    } else {\n        Write-Host \"  Trust $($trust.Name) : ERREUR\" -ForegroundColor Red\n    }\n}\nWrite-Host \"\"\n\n# 4. Synchronisation NTP\nWrite-Host \"[4/5] V\u00e9rification de la synchronisation horaire...\" -ForegroundColor Yellow\n$timeStatus = w32tm /query /status\nif ($timeStatus -match \"Leap Indicator: 0\") {\n    Write-Host \"  Synchronisation NTP : OK\" -ForegroundColor Green\n} else {\n    Write-Host \"  Synchronisation NTP : ATTENTION\" -ForegroundColor Yellow\n}\n$source = w32tm /query /source\nWrite-Host \"  Source: $source\"\nWrite-Host \"\"\n\n# 5. Connectivit\u00e9 inter-for\u00eat\nWrite-Host \"[5/5] Test de connectivit\u00e9 inter-for\u00eat...\" -ForegroundColor Yellow\n$targetDC = \"srv-dc-corp-01.corp.shellbook.local\"\n$ports = @(88, 389, 445, 135)\nforeach ($port in $ports) {\n    $test = Test-NetConnection -ComputerName $targetDC -Port $port -WarningAction SilentlyContinue\n    if ($test.TcpTestSucceeded) {\n        Write-Host \"  Port $port vers $targetDC : OK\" -ForegroundColor Green\n    } else {\n        Write-Host \"  Port $port vers $targetDC : BLOQU\u00c9\" -ForegroundColor Red\n    }\n}\n\nWrite-Host \"\"\nWrite-Host \"=== FIN DU DIAGNOSTIC ===\" -ForegroundColor Cyan\n</code></pre>"},{"location":"formations/windows/active-directory/#commandes-de-reference-rapide","title":"Commandes de R\u00e9f\u00e9rence Rapide","text":""},{"location":"formations/windows/active-directory/#fsmo","title":"FSMO","text":"<pre><code># Voir les r\u00f4les\nnetdom query fsmo\nGet-ADDomain | Select-Object PDCEmulator, RIDMaster, InfrastructureMaster\nGet-ADForest | Select-Object SchemaMaster, DomainNamingMaster\n\n# Transf\u00e9rer un r\u00f4le (planifi\u00e9)\nMove-ADDirectoryServerOperationMasterRole -Identity srv-dc-admin-02 -OperationMasterRole PDCEmulator\n\n# Seize un r\u00f4le (urgence - DC source down)\nMove-ADDirectoryServerOperationMasterRole -Identity srv-dc-admin-02 -OperationMasterRole PDCEmulator -Force\n</code></pre>"},{"location":"formations/windows/active-directory/#trust","title":"Trust","text":"<pre><code># V\u00e9rifier\nGet-ADTrust -Filter *\nnltest /trusted_domains\nnltest /sc_query:corp.shellbook.local\n\n# R\u00e9parer\nnetdom trust admin.shellbook.local /domain:corp.shellbook.local /reset /passwordt:*\n</code></pre>"},{"location":"formations/windows/active-directory/#replication","title":"R\u00e9plication","text":"<pre><code># Statut\nrepadmin /showrepl\nrepadmin /replsummary\n\n# Forcer\nrepadmin /syncall /AdeP\n\n# DFSR (SYSVOL)\ndfsrdiag pollad\nGet-DfsrBacklog -SourceComputerName srv-dc-admin-01 -DestinationComputerName srv-dc-admin-02\n</code></pre>"},{"location":"formations/windows/active-directory/#ntp","title":"NTP","text":"<pre><code># Statut\nw32tm /query /status\nw32tm /query /source\n\n# Resync\nw32tm /resync /rediscover\n\n# Configurer source externe (PDC uniquement)\nw32tm /config /manualpeerlist:\"pool.ntp.org\" /syncfromflags:manual /reliable:yes /update\n</code></pre>"},{"location":"formations/windows/active-directory/#checklist-operationnelle","title":"Checklist Op\u00e9rationnelle","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CHECKLIST QUOTIDIENNE AD                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   R\u00c9PLICATION                                                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502   \u2610 repadmin /replsummary : 0 failures                          \u2502\n\u2502   \u2610 Event Viewer : pas d'erreurs 1311, 1388                     \u2502\n\u2502   \u2610 DFSR : dfsrdiag pollad sans erreur                          \u2502\n\u2502                                                                 \u2502\n\u2502   TRUSTS                                                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500                                                        \u2502\n\u2502   \u2610 nltest /sc_query retourne SUCCESS                           \u2502\n\u2502   \u2610 Test-NetConnection ports 88, 389, 445 : OK                  \u2502\n\u2502                                                                 \u2502\n\u2502   NTP                                                           \u2502\n\u2502   \u2500\u2500\u2500                                                           \u2502\n\u2502   \u2610 w32tm /query /status : synchronis\u00e9                          \u2502\n\u2502   \u2610 D\u00e9calage &lt; 5 minutes entre tous les DCs                     \u2502\n\u2502                                                                 \u2502\n\u2502   FSMO                                                          \u2502\n\u2502   \u2500\u2500\u2500\u2500                                                          \u2502\n\u2502   \u2610 Tous les r\u00f4les attribu\u00e9s (netdom query fsmo)                \u2502\n\u2502   \u2610 DCs d\u00e9tenteurs des r\u00f4les : accessibles                      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"formations/windows/active-directory/#contacts-et-escalade","title":"Contacts et Escalade","text":"<p>En Cas d'Incident Tier 0</p> <ol> <li>Niveau 1 : V\u00e9rifier r\u00e9plication, NTP, connectivit\u00e9</li> <li>Niveau 2 : Trust reset, FSMO transfer</li> <li>Niveau 3 : Reconstruction SYSVOL, Forest Recovery</li> </ol> <p>ATTENTION : Toute modification FSMO ou Trust n\u00e9cessite un Change Approval.</p> <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 2.0 Classification : Interne - Infrastructure Critique Auteur : ShellBook ADSEC Team</p>"},{"location":"network/vpn-topology/","title":"Topologie VPN IPsec - Infrastructure ADSEC","text":"<p>Infrastructure Critique - Chemin d'Administration</p> <p>Ce tunnel VPN IPsec est le SEUL chemin permettant aux postes PADSEC d'administrer les serveurs de production.</p> <p>Si ce tunnel tombe : PLUS AUCUNE ADMINISTRATION POSSIBLE.</p> <p>Temps de r\u00e9solution cible : &lt; 30 minutes</p>"},{"location":"network/vpn-topology/#vue-densemble","title":"Vue d'Ensemble","text":""},{"location":"network/vpn-topology/#pourquoi-ce-vpn","title":"Pourquoi ce VPN ?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PROBL\u00c9MATIQUE DE S\u00c9CURIT\u00c9                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   SANS VPN (Interdit)                                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                           \u2502\n\u2502                                                                 \u2502\n\u2502   PADSEC \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Serveurs     \u2502\n\u2502          Trafic en clair sur le r\u00e9seau interne                  \u2502\n\u2502          Risque : Interception, Man-in-the-Middle               \u2502\n\u2502                                                                 \u2502\n\u2502   \u274c Credentials RDP/SSH visibles                               \u2502\n\u2502   \u274c Kerberos tickets interceptables                            \u2502\n\u2502   \u274c Pas d'isolation r\u00e9seau                                     \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   AVEC VPN IPsec (Architecture Actuelle)                        \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                        \u2502\n\u2502                                                                 \u2502\n\u2502   PADSEC \u2500\u2500\u25ba FW-Admin \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u25ba FW-Core \u2500\u2500\u25ba Serveurs    \u2502\n\u2502              \u2502        Tunnel Chiffr\u00e9         \u2502                  \u2502\n\u2502              \u2502        (AES-256-GCM)          \u2502                  \u2502\n\u2502              \u2502                               \u2502                  \u2502\n\u2502                                                                 \u2502\n\u2502   \u2705 Trafic enti\u00e8rement chiffr\u00e9                                 \u2502\n\u2502   \u2705 Authentification mutuelle (certificats)                    \u2502\n\u2502   \u2705 Isolation compl\u00e8te du r\u00e9seau de transit                    \u2502\n\u2502   \u2705 Int\u00e9grit\u00e9 garantie (HMAC-SHA256)                           \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#section-1-architecture-vpn-site-to-site","title":"Section 1 : Architecture VPN Site-to-Site","text":""},{"location":"network/vpn-topology/#11-topologie-globale","title":"1.1 Topologie Globale","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARCHITECTURE VPN IPSEC - ADSEC                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   ZONE ADMIN                        ZONE CORE (Production)      \u2502\n\u2502   (R\u00e9seau Management)               (Serveurs Critiques)        \u2502\n\u2502                                                                 \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502   \u2502   PADSEC-01     \u2502              \u2502 srv-dc-admin-01 \u2502         \u2502\n\u2502   \u2502   PADSEC-02     \u2502              \u2502 srv-dc-corp-01  \u2502         \u2502\n\u2502   \u2502   PADSEC-03     \u2502              \u2502 srv-bastion-01  \u2502         \u2502\n\u2502   \u2502   (Tier 0)      \u2502              \u2502 srv-wsus-01     \u2502         \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502            \u2502                                \u2502                   \u2502\n\u2502            \u2502 10.10.0.0/24                   \u2502 10.20.0.0/16      \u2502\n\u2502            \u2502                                \u2502                   \u2502\n\u2502            \u25bc                                \u2502                   \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502   \u2502                 \u2502              \u2502                 \u2502         \u2502\n\u2502   \u2502    FW-ADMIN     \u2502\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2502    FW-CORE      \u2502         \u2502\n\u2502   \u2502   (Fortigate)   \u2502  VPN IPsec   \u2502   (CIRRUS)      \u2502         \u2502\n\u2502   \u2502                 \u2502  IKEv2/ESP   \u2502                 \u2502         \u2502\n\u2502   \u2502  172.16.1.1     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  172.16.2.1     \u2502         \u2502\n\u2502   \u2502                 \u2502              \u2502                 \u2502         \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502                                                                 \u2502\n\u2502   TUNNEL IPSEC :                                                \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502   \u2022 Endpoint Local  : 172.16.1.1 (FW-ADMIN)                    \u2502\n\u2502   \u2022 Endpoint Distant: 172.16.2.1 (FW-CORE)                     \u2502\n\u2502   \u2022 R\u00e9seaux Prot\u00e9g\u00e9s: 10.10.0.0/24 \u2194 10.20.0.0/16             \u2502\n\u2502   \u2022 Encryption      : AES-256-GCM                               \u2502\n\u2502   \u2022 Authentification: Certificats X.509 (PKI interne)          \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#12-diagramme-de-flux","title":"1.2 Diagramme de Flux","text":"<pre><code>flowchart LR\n    subgraph ADMIN[\"Zone Admin (10.10.0.0/24)\"]\n        PADSEC[PADSEC-01&lt;br/&gt;Poste Tier 0]\n    end\n\n    subgraph FWADMIN[\"FW-ADMIN\"]\n        FW1[Fortigate&lt;br/&gt;172.16.1.1]\n    end\n\n    subgraph TUNNEL[\"Tunnel IPsec\"]\n        VPN[/\"IKEv2 + ESP&lt;br/&gt;AES-256-GCM\"/]\n    end\n\n    subgraph FWCORE[\"FW-CORE\"]\n        FW2[CIRRUS&lt;br/&gt;172.16.2.1]\n    end\n\n    subgraph CORE[\"Zone Core (10.20.0.0/16)\"]\n        DC[srv-dc-admin-01&lt;br/&gt;Domain Controller]\n        BASTION[srv-bastion-01&lt;br/&gt;Jump Server]\n        WSUS[srv-wsus-01&lt;br/&gt;Updates]\n    end\n\n    PADSEC --&gt;|RDP/SSH| FW1\n    FW1 ==&gt;|ESP Protocol 50| VPN\n    VPN ==&gt;|Encrypted| FW2\n    FW2 --&gt;|Decrypted| DC\n    FW2 --&gt;|Decrypted| BASTION\n    FW2 --&gt;|Decrypted| WSUS\n\n    style TUNNEL fill:#ff6b6b,stroke:#333,color:#fff\n    style VPN fill:#ff6b6b,stroke:#333,color:#fff</code></pre>"},{"location":"network/vpn-topology/#13-protocoles-ipsec","title":"1.3 Protocoles IPsec","text":"Protocole Port/Protocol Fonction Criticit\u00e9 IKEv2 UDP 500 N\u00e9gociation des cl\u00e9s, \u00e9tablissement du tunnel CRITIQUE NAT-T UDP 4500 Travers\u00e9e NAT (encapsulation ESP dans UDP) \u00c9lev\u00e9e ESP IP Protocol 50 Chiffrement et int\u00e9grit\u00e9 des donn\u00e9es CRITIQUE AH IP Protocol 51 Authentification uniquement (non utilis\u00e9) N/A <p>Attention au Filtrage</p> <p>Si UDP 500 ou IP Protocol 50 sont bloqu\u00e9s sur le chemin, le tunnel ne peut pas s'\u00e9tablir.</p> <p>Les pare-feu interm\u00e9diaires doivent autoriser : <pre><code>UDP 500   : IKE (n\u00e9gociation)\nUDP 4500  : NAT-Traversal\nESP (50)  : Donn\u00e9es chiffr\u00e9es\n</code></pre></p>"},{"location":"network/vpn-topology/#14-phases-de-negociation-ikev2","title":"1.4 Phases de N\u00e9gociation IKEv2","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u00c9TABLISSEMENT DU TUNNEL IPSEC                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   PHASE 1 : IKE_SA_INIT (Authentification Mutuelle)             \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500             \u2502\n\u2502                                                                 \u2502\n\u2502   FW-ADMIN                              FW-CORE                 \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500 IKE_SA_INIT (proposals) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500 IKE_SA_INIT (response) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502    \u00c9change Diffie-Hellman           \u2502                    \u2502\n\u2502      \u2502    V\u00e9rification Certificats         \u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502                                                                 \u2502\n\u2502   PHASE 2 : IKE_AUTH + CREATE_CHILD_SA (Tunnel Data)            \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500            \u2502\n\u2502                                                                 \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500 IKE_AUTH (identit\u00e9, cert) \u2500\u2500\u2500\u2500\u2500\u25ba\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500 IKE_AUTH (identit\u00e9, cert) \u2500\u2500\u2500\u2500\u2500\u2500\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502\u2500\u2500\u2500\u2500 CREATE_CHILD_SA (traffic sel) \u2500\u25ba\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502      \u2502\u25c4\u2500\u2500\u2500 CREATE_CHILD_SA (confirm) \u2500\u2500\u2500\u2500\u2500\u2500\u2502                    \u2502\n\u2502      \u2502                                     \u2502                    \u2502\n\u2502                                                                 \u2502\n\u2502   TUNNEL \u00c9TABLI \u2705                                              \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                \u2502\n\u2502      \u2502\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2502                    \u2502\n\u2502      \u2502         ESP (donn\u00e9es chiffr\u00e9es)     \u2502                    \u2502\n\u2502      \u2502\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2502                    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#section-2-matrice-de-flux-a-travers-le-tunnel","title":"Section 2 : Matrice de Flux \u00e0 Travers le Tunnel","text":""},{"location":"network/vpn-topology/#21-pourquoi-ces-flux","title":"2.1 Pourquoi Ces Flux ?","text":"<p>Le tunnel VPN transporte uniquement les flux d'administration critiques. Tout autre trafic est interdit.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              JUSTIFICATION DES FLUX                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   1. FLUX ACTIVE DIRECTORY                                      \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502   Pourquoi : Les PADSEC doivent s'authentifier sur le domaine   \u2502\n\u2502              admin.shellbook.local pour obtenir leurs tickets   \u2502\n\u2502              Kerberos avant de pouvoir administrer.             \u2502\n\u2502                                                                 \u2502\n\u2502   2. FLUX MANAGEMENT (RDP/SSH)                                  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                  \u2502\n\u2502   Pourquoi : Acc\u00e8s aux serveurs pour administration.            \u2502\n\u2502              Toujours via le Bastion (srv-bastion-01).          \u2502\n\u2502                                                                 \u2502\n\u2502   3. FLUX MISE \u00c0 JOUR                                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                           \u2502\n\u2502   Pourquoi : Les PADSEC doivent recevoir leurs patches depuis   \u2502\n\u2502              WSUS interne (pas d'acc\u00e8s Internet direct).        \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#22-matrice-de-flux-detaillee","title":"2.2 Matrice de Flux D\u00e9taill\u00e9e","text":""},{"location":"network/vpn-topology/#flux-active-directory-authentification","title":"Flux Active Directory (Authentification)","text":"Source Destination Port Protocole Service Usage <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 88 TCP/UDP Kerberos Authentification <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 389 TCP LDAP Annuaire <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 636 TCP LDAPS Annuaire chiffr\u00e9 <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 53 TCP/UDP DNS R\u00e9solution <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 135 TCP RPC Services AD <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 445 TCP SMB GPO, Scripts <code>10.10.0.0/24</code> (PADSEC) <code>srv-dc-admin-01</code> 49152-65535 TCP RPC Dynamic Services AD"},{"location":"network/vpn-topology/#flux-management-administration","title":"Flux Management (Administration)","text":"Source Destination Port Protocole Service Usage <code>10.10.0.0/24</code> (PADSEC) <code>srv-bastion-01</code> 3389 TCP RDP Jump Server Windows <code>10.10.0.0/24</code> (PADSEC) <code>srv-bastion-01</code> 22 TCP SSH Jump Server Linux <code>srv-bastion-01</code> <code>10.20.0.0/16</code> 3389 TCP RDP Vers serveurs cibles <code>srv-bastion-01</code> <code>10.20.0.0/16</code> 22 TCP SSH Vers serveurs cibles <code>srv-bastion-01</code> <code>10.20.0.0/16</code> 5985/5986 TCP WinRM PowerShell Remoting"},{"location":"network/vpn-topology/#flux-mise-a-jour","title":"Flux Mise \u00e0 Jour","text":"Source Destination Port Protocole Service Usage <code>10.10.0.0/24</code> (PADSEC) <code>srv-wsus-01</code> 8530 TCP HTTP WSUS Updates <code>10.10.0.0/24</code> (PADSEC) <code>srv-wsus-01</code> 8531 TCP HTTPS WSUS Updates (SSL) <code>10.10.0.0/24</code> (PADSEC) <code>srv-katello-01</code> 443 TCP HTTPS Katello/Satellite <code>10.10.0.0/24</code> (PADSEC) <code>srv-katello-01</code> 5647 TCP AMQP Katello Agent"},{"location":"network/vpn-topology/#23-diagramme-des-flux","title":"2.3 Diagramme des Flux","text":"<pre><code>flowchart TB\n    subgraph PADSEC[\"PADSEC (10.10.0.0/24)\"]\n        P1[PADSEC-01]\n    end\n\n    subgraph VPN[\"Tunnel VPN IPsec\"]\n        T1[/Chiffr\u00e9 AES-256/]\n    end\n\n    subgraph TARGETS[\"Zone Core (10.20.0.0/16)\"]\n        DC[srv-dc-admin-01&lt;br/&gt;TCP 88,389,445]\n        BASTION[srv-bastion-01&lt;br/&gt;TCP 3389,22]\n        WSUS[srv-wsus-01&lt;br/&gt;TCP 8530,8531]\n        KATELLO[srv-katello-01&lt;br/&gt;TCP 443,5647]\n    end\n\n    P1 --&gt;|\"Kerberos (88)\"| T1\n    P1 --&gt;|\"LDAP (389)\"| T1\n    P1 --&gt;|\"RDP (3389)\"| T1\n    P1 --&gt;|\"WSUS (8530)\"| T1\n\n    T1 --&gt;|AD Flows| DC\n    T1 --&gt;|Management| BASTION\n    T1 --&gt;|Updates| WSUS\n    T1 --&gt;|Updates| KATELLO\n\n    style T1 fill:#ff6b6b,stroke:#333,color:#fff</code></pre>"},{"location":"network/vpn-topology/#section-3-troubleshooting-connectivite","title":"Section 3 : Troubleshooting Connectivit\u00e9","text":""},{"location":"network/vpn-topology/#31-verifier-si-le-tunnel-est-actif","title":"3.1 V\u00e9rifier si le Tunnel est Actif","text":"<p>Depuis un PADSEC (Windows) :</p> <pre><code># Test de connectivit\u00e9 TCP vers un serveur cible\nTest-NetConnection -ComputerName srv-bastion-01 -Port 3389\n\n# R\u00e9sultat attendu si tunnel UP :\n# ComputerName     : srv-bastion-01\n# RemoteAddress    : 10.20.1.50\n# RemotePort       : 3389\n# TcpTestSucceeded : True\n\n# Si tunnel DOWN :\n# TcpTestSucceeded : False\n# WARNING: TCP connect to (10.20.1.50 : 3389) failed\n</code></pre> <pre><code># Tests multiples\n$targets = @(\n    @{Host=\"srv-dc-admin-01\"; Port=88},\n    @{Host=\"srv-dc-admin-01\"; Port=389},\n    @{Host=\"srv-bastion-01\"; Port=3389},\n    @{Host=\"srv-wsus-01\"; Port=8530}\n)\n\nforeach ($target in $targets) {\n    $result = Test-NetConnection -ComputerName $target.Host -Port $target.Port -WarningAction SilentlyContinue\n    $status = if ($result.TcpTestSucceeded) { \"\u2705 OK\" } else { \"\u274c FAILED\" }\n    Write-Host \"$($target.Host):$($target.Port) - $status\"\n}\n</code></pre> <p>Depuis un serveur Linux :</p> <pre><code># Test TCP avec nc (netcat)\nnc -zv srv-bastion-01 22\n# Connection to srv-bastion-01 22 port [tcp/ssh] succeeded!\n\n# Test TCP avec timeout\ntimeout 5 bash -c '&lt;/dev/tcp/srv-bastion-01/22 &amp;&amp; echo \"OK\" || echo \"FAILED\"'\n\n# Test multiple ports\nfor port in 22 3389 88 389; do\n    nc -zv srv-dc-admin-01 $port 2&gt;&amp;1 | grep -E \"(succeeded|failed)\"\ndone\n</code></pre>"},{"location":"network/vpn-topology/#32-problemes-de-mtu-fragmentation","title":"3.2 Probl\u00e8mes de MTU (Fragmentation)","text":"<p>Sympt\u00f4me Classique</p> <ul> <li>Ping fonctionne</li> <li>Petits transferts fonctionnent</li> <li>Gros transferts (RDP, copies de fichiers) bloquent ou sont tr\u00e8s lents</li> </ul> <p>Cause probable : La MTU effective dans le tunnel est r\u00e9duite (overhead IPsec ~50-100 bytes).</p> <p>Diagnostic MTU :</p> <pre><code># Windows : Test avec diff\u00e9rentes tailles de paquets\n# -f = Don't Fragment, -l = taille du payload\n\n# Test avec MTU standard (1500 - 28 = 1472 max payload)\nping -f -l 1472 srv-bastion-01\n# Si \"Packet needs to be fragmented but DF set\" \u2192 MTU trop grande\n\n# R\u00e9duire progressivement jusqu'\u00e0 ce que \u00e7a passe\nping -f -l 1400 srv-bastion-01\nping -f -l 1300 srv-bastion-01\nping -f -l 1200 srv-bastion-01\n\n# La bonne valeur est la plus grande qui passe + 28 (headers IP+ICMP)\n</code></pre> <pre><code># Linux : M\u00eame principe\nping -M do -s 1472 srv-bastion-01\n# \"Frag needed and DF set\" \u2192 MTU trop grande\n\nping -M do -s 1300 srv-bastion-01\n# Si \u00e7a passe, MTU effective \u2265 1328\n</code></pre> <p>R\u00e9solution MTU :</p> <pre><code># Windows : Ajuster la MTU de l'interface\n# Identifier l'interface\nGet-NetAdapter | Select-Object Name, InterfaceIndex, Status\n\n# Voir la MTU actuelle\nGet-NetIPInterface -InterfaceIndex &lt;INDEX&gt; | Select-Object InterfaceAlias, NlMtu\n\n# R\u00e9duire la MTU (n\u00e9cessite admin)\nSet-NetIPInterface -InterfaceIndex &lt;INDEX&gt; -NlMtuBytes 1400\n\n# Ou via netsh\nnetsh interface ipv4 set subinterface \"Ethernet\" mtu=1400 store=persistent\n</code></pre> <pre><code># Linux : Ajuster la MTU\nip link set eth0 mtu 1400\n\n# Permanent (Debian/Ubuntu)\n# Dans /etc/network/interfaces :\n# iface eth0 inet static\n#     mtu 1400\n</code></pre>"},{"location":"network/vpn-topology/#33-diagnostic-complet","title":"3.3 Diagnostic Complet","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              ARBRE DE D\u00c9CISION TROUBLESHOOTING                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   \u00c9TAPE 1 : Le tunnel est-il UP ?                               \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                               \u2502\n\u2502                                                                 \u2502\n\u2502   Test: ping srv-bastion-01                                     \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u251c\u2500\u2500 Succ\u00e8s \u2192 Tunnel probablement UP, aller \u00e0 \u00c9TAPE 2    \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u2514\u2500\u2500 \u00c9chec \u2192 Tunnel DOWN                                 \u2502\n\u2502                     \u2502                                           \u2502\n\u2502                     \u251c\u2500\u2500 V\u00e9rifier statut VPN sur FW-ADMIN        \u2502\n\u2502                     \u251c\u2500\u2500 V\u00e9rifier statut VPN sur FW-CORE         \u2502\n\u2502                     \u2514\u2500\u2500 Contacter \u00e9quipe R\u00e9seau/S\u00e9curit\u00e9        \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   \u00c9TAPE 2 : Le port cible est-il accessible ?                   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                   \u2502\n\u2502                                                                 \u2502\n\u2502   Test: Test-NetConnection srv-target -Port 3389                \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u251c\u2500\u2500 TcpTestSucceeded: True \u2192 Service accessible \u2705      \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u2514\u2500\u2500 TcpTestSucceeded: False                             \u2502\n\u2502                     \u2502                                           \u2502\n\u2502                     \u251c\u2500\u2500 Service arr\u00eat\u00e9 sur le serveur cible ?   \u2502\n\u2502                     \u251c\u2500\u2500 Firewall Windows bloque le port ?       \u2502\n\u2502                     \u2514\u2500\u2500 ACL sur FW-CORE bloque le flux ?        \u2502\n\u2502                                                                 \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\u2502                                                                 \u2502\n\u2502   \u00c9TAPE 3 : Probl\u00e8me de performance ?                           \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                           \u2502\n\u2502                                                                 \u2502\n\u2502   Test: ping -f -l 1400 srv-target                              \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u251c\u2500\u2500 Succ\u00e8s \u2192 MTU OK                                     \u2502\n\u2502         \u2502                                                       \u2502\n\u2502         \u2514\u2500\u2500 \"Packet needs fragmentation\"                        \u2502\n\u2502                     \u2502                                           \u2502\n\u2502                     \u2514\u2500\u2500 R\u00e9duire MTU sur l'interface client      \u2502\n\u2502                         ou demander ajustement sur les FW       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#34-script-de-diagnostic-vpn","title":"3.4 Script de Diagnostic VPN","text":"<pre><code>&lt;#\n.SYNOPSIS\n    Diagnostic de connectivit\u00e9 VPN ADSEC\n.DESCRIPTION\n    V\u00e9rifie la connectivit\u00e9 \u00e0 travers le tunnel VPN vers les cibles critiques\n#&gt;\n\nparam(\n    [switch]$Verbose\n)\n\nWrite-Host \"=== DIAGNOSTIC VPN ADSEC ===\" -ForegroundColor Cyan\nWrite-Host \"Date: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\"\nWrite-Host \"\"\n\n# Cibles \u00e0 tester\n$targets = @(\n    @{Name=\"DC Admin (Kerberos)\"; Host=\"srv-dc-admin-01\"; Port=88},\n    @{Name=\"DC Admin (LDAP)\"; Host=\"srv-dc-admin-01\"; Port=389},\n    @{Name=\"DC Admin (DNS)\"; Host=\"srv-dc-admin-01\"; Port=53},\n    @{Name=\"Bastion (RDP)\"; Host=\"srv-bastion-01\"; Port=3389},\n    @{Name=\"Bastion (SSH)\"; Host=\"srv-bastion-01\"; Port=22},\n    @{Name=\"WSUS (HTTP)\"; Host=\"srv-wsus-01\"; Port=8530}\n)\n\n$failures = 0\n\nWrite-Host \"[1/3] Test de connectivit\u00e9 TCP...\" -ForegroundColor Yellow\nforeach ($target in $targets) {\n    $result = Test-NetConnection -ComputerName $target.Host -Port $target.Port -WarningAction SilentlyContinue\n    if ($result.TcpTestSucceeded) {\n        Write-Host \"  \u2705 $($target.Name) [$($target.Host):$($target.Port)]\" -ForegroundColor Green\n    } else {\n        Write-Host \"  \u274c $($target.Name) [$($target.Host):$($target.Port)]\" -ForegroundColor Red\n        $failures++\n    }\n}\nWrite-Host \"\"\n\nWrite-Host \"[2/3] Test de r\u00e9solution DNS...\" -ForegroundColor Yellow\n$dnsTargets = @(\"srv-dc-admin-01\", \"srv-bastion-01\", \"srv-wsus-01\")\nforeach ($dns in $dnsTargets) {\n    try {\n        $resolved = Resolve-DnsName -Name $dns -ErrorAction Stop\n        Write-Host \"  \u2705 $dns \u2192 $($resolved.IPAddress)\" -ForegroundColor Green\n    } catch {\n        Write-Host \"  \u274c $dns \u2192 R\u00e9solution \u00e9chou\u00e9e\" -ForegroundColor Red\n        $failures++\n    }\n}\nWrite-Host \"\"\n\nWrite-Host \"[3/3] Test MTU (fragmentation)...\" -ForegroundColor Yellow\n$mtuTest = ping -f -l 1300 srv-bastion-01 -n 2 2&gt;&amp;1\nif ($mtuTest -match \"Reply from\") {\n    Write-Host \"  \u2705 MTU 1300+ : OK\" -ForegroundColor Green\n} else {\n    Write-Host \"  \u26a0\ufe0f  MTU 1300 : Fragmentation possible\" -ForegroundColor Yellow\n}\nWrite-Host \"\"\n\n# R\u00e9sum\u00e9\nWrite-Host \"=== R\u00c9SUM\u00c9 ===\" -ForegroundColor Cyan\nif ($failures -eq 0) {\n    Write-Host \"Tous les tests ont r\u00e9ussi. Tunnel VPN op\u00e9rationnel.\" -ForegroundColor Green\n} else {\n    Write-Host \"$failures test(s) en \u00e9chec. V\u00e9rifier le tunnel VPN.\" -ForegroundColor Red\n    Write-Host \"\"\n    Write-Host \"Actions recommand\u00e9es :\" -ForegroundColor Yellow\n    Write-Host \"  1. V\u00e9rifier le statut du tunnel sur FW-ADMIN\"\n    Write-Host \"  2. V\u00e9rifier le statut du tunnel sur FW-CORE\"\n    Write-Host \"  3. Contacter l'\u00e9quipe R\u00e9seau/S\u00e9curit\u00e9\"\n}\n</code></pre>"},{"location":"network/vpn-topology/#35-commandes-rapides","title":"3.5 Commandes Rapides","text":"<pre><code># === CONNECTIVIT\u00c9 ===\n# Test port unique\nTest-NetConnection srv-bastion-01 -Port 3389\n\n# Test ping simple\nping srv-bastion-01\n\n# Traceroute (voir le chemin)\ntracert srv-bastion-01\n\n# === MTU ===\n# Test MTU (Windows)\nping -f -l 1400 srv-bastion-01\n\n# Voir MTU actuelle\nnetsh interface ipv4 show subinterfaces\n\n# === DNS ===\n# R\u00e9solution\nnslookup srv-bastion-01\nResolve-DnsName srv-bastion-01\n\n# === ROUTE ===\n# Table de routage\nroute print\nGet-NetRoute -DestinationPrefix \"10.20.0.0/16\"\n</code></pre> <pre><code># === LINUX ===\n# Test port\nnc -zv srv-bastion-01 22\n\n# Test MTU\nping -M do -s 1400 srv-bastion-01\n\n# Traceroute\ntraceroute srv-bastion-01\n\n# Route\nip route show\n</code></pre>"},{"location":"network/vpn-topology/#procedure-descalade","title":"Proc\u00e9dure d'Escalade","text":""},{"location":"network/vpn-topology/#en-cas-de-tunnel-down","title":"En Cas de Tunnel DOWN","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              PROC\u00c9DURE D'ESCALADE - TUNNEL VPN DOWN              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                 \u2502\n\u2502   NIVEAU 1 : V\u00e9rification Initiale (Ops)              [5 min]   \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2502\n\u2502   \u2610 Ex\u00e9cuter le script de diagnostic                            \u2502\n\u2502   \u2610 V\u00e9rifier si le probl\u00e8me affecte tous les PADSEC            \u2502\n\u2502   \u2610 Documenter l'heure de d\u00e9but et les sympt\u00f4mes               \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 2 : \u00c9quipe R\u00e9seau                            [15 min]  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                      \u2502\n\u2502   \u2610 V\u00e9rifier statut IKE/IPsec sur FW-ADMIN                     \u2502\n\u2502   \u2610 V\u00e9rifier statut IKE/IPsec sur FW-CORE                      \u2502\n\u2502   \u2610 V\u00e9rifier les logs VPN pour erreurs                          \u2502\n\u2502   \u2610 Tenter un flap du tunnel (disable/enable)                   \u2502\n\u2502                                                                 \u2502\n\u2502   NIVEAU 3 : \u00c9quipe S\u00e9curit\u00e9                          [30 min]  \u2502\n\u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                     \u2502\n\u2502   \u2610 V\u00e9rifier expiration des certificats                         \u2502\n\u2502   \u2610 V\u00e9rifier les changements r\u00e9cents de configuration           \u2502\n\u2502   \u2610 Analyser les logs de s\u00e9curit\u00e9                               \u2502\n\u2502                                                                 \u2502\n\u2502   CONTACTS :                                                    \u2502\n\u2502   \u2022 R\u00e9seau : [Voir annuaire interne]                            \u2502\n\u2502   \u2022 S\u00e9curit\u00e9 : [Voir annuaire interne]                          \u2502\n\u2502   \u2022 Astreinte : [Voir planning astreinte]                       \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"network/vpn-topology/#parametres-de-reference","title":"Param\u00e8tres de R\u00e9f\u00e9rence","text":""},{"location":"network/vpn-topology/#configuration-ipsec","title":"Configuration IPsec","text":"Param\u00e8tre Valeur Notes IKE Version IKEv2 Plus s\u00e9curis\u00e9 que IKEv1 Encryption AES-256-GCM Chiffrement + int\u00e9grit\u00e9 PRF SHA-384 Pseudo-Random Function DH Group Group 20 (NIST P-384) \u00c9change de cl\u00e9s Auth Method Certificats X.509 PKI interne Lifetime Phase 1 28800 sec (8h) Rekey automatique Lifetime Phase 2 3600 sec (1h) Rekey automatique PFS Oui (Group 20) Perfect Forward Secrecy DPD 30 sec Dead Peer Detection"},{"location":"network/vpn-topology/#endpoints","title":"Endpoints","text":"\u00c9quipement IP Externe IP Interne R\u00f4le FW-ADMIN 172.16.1.1 10.10.0.1 Initiator FW-CORE 172.16.2.1 10.20.0.1 Responder <p>Derni\u00e8re mise \u00e0 jour : 2025-01-28 Version : 1.0 Classification : Interne - Infrastructure Critique Auteur : ShellBook Network Security Team</p>"},{"location":"security/certificates/","title":"Cheat Sheet : Commandes Certificats &amp; OpenSSL","text":"<p>R\u00e9f\u00e9rence rapide des commandes les plus utilis\u00e9es pour la gestion des certificats SSL/TLS.</p>"},{"location":"security/certificates/#generation-de-cles","title":"G\u00e9n\u00e9ration de Cl\u00e9s","text":"<pre><code># Cl\u00e9 RSA 2048 bits (sans passphrase)\nopenssl genrsa -out server.key 2048\n\n# Cl\u00e9 RSA 4096 bits avec chiffrement AES-256\nopenssl genrsa -aes256 -out ca.key 4096\n\n# Cl\u00e9 ECDSA (courbe P-256)\nopenssl ecparam -genkey -name prime256v1 -out server-ec.key\n\n# Cl\u00e9 ECDSA (courbe P-384, recommand\u00e9 ANSSI)\nopenssl ecparam -genkey -name secp384r1 -out server-ec.key\n</code></pre>"},{"location":"security/certificates/#generation-de-csr-certificate-signing-request","title":"G\u00e9n\u00e9ration de CSR (Certificate Signing Request)","text":"<pre><code># CSR simple (interactive)\nopenssl req -new -key server.key -out server.csr\n\n# CSR avec subject en ligne de commande\nopenssl req -new -key server.key -out server.csr \\\n    -subj \"/C=FR/ST=IDF/L=Paris/O=MyCorp/CN=www.example.com\"\n\n# CSR avec fichier de configuration (pour SAN)\nopenssl req -new -key server.key -out server.csr -config san.cnf\n</code></pre>"},{"location":"security/certificates/#certificats-auto-signes","title":"Certificats Auto-Sign\u00e9s","text":"<pre><code># Certificat auto-sign\u00e9 valide 365 jours\nopenssl req -x509 -new -nodes -key ca.key -sha256 -days 365 \\\n    -out ca.crt -subj \"/CN=My Root CA\"\n\n# Certificat auto-sign\u00e9 avec SAN\nopenssl req -x509 -new -nodes -key server.key -sha256 -days 365 \\\n    -out server.crt -config san.cnf -extensions req_ext\n</code></pre>"},{"location":"security/certificates/#signature-de-certificats","title":"Signature de Certificats","text":"<pre><code># Signer une CSR avec une CA\nopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key \\\n    -CAcreateserial -out server.crt -days 365 -sha256\n\n# Signer avec extensions (SAN, Key Usage)\nopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key \\\n    -CAcreateserial -out server.crt -days 365 -sha256 \\\n    -extfile extensions.cnf\n</code></pre>"},{"location":"security/certificates/#inspection-de-certificats","title":"Inspection de Certificats","text":"<pre><code># Afficher le contenu complet\nopenssl x509 -in cert.crt -text -noout\n\n# Afficher uniquement le Subject\nopenssl x509 -in cert.crt -subject -noout\n\n# Afficher uniquement l'Issuer\nopenssl x509 -in cert.crt -issuer -noout\n\n# Afficher les dates de validit\u00e9\nopenssl x509 -in cert.crt -dates -noout\n\n# Afficher le fingerprint SHA256\nopenssl x509 -in cert.crt -fingerprint -sha256 -noout\n\n# Afficher les SAN (Subject Alternative Names)\nopenssl x509 -in cert.crt -text -noout | grep -A1 \"Subject Alternative Name\"\n\n# V\u00e9rifier si expire dans N secondes (2592000 = 30 jours)\nopenssl x509 -in cert.crt -checkend 2592000 -noout\n</code></pre>"},{"location":"security/certificates/#inspection-de-csr","title":"Inspection de CSR","text":"<pre><code># Afficher le contenu d'une CSR\nopenssl req -in server.csr -text -noout\n\n# V\u00e9rifier la signature de la CSR\nopenssl req -in server.csr -verify -noout\n</code></pre>"},{"location":"security/certificates/#inspection-de-cles","title":"Inspection de Cl\u00e9s","text":"<pre><code># V\u00e9rifier une cl\u00e9 RSA\nopenssl rsa -in server.key -check -noout\n\n# Afficher les d\u00e9tails d'une cl\u00e9 RSA\nopenssl rsa -in server.key -text -noout\n\n# Extraire la cl\u00e9 publique\nopenssl rsa -in server.key -pubout -out server.pub\n\n# V\u00e9rifier correspondance cl\u00e9/certificat (les modulus doivent \u00eatre identiques)\nopenssl x509 -in cert.crt -noout -modulus | openssl md5\nopenssl rsa -in server.key -noout -modulus | openssl md5\n</code></pre>"},{"location":"security/certificates/#validation-de-chaine","title":"Validation de Cha\u00eene","text":"<pre><code># V\u00e9rifier un certificat contre une CA\nopenssl verify -CAfile ca.crt server.crt\n\n# V\u00e9rifier avec cha\u00eene compl\u00e8te (root + intermediate)\nopenssl verify -CAfile ca-chain.crt server.crt\n\n# Afficher la cha\u00eene de v\u00e9rification\nopenssl verify -CAfile ca-chain.crt -show_chain server.crt\n</code></pre>"},{"location":"security/certificates/#conversions-de-format","title":"Conversions de Format","text":""},{"location":"security/certificates/#pem-der","title":"PEM \u2194 DER","text":"<pre><code># PEM vers DER\nopenssl x509 -in cert.pem -outform DER -out cert.der\n\n# DER vers PEM\nopenssl x509 -in cert.der -inform DER -outform PEM -out cert.pem\n</code></pre>"},{"location":"security/certificates/#pem-pkcs12-pfx","title":"PEM \u2194 PKCS#12 (PFX)","text":"<pre><code># Cr\u00e9er un PFX (cl\u00e9 + cert + CA)\nopenssl pkcs12 -export -out bundle.pfx \\\n    -inkey server.key -in server.crt -certfile ca.crt\n\n# Extraire le certificat d'un PFX\nopenssl pkcs12 -in bundle.pfx -clcerts -nokeys -out cert.pem\n\n# Extraire la cl\u00e9 priv\u00e9e d'un PFX\nopenssl pkcs12 -in bundle.pfx -nocerts -nodes -out key.pem\n\n# Extraire les CA d'un PFX\nopenssl pkcs12 -in bundle.pfx -cacerts -nokeys -out ca.pem\n</code></pre>"},{"location":"security/certificates/#pkcs7-p7b","title":"PKCS#7 (P7B)","text":"<pre><code># PEM vers PKCS#7\nopenssl crl2pkcs7 -nocrl -certfile cert.pem -out cert.p7b\n\n# PKCS#7 vers PEM\nopenssl pkcs7 -in cert.p7b -print_certs -out cert.pem\n</code></pre>"},{"location":"security/certificates/#test-de-connexion-tls","title":"Test de Connexion TLS","text":"<pre><code># Connexion basique\nopenssl s_client -connect example.com:443\n\n# Avec SNI (Server Name Indication)\nopenssl s_client -connect example.com:443 -servername www.example.com\n\n# Afficher la cha\u00eene compl\u00e8te\nopenssl s_client -connect example.com:443 -showcerts\n\n# Forcer TLS 1.3\nopenssl s_client -connect example.com:443 -tls1_3\n\n# Forcer TLS 1.2\nopenssl s_client -connect example.com:443 -tls1_2\n\n# Avec CA bundle personnalis\u00e9\nopenssl s_client -connect example.com:443 -CAfile ca-bundle.crt\n\n# Extraire le certificat d'un serveur\necho | openssl s_client -connect example.com:443 2&gt;/dev/null | \\\n    sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; server.crt\n\n# Test STARTTLS (SMTP)\nopenssl s_client -connect mail.example.com:25 -starttls smtp\n\n# Test STARTTLS (IMAP)\nopenssl s_client -connect mail.example.com:143 -starttls imap\n</code></pre>"},{"location":"security/certificates/#gestion-des-passphrases","title":"Gestion des Passphrases","text":"<pre><code># Retirer la passphrase d'une cl\u00e9\nopenssl rsa -in encrypted.key -out decrypted.key\n\n# Ajouter une passphrase \u00e0 une cl\u00e9\nopenssl rsa -in decrypted.key -aes256 -out encrypted.key\n\n# Changer la passphrase\nopenssl rsa -in oldpass.key -aes256 -out newpass.key\n</code></pre>"},{"location":"security/certificates/#generation-de-hashs","title":"G\u00e9n\u00e9ration de Hashs","text":"<pre><code># Hash SHA256 d'un fichier\nopenssl dgst -sha256 file.txt\n\n# Hash SHA256 avec signature\nopenssl dgst -sha256 -sign private.key -out signature.bin file.txt\n\n# V\u00e9rifier une signature\nopenssl dgst -sha256 -verify public.key -signature signature.bin file.txt\n</code></pre>"},{"location":"security/certificates/#configuration-openssl-pour-san","title":"Configuration OpenSSL pour SAN","text":"<p>Fichier <code>san.cnf</code> exemple :</p> <pre><code>[req]\ndefault_bits       = 2048\nprompt             = no\ndefault_md         = sha256\ndistinguished_name = dn\nreq_extensions     = req_ext\n\n[dn]\nC  = FR\nST = Ile-de-France\nL  = Paris\nO  = MyCorp\nCN = www.example.com\n\n[req_ext]\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = www.example.com\nDNS.2 = example.com\nDNS.3 = api.example.com\nIP.1  = 192.168.1.100\n</code></pre>"},{"location":"security/certificates/#tableau-des-formats-de-fichiers","title":"Tableau des Formats de Fichiers","text":"Extension Format Contenu Usage <code>.pem</code> ASCII Base64 Cl\u00e9, Cert, ou les deux Linux, Apache, Nginx <code>.crt</code> ASCII/DER Certificat Universel <code>.cer</code> ASCII/DER Certificat Windows <code>.key</code> ASCII Base64 Cl\u00e9 priv\u00e9e Configuration serveur <code>.der</code> Binaire Certificat Java <code>.pfx</code> <code>.p12</code> Binaire PKCS#12 Cl\u00e9 + Cert + Cha\u00eene Windows/IIS <code>.csr</code> ASCII Base64 Requ\u00eate de signature Soumission CA <code>.p7b</code> ASCII/Binaire PKCS#7 Cha\u00eene de certificats Windows"},{"location":"security/certificates/#codes-derreur-courants","title":"Codes d'Erreur Courants","text":"Code Message Cause <code>2</code> <code>unable to get issuer certificate</code> Cha\u00eene incompl\u00e8te <code>10</code> <code>certificate has expired</code> Certificat p\u00e9rim\u00e9 <code>18</code> <code>self-signed certificate</code> CA non reconnue <code>20</code> <code>unable to get local issuer certificate</code> Root CA manquante <code>21</code> <code>unable to verify first certificate</code> Cha\u00eene non pr\u00e9sent\u00e9e <p>Version : 1.0 Derni\u00e8re mise \u00e0 jour : 2025-01-28</p>"}]}