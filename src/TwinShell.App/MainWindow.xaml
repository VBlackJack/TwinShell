<Window x:Class="TwinShell.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TwinShell.App"
        xmlns:vm="clr-namespace:TwinShell.App.ViewModels"
        xmlns:behaviors="clr-namespace:TwinShell.App.Behaviors"
        mc:Ignorable="d"
        Title="TwinShell - PowerShell &amp; Bash Command Manager"
        Height="900" Width="1200"
        MinHeight="600" MinWidth="800"
        Background="{DynamicResource BackgroundBrush}"
        Icon="Assets/twinshell-icon.png"
        AutomationProperties.Name="TwinShell Main Window"
        AutomationProperties.HelpText="PowerShell and Bash command manager application">

    <Window.InputBindings>
        <!-- UX: Standard Windows keyboard shortcuts for better discoverability -->
        <!-- New Action: Ctrl+N -->
        <KeyBinding Key="N" Modifiers="Control" Command="{Binding AddNewActionCommand}"/>
        <!-- Search: Ctrl+F -->
        <KeyBinding Key="F" Modifiers="Control" Command="{Binding FocusSearchCommand}"/>
        <!-- Copy: Ctrl+C (on generated command) -->
        <KeyBinding Key="C" Modifiers="Control" Command="{Binding CopyCommandCommand}"/>
        <!-- Export: Ctrl+E -->
        <KeyBinding Key="E" Modifiers="Control" Command="{Binding ExportConfigurationCommand}"/>
        <!-- Import: Ctrl+I -->
        <KeyBinding Key="I" Modifiers="Control" Command="{Binding ImportConfigurationCommand}"/>
        <!-- Refresh: F5 -->
        <KeyBinding Key="F5" Command="{Binding RefreshCommand}"/>
        <!-- Help: F1 -->
        <KeyBinding Key="F1" Command="{Binding ShowHelpCommand}"/>
        <!-- Clear filters: Ctrl+K -->
        <KeyBinding Key="K" Modifiers="Control" Command="{Binding ClearFiltersCommand}"/>
        <!-- UX: Additional essential shortcuts for power users -->
        <!-- Toggle Favorite: Ctrl+D (like bookmark) -->
        <KeyBinding Key="D" Modifiers="Control" Command="{Binding ToggleFavoriteCommand}"/>
        <!-- Close/Cancel dialogs: Escape -->
        <KeyBinding Key="Escape" Command="{Binding CancelCommand}"/>
        <!-- UX: Tab navigation shortcuts (standard Windows pattern) -->
        <!-- Next tab: Ctrl+Tab -->
        <KeyBinding Key="Tab" Modifiers="Control" Command="{Binding NextTabCommand}"/>
        <!-- Previous tab: Ctrl+Shift+Tab -->
        <KeyBinding Key="Tab" Modifiers="Control+Shift" Command="{Binding PreviousTabCommand}"/>
        <!-- Go to Actions: Ctrl+1 -->
        <KeyBinding Key="D1" Modifiers="Control" Command="{Binding GoToActionsTabCommand}"/>
        <!-- Go to History: Ctrl+2 -->
        <KeyBinding Key="D2" Modifiers="Control" Command="{Binding GoToHistoryTabCommand}"/>
    </Window.InputBindings>

    <Grid x:Name="RootGrid">
    <DockPanel>
        <!-- UX: Menu reorganized following Windows standards (File/Edit/View/Tools/Help) -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_New Action..." InputGestureText="Ctrl+N"
                          Command="{Binding AddNewActionCommand}"
                          ToolTip="Create a new custom action"/>
                <Separator/>
                <MenuItem Header="_Export">
                    <MenuItem Header="_User Data (Favorites, History)..." InputGestureText="Ctrl+E"
                              Command="{Binding ExportConfigurationCommand}"
                              ToolTip="Export your favorites and history to a JSON file"/>
                    <MenuItem Header="_Actions Database..."
                              Command="{Binding ExportActionsCommand}"
                              ToolTip="Export all actions to a JSON file"/>
                </MenuItem>
                <MenuItem Header="_Import">
                    <MenuItem Header="_User Data (Favorites, History)..." InputGestureText="Ctrl+I"
                              Command="{Binding ImportConfigurationCommand}"
                              ToolTip="Import favorites and history from a JSON file"/>
                    <MenuItem Header="_Actions Database..."
                              Command="{Binding ImportActionsCommand}"
                              ToolTip="Import actions from a JSON file"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="E_xit" InputGestureText="Alt+F4" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Find..." InputGestureText="Ctrl+F"
                          Command="{Binding FocusSearchCommand}"
                          ToolTip="Focus the search box to search for actions"/>
                <MenuItem Header="C_lear Filters" InputGestureText="Ctrl+K"
                          Command="{Binding ClearFiltersCommand}"
                          ToolTip="Reset all search filters to show all actions"/>
                <Separator/>
                <MenuItem Header="_Edit Selected Action..."
                          Command="{Binding EditActionCommand}"
                          ToolTip="Edit the selected action"/>
                <MenuItem Header="_Delete Selected Action"
                          Command="{Binding DeleteActionCommand}"
                          ToolTip="Delete the selected action (permanently removes from database)"/>
                <Separator/>
                <MenuItem Header="_Preferences..."
                          Click="Settings_Click"
                          ToolTip="Configure application settings, theme, and behavior"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="_Theme">
                    <MenuItem Header="_Light Theme"
                              Command="{Binding SetLightThemeCommand}"
                              ToolTip="Switch to light theme"/>
                    <MenuItem Header="_Dark Theme"
                              Command="{Binding SetDarkThemeCommand}"
                              ToolTip="Switch to dark theme"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="_Refresh" InputGestureText="F5"
                          Command="{Binding RefreshCommand}"
                          ToolTip="Reload actions and data"/>
            </MenuItem>
            <MenuItem Header="_Tools">
                <MenuItem Header="_Manage Categories..."
                          Click="ManageCategories_Click"
                          ToolTip="Create and organize custom categories"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Keyboard Shortcuts" InputGestureText="F1" Click="KeyboardShortcuts_Click"
                          ToolTip="View all available keyboard shortcuts"/>
                <Separator/>
                <MenuItem Header="_About TwinShell" Click="About_Click"
                          ToolTip="About TwinShell - version and information"/>
            </MenuItem>
        </Menu>

        <!-- UX: Main Content with cleaner layout (removed redundant header) -->
        <Grid Margin="16">
        <!-- UX: Tabs with text-only headers (professional, accessible, language-unified) -->
        <TabControl>
            <TabItem Header="Actions">
                <Grid Margin="0,16,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

        <!-- Search and Filters -->
        <Border Grid.Row="0"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16"
                Margin="0,0,0,16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- UX: Simplified search box with cleaner helper text -->
                <Grid Grid.Row="0" Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="SearchTextBox"
                             Grid.Column="0"
                             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource ModernTextBoxStyle}"
                             FontSize="14"
                             TabIndex="1"
                             behaviors:TextBoxPlaceholderBehavior.Placeholder="Search actions by name, description, or category..."
                             AutomationProperties.Name="Search actions"
                             AutomationProperties.HelpText="Search for actions by name, description or category. Press Ctrl+K to clear.">
                        <TextBox.InputBindings>
                            <KeyBinding Key="K" Modifiers="Control"
                                      Command="{Binding DataContext.ClearFiltersCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                        </TextBox.InputBindings>
                    </TextBox>

                    <Button Grid.Column="1"
                            Content="✕"
                            Command="{Binding ClearFiltersCommand}"
                            Style="{StaticResource PrimaryButtonStyle}"
                            VerticalAlignment="Center"
                            Margin="8,0,0,0"
                            Padding="12,8"
                            FontSize="16"
                            FontWeight="Bold"
                            MinWidth="44"
                            MinHeight="44"
                            TabIndex="2"
                            ToolTip="Clear search and filters (Ctrl+K)"
                            AutomationProperties.Name="Clear search"
                            AutomationProperties.HelpText="Clear search text and reset all filters"/>
                </Grid>

                <!-- UX: Filters with consistent English labels and lighter weight -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Platform Filters -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,24,0">
                        <TextBlock Text="Platform:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,12,0"
                                   FontWeight="Medium"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <CheckBox Content="Windows" IsChecked="{Binding FilterWindows}" Margin="0,0,12,0"
                                  TabIndex="2"
                                  AutomationProperties.Name="Filter by Windows platform"/>
                        <CheckBox Content="Linux" IsChecked="{Binding FilterLinux}" Margin="0,0,12,0"
                                  TabIndex="3"
                                  AutomationProperties.Name="Filter by Linux platform"/>
                        <CheckBox Content="Windows &amp; Linux" IsChecked="{Binding FilterBoth}"
                                  TabIndex="4"
                                  ToolTip="Commands that work on both Windows and Linux"
                                  AutomationProperties.Name="Filter by cross-platform actions"
                                  AutomationProperties.HelpText="Filter to show only actions that work on both Windows and Linux platforms"/>
                    </StackPanel>

                    <!-- Level Filters -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <TextBlock Text="Level:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,12,0"
                                   FontWeight="Medium"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <CheckBox Content="Info" IsChecked="{Binding FilterInfo}" Margin="0,0,12,0"
                                  TabIndex="5"
                                  AutomationProperties.Name="Filter by informational commands"/>
                        <CheckBox Content="Run" IsChecked="{Binding FilterRun}" Margin="0,0,12,0"
                                  TabIndex="6"
                                  AutomationProperties.Name="Filter by executable commands"/>
                        <CheckBox Content="Dangerous" IsChecked="{Binding FilterDangerous}"
                                  TabIndex="7"
                                  AutomationProperties.Name="Filter by dangerous commands"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- UX: Rebalanced 3-column layout (250px | 350px | *) for better proportions -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" MinWidth="150"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="350" MinWidth="200"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- Categories Panel -->
            <Border Grid.Column="0"
                    Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Top"
                               Text="Categories"
                               FontSize="14"
                               FontWeight="SemiBold"
                               Padding="12"
                               Background="{DynamicResource PrimaryBrush}"
                               Foreground="{DynamicResource TextOnPrimaryBrush}"/>
                    <ListBox ItemsSource="{Binding Categories}"
                             SelectedItem="{Binding SelectedCategory}"
                             BorderThickness="0"
                             Background="Transparent"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             TabIndex="8"
                             AutomationProperties.Name="Categories list"
                             AutomationProperties.HelpText="Select a category to filter actions">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Padding="8,4"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
            </Border>

            <!-- GridSplitter for Categories/Actions -->
            <GridSplitter Grid.Column="1"
                          Width="6"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Background="Transparent"
                          ShowsPreview="False"
                          ResizeBehavior="PreviousAndNext"
                          Cursor="SizeWE"/>

            <!-- Actions ListBox -->
            <Border Grid.Column="2"
                    Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Top"
                               Text="{Binding FilteredActions.Count, StringFormat='Actions ({0})'}"
                               FontSize="14"
                               FontWeight="Bold"
                               Padding="12"
                               Background="{DynamicResource PrimaryBrush}"
                               Foreground="{DynamicResource TextOnPrimaryBrush}"/>
                    <ListBox ItemsSource="{Binding FilteredActions}"
                             SelectedItem="{Binding SelectedAction}"
                             BorderThickness="0"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ItemContainerStyle="{StaticResource ActionListBoxItemStyle}"
                             VirtualizingPanel.IsVirtualizing="True"
                             VirtualizingPanel.VirtualizationMode="Recycling"
                             VirtualizingPanel.CacheLength="20,20"
                             VirtualizingPanel.CacheLengthUnit="Item"
                             TabIndex="9"
                             AutomationProperties.Name="Actions list"
                             AutomationProperties.HelpText="Select an action to view details and generate commands">
                        <!-- UX: Context menu for power users (right-click actions) -->
                        <ListBox.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Edit Action..."
                                          Command="{Binding EditActionCommand}"
                                          ToolTip="Edit this action"/>
                                <MenuItem Header="Add to Favorites"
                                          Command="{Binding ToggleFavoriteCommand}"
                                          ToolTip="Add this action to your favorites"/>
                                <Separator/>
                                <MenuItem Header="Copy Action ID"
                                          Command="{Binding CopyActionIdCommand}"
                                          ToolTip="Copy the action ID to clipboard"/>
                                <MenuItem Header="Export Action..."
                                          Command="{Binding ExportActionCommand}"
                                          ToolTip="Export this action to a JSON file"/>
                                <MenuItem Header="Import Action..."
                                          Command="{Binding ImportActionCommand}"
                                          ToolTip="Import an action from a JSON file"/>
                            </ContextMenu>
                        </ListBox.ContextMenu>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding Title}"
                                               FontWeight="SemiBold"
                                               TextWrapping="Wrap"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                        <Border Style="{StaticResource PlatformBadgeStyle}">
                                            <TextBlock Text="{Binding Platform, Converter={StaticResource PlatformToTextConverter}}"
                                                       FontSize="10"
                                                       Foreground="{DynamicResource PrimaryBrush}"/>
                                        </Border>
                                        <Border Style="{StaticResource LevelBadgeStyle}"
                                                Background="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}"
                                                BorderBrush="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}">
                                            <TextBlock Text="{Binding Level, Converter={StaticResource CriticalityToTextConverter}}"
                                                       FontSize="10"
                                                       Foreground="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}"/>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
            </Border>

            <!-- GridSplitter for Actions/Details -->
            <GridSplitter Grid.Column="3"
                          Width="6"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Background="Transparent"
                          ShowsPreview="False"
                          ResizeBehavior="PreviousAndNext"
                          Cursor="SizeWE"/>

            <!-- Action Details and Command Generator -->
            <Border Grid.Column="4"
                    Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="16" DataContext="{Binding SelectedAction}">
                        <!-- UX: Enhanced empty state with icon and better guidance -->
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Top"
                                    Margin="0,60,0,0">
                            <StackPanel.Style>
                                <Style TargetType="StackPanel">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Style>

                            <TextBlock Text="&#xE8A4;"
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="48"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,16"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Opacity="0.6"/>
                            <TextBlock Text="Select an Action"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="Choose an action from the list to view details&#x0a;and generate commands"
                                       FontSize="12"
                                       HorizontalAlignment="Center"
                                       TextAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       TextWrapping="Wrap"
                                       MaxWidth="250"/>
                        </StackPanel>

                        <!-- Action Details -->
                        <StackPanel>
                            <StackPanel.Style>
                                <Style TargetType="StackPanel">
                                    <Setter Property="Visibility" Value="Visible"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Style>

                            <!-- UX: Title with improved Favorite button (clear visual state) -->
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0"
                                           Text="{Binding Title}"
                                           FontSize="20"
                                           FontWeight="SemiBold"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>

                                <!-- UX: Favorite button with clear visual states (empty/filled star) -->
                                <Button Grid.Column="1"
                                        x:Name="FavoriteButton"
                                        FontSize="20"
                                        Padding="10,6"
                                        Margin="8,0,0,0"
                                        Background="Transparent"
                                        BorderThickness="1"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        Cursor="Hand"
                                        Command="{Binding DataContext.ToggleFavoriteCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                        VerticalAlignment="Center"
                                        TabIndex="11"
                                        MinWidth="44"
                                        MinHeight="44"
                                        AutomationProperties.Name="Toggle favorite">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Content" Value="☆"/>
                                            <Setter Property="Foreground" Value="#9E9E9E"/>
                                            <Setter Property="AutomationProperties.HelpText" Value="Add this action to your favorites"/>
                                            <!-- UX: Tooltip with keyboard shortcut -->
                                            <Setter Property="ToolTip">
                                                <Setter.Value>
                                                    <ToolTip>
                                                        <StackPanel>
                                                            <TextBlock Text="Add to Favorites" FontWeight="SemiBold"/>
                                                            <TextBlock Text="Ctrl+D" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,2,0,0"/>
                                                        </StackPanel>
                                                    </ToolTip>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <!-- UX: Filled star when favorited -->
                                                <DataTrigger Binding="{Binding DataContext.IsCurrentActionFavorite, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                    <Setter Property="Content" Value="★"/>
                                                    <Setter Property="Foreground" Value="#FFD700"/>
                                                    <Setter Property="Background" Value="#FFFEF5"/>
                                                    <Setter Property="AutomationProperties.HelpText" Value="Remove this action from your favorites"/>
                                                    <Setter Property="ToolTip">
                                                        <Setter.Value>
                                                            <ToolTip>
                                                                <StackPanel>
                                                                    <TextBlock Text="Remove from Favorites" FontWeight="SemiBold"/>
                                                                    <TextBlock Text="Ctrl+D" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,2,0,0"/>
                                                                </StackPanel>
                                                            </ToolTip>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                                <!-- UX: Hover effect -->
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="#FFD700"/>
                                                    <Setter Property="Background" Value="#FFFEF5"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>

                            <!-- Badges -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <Border Style="{StaticResource PlatformBadgeStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding Platform, Converter={StaticResource PlatformToIconConverter}}"
                                                   Margin="0,0,4,0"/>
                                        <TextBlock Text="{Binding Platform, Converter={StaticResource PlatformToTextConverter}}"
                                                   Foreground="{DynamicResource PrimaryBrush}"/>
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource LevelBadgeStyle}"
                                        Background="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}"
                                        BorderBrush="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}">
                                    <TextBlock Text="{Binding Level, Converter={StaticResource CriticalityToTextConverter}}"
                                               Foreground="{Binding Level, Converter={StaticResource CriticalityToColorConverter}}"
                                               FontWeight="SemiBold"/>
                                </Border>
                            </StackPanel>

                            <!-- Tags -->
                            <ItemsControl ItemsSource="{Binding Tags}" Margin="0,0,0,16">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{DynamicResource SurfaceBrush}"
                                                BorderBrush="{DynamicResource BorderBrush}"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="8,4"
                                                Margin="0,0,4,4">
                                            <TextBlock Text="{Binding}"
                                                       FontSize="11"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- UX: Danger banner with clearer English wording -->
                            <Border>
                                <Border.Style>
                                    <Style TargetType="Border" BasedOn="{StaticResource DangerBannerStyle}">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Level}" Value="2">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center" Foreground="{DynamicResource DangerBrush}"/>
                                    <TextBlock Text="WARNING: This command can cause significant system changes"
                                               Foreground="{DynamicResource DangerBrush}"
                                               FontWeight="SemiBold"
                                               TextWrapping="Wrap"/>
                                </StackPanel>
                            </Border>

                            <!-- Description -->
                            <TextBlock Text="Description"
                                       FontWeight="SemiBold"
                                       FontSize="14"
                                       Margin="0,0,0,4"/>
                            <TextBlock Text="{Binding Description}"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,16"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>

                            <!-- Examples Section with Platform Selector for Cross-Platform Actions -->
                            <StackPanel Margin="0,0,0,16">
                                <!-- Examples Header with Platform Switcher for cross-platform actions -->
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0"
                                               Text="Examples"
                                               FontWeight="SemiBold"
                                               FontSize="14"
                                               VerticalAlignment="Center"/>

                                    <!-- Platform Switcher (only visible for cross-platform actions) -->
                                    <StackPanel Grid.Column="1"
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center">
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.IsCommandCrossPlatform, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </StackPanel.Style>

                                        <!-- Windows Button -->
                                        <Border CornerRadius="4,0,0,4"
                                                BorderThickness="1"
                                                BorderBrush="{DynamicResource PrimaryBrush}"
                                                Cursor="Hand"
                                                Padding="12,4">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.SelectedPlatformForGenerator, RelativeSource={RelativeSource AncestorType=Window}}" Value="Windows">
                                                            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Border.InputBindings>
                                                <MouseBinding MouseAction="LeftClick"
                                                              Command="{Binding DataContext.SelectWindowsPlatformCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                            </Border.InputBindings>
                                            <TextBlock Text="Windows"
                                                       FontSize="11"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.SelectedPlatformForGenerator, RelativeSource={RelativeSource AncestorType=Window}}" Value="Windows">
                                                                <Setter Property="Foreground" Value="White"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>

                                        <!-- Linux Button -->
                                        <Border CornerRadius="0,4,4,0"
                                                BorderThickness="0,1,1,1"
                                                BorderBrush="{DynamicResource PrimaryBrush}"
                                                Cursor="Hand"
                                                Padding="12,4">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.SelectedPlatformForGenerator, RelativeSource={RelativeSource AncestorType=Window}}" Value="Linux">
                                                            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Border.InputBindings>
                                                <MouseBinding MouseAction="LeftClick"
                                                              Command="{Binding DataContext.SelectLinuxPlatformCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                            </Border.InputBindings>
                                            <TextBlock Text="Linux"
                                                       FontSize="11"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.SelectedPlatformForGenerator, RelativeSource={RelativeSource AncestorType=Window}}" Value="Linux">
                                                                <Setter Property="Foreground" Value="White"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </StackPanel>
                                </Grid>

                                <!-- Examples List - bound to CurrentExamples from MainViewModel -->
                                <ItemsControl ItemsSource="{Binding DataContext.CurrentExamples, RelativeSource={RelativeSource AncestorType=Window}}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Margin="0,0,0,8"
                                                    CornerRadius="4"
                                                    Cursor="Hand"
                                                    ToolTip="Click to copy this command to clipboard">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="{DynamicResource CodeBackgroundBrush}"/>
                                                        <Setter Property="BorderBrush" Value="{DynamicResource CodeBorderBrush}"/>
                                                        <Setter Property="BorderThickness" Value="1"/>
                                                        <Setter Property="Padding" Value="8"/>
                                                        <Style.Triggers>
                                                            <!-- Hover effect -->
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
                                                                <Setter Property="Background" Value="{DynamicResource SurfaceElevatedBrush}"/>
                                                            </Trigger>
                                                            <!-- Selected state -->
                                                            <DataTrigger Value="True">
                                                                <DataTrigger.Binding>
                                                                    <MultiBinding Converter="{StaticResource EqualityConverter}">
                                                                        <Binding/>
                                                                        <Binding Path="DataContext.SelectedExample" RelativeSource="{RelativeSource AncestorType=Window}"/>
                                                                    </MultiBinding>
                                                                </DataTrigger.Binding>
                                                                <Setter Property="BorderBrush" Value="{DynamicResource SuccessBrush}"/>
                                                                <Setter Property="BorderThickness" Value="2"/>
                                                                <Setter Property="Background" Value="{DynamicResource SuccessBackgroundBrush}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <Border.InputBindings>
                                                    <MouseBinding MouseAction="LeftClick"
                                                                  Command="{Binding DataContext.ApplyExampleCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                  CommandParameter="{Binding}"/>
                                                </Border.InputBindings>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Command, Mode=OneWay}"
                                                               FontFamily="Consolas"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource CodeTextBrush}"
                                                               TextWrapping="Wrap"/>
                                                    <TextBlock Text="{Binding Description, Mode=OneWay}"
                                                               FontSize="11"
                                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                                               TextWrapping="Wrap"
                                                               Margin="0,4,0,0"/>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                                <!-- Empty state when no examples -->
                                <TextBlock Text="No examples available for this platform"
                                           FontStyle="Italic"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,4,0,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding DataContext.CurrentExamples.Count, RelativeSource={RelativeSource AncestorType=Window}}" Value="0">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>

                            <!-- Notes -->
                            <StackPanel>
                                <StackPanel.Style>
                                    <Style TargetType="StackPanel">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Notes, Converter={StaticResource BoolToVisibilityConverter}}" Value="Visible">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </StackPanel.Style>
                                <TextBlock Text="Notes"
                                           FontWeight="Bold"
                                           Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding Notes}"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,16"/>
                            </StackPanel>

                            <!-- UX: Command Generator with English labels and clearer structure -->
                            <Border Background="{DynamicResource SurfaceElevatedBrush}"
                                    BorderBrush="{DynamicResource SuccessBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    Padding="12"
                                    Margin="0,8,0,0">
                                <StackPanel DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=Window}}">
                                    <!-- Header with mode indicator and reset button -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="Command Generator"
                                                       FontWeight="SemiBold"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                                            <!-- Example mode indicator -->
                                            <Border Background="{DynamicResource PrimaryBrush}"
                                                    CornerRadius="8"
                                                    Padding="8,2"
                                                    Margin="8,0,0,0"
                                                    VerticalAlignment="Center">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsUsingExampleMode}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock Text="Example Mode"
                                                           FontSize="10"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource TextOnPrimaryBrush}"/>
                                            </Border>
                                        </StackPanel>

                                        <!-- Reset to Template button (only visible in example mode) -->
                                        <Button Grid.Column="1"
                                                Content="Reset to Template"
                                                Command="{Binding ResetToTemplateCommand}"
                                                FontSize="11"
                                                Padding="8,4"
                                                VerticalAlignment="Center"
                                                ToolTip="Return to the default template-based generator">
                                            <Button.Style>
                                                <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsUsingExampleMode}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>

                                    <!-- Platform Selector (visible only for cross-platform commands) -->
                                    <Border Background="{DynamicResource BackgroundBrush}"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="4"
                                            Padding="12"
                                            Margin="0,0,0,12">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsCommandCrossPlatform}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <StackPanel>
                                            <TextBlock Text="Select Platform"
                                                       FontWeight="SemiBold"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                                       Margin="0,0,0,8"/>
                                            <StackPanel Orientation="Horizontal">
                                                <RadioButton Content="Windows"
                                                             GroupName="PlatformSelector"
                                                             IsChecked="{Binding SelectedPlatformForGenerator, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter=Windows}"
                                                             Margin="0,0,16,0"
                                                             VerticalContentAlignment="Center">
                                                    <RadioButton.Style>
                                                        <Style TargetType="RadioButton">
                                                            <Setter Property="FontSize" Value="12"/>
                                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                                        </Style>
                                                    </RadioButton.Style>
                                                </RadioButton>
                                                <RadioButton Content="Linux"
                                                             GroupName="PlatformSelector"
                                                             IsChecked="{Binding SelectedPlatformForGenerator, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter=Linux}"
                                                             VerticalContentAlignment="Center">
                                                    <RadioButton.Style>
                                                        <Style TargetType="RadioButton">
                                                            <Setter Property="FontSize" Value="12"/>
                                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                                        </Style>
                                                    </RadioButton.Style>
                                                </RadioButton>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>

                                    <!-- Parameters -->
                                    <ItemsControl ItemsSource="{Binding CommandParameters}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="0,0,0,8">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Label, Mode=OneWay}"/>
                                                        <TextBlock Text="*" Foreground="{DynamicResource DangerBrush}" Margin="2,0,0,0">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Required}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    <!-- TextBox with dynamic style based on Type -->
                                                    <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             Margin="0,4,0,0"
                                                             AutomationProperties.LabeledBy="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=StackPanel}, Path=Children[0]}"
                                                             AutomationProperties.HelpText="{Binding Description}">
                                                        <TextBox.Style>
                                                            <Style TargetType="TextBox" BasedOn="{StaticResource ModernTextBoxStyle}">
                                                                <Setter Property="MinHeight" Value="0"/>
                                                                <Setter Property="MaxHeight" Value="Infinity"/>
                                                                <Setter Property="TextWrapping" Value="NoWrap"/>
                                                                <Setter Property="AcceptsReturn" Value="False"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Type}" Value="multiline">
                                                                        <Setter Property="FontFamily" Value="Consolas"/>
                                                                        <Setter Property="FontSize" Value="12"/>
                                                                        <Setter Property="MinHeight" Value="80"/>
                                                                        <Setter Property="MaxHeight" Value="200"/>
                                                                        <Setter Property="TextWrapping" Value="Wrap"/>
                                                                        <Setter Property="AcceptsReturn" Value="True"/>
                                                                        <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
                                                                        <Setter Property="Background" Value="{DynamicResource CodeBackgroundBrush}"/>
                                                                        <Setter Property="Foreground" Value="{DynamicResource CodeTextBrush}"/>
                                                                        <Setter Property="BorderBrush" Value="{DynamicResource CodeBorderBrush}"/>
                                                                        <Setter Property="Padding" Value="8"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBox.Style>
                                                    </TextBox>
                                                    <TextBlock Text="{Binding Description}"
                                                               FontSize="10"
                                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                                               TextWrapping="Wrap"
                                                               Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <!-- Generated Command -->
                                    <TextBlock Text="Generated Command"
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"
                                               Margin="0,8,0,4"/>
                                    <Border Background="{DynamicResource CodeBackgroundBrush}"
                                            BorderBrush="{DynamicResource CodeBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="4"
                                            Padding="8">
                                        <TextBox x:Name="GeneratedCommandText"
                                                 Text="{Binding GeneratedCommand, Mode=OneWay}"
                                                 FontFamily="Consolas"
                                                 FontSize="12"
                                                 Foreground="{DynamicResource CodeTextBrush}"
                                                 TextWrapping="Wrap"
                                                 IsReadOnly="True"
                                                 BorderThickness="0"
                                                 Background="Transparent"
                                                 IsTabStop="False"/>
                                    </Border>

                                    <!-- UX: Action button (Execute hidden until Sprint 4 - reduces confusion and UI clutter) -->
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
                                        <Button Content="Copy to Clipboard"
                                                Command="{Binding CopyCommandCommand}"
                                                Style="{StaticResource PrimaryButtonStyle}"
                                                Padding="16,10"
                                                MinWidth="44"
                                                MinHeight="44"
                                                TabIndex="12"
                                                AutomationProperties.Name="Copy command to clipboard"
                                                AutomationProperties.HelpText="Copy the generated command to clipboard for use in terminal">
                                            <Button.ToolTip>
                                                <ToolTip>
                                                    <StackPanel>
                                                        <TextBlock Text="Copy to Clipboard" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Ctrl+C" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,2,0,0"/>
                                                    </StackPanel>
                                                </ToolTip>
                                            </Button.ToolTip>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
                </Grid>
            </TabItem>

            <!-- History Tab -->
            <TabItem Header="History">
                <ContentControl x:Name="HistoryTabContent"/>
            </TabItem>

            <!-- UX: Execution Tab completely removed until Sprint 4 - cleaner, less confusing -->
        </TabControl>
        </Grid>
    </DockPanel>
    </Grid>
</Window>
