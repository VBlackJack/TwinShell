{
  "id": "eventlog-get-critical-errors",
  "title": "Rechercher les erreurs critiques dans les logs syst√®me",
  "description": "Extrait les √©v√©nements de niveau Critique et Erreur des derni√®res heures depuis le journal System",
  "category": "üìä Monitoring & Logs",
  "platform": 0,
  "level": 0,
  "tags": [
    "eventlog",
    "errors",
    "diagnostic",
    "system"
  ],
  "windowsCommandTemplateId": "eventlog-get-critical-errors-cmd",
  "windowsCommandTemplate": {
    "id": "eventlog-get-critical-errors-cmd",
    "platform": 0,
    "name": "Get-WinEvent",
    "commandPattern": "Get-WinEvent -FilterHashtable @{LogName='System'; Level=1,2; StartTime=(Get-Date).AddHours(-{hours})} | Select-Object TimeCreated,ProviderName,Id,LevelDisplayName,Message | Format-Table -AutoSize",
    "parameters": [
      {
        "name": "hours",
        "label": "Nombre d'heures",
        "type": "number",
        "defaultValue": "24",
        "required": true,
        "description": "Nombre d'heures √† analyser en arri√®re"
      }
    ]
  },
  "examples": [
    {
      "command": "Get-WinEvent -FilterHashtable @{LogName='System'; Level=2; StartTime=(Get-Date).AddHours(-24)}",
      "description": "M√©thode performante pour filtrer les erreurs (Level=2) des derni√®res 24h. Beaucoup plus rapide que Get-EventLog sur les gros volumes.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName System -MaxEvents 100",
      "description": "Affiche les 100 derniers √©v√©nements du journal Syst√®me. Get-WinEvent est la cmdlet moderne (remplace Get-EventLog). -MaxEvents limite les r√©sultats. Supporte les journaux classiques ET les nouveaux journaux Applications and Services. Plus rapide et plus flexible que Get-EventLog.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName Application -FilterHashtable @{Level=2; StartTime=(Get-Date).AddHours(-24)}",
      "description": "Filtre les erreurs (Level=2) des derni√®res 24h avec FilterHashtable. -FilterHashtable utilise une table de hachage pour des filtres complexes c√¥t√© serveur (plus rapide que Where-Object). Levels : 1=Critical, 2=Error, 3=Warning, 4=Information. Le filtrage c√¥t√© serveur peut √™tre 10x plus rapide sur de gros journaux.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName Security -FilterHashtable @{ID=4624; StartTime=(Get-Date).AddDays(-1)} | Select-Object TimeCreated,Message -First 50",
      "description": "Affiche les 50 premi√®res connexions r√©ussies (ID 4624) des derni√®res 24h. L'Event ID 4624 = authentification r√©ussie. FilterHashtable filtre efficacement par ID et date. Utile pour auditer les connexions, identifier les patterns d'utilisation et d√©tecter les connexions suspectes.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -ListLog *",
      "description": "Liste TOUS les journaux d'√©v√©nements disponibles sur le syst√®me. Retourne le nom, la taille max, le nombre d'enregistrements et le statut (activ√©/d√©sactiv√©). Il peut y avoir des centaines de journaux (System, Application, Security + tous les journaux Applications and Services). Utilisez cette commande pour d√©couvrir les journaux disponibles.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName 'Microsoft-Windows-PowerShell/Operational' -MaxEvents 20",
      "description": "Affiche les √©v√©nements du journal PowerShell. Les journaux Applications and Services ont des noms avec chemins (slashes). Ce journal enregistre toutes les activit√©s PowerShell : commandes ex√©cut√©es, erreurs, scripts. Essentiel pour l'audit de s√©curit√© et le troubleshooting PowerShell.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName System -FilterHashtable @{ProviderName='Service Control Manager'; ID=7036}",
      "description": "Filtre par fournisseur (source) et ID d'√©v√©nement. ProviderName = composant √©metteur. L'ID 7036 = changement d'√©tat de service (d√©marr√©/arr√™t√©). Retourne l'historique complet des d√©marrages/arr√™ts de services. Utile pour diagnostiquer les services qui crashent ou s'arr√™tent.",
      "platform": 0
    },
    {
      "command": "$xml = 'Security,ApplicationSELECT * FROM Users WHERE Active = 1<Select Path=\"System\">*[System[(Level=1 or Level=2) and TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]</Select></Query></QueryList>'; Get-WinEvent -FilterXml $xml",
      "description": "Filtre avanc√© avec XPath/XML pour les requ√™tes complexes. FilterXml permet des filtres impossibles avec FilterHashtable (conditions multiples, OU logiques complexes, filtres sur le contenu du message). Cet exemple r√©cup√®re Critical OU Error des derni√®res 24h. Courbe d'apprentissage √©lev√©e mais tr√®s puissant.",
      "platform": 0
    },
    {
      "command": "Get-WinEvent -LogName Application -FilterHashtable @{Level=2} | Group-Object ProviderName | Sort-Object Count -Descending | Select-Object Count,Name -First 10",
      "description": "Analyse statistique : top 10 des sources d'erreurs dans Application. Group-Object agr√®ge par fournisseur. Sort trie par fr√©quence. Identifie rapidement les applications les plus probl√©matiques pour prioriser les actions de correction.",
      "platform": 0
    }
  ],
  "notes": "N√©cessite des droits d'administrateur. Utilise Get-WinEvent (recommand√©) plut√¥t que Get-EventLog. Level 1=Critical, 2=Error.",
  "links": [
    {
      "title": "Documentation Get-WinEvent",
      "url": "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent"
    }
  ]
}