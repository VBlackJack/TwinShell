{
  "id": "perf-network-connections",
  "title": "Monitorer les connexions r√©seau actives",
  "description": "Affiche toutes les connexions r√©seau TCP/UDP actives avec les ports locaux/distants, √©tat et processus associ√©.",
  "category": "‚ö° Performance",
  "platform": 2,
  "level": 0,
  "tags": [
    "network",
    "connections",
    "tcp",
    "udp",
    "monitoring",
    "diagnostic",
    "ports",
    "netstat"
  ],
  "windowsCommandTemplateId": "perf-network-connections-win",
  "windowsCommandTemplate": {
    "id": "perf-network-connections-win",
    "platform": 0,
    "name": "Get-NetTCPConnection",
    "commandPattern": "Get-NetTCPConnection | Where-Object {$_.State -eq 'Established'} | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, @{Name='Process';Expression={(Get-Process -Id $_.OwningProcess).ProcessName}} | Format-Table -AutoSize",
    "parameters": []
  },
  "linuxCommandTemplateId": "perf-network-connections-linux",
  "linuxCommandTemplate": {
    "id": "perf-network-connections-linux",
    "platform": 1,
    "name": "netstat",
    "commandPattern": "netstat -tunap | grep ESTABLISHED",
    "parameters": []
  },
  "examples": [
    {
      "command": "netstat -anob",
      "description": "üî• URGENCE : Affiche TOUS les ports √©cout√©s avec le nom de l'ex√©cutable (-b) et le PID (-o). Le flag -n (num√©rique) √©vite les lenteurs de r√©solution DNS. N√©cessite des droits Admin.",
      "platform": 0
    },
    {
      "command": "netstat -an | findstr \"ESTABLISHED\"",
      "description": "Filtre uniquement les connexions actives √©tablies. Utile pour rep√©rer une exfiltration de donn√©es ou une activit√© suspecte en cours.",
      "platform": 0
    },
    {
      "command": "Get-NetTCPConnection | Group-Object State | Select-Object Name, Count",
      "description": "Nombre de connexions par √©tat",
      "platform": 0
    },
    {
      "command": "netstat -ano | findstr ESTABLISHED",
      "description": "Connexions √©tablies avec PID (Windows cmd)",
      "platform": 0
    },
    {
      "command": "ss -tunap | grep ESTAB",
      "description": "Alternative moderne sur Linux (ss au lieu de netstat)",
      "platform": 1
    },
    {
      "command": "netstat -tulpn",
      "description": "Ports en √©coute avec processus",
      "platform": 1
    },
    {
      "command": "netstat -an | grep ESTABLISHED",
      "description": "Connexions √©tablies",
      "platform": 1
    },
    {
      "command": "netstat -r",
      "description": "Table de routage",
      "platform": 1
    }
  ],
  "notes": "√âtats TCP: Established, Listen, TimeWait, CloseWait. Pour UDP, utilisez Get-NetUDPEndpoint. ss est plus rapide que netstat sur Linux.",
  "links": [
    {
      "title": "Documentation Get-NetTCPConnection",
      "url": "https://learn.microsoft.com/en-us/powershell/module/nettcpip/get-nettcpconnection"
    }
  ]
}