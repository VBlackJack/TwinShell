{
  "id": "bitlocker-ad-find-by-recovery-password",
  "title": "Trouver un ordinateur par son mot de passe de r√©cup√©ration BitLocker",
  "description": "Recherche dans AD quel ordinateur correspond √† un mot de passe de r√©cup√©ration BitLocker donn√© (utile quand un utilisateur a le mot de passe mais pas le nom du PC).",
  "category": "üîí Security & Encryption",
  "platform": 0,
  "level": 1,
  "tags": [
    "bitlocker",
    "ad",
    "search",
    "recovery",
    "domain-admin"
  ],
  "windowsCommandTemplateId": "bitlocker-ad-find-by-recovery-password-cmd",
  "windowsCommandTemplate": {
    "id": "bitlocker-ad-find-by-recovery-password-cmd",
    "platform": 0,
    "name": "Get-ADObject",
    "commandPattern": "$searchPassword = '{recoveryPassword}'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Where-Object {$_.'msFVE-RecoveryPassword' -like \"*$searchPassword*\"} | ForEach-Object { $computerDN = ($_.DistinguishedName -split ',',2)[1]; $computer = Get-ADComputer -Identity $computerDN; [PSCustomObject]@{ Computer=$computer.Name; RecoveryPassword=$_.'msFVE-RecoveryPassword'; ComputerDN=$computer.DistinguishedName } }",
    "parameters": [
      {
        "name": "recoveryPassword",
        "label": "Mot de passe de r√©cup√©ration",
        "type": "string",
        "defaultValue": "",
        "required": true,
        "description": "Mot de passe ou d√©but du mot de passe (premiers chiffres)"
      }
    ]
  },
  "examples": [
    {
      "command": "ss -tulpn",
      "description": "üî• STANDARD LINUX : Liste tous les ports TCP/UDP en √©coute (-tul) avec les processus associ√©s (-p) et sans r√©solution DNS (-n). La commande de r√©f√©rence pour savoir 'qui √©coute sur ce port'.",
      "platform": 1
    },
    {
      "command": "ss -s",
      "description": "R√©sum√© statistique rapide des sockets (Total, TCP, UDP). Utile pour d√©tecter une saturation de sockets ou une attaque DDoS.",
      "platform": 1
    },
    {
      "command": "$search = '123456-789012'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Where-Object {$_.'msFVE-RecoveryPassword' -like \"*$search*\"} | ForEach-Object { $computerDN = ($_.DistinguishedName -split ',',2)[1]; (Get-ADComputer -Identity $computerDN).Name }",
      "description": "Trouve l'ordinateur correspondant aux premiers chiffres du mot de passe",
      "platform": 1
    },
    {
      "command": "$fullPassword = '123456-789012-345678-901234-567890-123456-789012-890123'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Where-Object {$_.'msFVE-RecoveryPassword' -eq $fullPassword} | ForEach-Object { $computerDN = ($_.DistinguishedName -split ',',2)[1]; Get-ADComputer -Identity $computerDN | Select-Object Name,DNSHostName }",
      "description": "Trouve l'ordinateur avec le mot de passe complet exact",
      "platform": 1
    },
    {
      "command": "$keyId = '{12345678-1234-1234-1234-123456789012}'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation' -and msFVE-RecoveryGuid -eq '$keyId'\" -Properties msFVE-RecoveryPassword | ForEach-Object { $computerDN = ($_.DistinguishedName -split ',',2)[1]; [PSCustomObject]@{Computer=(Get-ADComputer -Identity $computerDN).Name; Password=$_.'msFVE-RecoveryPassword'} }",
      "description": "Trouve l'ordinateur par GUID de cl√© de r√©cup√©ration",
      "platform": 1
    },
    {
      "command": "$searchPassword = '123456-789012-345678-901234-567890-123456-789012-890123'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Format-Table -AutoSize",
      "description": "Affiche les r√©sultats dans un tableau optimis√© pour la console. Format-Table -AutoSize ajuste automatiquement la largeur des colonnes pour un affichage lisible. Id√©al pour visualiser rapidement les donn√©es structur√©es.",
      "platform": 1
    },
    {
      "command": "$searchPassword = '123456-789012-345678-901234-567890-123456-789012-890123'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Export-Csv C:\\Temp\\Export.csv -NoTypeInformation -Encoding UTF8",
      "description": "Exporte les r√©sultats vers un fichier CSV exploitable dans Excel. -NoTypeInformation supprime la ligne de m√©tadonn√©es. -Encoding UTF8 garantit la compatibilit√© des caract√®res accentu√©s. Utile pour l'archivage, les rapports et l'analyse externe.",
      "platform": 1
    },
    {
      "command": "$searchPassword = '123456-789012-345678-901234-567890-123456-789012-890123'; Get-ADObject -Filter \"objectClass -eq 'msFVE-RecoveryInformation'\" -Properties msFVE-RecoveryPassword | Measure-Object",
      "description": "Compte le nombre total d'objets retourn√©s. Measure-Object retourne Count, Sum, Average, Min, Max selon les propri√©t√©s. Utile pour les statistiques rapides et la validation de r√©sultats.",
      "platform": 1
    }
  ],
  "notes": "CAS D'USAGE: Utilisateur bloqu√© avec √©cran de r√©cup√©ration BitLocker, fournit les premiers chiffres du mot de passe, admin cherche √† quel PC cela correspond. RECHERCHE PARTIELLE: Utilisez les premiers groupes de chiffres (ex: 123456-789012). RECHERCHE COMPL√àTE: Utilisez le mot de passe entier pour match exact. Tr√®s utile pour helpdesk!",
  "links": [
    {
      "title": "BitLocker Recovery Scenarios",
      "url": "https://learn.microsoft.com/en-us/windows/security/operating-system-security/data-protection/bitlocker/recovery-overview"
    }
  ]
}