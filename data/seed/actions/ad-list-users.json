{
  "id": "ad-list-users",
  "title": "Lister tous les utilisateurs Active Directory",
  "description": "Affiche une liste compl√®te de tous les comptes utilisateurs dans Active Directory avec leurs propri√©t√©s principales.",
  "category": "üè¢ Active Directory & GPO",
  "platform": 0,
  "level": 0,
  "tags": [
    "ad",
    "users",
    "list",
    "diagnostic"
  ],
  "windowsCommandTemplateId": "ad-list-users-cmd",
  "windowsCommandTemplate": {
    "id": "ad-list-users-cmd",
    "platform": 0,
    "name": "Get-ADUser",
    "commandPattern": "Get-ADUser -Filter * -Properties DisplayName,EmailAddress,Enabled | Select-Object Name,DisplayName,EmailAddress,Enabled | Format-Table -AutoSize",
    "parameters": []
  },
  "examples": [
    {
      "command": "Get-ADUser -Filter *",
      "description": "Liste tous les utilisateurs Active Directory du domaine avec les propri√©t√©s par d√©faut (Name, SamAccountName, DistinguishedName, etc.). Attention : peut √™tre long sur de gros domaines (>10000 utilisateurs), privil√©gier un filtre plus restrictif en production.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -Properties DisplayName,EmailAddress,Enabled,Department | Select-Object Name,DisplayName,EmailAddress,Enabled,Department | Format-Table -AutoSize",
      "description": "Liste tous les utilisateurs avec leurs informations essentielles. Le param√®tre -Properties charge des propri√©t√©s √©tendues non retourn√©es par d√©faut. Select-Object permet de choisir les colonnes affich√©es. Format-Table -AutoSize optimise l'affichage en console.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter {Enabled -eq $true} -Properties LastLogonDate | Select-Object Name,SamAccountName,LastLogonDate | Sort-Object LastLogonDate -Descending",
      "description": "Liste uniquement les utilisateurs actifs tri√©s par date de derni√®re connexion (du plus r√©cent au plus ancien). Le filtre {Enabled -eq $true} exclut les comptes d√©sactiv√©s. Utile pour identifier les utilisateurs actifs et rep√©rer rapidement les connexions r√©centes.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -Properties LastLogonDate | Where-Object {$_.Enabled -eq $true -and $_.LastLogonDate -lt (Get-Date).AddDays(-90)} | Select-Object Name,SamAccountName,LastLogonDate,Enabled",
      "description": "Audit de s√©curit√© : identifie les utilisateurs actifs qui ne se sont pas connect√©s depuis 90 jours. LastLogonDate n'√©tant pas une propri√©t√© par d√©faut, elle doit √™tre sp√©cifi√©e dans -Properties. Where-Object filtre selon des conditions PowerShell complexes. Essentiel pour les audits trimestriels et l'identification des comptes zombies.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter {Department -like 'IT*'} -Properties Department,Title,Manager -SearchBase 'OU=Users,DC=contoso,DC=com'",
      "description": "Recherche les utilisateurs d'un d√©partement sp√©cifique dans une OU particuli√®re. Le param√®tre -SearchBase limite la recherche √† une branche de l'arbre AD pour am√©liorer significativement les performances (jusqu'√† 10x plus rapide sur de gros domaines). L'op√©rateur -like permet les wildcards (*) pour des recherches partielles.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -Properties * | Select-Object -First 1 | Format-List *",
      "description": "Affiche TOUTES les propri√©t√©s disponibles pour un utilisateur (mode d√©couverte). Le param√®tre -Properties * charge l'int√©gralit√© des 100+ propri√©t√©s AD disponibles (tr√®s co√ªteux en performance). Format-List * affiche chaque propri√©t√© sur une ligne s√©par√©e. Utilisez cette commande uniquement pour d√©couvrir les noms de propri√©t√©s, jamais en production sur de gros volumes.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -Properties Department,EmailAddress,Enabled | Export-Csv -Path C:\\Temp\\ADUsers.csv -NoTypeInformation -Encoding UTF8",
      "description": "Exporte tous les utilisateurs vers un fichier CSV exploitable dans Excel. -NoTypeInformation supprime la ligne de m√©tadonn√©es '#TYPE' du CSV. -Encoding UTF8 garantit la compatibilit√© internationale des caract√®res accentu√©s. Le fichier CSV peut ensuite √™tre utilis√© pour des rapports, des imports ou des analyses tierces.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -ResultSetSize 100 -Properties DisplayName,EmailAddress",
      "description": "Limite le r√©sultat aux 100 premiers utilisateurs pour un aper√ßu rapide. Le param√®tre -ResultSetSize plafonne le nombre de r√©sultats retourn√©s par le serveur AD, ce qui am√©liore drastiquement les performances et r√©duit la consommation m√©moire. Id√©al pour les tests et les v√©rifications rapides.",
      "platform": 0
    }
  ],
  "notes": "N√©cessite le module Active Directory PowerShell. Peut √™tre lent sur de gros domaines.",
  "links": [
    {
      "title": "Documentation Get-ADUser",
      "url": "https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-aduser"
    }
  ]
}