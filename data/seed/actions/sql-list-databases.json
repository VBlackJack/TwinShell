{
  "id": "sql-list-databases",
  "title": "Lister toutes les bases de donn√©es SQL Server",
  "description": "Affiche la liste compl√®te de toutes les bases de donn√©es sur une instance SQL Server avec leur taille, √©tat et mode de r√©cup√©ration.",
  "category": "üíΩ Database",
  "platform": 0,
  "level": 0,
  "tags": [
    "sql",
    "database",
    "list",
    "mssql",
    "sql-server",
    "diagnostic",
    "inventory"
  ],
  "windowsCommandTemplateId": "sql-list-databases-cmd",
  "windowsCommandTemplate": {
    "id": "sql-list-databases-cmd",
    "platform": 0,
    "name": "Invoke-Sqlcmd",
    "commandPattern": "Invoke-Sqlcmd -ServerInstance '{serverInstance}' -Query \"SELECT name AS DatabaseName, database_id AS ID, state_desc AS State, recovery_model_desc AS RecoveryModel, (SELECT SUM(size)*8/1024 FROM sys.master_files WHERE database_id = d.database_id) AS SizeMB FROM sys.databases d ORDER BY name\" | Format-Table -AutoSize",
    "parameters": [
      {
        "name": "serverInstance",
        "label": "Instance SQL Server",
        "type": "string",
        "defaultValue": "localhost",
        "required": true,
        "description": "Nom de l'instance SQL Server (ex: localhost, SERVER\\INSTANCE)"
      }
    ]
  },
  "examples": [
    {
      "command": "Invoke-Sqlcmd -ServerInstance 'localhost' -Query \"SELECT name, state_desc FROM sys.databases\"",
      "description": "Liste simple des bases et leur √©tat",
      "platform": 0
    },
    {
      "command": "Invoke-Sqlcmd -ServerInstance 'PROD-SQL\\INSTANCE1' -Query \"SELECT * FROM sys.databases\"",
      "description": "Liste d√©taill√©e sur une instance nomm√©e",
      "platform": 0
    },
    {
      "command": "Invoke-Sqlcmd -ServerInstance 'localhost' -Query \"SELECT name AS DatabaseName, database_id AS ID, state_desc AS State, recovery_model_desc AS RecoveryModel, (SELECT SUM(size)*8/1024 FROM sys.master_files WHERE database_id = d.database_id) AS SizeMB FROM sys.databases d ORDER BY name\" | Format-Table -AutoSize",
      "description": "Exemple utilisant le param√®tre 'serverInstance': Nom de l'instance SQL Server (ex: localhost, SERVER\\INSTANCE). Remplacez localhost\\SQLEXPRESS par la valeur appropri√©e selon votre environnement.",
      "platform": 0
    },
    {
      "command": "Invoke-Sqlcmd -ServerInstance 'localhost\\SQLEXPRESS' -Query \"SELECT name AS DatabaseName, database_id AS ID, state_desc AS State, recovery_model_desc AS RecoveryModel, (SELECT SUM(size)*8/1024 FROM sys.master_files WHERE database_id = d.database_id) AS SizeMB FROM sys.databases d ORDER BY name\" | Format-Table -AutoSize",
      "description": "Cas d'usage standard. Affiche la liste compl√®te de toutes les bases de donn√©es sur une instance SQL Server avec leur taille, √©tat et mode de r√©cup√©ration. Consultez la documentation pour des param√®tres avanc√©s et des options de filtrage.",
      "platform": 0
    }
  ],
  "notes": "N√©cessite le module SqlServer PowerShell ou sqlcmd.exe. Privil√®ges de lecture requis sur sys.databases.",
  "links": [
    {
      "title": "Documentation Invoke-Sqlcmd",
      "url": "https://learn.microsoft.com/en-us/powershell/module/sqlserver/invoke-sqlcmd"
    }
  ]
}