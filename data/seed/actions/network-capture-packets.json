{
  "id": "network-capture-packets",
  "title": "Capturer le trafic r√©seau",
  "description": "D√©marre une capture de paquets r√©seau avec netsh trace pour analyse ult√©rieure",
  "category": "üåê Network & DNS",
  "platform": 2,
  "level": 1,
  "tags": [
    "network",
    "capture",
    "packets",
    "trace",
    "diagnostic"
  ],
  "windowsCommandTemplateId": "network-capture-packets-cmd",
  "windowsCommandTemplate": {
    "id": "network-capture-packets-cmd",
    "platform": 0,
    "name": "netsh",
    "commandPattern": "netsh trace start capture=yes tracefile={outputPath} maxSize={maxSizeMB}",
    "parameters": [
      {
        "name": "outputPath",
        "label": "Fichier de sortie",
        "type": "string",
        "defaultValue": "C:\\Temp\\networktrace.etl",
        "required": true,
        "description": "Chemin complet du fichier de trace (.etl)"
      },
      {
        "name": "maxSizeMB",
        "label": "Taille maximale (MB)",
        "type": "number",
        "defaultValue": "250",
        "required": true,
        "description": "Taille maximale du fichier en MB"
      }
    ]
  },
  "examples": [],
  "notes": "ATTENTION: N√©cessite droits administrateur. Pour arr√™ter: 'netsh trace stop'. Le fichier .etl peut √™tre analys√© avec Microsoft Network Monitor ou Wireshark.",
  "links": [
    {
      "title": "Netsh Trace Commands",
      "url": "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj129382(v=ws.11)"
    }
  ],
  "linuxCommandTemplate": {
    "id": "tcpdump-cmd",
    "platform": 1,
    "name": "tcpdump",
    "commandPattern": "tcpdump -i {interface} -c {count} {filter}",
    "parameters": [
      {
        "name": "interface",
        "label": "Interface",
        "type": "string",
        "defaultValue": "any",
        "required": true,
        "description": "Interface r√©seau (any, eth0, wlan0, etc.)"
      },
      {
        "name": "count",
        "label": "Nombre de paquets",
        "type": "number",
        "defaultValue": "100",
        "required": true,
        "description": "Nombre de paquets √† capturer"
      },
      {
        "name": "filter",
        "label": "Filtre",
        "type": "string",
        "defaultValue": "",
        "required": false,
        "description": "Filtre BPF (port 80, host 192.168.1.1, etc.)"
      }
    ]
  },
  "windowsExamples": [
    {
      "command": "netsh trace start capture=yes tracefile=C:\\Temp\\trace.etl maxSize=500",
      "description": "D√©marre une capture r√©seau (max 500 MB)",
      "platform": 0
    },
    {
      "command": "netsh trace start capture=yes tracefile=C:\\Reports\\output.txt maxSize=100",
      "description": "Ex√©cution standard de la commande None. Consultez la documentation officielle avec Get-Help netsh -Full pour plus de d√©tails sur les param√®tres disponibles et les cas d'usage avanc√©s.",
      "platform": 0
    }
  ],
  "linuxExamples": [
    {
      "command": "tcpdump -i any port 80 -A -n",
      "description": "üî• DEBUG APP : Capture le trafic HTTP et affiche le contenu en ASCII (-A). Le flag -n est CRITIQUE pour la vitesse (pas de DNS). Permet de lire les headers HTTP en temps r√©el.",
      "platform": 1
    },
    {
      "command": "tcpdump -i eth0 host 192.168.1.50 -w capture.pcap",
      "description": "Capture tout le trafic d'une IP cible vers un fichier (-w) pour analyse ult√©rieure sur Wireshark. Ne sature pas la console.",
      "platform": 1
    },
    {
      "command": "tcpdump -i eth0 dst port 53",
      "description": "Audit DNS : Surveille uniquement les requ√™tes DNS sortantes. Utile pour diagnostiquer des probl√®mes de r√©solution ou rep√©rer des malwares communiquant par DNS.",
      "platform": 1
    },
    {
      "command": "sudo tcpdump -i any -c 100",
      "description": "Capture 100 paquets sur toutes les interfaces",
      "platform": 1
    },
    {
      "command": "sudo tcpdump -i eth0 port 80",
      "description": "Capture uniquement le trafic HTTP",
      "platform": 1
    },
    {
      "command": "sudo tcpdump -i any -w capture.pcap",
      "description": "Sauvegarde dans un fichier pcap",
      "platform": 1
    },
    {
      "command": "tcpdump -i eth0",
      "description": "Capturer sur eth0",
      "platform": 1
    },
    {
      "command": "tcpdump -i any port 80",
      "description": "Trafic HTTP",
      "platform": 1
    },
    {
      "command": "tcpdump -w capture.pcap",
      "description": "Sauvegarder dans un fichier",
      "platform": 1
    },
    {
      "command": "tcpdump -r capture.pcap",
      "description": "Lire un fichier de capture",
      "platform": 1
    },
    {
      "command": "tcpdump host 192.168.1.100",
      "description": "Trafic vers/depuis une IP",
      "platform": 1
    }
  ],
  "linuxCommandTemplateId": "tcpdump-cmd"
}