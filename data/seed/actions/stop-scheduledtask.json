{
  "id": "stop-scheduledtask",
  "title": "Arrêter une tâche planifiée",
  "description": "Arrête l'exécution en cours d'une tâche planifiée",
  "category": "⚙️ Services & Automation",
  "platform": 0,
  "level": 1,
  "tags": [
    "taskscheduler",
    "stop",
    "kill",
    "automation",
    "windows"
  ],
  "windowsCommandTemplateId": "stop-scheduledtask-cmd",
  "windowsCommandTemplate": {
    "id": "stop-scheduledtask-cmd",
    "platform": 0,
    "name": "Stop-ScheduledTask",
    "commandPattern": "Stop-ScheduledTask -TaskName '{taskname}' {taskpath}",
    "parameters": [
      {
        "name": "taskname",
        "label": "Nom de la tâche",
        "type": "string",
        "defaultValue": "MyTask",
        "required": true,
        "description": "Nom de la tâche à arrêter"
      },
      {
        "name": "taskpath",
        "label": "Chemin",
        "type": "string",
        "defaultValue": "",
        "required": false,
        "description": "Chemin de la tâche"
      }
    ]
  },
  "examples": [
    {
      "command": "Stop-ScheduledTask -TaskName 'LongRunningTask'",
      "description": "Arrête une tâche en cours d'exécution",
      "platform": 0
    },
    {
      "command": "Get-ScheduledTask | Where-Object {$_.State -eq 'Running'} | Stop-ScheduledTask",
      "description": "Arrête toutes les tâches en cours",
      "platform": 0
    },
    {
      "command": "Stop-ScheduledTask -TaskName 'DailyBackup' \\Microsoft\\Windows\\ -PassThru",
      "description": "Exécute l'action et retourne l'objet résultant pour vérification immédiate. -PassThru permet de confirmer que l'opération a réussi en affichant le statut final. Utile pour les scripts avec gestion d'erreurs.",
      "platform": 0
    },
    {
      "command": "Stop-ScheduledTask -TaskName 'DailyBackup' \\Microsoft\\Windows\\ -Force",
      "description": "Force l'action même en cas de résistance (services dépendants, processus protégés, etc.). -Force contourne certaines sécurités. À utiliser avec précaution après avoir vérifié les dépendances.",
      "platform": 0
    },
    {
      "command": "Stop-ScheduledTask -TaskName 'MyTask' \\Microsoft\\Windows\\",
      "description": "Exemple utilisant le paramètre 'taskname': Nom de la tâche à arrêter. Remplacez DailyBackup par la valeur appropriée selon votre environnement.",
      "platform": 0
    },
    {
      "command": "Stop-ScheduledTask -TaskName 'DailyBackup' \\Microsoft\\Windows\\",
      "description": "Exemple utilisant le paramètre 'taskpath': Chemin de la tâche. Remplacez \\Microsoft\\Windows\\ par la valeur appropriée selon votre environnement.",
      "platform": 0
    }
  ],
  "notes": "Termine immédiatement l'exécution. Utilisez avec prudence sur les tâches critiques.",
  "links": [
    {
      "title": "Stop-ScheduledTask Documentation",
      "url": "https://learn.microsoft.com/en-us/powershell/module/scheduledtasks/stop-scheduledtask"
    }
  ]
}