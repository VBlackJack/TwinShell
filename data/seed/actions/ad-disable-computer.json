{
  "id": "ad-disable-computer",
  "title": "D√©sactiver un compte ordinateur AD",
  "description": "D√©sactive un compte ordinateur Active Directory.",
  "category": "üè¢ Active Directory & GPO",
  "platform": 0,
  "level": 2,
  "tags": [
    "ad",
    "computer",
    "disable"
  ],
  "windowsCommandTemplateId": "ad-disable-computer-cmd",
  "windowsCommandTemplate": {
    "id": "ad-disable-computer-cmd",
    "platform": 0,
    "name": "Disable-ADAccount",
    "commandPattern": "Disable-ADAccount -Identity {computerName}$",
    "parameters": [
      {
        "name": "computerName",
        "label": "Nom de l'ordinateur",
        "type": "string",
        "defaultValue": "",
        "required": true,
        "description": "Nom de l'ordinateur AD (sans le $)"
      }
    ]
  },
  "examples": [
    {
      "command": "Disable-ADAccount -Identity jdupont",
      "description": "D√©sactive imm√©diatement le compte de jdupont. L'utilisateur ne pourra plus se connecter mais le compte et toutes ses donn√©es restent dans AD. La d√©sactivation est r√©versible avec Enable-ADAccount. M√©thode recommand√©e pour les d√©parts temporaires (cong√©s longs, suspensions).",
      "platform": 0
    },
    {
      "command": "Disable-ADAccount -Identity jdupont -Confirm:$false",
      "description": "D√©sactive le compte sans demander de confirmation. Le param√®tre -Confirm:$false supprime l'invite (utile pour les scripts automatis√©s). Utilisez avec pr√©caution : la d√©sactivation est imm√©diate et peut d√©connecter l'utilisateur de toutes ses sessions actives.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter {Enabled -eq $true -and LastLogonDate -lt (Get-Date).AddDays(-180)} -Properties LastLogonDate | Disable-ADAccount -WhatIf",
      "description": "Simulation de d√©sactivation des comptes inactifs depuis 180 jours. Le switch -WhatIf affiche ce qui serait fait SANS ex√©cuter l'action (mode dry-run). Indispensable avant toute action de masse pour √©viter les erreurs. Retirez -WhatIf apr√®s v√©rification pour ex√©cuter r√©ellement.",
      "platform": 0
    },
    {
      "command": "Get-ADUser jdupont -Properties Enabled | Select-Object Name,Enabled,SamAccountName",
      "description": "V√©rifie si un compte est actif ou d√©sactiv√©. La propri√©t√© Enabled vaut $true (actif) ou $false (d√©sactiv√©). Toujours v√©rifier l'√©tat avant de d√©sactiver ou r√©activer. Utile aussi pour les scripts de reporting et les tableaux de bord.",
      "platform": 0
    },
    {
      "command": "Disable-ADAccount -Identity jdupont -PassThru | Set-ADUser -Description \"Compte d√©sactiv√© le $(Get-Date -Format 'dd/MM/yyyy') - D√©part entreprise\"",
      "description": "D√©sactive le compte et ajoute automatiquement une note avec la date et la raison. Le switch -PassThru permet de passer l'objet au pipeline. Set-ADUser -Description documente l'action pour la tra√ßabilit√©. Excellente pratique pour les audits : toujours documenter les raisons de d√©sactivation.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter {Department -eq 'Finance' -and Enabled -eq $true} | Select-Object Name,SamAccountName | Export-Csv C:\\Temp\\FinanceUsersBeforeDisable.csv -NoTypeInformation; Get-ADUser -Filter {Department -eq 'Finance'} | Disable-ADAccount",
      "description": "D√©sactivation massive avec sauvegarde pr√©alable : exporte d'abord la liste des utilisateurs Finance actifs, puis les d√©sactive tous. La sauvegarde CSV permet une restauration en cas d'erreur. Les deux commandes sont s√©par√©es par un point-virgule pour ex√©cution s√©quentielle. Toujours faire une sauvegarde avant une op√©ration de masse.",
      "platform": 0
    },
    {
      "command": "Get-ADUser -Filter * -Properties Enabled,LastLogonDate | Where-Object {$_.Enabled -eq $false} | Select-Object Name,SamAccountName,Enabled,LastLogonDate | Export-Csv C:\\Temp\\DisabledAccounts.csv -NoTypeInformation",
      "description": "Exporte un rapport complet de tous les comptes d√©sactiv√©s avec leur derni√®re connexion. Utile pour les audits de s√©curit√©, l'analyse des comptes dormants et la pr√©paration au nettoyage de l'AD. Effectuez ce rapport trimestriellement pour maintenir un AD propre.",
      "platform": 0
    }
  ],
  "notes": "L'ordinateur ne pourra plus communiquer avec le domaine. Utile pour les machines retir√©es du service.",
  "links": []
}