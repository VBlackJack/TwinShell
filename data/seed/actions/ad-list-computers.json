{
  "id": "ad-list-computers",
  "title": "Lister tous les ordinateurs AD",
  "description": "Affiche la liste de tous les comptes ordinateur dans Active Directory.",
  "category": "üè¢ Active Directory & GPO",
  "platform": 0,
  "level": 0,
  "tags": [
    "ad",
    "computers",
    "list"
  ],
  "windowsCommandTemplateId": "ad-list-computers-cmd",
  "windowsCommandTemplate": {
    "id": "ad-list-computers-cmd",
    "platform": 0,
    "name": "Get-ADComputer",
    "commandPattern": "Get-ADComputer -Filter * -Properties OperatingSystem,LastLogonDate,Enabled | Select-Object Name,OperatingSystem,LastLogonDate,Enabled | Format-Table -AutoSize",
    "parameters": []
  },
  "examples": [
    {
      "command": "Get-ADComputer -Filter *",
      "description": "Liste tous les ordinateurs du domaine Active Directory avec leurs propri√©t√©s par d√©faut. Retourne Name, DNSHostName, DistinguishedName, Enabled, etc. Attention : peut √™tre tr√®s long sur de gros domaines avec des milliers de machines.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Filter {OperatingSystem -like '*Server*'} -Properties OperatingSystem,OperatingSystemVersion",
      "description": "Liste uniquement les serveurs Windows. Le filtre sur OperatingSystem identifie les OS serveurs (Windows Server 2012/2016/2019/2022). Utile pour l'inventaire des serveurs, les rapports de compliance et la planification des mises √† jour.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Filter {Enabled -eq $true} -Properties LastLogonDate | Where-Object {$_.LastLogonDate -lt (Get-Date).AddDays(-90)} | Select-Object Name,LastLogonDate,Enabled",
      "description": "Identifie les ordinateurs actifs mais non connect√©s depuis 90 jours. D√©tecte les machines zombies, les postes perdus ou vol√©s. LastLogonDate doit √™tre sp√©cifi√© dans -Properties. Essentiel pour le nettoyage AD et les audits de s√©curit√©.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Filter {Name -like 'LAPTOP-*'} -Properties OperatingSystem,IPv4Address",
      "description": "Recherche tous les ordinateurs portables (selon une convention de nommage). Retourne l'OS et l'adresse IP. Utile pour l'inventaire des laptops, la gestion du parc mobile et les d√©ploiements cibl√©s.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Filter * -Properties * | Select-Object -First 1 | Format-List *",
      "description": "Affiche TOUTES les propri√©t√©s disponibles pour un ordinateur (mode d√©couverte). -Properties * charge toutes les propri√©t√©s (co√ªteux). Format-List * affiche chaque propri√©t√© sur une ligne. Utilisez uniquement pour d√©couvrir les noms de propri√©t√©s disponibles.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Filter * -Properties OperatingSystem,OperatingSystemVersion,Created | Select-Object Name,OperatingSystem,OperatingSystemVersion,Created | Export-Csv C:\\Temp\\ComputerInventory.csv -NoTypeInformation",
      "description": "Exporte un inventaire complet des ordinateurs avec OS et date de cr√©ation. Le CSV peut √™tre import√© dans Excel pour analyse, reporting ou documentation. Utile pour les audits, la gestion du parc et les statistiques.",
      "platform": 0
    },
    {
      "command": "Get-ADComputer -Identity WKS-IT-01 -Properties *",
      "description": "Affiche toutes les informations d'un ordinateur sp√©cifique. -Identity accepte le nom, DN, GUID ou SID. Retourne toutes les propri√©t√©s. Utile pour le troubleshooting et la v√©rification de configuration d'une machine.",
      "platform": 0
    }
  ],
  "notes": "Peut √™tre lent sur de gros domaines. Pour filtrer par OS, utiliser -Filter {OperatingSystem -like '*Windows*'}.",
  "links": [
    {
      "title": "Documentation Get-ADComputer",
      "url": "https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-adcomputer"
    }
  ]
}